{"timestamp": "2025-11-13T05:04:40.859903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:04:40.905033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030764910130718953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:04:47.121427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891268739852424, "overlap_percentage": 0.9425088260296312, "num_intersection": 1738499, "num_union": 1950589, "num_only_computed": 200957, "num_only_roped": 11133, "total_diff": 212090, "diff_percentage": 0.10873126014757593, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:04:49.947979", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.67572021484375e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.016053082191780824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:08.849130", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9110305475423017, "overlap_percentage": 0.9534442541632219, "num_intersection": 2583300, "num_union": 2835580, "num_only_computed": 194812, "num_only_roped": 57468, "total_diff": 252280, "diff_percentage": 0.08896945245769824, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:09.501483", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.015393518518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:31.896715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9041839096135733, "overlap_percentage": 0.9496812834607603, "num_intersection": 3394480, "num_union": 3754192, "num_only_computed": 222288, "num_only_roped": 137424, "total_diff": 359712, "diff_percentage": 0.09581609038642669, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:32.884018", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.155801773071289e-06, "l2_diff": 0.2294921875, "l2_diff_relative": 0.025499131944444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:00.834004", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8853446280904005, "overlap_percentage": 0.939185987430993, "num_intersection": 4170106, "num_union": 4710150, "num_only_computed": 286342, "num_only_roped": 253702, "total_diff": 540044, "diff_percentage": 0.11465537190959948, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:01.903840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.6656856536865234e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.01965725806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:38.219689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8562049947638877, "overlap_percentage": 0.9225327991026102, "num_intersection": 4884319, "num_union": 5704614, "num_only_computed": 410785, "num_only_roped": 409510, "total_diff": 820295, "diff_percentage": 0.14379500523611238, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:41.109708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.637505531311035e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01688878676470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:07:23.853994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8262820426933206, "overlap_percentage": 0.9048788997287145, "num_intersection": 5550310, "num_union": 6717210, "num_only_computed": 583450, "num_only_roped": 583450, "total_diff": 1166900, "diff_percentage": 0.1737179573066794, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:07:25.189949", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.4884939193725586e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.017269736842105265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:08:12.073078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8059319200143181, "overlap_percentage": 0.8925385404427963, "num_intersection": 6223150, "num_union": 7721682, "num_only_computed": 749266, "num_only_roped": 749266, "total_diff": 1498532, "diff_percentage": 0.19406807998568187, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:08:13.677112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.019369834710743803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:09:14.483775", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7891991867018212, "overlap_percentage": 0.8821814726582984, "num_intersection": 6890783, "num_union": 8731361, "num_only_computed": 920289, "num_only_roped": 920289, "total_diff": 1840578, "diff_percentage": 0.21080081329817882, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:09:16.507241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.20815899581589958}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:10:22.720090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7753736041312328, "overlap_percentage": 0.8734765486283735, "num_intersection": 7556229, "num_union": 9745275, "num_only_computed": 1094523, "num_only_roped": 1094523, "total_diff": 2189046, "diff_percentage": 0.22462639586876718, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:10:25.008641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.5636363636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:11:37.115702", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7673283480017701, "overlap_percentage": 0.8683483732599547, "num_intersection": 8240112, "num_union": 10738704, "num_only_computed": 1249296, "num_only_roped": 1249296, "total_diff": 2498592, "diff_percentage": 0.23267165199822995, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:11:39.683620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 3.933906555175781e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.30128205128205127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:12:51.421588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7213319730945527, "overlap_percentage": 0.8381090741000603, "num_intersection": 507672, "num_union": 703798, "num_only_computed": 98063, "num_only_roped": 98063, "total_diff": 196126, "diff_percentage": 0.2786680269054473, "num_computed": 605735, "num_roped": 605735}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:12:54.100967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08740234375, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.17692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:14:00.012737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7204445365354698, "overlap_percentage": 0.8375097496444247, "num_intersection": 219049, "num_union": 304047, "num_only_computed": 42499, "num_only_roped": 42499, "total_diff": 84998, "diff_percentage": 0.27955546346453014, "num_computed": 261548, "num_roped": 261548}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:14:02.569947", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.11767578125, "l2_diff_relative": 0.09297839506172839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:15:06.523487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7190173889042231, "overlap_percentage": 0.8365446371226718, "num_intersection": 7815, "num_union": 10869, "num_only_computed": 1527, "num_only_roped": 1527, "total_diff": 3054, "diff_percentage": 0.280982611095777, "num_computed": 9342, "num_roped": 9342}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:15:10.695867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.017578125, "l2_diff_relative": 0.08035714285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:16:13.309213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7171475831648594, "overlap_percentage": 0.835277748046666, "num_intersection": 7804, "num_union": 10882, "num_only_computed": 1539, "num_only_roped": 1539, "total_diff": 3078, "diff_percentage": 0.2828524168351406, "num_computed": 9343, "num_roped": 9343}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:16:15.490632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00506591796875, "mean_diff": 1.430511474609375e-05, "l2_diff": 0.0126953125, "l2_diff_relative": 0.051181102362204724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:19.252484", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7219202063945452, "overlap_percentage": 0.838505993150685, "num_intersection": 7835, "num_union": 10853, "num_only_computed": 1509, "num_only_roped": 1509, "total_diff": 3018, "diff_percentage": 0.2780797936054547, "num_computed": 9344, "num_roped": 9344}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:21.226720", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.3034188034188034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:18:25.719466", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7069784435513335, "overlap_percentage": 0.8283390410958904, "num_intersection": 7740, "num_union": 10948, "num_only_computed": 1604, "num_only_roped": 1604, "total_diff": 3208, "diff_percentage": 0.2930215564486664, "num_computed": 9344, "num_roped": 9344}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:18:27.756947", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008056640625, "mean_diff": 1.3470649719238281e-05, "l2_diff": 0.0152587890625, "l2_diff_relative": 0.07038288288288289}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:04:59.450594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:04:59.496366", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030764910130718953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:06.649609", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891268739852424, "overlap_percentage": 0.9425088260296312, "num_intersection": 1738499, "num_union": 1950589, "num_only_computed": 200957, "num_only_roped": 11133, "total_diff": 212090, "diff_percentage": 0.10873126014757593, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:07.051051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.67572021484375e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.016053082191780824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:23.432513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9110305475423017, "overlap_percentage": 0.9534442541632219, "num_intersection": 2583300, "num_union": 2835580, "num_only_computed": 194812, "num_only_roped": 57468, "total_diff": 252280, "diff_percentage": 0.08896945245769824, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:24.062654", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.976987838745117e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.015393518518518518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:45.405794", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9041839096135733, "overlap_percentage": 0.9496812834607603, "num_intersection": 3394480, "num_union": 3754192, "num_only_computed": 222288, "num_only_roped": 137424, "total_diff": 359712, "diff_percentage": 0.09581609038642669, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:05:46.596032", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.155801773071289e-06, "l2_diff": 0.2294921875, "l2_diff_relative": 0.025499131944444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:16.546699", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8853446280904005, "overlap_percentage": 0.939185987430993, "num_intersection": 4170106, "num_union": 4710150, "num_only_computed": 286342, "num_only_roped": 253702, "total_diff": 540044, "diff_percentage": 0.11465537190959948, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:17.690784", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.6656856536865234e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.01965725806451613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:53.457333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8562049947638877, "overlap_percentage": 0.9225327991026102, "num_intersection": 4884319, "num_union": 5704614, "num_only_computed": 410785, "num_only_roped": 409510, "total_diff": 820295, "diff_percentage": 0.14379500523611238, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:06:55.932392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.637505531311035e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01688878676470588}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:07:37.016202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8262820426933206, "overlap_percentage": 0.9048788997287145, "num_intersection": 5550310, "num_union": 6717210, "num_only_computed": 583450, "num_only_roped": 583450, "total_diff": 1166900, "diff_percentage": 0.1737179573066794, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:07:38.358521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.4884939193725586e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.017269736842105265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:08:26.207997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8059319200143181, "overlap_percentage": 0.8925385404427963, "num_intersection": 6223150, "num_union": 7721682, "num_only_computed": 749266, "num_only_roped": 749266, "total_diff": 1498532, "diff_percentage": 0.19406807998568187, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:08:27.892415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.019369834710743803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:09:28.871876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7891991867018212, "overlap_percentage": 0.8821814726582984, "num_intersection": 6890783, "num_union": 8731361, "num_only_computed": 920289, "num_only_roped": 920289, "total_diff": 1840578, "diff_percentage": 0.21080081329817882, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:09:30.897923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0869140625, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.5546875, "l2_diff_relative": 0.20815899581589958}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:10:36.583373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7753736041312328, "overlap_percentage": 0.8734765486283735, "num_intersection": 7556229, "num_union": 9745275, "num_only_computed": 1094523, "num_only_roped": 1094523, "total_diff": 2189046, "diff_percentage": 0.22462639586876718, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:10:38.905654", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 6.914138793945312e-05, "l2_diff": 2.90625, "l2_diff_relative": 0.5636363636363636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:11:51.099275", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7673283480017701, "overlap_percentage": 0.8683483732599547, "num_intersection": 8240112, "num_union": 10738704, "num_only_computed": 1249296, "num_only_roped": 1249296, "total_diff": 2498592, "diff_percentage": 0.23267165199822995, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:11:53.753753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 3.933906555175781e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.30128205128205127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:13:04.192206", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7213319730945527, "overlap_percentage": 0.8381090741000603, "num_intersection": 507672, "num_union": 703798, "num_only_computed": 98063, "num_only_roped": 98063, "total_diff": 196126, "diff_percentage": 0.2786680269054473, "num_computed": 605735, "num_roped": 605735}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "mask_shape": [1, 32, 65, 11329], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:13:07.802036", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08740234375, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.359375, "l2_diff_relative": 0.17692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 65, "seq_len_k": 11329, "queries_shape": [1, 32, 65, 128], "keys_shape": [1, 8, 11329, 128], "attention_shape": [1, 32, 65, 11329]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:14:13.708073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7204445365354698, "overlap_percentage": 0.8375097496444247, "num_intersection": 219049, "num_union": 304047, "num_only_computed": 42499, "num_only_roped": 42499, "total_diff": 84998, "diff_percentage": 0.27955546346453014, "num_computed": 261548, "num_roped": 261548}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 28, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:14:16.167184", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.11767578125, "l2_diff_relative": 0.09297839506172839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 11357, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 28, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:15:19.945722", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7190173889042231, "overlap_percentage": 0.8365446371226718, "num_intersection": 7815, "num_union": 10869, "num_only_computed": 1527, "num_only_roped": 1527, "total_diff": 3054, "diff_percentage": 0.280982611095777, "num_computed": 9342, "num_roped": 9342}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "mask_shape": [1, 32, 1, 11358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:15:24.374166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.017578125, "l2_diff_relative": 0.08035714285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11358, 128], "attention_shape": [1, 32, 1, 11358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:16:27.481430", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7171475831648594, "overlap_percentage": 0.835277748046666, "num_intersection": 7804, "num_union": 10882, "num_only_computed": 1539, "num_only_roped": 1539, "total_diff": 3078, "diff_percentage": 0.2828524168351406, "num_computed": 9343, "num_roped": 9343}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "mask_shape": [1, 32, 1, 11359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:16:29.866618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00506591796875, "mean_diff": 1.430511474609375e-05, "l2_diff": 0.0126953125, "l2_diff_relative": 0.051181102362204724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11359, 128], "attention_shape": [1, 32, 1, 11359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:32.536268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7219202063945452, "overlap_percentage": 0.838505993150685, "num_intersection": 7835, "num_union": 10853, "num_only_computed": 1509, "num_only_roped": 1509, "total_diff": 3018, "diff_percentage": 0.2780797936054547, "num_computed": 9344, "num_roped": 9344}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "mask_shape": [1, 32, 1, 11360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:17:34.604537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.3034188034188034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11360, 128], "attention_shape": [1, 32, 1, 11360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:18:37.948104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7069784435513335, "overlap_percentage": 0.8283390410958904, "num_intersection": 7740, "num_union": 10948, "num_only_computed": 1604, "num_only_roped": 1604, "total_diff": 3208, "diff_percentage": 0.2930215564486664, "num_computed": 9344, "num_roped": 9344}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "mask_shape": [1, 32, 1, 11361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:18:40.488421", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008056640625, "mean_diff": 1.3470649719238281e-05, "l2_diff": 0.0152587890625, "l2_diff_relative": 0.07038288288288289}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11361, 128], "attention_shape": [1, 32, 1, 11361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:22.297225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:22.313734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003127639358108108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:29.474317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8913996433650833, "overlap_percentage": 0.9425820148502828, "num_intersection": 1738634, "num_union": 1950454, "num_only_computed": 200822, "num_only_roped": 10998, "total_diff": 211820, "diff_percentage": 0.1086003566349168, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:31.010643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.014818548387096774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:48.972110", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.909931298753847, "overlap_percentage": 0.9528419156726113, "num_intersection": 2581668, "num_union": 2837212, "num_only_computed": 196444, "num_only_roped": 59100, "total_diff": 255544, "diff_percentage": 0.09006870124615292, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:19:49.602180", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.015219155844155844}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:20:10.758728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9042630385004299, "overlap_percentage": 0.9497249279306702, "num_intersection": 3394636, "num_union": 3754036, "num_only_computed": 222132, "num_only_roped": 137268, "total_diff": 359400, "diff_percentage": 0.09573696149957006, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:20:12.459900", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.692243576049805e-06, "l2_diff": 0.232421875, "l2_diff_relative": 0.02618838028169014}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:20:42.841119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8868496532270042, "overlap_percentage": 0.9400321342087435, "num_intersection": 4173863, "num_union": 4706393, "num_only_computed": 282585, "num_only_roped": 249945, "total_diff": 532530, "diff_percentage": 0.11315034677299579, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:20:43.903324", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.01730769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:21:19.450267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8570451977391221, "overlap_percentage": 0.9230202892019432, "num_intersection": 4886900, "num_union": 5702033, "num_only_computed": 408204, "num_only_roped": 406929, "total_diff": 815133, "diff_percentage": 0.14295480226087784, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:21:21.923732", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.7120113372802734e-06, "l2_diff": 0.11767578125, "l2_diff_relative": 0.01394675925925926}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:22:03.502989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8273906304580497, "overlap_percentage": 0.9055432556865609, "num_intersection": 5554385, "num_union": 6713135, "num_only_computed": 579375, "num_only_roped": 579375, "total_diff": 1158750, "diff_percentage": 0.17260936954195022, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:22:04.829377", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.5779008865356445e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.018287037037037036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:22:53.404469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8071158847594343, "overlap_percentage": 0.8932641139025554, "num_intersection": 6228209, "num_union": 7716623, "num_only_computed": 744207, "num_only_roped": 744207, "total_diff": 1488414, "diff_percentage": 0.19288411524056573, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:22:56.525858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.175569534301758e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.015513392857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:23:55.819272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7927086933750488, "overlap_percentage": 0.8843697766452543, "num_intersection": 6907876, "num_union": 8714268, "num_only_computed": 903196, "num_only_roped": 903196, "total_diff": 1806392, "diff_percentage": 0.20729130662495118, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:23:57.823874", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07763671875, "mean_diff": 2.5987625122070312e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.12692307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:25:04.315566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7742133432215765, "overlap_percentage": 0.8727398496685606, "num_intersection": 7549856, "num_union": 9751648, "num_only_computed": 1100896, "num_only_roped": 1100896, "total_diff": 2201792, "diff_percentage": 0.2257866567784235, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:25:06.611968", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 4.410743713378906e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.2832618025751073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:26:18.487902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7602303541446411, "overlap_percentage": 0.8637850748961369, "num_intersection": 8196809, "num_union": 10782007, "num_only_computed": 1292599, "num_only_roped": 1292599, "total_diff": 2585198, "diff_percentage": 0.23976964585535884, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:26:21.760734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 5.1021575927734375e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.43386243386243384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:27:39.094820", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7503703922140862, "overlap_percentage": 0.8573846947501487, "num_intersection": 8855124, "num_union": 11801004, "num_only_computed": 1472940, "num_only_roped": 1472940, "total_diff": 2945880, "diff_percentage": 0.2496296077859138, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:27:43.794974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10205078125, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.27427184466019416}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:29:08.009518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.742061696770389, "overlap_percentage": 0.8519350355341586, "num_intersection": 9513320, "num_union": 12820120, "num_only_computed": 1653400, "num_only_roped": 1653400, "total_diff": 3306800, "diff_percentage": 0.257938303229611, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:29:10.857433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 4.00543212890625e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.32790697674418606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:30:42.631783", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7366665292421326, "overlap_percentage": 0.8483684309429376, "num_intersection": 10184982, "num_union": 13825770, "num_only_computed": 1820394, "num_only_roped": 1820394, "total_diff": 3640788, "diff_percentage": 0.2633334707578674, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:30:46.100485", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.453416149068323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:32:27.571108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7324369657682334, "overlap_percentage": 0.845556843037508, "num_intersection": 10861225, "num_union": 14828887, "num_only_computed": 1983831, "num_only_roped": 1983831, "total_diff": 3967662, "diff_percentage": 0.2675630342317667, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:32:33.257112", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.4664429530201342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:34:20.233575", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7309801382354629, "overlap_percentage": 0.8445852405685185, "num_intersection": 10011330, "num_union": 13695762, "num_only_computed": 1842216, "num_only_roped": 1842216, "total_diff": 3684432, "diff_percentage": 0.26901986176453707, "num_computed": 11853546, "num_roped": 11853546}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "mask_shape": [1, 32, 894, 16254], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:34:23.753384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.5, "l2_diff_relative": 0.4624277456647399}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 894, "seq_len_k": 16254, "queries_shape": [1, 32, 894, 128], "keys_shape": [1, 8, 16254, 128], "attention_shape": [1, 32, 894, 16254]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:10.383502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7103169254852307, "overlap_percentage": 0.8306260844418739, "num_intersection": 574461, "num_union": 808739, "num_only_computed": 117139, "num_only_roped": 117139, "total_diff": 234278, "diff_percentage": 0.28968307451476927, "num_computed": 691600, "num_roped": 691600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "mask_shape": [1, 32, 52, 16306], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:36:14.543880", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.193359375, "l2_diff_relative": 0.11785714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 16306, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 16306, 128], "attention_shape": [1, 32, 52, 16306]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:37:52.849986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7074454428754814, "overlap_percentage": 0.828659499285768, "num_intersection": 11022, "num_union": 15580, "num_only_computed": 2279, "num_only_roped": 2279, "total_diff": 4558, "diff_percentage": 0.2925545571245186, "num_computed": 13301, "num_roped": 13301}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "mask_shape": [1, 32, 1, 16307], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:37:55.891027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0174560546875, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.026123046875, "l2_diff_relative": 0.1400523560209424}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16307, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16307, 128], "attention_shape": [1, 32, 1, 16307]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:39:29.778290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6983083306734759, "overlap_percentage": 0.8223575402195159, "num_intersection": 10939, "num_union": 15665, "num_only_computed": 2363, "num_only_roped": 2363, "total_diff": 4726, "diff_percentage": 0.3016916693265241, "num_computed": 13302, "num_roped": 13302}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "mask_shape": [1, 32, 1, 16308], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:39:32.813659", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.031005859375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.056396484375, "l2_diff_relative": 0.29922279792746115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16308, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16308, 128], "attention_shape": [1, 32, 1, 16308]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:41:07.038928", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7084697874526424, "overlap_percentage": 0.8293617980906562, "num_intersection": 11033, "num_union": 15573, "num_only_computed": 2270, "num_only_roped": 2270, "total_diff": 4540, "diff_percentage": 0.2915302125473576, "num_computed": 13303, "num_roped": 13303}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "mask_shape": [1, 32, 1, 16309], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:41:10.101574", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.0224609375, "l2_diff_relative": 0.09787234042553192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16309, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16309, 128], "attention_shape": [1, 32, 1, 16309]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:42:03.800143", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:42:03.813794", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.02978515625, "l2_diff_relative": 0.003156043046357616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:42:09.764990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891420007762379, "overlap_percentage": 0.9425933997779397, "num_intersection": 1738655, "num_union": 1950433, "num_only_computed": 200801, "num_only_roped": 10977, "total_diff": 211778, "diff_percentage": 0.10857999223762108, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:42:11.063044", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.556510925292969e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015735815602836878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:42:25.941874", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9108580326930048, "overlap_percentage": 0.9533497696941066, "num_intersection": 2583044, "num_union": 2835836, "num_only_computed": 195068, "num_only_roped": 57724, "total_diff": 252792, "diff_percentage": 0.08914196730699518, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:42:26.493010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.827976226806641e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.015510110294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:42:48.172104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9035881180188248, "overlap_percentage": 0.9493525510752207, "num_intersection": 3393305, "num_union": 3755367, "num_only_computed": 223463, "num_only_roped": 138599, "total_diff": 362062, "diff_percentage": 0.09641188198117522, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:42:48.921749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.2275390625, "l2_diff_relative": 0.02657390510948905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:43:18.154565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8855199638534161, "overlap_percentage": 0.9392846332357986, "num_intersection": 4170544, "num_union": 4709712, "num_only_computed": 285904, "num_only_roped": 253264, "total_diff": 539168, "diff_percentage": 0.1144800361465839, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:43:20.089813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.01784206081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:43:52.788677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8573491080668643, "overlap_percentage": 0.9231965109232441, "num_intersection": 4887833, "num_union": 5701100, "num_only_computed": 407271, "num_only_roped": 405996, "total_diff": 813267, "diff_percentage": 0.1426508919331357, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:43:53.884910", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.682209014892578e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.016183035714285716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:44:33.874097", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8288254926900768, "overlap_percentage": 0.906401945951586, "num_intersection": 5559652, "num_union": 6707868, "num_only_computed": 574108, "num_only_roped": 574108, "total_diff": 1148216, "diff_percentage": 0.1711745073099232, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:44:35.199527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.5779008865356445e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.018342391304347828}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:45:20.791665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.80628678273068, "overlap_percentage": 0.892756112085108, "num_intersection": 6224667, "num_union": 7720165, "num_only_computed": 747749, "num_only_roped": 747749, "total_diff": 1495498, "diff_percentage": 0.19371321726932003, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:45:24.102870", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.017210144927536232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:46:16.684107", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7875582879143774, "overlap_percentage": 0.8811553651022549, "num_intersection": 6882768, "num_union": 8739376, "num_only_computed": 928304, "num_only_roped": 928304, "total_diff": 1856608, "diff_percentage": 0.2124417120856226, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:46:19.434158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 3.2901763916015625e-05, "l2_diff": 1.421875, "l2_diff_relative": 0.19279661016949154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:47:19.154118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7730169862807059, "overlap_percentage": 0.8719792221531724, "num_intersection": 7543276, "num_union": 9758228, "num_only_computed": 1107476, "num_only_roped": 1107476, "total_diff": 2214952, "diff_percentage": 0.2269830137192941, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:47:21.233002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.7220458984375e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.42786069651741293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:48:28.774694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7610251178860887, "overlap_percentage": 0.8642978571476746, "num_intersection": 8201675, "num_union": 10777141, "num_only_computed": 1287733, "num_only_roped": 1287733, "total_diff": 2575466, "diff_percentage": 0.2389748821139113, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:48:31.122429", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1865234375, "mean_diff": 4.863739013671875e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.3886138613861386}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:49:48.020192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7537174785101746, "overlap_percentage": 0.8595654519569205, "num_intersection": 8877647, "num_union": 11778481, "num_only_computed": 1450417, "num_only_roped": 1450417, "total_diff": 2900834, "diff_percentage": 0.24628252148982538, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:49:50.602237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.39552238805970147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:51:13.557082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7430905456547184, "overlap_percentage": 0.8526126740887208, "num_intersection": 9520887, "num_union": 12812553, "num_only_computed": 1645833, "num_only_roped": 1645833, "total_diff": 3291666, "diff_percentage": 0.25690945434528156, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:51:18.964106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.982948303222656e-05, "l2_diff": 2.953125, "l2_diff_relative": 0.4276018099547511}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:52:50.490271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7381849834207973, "overlap_percentage": 0.8493744802328557, "num_intersection": 10197060, "num_union": 13813692, "num_only_computed": 1808316, "num_only_roped": 1808316, "total_diff": 3616632, "diff_percentage": 0.2618150165792027, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:52:54.707094", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 4.7206878662109375e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.4708994708994709}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:54:35.488409", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7308501367897903, "overlap_percentage": 0.8444984591737086, "num_intersection": 10847630, "num_union": 14842482, "num_only_computed": 1997426, "num_only_roped": 1997426, "total_diff": 3994852, "diff_percentage": 0.2691498632102097, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:54:38.845916", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10791015625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.39166666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:56:29.572760", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7200586850748265, "overlap_percentage": 0.8372489744947305, "num_intersection": 10405347, "num_union": 14450693, "num_only_computed": 2022673, "num_only_roped": 2022673, "total_diff": 4045346, "diff_percentage": 0.2799413149251735, "num_computed": 12428020, "num_roped": 12428020}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:56:35.693657", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.46}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:58:23.580980", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6868685802358356, "overlap_percentage": 0.8143711825372985, "num_intersection": 325325, "num_union": 473635, "num_only_computed": 74155, "num_only_roped": 74155, "total_diff": 148310, "diff_percentage": 0.31313141976416436, "num_computed": 399480, "num_roped": 399480}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "mask_shape": [1, 32, 30, 16325], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T05:58:26.959391", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.1318359375, "l2_diff_relative": 0.10044642857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16325, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16325, 128], "attention_shape": [1, 32, 30, 16325]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:00:06.244771", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6754954388172382, "overlap_percentage": 0.8063232201862421, "num_intersection": 10737, "num_union": 15895, "num_only_computed": 2579, "num_only_roped": 2579, "total_diff": 5158, "diff_percentage": 0.3245045611827619, "num_computed": 13316, "num_roped": 13316}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "mask_shape": [1, 32, 1, 16326], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:00:09.329148", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.02685546875, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16326, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16326, 128], "attention_shape": [1, 32, 1, 16326]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:02.952449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:02.966110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.003043519938650307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:08.950751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8914878922539035, "overlap_percentage": 0.9426313495367961, "num_intersection": 1738725, "num_union": 1950363, "num_only_computed": 200731, "num_only_roped": 10907, "total_diff": 211638, "diff_percentage": 0.1085121077460965, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:10.726850", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:25.677622", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9113608386329888, "overlap_percentage": 0.9536251033423881, "num_intersection": 2583790, "num_union": 2835090, "num_only_computed": 194322, "num_only_roped": 56978, "total_diff": 251300, "diff_percentage": 0.08863916136701128, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:26.239483", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.036592483520508e-06, "l2_diff": 0.1201171875, "l2_diff_relative": 0.016150210084033615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:47.707848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9054299381859656, "overlap_percentage": 0.9503681243173557, "num_intersection": 3396935, "num_union": 3751737, "num_only_computed": 219833, "num_only_roped": 134969, "total_diff": 354802, "diff_percentage": 0.0945700618140344, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:01:48.448071", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.201171875, "l2_diff_relative": 0.02774784482758621}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:02:17.728213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8856717076494697, "overlap_percentage": 0.9393699911353907, "num_intersection": 4170923, "num_union": 4709333, "num_only_computed": 285525, "num_only_roped": 252885, "total_diff": 538410, "diff_percentage": 0.11432829235053033, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:02:19.659384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.5315752029418945e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.018954918032786885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:02:52.478692", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8593297274973412, "overlap_percentage": 0.9243435575614654, "num_intersection": 4893906, "num_union": 5695027, "num_only_computed": 401198, "num_only_roped": 399923, "total_diff": 801121, "diff_percentage": 0.1406702725026589, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:02:53.587453", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.8312206268310547e-06, "l2_diff": 0.11572265625, "l2_diff_relative": 0.015176741803278689}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:03:33.451963", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8295013414581404, "overlap_percentage": 0.9068059395868113, "num_intersection": 5562130, "num_union": 6705390, "num_only_computed": 571630, "num_only_roped": 571630, "total_diff": 1143260, "diff_percentage": 0.1704986585418596, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:03:34.755100", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.8014183044433594e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.018982438016528925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:04:20.485717", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8103426139013918, "overlap_percentage": 0.8952367443365399, "num_intersection": 6241963, "num_union": 7702869, "num_only_computed": 730453, "num_only_roped": 730453, "total_diff": 1460906, "diff_percentage": 0.1896573860986082, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:04:23.111961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.3692846298217773e-06, "l2_diff": 0.1328125, "l2_diff_relative": 0.017634854771784232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:05:16.043790", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7936413005352515, "overlap_percentage": 0.8849498506735055, "num_intersection": 6912407, "num_union": 8709737, "num_only_computed": 898665, "num_only_roped": 898665, "total_diff": 1797330, "diff_percentage": 0.20635869946474847, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:05:18.093219", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0771484375, "mean_diff": 2.7894973754882812e-05, "l2_diff": 1.25, "l2_diff_relative": 0.16806722689075632}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:06:17.604471", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7805966620934354, "overlap_percentage": 0.8767810012354995, "num_intersection": 7584815, "num_union": 9716689, "num_only_computed": 1065937, "num_only_roped": 1065937, "total_diff": 2131874, "diff_percentage": 0.2194033379065647, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:06:19.674272", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.4175531914893617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:07:27.231170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.765428392854834, "overlap_percentage": 0.8671304890673897, "num_intersection": 8228555, "num_union": 10750261, "num_only_computed": 1260853, "num_only_roped": 1260853, "total_diff": 2521706, "diff_percentage": 0.23457160714516606, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:07:29.527129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.3994708994708995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:08:47.364006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7510930275970076, "overlap_percentage": 0.8578562255230022, "num_intersection": 8859994, "num_union": 11796134, "num_only_computed": 1468070, "num_only_roped": 1468070, "total_diff": 2936140, "diff_percentage": 0.24890697240299237, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:08:49.944683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1279296875, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.38333333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:10:12.968527", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7399713077504756, "overlap_percentage": 0.8505557585396607, "num_intersection": 9497918, "num_union": 12835522, "num_only_computed": 1668802, "num_only_roped": 1668802, "total_diff": 3337604, "diff_percentage": 0.2600286922495244, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:10:15.809409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.3380952380952381}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:11:48.321309", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7423215442595315, "overlap_percentage": 0.8521062563971341, "num_intersection": 10229856, "num_union": 13780896, "num_only_computed": 1775520, "num_only_roped": 1775520, "total_diff": 3551040, "diff_percentage": 0.25767845574046855, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:11:51.414596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.078125, "l2_diff_relative": 0.3778409090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:13:33.290593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7336170361513249, "overlap_percentage": 0.8463426706742267, "num_intersection": 10871319, "num_union": 14818793, "num_only_computed": 1973737, "num_only_roped": 1973737, "total_diff": 3947474, "diff_percentage": 0.2663829638486751, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:13:36.635801", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.8046875, "l2_diff_relative": 0.3055555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:15:25.131795", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7322777261862523, "overlap_percentage": 0.845450720882292, "num_intersection": 10851918, "num_union": 14819402, "num_only_computed": 1983742, "num_only_roped": 1983742, "total_diff": 3967484, "diff_percentage": 0.2677222738137477, "num_computed": 12835660, "num_roped": 12835660}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:15:28.735101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.00543212890625e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.3898809523809524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:17:16.606721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.69796407726529, "overlap_percentage": 0.8221187793200174, "num_intersection": 339979, "num_union": 487101, "num_only_computed": 73561, "num_only_roped": 73561, "total_diff": 147122, "diff_percentage": 0.30203592273471, "num_computed": 413540, "num_roped": 413540}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 31, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:17:19.992952", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.1474609375, "l2_diff_relative": 0.11038011695906433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 16355, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 31, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:18:59.377181", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6917126371187623, "overlap_percentage": 0.8177661169415292, "num_intersection": 10909, "num_union": 15771, "num_only_computed": 2431, "num_only_roped": 2431, "total_diff": 4862, "diff_percentage": 0.3082873628812377, "num_computed": 13340, "num_roped": 13340}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:19:04.288301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00885009765625, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.0216064453125, "l2_diff_relative": 0.10586124401913875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:19:58.809930", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:19:58.821479", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.129243850708008e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0030174026946107784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:20:04.783940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.892480531872326, "overlap_percentage": 0.9431859581555117, "num_intersection": 1739748, "num_union": 1949340, "num_only_computed": 199708, "num_only_roped": 9884, "total_diff": 209592, "diff_percentage": 0.10751946812767398, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:20:05.177065", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 6.198883056640625e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.014401355421686747}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:20:20.169434", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9123051568802516, "overlap_percentage": 0.9541418152828629, "num_intersection": 2585190, "num_union": 2833690, "num_only_computed": 192922, "num_only_roped": 55578, "total_diff": 248500, "diff_percentage": 0.08769484311974846, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:20:20.723919", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.150390625, "l2_diff_relative": 0.015524193548387097}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:20:41.387852", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9054852986490132, "overlap_percentage": 0.9503986194918441, "num_intersection": 3397044, "num_union": 3751628, "num_only_computed": 219724, "num_only_roped": 134860, "total_diff": 354584, "diff_percentage": 0.09451470135098683, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:20:42.131637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.244140625, "l2_diff_relative": 0.02396472392638037}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:21:08.711743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8858703327382111, "overlap_percentage": 0.9394816996266774, "num_intersection": 4171419, "num_union": 4708837, "num_only_computed": 285029, "num_only_roped": 252389, "total_diff": 537418, "diff_percentage": 0.11412966726178884, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:21:09.647759", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.680586814880371e-06, "l2_diff": 0.1806640625, "l2_diff_relative": 0.019664115646258504}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:21:42.494871", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8601750497458119, "overlap_percentage": 0.9248323697958992, "num_intersection": 4896494, "num_union": 5692439, "num_only_computed": 398610, "num_only_roped": 397335, "total_diff": 795945, "diff_percentage": 0.13982495025418806, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:21:43.623185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.1240234375, "l2_diff_relative": 0.014174107142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:22:25.017007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8304510459777815, "overlap_percentage": 0.9073731283910684, "num_intersection": 5565609, "num_union": 6701911, "num_only_computed": 568151, "num_only_roped": 568151, "total_diff": 1136302, "diff_percentage": 0.16954895402221845, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:22:26.322296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.018606870229007633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:23:14.471683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8052920226103737, "overlap_percentage": 0.8921459935838596, "num_intersection": 6220413, "num_union": 7724419, "num_only_computed": 752003, "num_only_roped": 752003, "total_diff": 1504006, "diff_percentage": 0.19470797738962634, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:23:16.020145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.384185791015625e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.01680871212121212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:24:08.978817", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7870665028098965, "overlap_percentage": 0.8808474688237414, "num_intersection": 6880363, "num_union": 8741781, "num_only_computed": 930709, "num_only_roped": 930709, "total_diff": 1861418, "diff_percentage": 0.2129334971901035, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:24:10.773228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 3.039836883544922e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.1627155172413793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:25:10.953068", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7725398031217552, "overlap_percentage": 0.8716755491314512, "num_intersection": 7540649, "num_union": 9760855, "num_only_computed": 1110103, "num_only_roped": 1110103, "total_diff": 2220206, "diff_percentage": 0.22746019687824479, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:25:15.130055", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.43455497382198954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:26:22.777769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7612272715124411, "overlap_percentage": 0.8644282130139204, "num_intersection": 8202912, "num_union": 10775904, "num_only_computed": 1286496, "num_only_roped": 1286496, "total_diff": 2572992, "diff_percentage": 0.2387727284875589, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:26:25.088176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 5.9604644775390625e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.47554347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:27:41.161796", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.753040134321964, "overlap_percentage": 0.8591248079020425, "num_intersection": 8873096, "num_union": 11783032, "num_only_computed": 1454968, "num_only_roped": 1454968, "total_diff": 2909936, "diff_percentage": 0.24695986567803602, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:27:46.046082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.4385026737967914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:29:09.455571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7461067153301678, "overlap_percentage": 0.8545946347718937, "num_intersection": 9543019, "num_union": 12790421, "num_only_computed": 1623701, "num_only_roped": 1623701, "total_diff": 3247402, "diff_percentage": 0.2538932846698322, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:29:12.306131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.38860103626943004}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:30:43.990642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7390230415147061, "overlap_percentage": 0.8499289818161464, "num_intersection": 10203717, "num_union": 13807035, "num_only_computed": 1801659, "num_only_roped": 1801659, "total_diff": 3603318, "diff_percentage": 0.2609769584852939, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:30:47.085508", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.65625, "l2_diff_relative": 0.38990825688073394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:32:19.812721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6981023897307671, "overlap_percentage": 0.8222147191506523, "num_intersection": 1490339, "num_union": 2134843, "num_only_computed": 322252, "num_only_roped": 322252, "total_diff": 644504, "diff_percentage": 0.3018976102692329, "num_computed": 1812591, "num_roped": 1812591}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "mask_shape": [1, 32, 153, 14489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:32:22.758186", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.66015625, "l2_diff_relative": 0.22837837837837838}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 153, "seq_len_k": 14489, "queries_shape": [1, 32, 153, 128], "keys_shape": [1, 8, 14489, 128], "attention_shape": [1, 32, 153, 14489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:33:51.482273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6915533406788571, "overlap_percentage": 0.8176547839766279, "num_intersection": 232855, "num_union": 336713, "num_only_computed": 51929, "num_only_roped": 51929, "total_diff": 103858, "diff_percentage": 0.30844665932114296, "num_computed": 284784, "num_roped": 284784}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "mask_shape": [1, 32, 24, 14513], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:33:54.755710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.777576446533203e-05, "l2_diff": 0.1669921875, "l2_diff_relative": 0.140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 14513, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 14513, 128], "attention_shape": [1, 32, 24, 14513]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:35:20.341975", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6851746662879864, "overlap_percentage": 0.8131794050728912, "num_intersection": 9650, "num_union": 14084, "num_only_computed": 2217, "num_only_roped": 2217, "total_diff": 4434, "diff_percentage": 0.31482533371201366, "num_computed": 11867, "num_roped": 11867}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "mask_shape": [1, 32, 1, 14514], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:35:23.055722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013916015625, "mean_diff": 1.7523765563964844e-05, "l2_diff": 0.019287109375, "l2_diff_relative": 0.06539735099337748}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14514, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14514, 128], "attention_shape": [1, 32, 1, 14514]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:36:09.494422", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:36:09.507113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0030623070987654323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:36:15.438578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891454919177993, "overlap_percentage": 0.9426129167967802, "num_intersection": 1738691, "num_union": 1950397, "num_only_computed": 200765, "num_only_roped": 10941, "total_diff": 211706, "diff_percentage": 0.108545080822007, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:36:15.820780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.5267086029052734e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.015316611842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:36:30.635459", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9110992926060438, "overlap_percentage": 0.9534819003188851, "num_intersection": 2583402, "num_union": 2835478, "num_only_computed": 194710, "num_only_roped": 57366, "total_diff": 252076, "diff_percentage": 0.08890070739395615, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:36:31.174410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.015517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:36:51.855276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9039967655339732, "overlap_percentage": 0.9495780475030887, "num_intersection": 3394111, "num_union": 3754561, "num_only_computed": 222657, "num_only_roped": 137793, "total_diff": 360450, "diff_percentage": 0.0960032344660268, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:36:54.549955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.304813385009766e-06, "l2_diff": 0.2197265625, "l2_diff_relative": 0.025475543478260868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:37:21.512405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.88748972591166, "overlap_percentage": 0.9403915833057065, "num_intersection": 4175459, "num_union": 4704797, "num_only_computed": 280989, "num_only_roped": 248349, "total_diff": 529338, "diff_percentage": 0.11251027408834005, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:37:22.431917", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.017974624060150376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:37:54.978808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8610008624033443, "overlap_percentage": 0.9253094716908682, "num_intersection": 4899020, "num_union": 5689913, "num_only_computed": 396084, "num_only_roped": 394809, "total_diff": 790893, "diff_percentage": 0.1389991375966557, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:37:56.097355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.7865171432495117e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.015404929577464789}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:38:36.031524", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8280877570103903, "overlap_percentage": 0.9059606179570117, "num_intersection": 5556945, "num_union": 6710575, "num_only_computed": 576815, "num_only_roped": 576815, "total_diff": 1153630, "diff_percentage": 0.1719122429896097, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:38:37.325412", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.5033950805664062e-06, "l2_diff": 0.15625, "l2_diff_relative": 0.017361111111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:39:22.616341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8065916970662256, "overlap_percentage": 0.8929429913533559, "num_intersection": 6225970, "num_union": 7718862, "num_only_computed": 746446, "num_only_roped": 746446, "total_diff": 1492892, "diff_percentage": 0.19340830293377442, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:39:25.492590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.115964889526367e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.015518707482993197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:18.170222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.78883614849333, "overlap_percentage": 0.8819546151923833, "num_intersection": 6889011, "num_union": 8733133, "num_only_computed": 922061, "num_only_roped": 922061, "total_diff": 1844122, "diff_percentage": 0.21116385150667005, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:40:20.470771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.546875, "l2_diff_relative": 0.2053941908713693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:41:21.164269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7730513272185119, "overlap_percentage": 0.8720010699647845, "num_intersection": 7543465, "num_union": 9758039, "num_only_computed": 1107287, "num_only_roped": 1107287, "total_diff": 2214574, "diff_percentage": 0.22694867278148817, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:41:23.247040", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 6.628036499023438e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.5188172043010753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:42:32.364631", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7602905977737334, "overlap_percentage": 0.8638239603566419, "num_intersection": 8197178, "num_union": 10781638, "num_only_computed": 1292230, "num_only_roped": 1292230, "total_diff": 2584460, "diff_percentage": 0.23970940222626655, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:42:36.733787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1552734375, "mean_diff": 5.245208740234375e-05, "l2_diff": 2.640625, "l2_diff_relative": 0.38235294117647056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:43:52.521606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7498337727515737, "overlap_percentage": 0.8570342902600139, "num_intersection": 8851505, "num_union": 11804623, "num_only_computed": 1476559, "num_only_roped": 1476559, "total_diff": 2953118, "diff_percentage": 0.2501662272484263, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:43:55.107805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1298828125, "mean_diff": 4.935264587402344e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.3958333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:45:20.105871", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7448339424727871, "overlap_percentage": 0.8537591163743695, "num_intersection": 9533689, "num_union": 12799751, "num_only_computed": 1633031, "num_only_roped": 1633031, "total_diff": 3266062, "diff_percentage": 0.25516605752721283, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:45:24.636762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1396484375, "mean_diff": 4.506111145019531e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.38613861386138615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:46:56.099291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7355717676927904, "overlap_percentage": 0.8476420063811413, "num_intersection": 10176261, "num_union": 13834491, "num_only_computed": 1829115, "num_only_roped": 1829115, "total_diff": 3658230, "diff_percentage": 0.2644282323072096, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:47:00.585790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 4.100799560546875e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.3962765957446808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:48:33.688127", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7007399191323564, "overlap_percentage": 0.8240412437544753, "num_intersection": 2476534, "num_union": 3534170, "num_only_computed": 528818, "num_only_roped": 528818, "total_diff": 1057636, "diff_percentage": 0.2992600808676436, "num_computed": 3005352, "num_roped": 3005352}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "mask_shape": [1, 32, 252, 14588], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:48:36.667978", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09423828125, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.3285024154589372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 252, "seq_len_k": 14588, "queries_shape": [1, 32, 252, 128], "keys_shape": [1, 8, 14588, 128], "attention_shape": [1, 32, 252, 14588]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:50:07.044755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6887393533175261, "overlap_percentage": 0.8156846134538153, "num_intersection": 311970, "num_union": 452958, "num_only_computed": 70494, "num_only_roped": 70494, "total_diff": 140988, "diff_percentage": 0.3112606466824739, "num_computed": 382464, "num_roped": 382464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "mask_shape": [1, 32, 32, 14620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:50:11.797335", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.1650390625, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 14620, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 14620, 128], "attention_shape": [1, 32, 32, 14620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:51:38.250492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7054794520547946, "overlap_percentage": 0.8273092369477911, "num_intersection": 9888, "num_union": 14016, "num_only_computed": 2064, "num_only_roped": 2064, "total_diff": 4128, "diff_percentage": 0.2945205479452055, "num_computed": 11952, "num_roped": 11952}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "mask_shape": [1, 32, 1, 14621], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:51:40.963013", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 4.4345855712890625e-05, "l2_diff": 0.04833984375, "l2_diff_relative": 0.2551546391752577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14621, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14621, 128], "attention_shape": [1, 32, 1, 14621]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:52:30.840401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:52:30.870425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.0030137624172185433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:52:36.919751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8909497990176932, "overlap_percentage": 0.9423304621630061, "num_intersection": 1738170, "num_union": 1950918, "num_only_computed": 201286, "num_only_roped": 11462, "total_diff": 212748, "diff_percentage": 0.10905020098230679, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:52:37.313836", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.8710575103759766e-06, "l2_diff": 0.12060546875, "l2_diff_relative": 0.013400607638888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:52:54.708387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9127587611515352, "overlap_percentage": 0.9543898370142908, "num_intersection": 2585862, "num_union": 2833018, "num_only_computed": 192250, "num_only_roped": 54906, "total_diff": 247156, "diff_percentage": 0.08724123884846478, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:52:55.265074", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.649162292480469e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.015294894366197184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:53:16.122031", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.903809151220089, "overlap_percentage": 0.9494745317731741, "num_intersection": 3393741, "num_union": 3754931, "num_only_computed": 223027, "num_only_roped": 138163, "total_diff": 361190, "diff_percentage": 0.096190848779911, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:53:16.899806", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.751848220825195e-06, "l2_diff": 0.228515625, "l2_diff_relative": 0.027083333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:53:43.593576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8817996860790889, "overlap_percentage": 0.9371876216181155, "num_intersection": 4161233, "num_union": 4719023, "num_only_computed": 295215, "num_only_roped": 262575, "total_diff": 557790, "diff_percentage": 0.11820031392091117, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:53:44.553415", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.844499588012695e-06, "l2_diff": 0.17578125, "l2_diff_relative": 0.019667832167832168}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:54:19.996483", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8566502304126458, "overlap_percentage": 0.9227911820766077, "num_intersection": 4885687, "num_union": 5703246, "num_only_computed": 409417, "num_only_roped": 408142, "total_diff": 817559, "diff_percentage": 0.1433497695873543, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:54:21.171803", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.7418136596679688e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.014406028368794326}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:55:00.348878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8288813853647686, "overlap_percentage": 0.9064353675396494, "num_intersection": 5559857, "num_union": 6707663, "num_only_computed": 573903, "num_only_roped": 573903, "total_diff": 1147806, "diff_percentage": 0.17111861463523137, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:55:01.668752", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.7865171432495117e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.01893248175182482}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:55:47.193529", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8069702335483712, "overlap_percentage": 0.8931749052265384, "num_intersection": 6227587, "num_union": 7717245, "num_only_computed": 744829, "num_only_roped": 744829, "total_diff": 1489658, "diff_percentage": 0.19302976645162878, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:55:48.761015", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.175569534301758e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.01584663120567376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:56:41.674940", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7833294140477849, "overlap_percentage": 0.878502208147614, "num_intersection": 6862044, "num_union": 8760100, "num_only_computed": 949028, "num_only_roped": 949028, "total_diff": 1898056, "diff_percentage": 0.21667058595221517, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:56:43.445640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.46875, "l2_diff_relative": 0.22380952380952382}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:57:43.578295", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7719184152683896, "overlap_percentage": 0.8712798609878077, "num_intersection": 7537226, "num_union": 9764278, "num_only_computed": 1113526, "num_only_roped": 1113526, "total_diff": 2227052, "diff_percentage": 0.22808158473161047, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:57:46.166708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 5.602836608886719e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.4}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:58:54.216123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.766932138869793, "overlap_percentage": 0.8680946166504802, "num_intersection": 8237704, "num_union": 10741112, "num_only_computed": 1251704, "num_only_roped": 1251704, "total_diff": 2503408, "diff_percentage": 0.233067861130207, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T06:58:56.535167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 5.030632019042969e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.40476190476190477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:11.876629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7553395140911097, "overlap_percentage": 0.8606192796636427, "num_intersection": 8888531, "num_union": 11767597, "num_only_computed": 1439533, "num_only_roped": 1439533, "total_diff": 2879066, "diff_percentage": 0.2446604859088903, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:00:14.785399", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10009765625, "mean_diff": 5.1975250244140625e-05, "l2_diff": 2.390625, "l2_diff_relative": 0.3903061224489796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:38.206417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7387312844636953, "overlap_percentage": 0.8497360012608896, "num_intersection": 9488764, "num_union": 12844676, "num_only_computed": 1677956, "num_only_roped": 1677956, "total_diff": 3355912, "diff_percentage": 0.2612687155363047, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:01:41.072011", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.765625, "l2_diff_relative": 0.3343195266272189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:03:12.713485", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7331746744985518, "overlap_percentage": 0.846048220397262, "num_intersection": 10157127, "num_union": 13853625, "num_only_computed": 1848249, "num_only_roped": 1848249, "total_diff": 3696498, "diff_percentage": 0.26682532550144816, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:03:16.317671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 4.363059997558594e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.3743718592964824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:04:56.525287", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7389340076405815, "overlap_percentage": 0.8498700978804608, "num_intersection": 10916629, "num_union": 14773483, "num_only_computed": 1928427, "num_only_roped": 1928427, "total_diff": 3856854, "diff_percentage": 0.2610659923594186, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:04:59.942346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.24879227053140096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:06:43.577733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7146687048033394, "overlap_percentage": 0.8335939214395436, "num_intersection": 4740762, "num_union": 6633510, "num_only_computed": 946374, "num_only_roped": 946374, "total_diff": 1892748, "diff_percentage": 0.2853312951966606, "num_computed": 5687136, "num_roped": 5687136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "mask_shape": [1, 32, 441, 15801], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:06:46.963430", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 3.695487976074219e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.3253424657534247}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 441, "seq_len_k": 15801, "queries_shape": [1, 32, 441, 128], "keys_shape": [1, 8, 15801, 128], "attention_shape": [1, 32, 441, 15801]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:08:27.233757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.704857444561774, "overlap_percentage": 0.8268813874264478, "num_intersection": 256320, "num_union": 363648, "num_only_computed": 53664, "num_only_roped": 53664, "total_diff": 107328, "diff_percentage": 0.295142555438226, "num_computed": 309984, "num_roped": 309984}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "mask_shape": [1, 32, 24, 15825], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:08:33.023703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.12890625, "l2_diff_relative": 0.1}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 15825, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 15825, 128], "attention_shape": [1, 32, 24, 15825]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:10:07.771574", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7086916258764386, "overlap_percentage": 0.8295137813564571, "num_intersection": 10714, "num_union": 15118, "num_only_computed": 2202, "num_only_roped": 2202, "total_diff": 4404, "diff_percentage": 0.2913083741235613, "num_computed": 12916, "num_roped": 12916}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "mask_shape": [1, 32, 1, 15826], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:10:10.718513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00537109375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.01422119140625, "l2_diff_relative": 0.060175619834710745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15826, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15826, 128], "attention_shape": [1, 32, 1, 15826]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:11:43.070382", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7139255622636502, "overlap_percentage": 0.8330881783695905, "num_intersection": 10761, "num_union": 15073, "num_only_computed": 2156, "num_only_roped": 2156, "total_diff": 4312, "diff_percentage": 0.2860744377363498, "num_computed": 12917, "num_roped": 12917}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "mask_shape": [1, 32, 1, 15827], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:11:46.119028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00946044921875, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.0242919921875, "l2_diff_relative": 0.10364583333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15827, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15827, 128], "attention_shape": [1, 32, 1, 15827]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:13:17.424728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7048963969908935, "overlap_percentage": 0.82690819012231, "num_intersection": 10682, "num_union": 15154, "num_only_computed": 2236, "num_only_roped": 2236, "total_diff": 4472, "diff_percentage": 0.2951036030091065, "num_computed": 12918, "num_roped": 12918}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "mask_shape": [1, 32, 1, 15828], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:13:21.407313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.01544189453125, "l2_diff_relative": 0.053784013605442174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15828, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15828, 128], "attention_shape": [1, 32, 1, 15828]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:14:52.453310", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7040163556024533, "overlap_percentage": 0.8263023453827696, "num_intersection": 10675, "num_union": 15163, "num_only_computed": 2244, "num_only_roped": 2244, "total_diff": 4488, "diff_percentage": 0.29598364439754665, "num_computed": 12919, "num_roped": 12919}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "mask_shape": [1, 32, 1, 15829], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:14:57.370826", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.19977678571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15829, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15829, 128], "attention_shape": [1, 32, 1, 15829]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:16:28.646142", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7022397891963109, "overlap_percentage": 0.8250773993808049, "num_intersection": 10660, "num_union": 15180, "num_only_computed": 2260, "num_only_roped": 2260, "total_diff": 4520, "diff_percentage": 0.2977602108036891, "num_computed": 12920, "num_roped": 12920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "mask_shape": [1, 32, 1, 15830], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:16:31.742856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.4185905456542969e-05, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.10026041666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15830, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15830, 128], "attention_shape": [1, 32, 1, 15830]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:19.865965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:19.874329", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030967310855263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:25.849093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8916479249799251, "overlap_percentage": 0.9427208025398147, "num_intersection": 1738890, "num_union": 1950198, "num_only_computed": 200566, "num_only_roped": 10742, "total_diff": 211308, "diff_percentage": 0.10835207502007488, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:27.681646", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.3478946685791016e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.014539930555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:39.892540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9179647042099064, "overlap_percentage": 0.9572279429282368, "num_intersection": 361612, "num_union": 393928, "num_only_computed": 16158, "num_only_roped": 16158, "total_diff": 32316, "diff_percentage": 0.08203529579009362, "num_computed": 377770, "num_roped": 377770}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "mask_shape": [1, 32, 185, 2233], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:41.347545", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 7.68899917602539e-06, "l2_diff": 0.06689453125, "l2_diff_relative": 0.02009976525821596}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 185, "seq_len_k": 2233, "queries_shape": [1, 32, 185, 128], "keys_shape": [1, 8, 2233, 128], "attention_shape": [1, 32, 185, 2233]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:53.465059", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8589639566542255, "overlap_percentage": 0.9241319107662463, "num_intersection": 47639, "num_union": 55461, "num_only_computed": 3911, "num_only_roped": 3911, "total_diff": 7822, "diff_percentage": 0.14103604334577452, "num_computed": 51550, "num_roped": 51550}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "mask_shape": [1, 32, 25, 2258], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:17:55.013268", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.01556396484375, "l2_diff_relative": 0.012222009202453988}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 2258, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 2258, 128], "attention_shape": [1, 32, 25, 2258]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:06.921138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8419642857142857, "overlap_percentage": 0.9142026175472613, "num_intersection": 1886, "num_union": 2240, "num_only_computed": 177, "num_only_roped": 177, "total_diff": 354, "diff_percentage": 0.15803571428571428, "num_computed": 2063, "num_roped": 2063}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "mask_shape": [1, 32, 1, 2259], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:08.670358", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.4836273193359375e-06, "l2_diff": 0.003265380859375, "l2_diff_relative": 0.012762404580152672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2259, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2259, 128], "attention_shape": [1, 32, 1, 2259]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:20.410470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8469798657718121, "overlap_percentage": 0.9171511627906976, "num_intersection": 1893, "num_union": 2235, "num_only_computed": 171, "num_only_roped": 171, "total_diff": 342, "diff_percentage": 0.15302013422818792, "num_computed": 2064, "num_roped": 2064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "mask_shape": [1, 32, 1, 2260], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:22.370214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0029296875, "mean_diff": 7.748603820800781e-06, "l2_diff": 0.0040283203125, "l2_diff_relative": 0.018497757847533634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2260, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2260, 128], "attention_shape": [1, 32, 1, 2260]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:34.119224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8453285650424676, "overlap_percentage": 0.9161821705426356, "num_intersection": 1891, "num_union": 2237, "num_only_computed": 173, "num_only_roped": 173, "total_diff": 346, "diff_percentage": 0.1546714349575324, "num_computed": 2064, "num_roped": 2064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "mask_shape": [1, 32, 1, 2261], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:36.013308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00146484375, "mean_diff": 6.0498714447021484e-06, "l2_diff": 0.003021240234375, "l2_diff_relative": 0.01345108695652174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2261, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2261, 128], "attention_shape": [1, 32, 1, 2261]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:47.776291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8453976764968723, "overlap_percentage": 0.9162227602905569, "num_intersection": 1892, "num_union": 2238, "num_only_computed": 173, "num_only_roped": 173, "total_diff": 346, "diff_percentage": 0.1546023235031278, "num_computed": 2065, "num_roped": 2065}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2262, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2262, 128], "mask_shape": [1, 32, 1, 2262], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:49.709783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.632638931274414e-06, "l2_diff": 0.0028228759765625, "l2_diff_relative": 0.011032919847328244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 2262, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 2262, 128], "attention_shape": [1, 32, 1, 2262]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:59.027531", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:18:59.040049", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031105324074074073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:05.038209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8915974875016024, "overlap_percentage": 0.9426926112903785, "num_intersection": 1738838, "num_union": 1950250, "num_only_computed": 200618, "num_only_roped": 10794, "total_diff": 211412, "diff_percentage": 0.10840251249839764, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:05.445936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.67572021484375e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015848214285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:20.388217", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9111532137639936, "overlap_percentage": 0.9535114267154836, "num_intersection": 2583482, "num_union": 2835398, "num_only_computed": 194630, "num_only_roped": 57286, "total_diff": 251916, "diff_percentage": 0.08884678623600638, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:20.943250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.014865451388888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:41.799652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9040900793926662, "overlap_percentage": 0.9496295255958029, "num_intersection": 3394295, "num_union": 3754377, "num_only_computed": 222473, "num_only_roped": 137609, "total_diff": 360082, "diff_percentage": 0.09590992060733379, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:19:44.803973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.5730342864990234e-06, "l2_diff": 0.251953125, "l2_diff_relative": 0.0274234693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:20:11.484087", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8860982424959667, "overlap_percentage": 0.9396098490854318, "num_intersection": 4171988, "num_union": 4708268, "num_only_computed": 284460, "num_only_roped": 251820, "total_diff": 536280, "diff_percentage": 0.11390175750403334, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:20:12.413688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.017899525316455698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:20:45.270576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8596134845573306, "overlap_percentage": 0.9245076911904155, "num_intersection": 4894775, "num_union": 5694158, "num_only_computed": 400329, "num_only_roped": 399054, "total_diff": 799383, "diff_percentage": 0.14038651544266947, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:20:46.390958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.4586915969848633e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.01357421875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:21:26.497532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8305346256605693, "overlap_percentage": 0.9074230162249582, "num_intersection": 5565915, "num_union": 6701605, "num_only_computed": 567845, "num_only_roped": 567845, "total_diff": 1135690, "diff_percentage": 0.16946537433943062, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:21:27.807270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.177734375, "l2_diff_relative": 0.018586601307189542}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:22:13.590405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8062289939966935, "overlap_percentage": 0.8927206867748568, "num_intersection": 6224420, "num_union": 7720412, "num_only_computed": 747996, "num_only_roped": 747996, "total_diff": 1495992, "diff_percentage": 0.19377100600330657, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:22:15.980962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.017299107142857144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:23:10.412381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7873875127270955, "overlap_percentage": 0.8810484655627294, "num_intersection": 6881933, "num_union": 8740211, "num_only_computed": 929139, "num_only_roped": 929139, "total_diff": 1858278, "diff_percentage": 0.21261248727290452, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:23:12.169026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.17116182572614108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:24:12.362926", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7751653992266697, "overlap_percentage": 0.8733444213867188, "num_intersection": 7555086, "num_union": 9746418, "num_only_computed": 1095666, "num_only_roped": 1095666, "total_diff": 2191332, "diff_percentage": 0.22483460077333026, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:24:14.416756", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 6.532669067382812e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:25:23.809620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7648559367394512, "overlap_percentage": 0.8667630267346498, "num_intersection": 8225068, "num_union": 10753748, "num_only_computed": 1264340, "num_only_roped": 1264340, "total_diff": 2528680, "diff_percentage": 0.2351440632605488, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:25:26.538484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.859375, "l2_diff_relative": 0.4216589861751152}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:26:41.483388", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7454239858053731, "overlap_percentage": 0.8541466049137851, "num_intersection": 7267169, "num_union": 9749041, "num_only_computed": 1240936, "num_only_roped": 1240936, "total_diff": 2481872, "diff_percentage": 0.25457601419462694, "num_computed": 8508105, "num_roped": 8508105}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "mask_shape": [1, 32, 855, 12119], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:26:43.986677", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 7.009506225585938e-05, "l2_diff": 3.015625, "l2_diff_relative": 0.6225806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 855, "seq_len_k": 12119, "queries_shape": [1, 32, 855, 128], "keys_shape": [1, 8, 12119, 128], "attention_shape": [1, 32, 855, 12119]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:27:58.616507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7190668660576832, "overlap_percentage": 0.8365781229984511, "num_intersection": 359189, "num_union": 499521, "num_only_computed": 70166, "num_only_roped": 70166, "total_diff": 140332, "diff_percentage": 0.2809331339423167, "num_computed": 429355, "num_roped": 429355}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "mask_shape": [1, 32, 43, 12162], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:28:00.988621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 4.1484832763671875e-05, "l2_diff": 0.3828125, "l2_diff_relative": 0.2737430167597765}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 43, "seq_len_k": 12162, "queries_shape": [1, 32, 43, 128], "keys_shape": [1, 8, 12162, 128], "attention_shape": [1, 32, 43, 12162]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:29:09.738840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7089073329340293, "overlap_percentage": 0.8296615261365913, "num_intersection": 8285, "num_union": 11687, "num_only_computed": 1701, "num_only_roped": 1701, "total_diff": 3402, "diff_percentage": 0.29109266706597076, "num_computed": 9986, "num_roped": 9986}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "mask_shape": [1, 32, 1, 12163], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:29:11.867636", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 5.364418029785156e-05, "l2_diff": 0.0712890625, "l2_diff_relative": 0.42441860465116277}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12163, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12163, 128], "attention_shape": [1, 32, 1, 12163]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:30:17.814437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7164217581850992, "overlap_percentage": 0.8347852207870231, "num_intersection": 8337, "num_union": 11637, "num_only_computed": 1650, "num_only_roped": 1650, "total_diff": 3300, "diff_percentage": 0.28357824181490077, "num_computed": 9987, "num_roped": 9987}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "mask_shape": [1, 32, 1, 12164], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:30:19.940613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 4.792213439941406e-05, "l2_diff": 0.06640625, "l2_diff_relative": 0.34}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12164, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12164, 128], "attention_shape": [1, 32, 1, 12164]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:31:26.542892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7080803762291578, "overlap_percentage": 0.829094913896676, "num_intersection": 8281, "num_union": 11695, "num_only_computed": 1707, "num_only_roped": 1707, "total_diff": 3414, "diff_percentage": 0.29191962377084224, "num_computed": 9988, "num_roped": 9988}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "mask_shape": [1, 32, 1, 12165], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:31:28.684676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.010009765625, "mean_diff": 1.3053417205810547e-05, "l2_diff": 0.020263671875, "l2_diff_relative": 0.06650641025641026}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12165, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12165, 128], "attention_shape": [1, 32, 1, 12165]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:32:07.723007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:32:07.732392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.002972146739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:32:13.706594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8915412334872236, "overlap_percentage": 0.9426611672044689, "num_intersection": 1738780, "num_union": 1950308, "num_only_computed": 200676, "num_only_roped": 10852, "total_diff": 211528, "diff_percentage": 0.10845876651277644, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:32:14.095034", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.288290023803711e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.014762931034482759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:32:28.940265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9116595470264904, "overlap_percentage": 0.9537886057635526, "num_intersection": 2584233, "num_union": 2834647, "num_only_computed": 193879, "num_only_roped": 56535, "total_diff": 250414, "diff_percentage": 0.08834045297350958, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:32:29.495747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.015391791044776119}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:32:50.008502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9035911594118382, "overlap_percentage": 0.9493542297086788, "num_intersection": 3393311, "num_union": 3755361, "num_only_computed": 223457, "num_only_roped": 138593, "total_diff": 362050, "diff_percentage": 0.09640884058816183, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:32:50.757191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.2177734375, "l2_diff_relative": 0.02436625874125874}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:33:17.361820", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8881519119006912, "overlap_percentage": 0.9407631942142208, "num_intersection": 4177109, "num_union": 4703147, "num_only_computed": 279339, "num_only_roped": 246699, "total_diff": 526038, "diff_percentage": 0.11184808809930882, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:33:18.290994", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.382563591003418e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.017780172413793104}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:33:51.035457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8616683248729358, "overlap_percentage": 0.9256947796345486, "num_intersection": 4901060, "num_union": 5687873, "num_only_computed": 394044, "num_only_roped": 392769, "total_diff": 786813, "diff_percentage": 0.1383316751270642, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:33:52.158308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.4586915969848633e-06, "l2_diff": 0.12060546875, "l2_diff_relative": 0.01368572695035461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:34:32.792121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8342098302721355, "overlap_percentage": 0.9096122117591819, "num_intersection": 5579343, "num_union": 6688177, "num_only_computed": 554417, "num_only_roped": 554417, "total_diff": 1108834, "diff_percentage": 0.16579016972786456, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:34:36.210290", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.4884939193725586e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.01763392857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:35:21.647648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8139637738810005, "overlap_percentage": 0.8974421491775592, "num_intersection": 6257340, "num_union": 7687492, "num_only_computed": 715076, "num_only_roped": 715076, "total_diff": 1430152, "diff_percentage": 0.18603622611899953, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:35:23.158769", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.3543834686279297e-06, "l2_diff": 0.125, "l2_diff_relative": 0.01639344262295082}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:36:13.018455", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7634577634054714, "overlap_percentage": 0.8658645296172368, "num_intersection": 3299582, "num_union": 4321892, "num_only_computed": 511155, "num_only_roped": 511155, "total_diff": 1022310, "diff_percentage": 0.2365422365945285, "num_computed": 3810737, "num_roped": 3810737}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "mask_shape": [1, 32, 527, 8719], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:36:15.169531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.5390625, "l2_diff_relative": 0.09913793103448276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 527, "seq_len_k": 8719, "queries_shape": [1, 32, 527, 128], "keys_shape": [1, 8, 8719, 128], "attention_shape": [1, 32, 527, 8719]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:37:04.844482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7306041335453101, "overlap_percentage": 0.844334206053925, "num_intersection": 202202, "num_union": 276760, "num_only_computed": 37279, "num_only_roped": 37279, "total_diff": 74558, "diff_percentage": 0.26939586645469, "num_computed": 239481, "num_roped": 239481}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "mask_shape": [1, 32, 33, 8752], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:37:06.932161", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.288818359375e-05, "l2_diff": 0.0927734375, "l2_diff_relative": 0.06944444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 8752, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 8752, 128], "attention_shape": [1, 32, 33, 8752]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:37:55.097481", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7278895369598857, "overlap_percentage": 0.8425186001653348, "num_intersection": 6115, "num_union": 8401, "num_only_computed": 1143, "num_only_roped": 1143, "total_diff": 2286, "diff_percentage": 0.27211046304011427, "num_computed": 7258, "num_roped": 7258}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "mask_shape": [1, 32, 1, 8753], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:37:56.559619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.01019287109375, "l2_diff_relative": 0.04638888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8753, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8753, 128], "attention_shape": [1, 32, 1, 8753]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:38:41.319134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7397243858597963, "overlap_percentage": 0.8503926160628186, "num_intersection": 6173, "num_union": 8345, "num_only_computed": 1086, "num_only_roped": 1086, "total_diff": 2172, "diff_percentage": 0.2602756141402037, "num_computed": 7259, "num_roped": 7259}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "mask_shape": [1, 32, 1, 8754], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:38:43.095811", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.009521484375, "l2_diff_relative": 0.045990566037735846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8754, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8754, 128], "attention_shape": [1, 32, 1, 8754]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:39:29.003050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7368421052631579, "overlap_percentage": 0.8484848484848485, "num_intersection": 6160, "num_union": 8360, "num_only_computed": 1100, "num_only_roped": 1100, "total_diff": 2200, "diff_percentage": 0.2631578947368421, "num_computed": 7260, "num_roped": 7260}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "mask_shape": [1, 32, 1, 8755], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:39:30.473569", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 1.245737075805664e-05, "l2_diff": 0.008056640625, "l2_diff_relative": 0.026785714285714284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 8755, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 8755, 128], "attention_shape": [1, 32, 1, 8755]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:39:58.189002", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:39:58.202645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3527612686157227e-06, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.0030565137987012985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:40:04.207625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8918002236876045, "overlap_percentage": 0.9428059184275355, "num_intersection": 1739047, "num_union": 1950041, "num_only_computed": 200409, "num_only_roped": 10585, "total_diff": 210994, "diff_percentage": 0.10819977631239548, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:40:04.608304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 6.109476089477539e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.014533547794117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:40:21.788337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.911281288709682, "overlap_percentage": 0.9535815519074052, "num_intersection": 2583672, "num_union": 2835208, "num_only_computed": 194440, "num_only_roped": 57096, "total_diff": 251536, "diff_percentage": 0.08871871129031803, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:40:22.340195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.76837158203125e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.01528033088235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:40:43.583525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9041712293135958, "overlap_percentage": 0.949674289154685, "num_intersection": 3394455, "num_union": 3754217, "num_only_computed": 222313, "num_only_roped": 137449, "total_diff": 359762, "diff_percentage": 0.09582877068640412, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:40:44.322048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.185604095458984e-06, "l2_diff": 0.2021484375, "l2_diff_relative": 0.023958333333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:10.866037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8841385777922055, "overlap_percentage": 0.9385069529527077, "num_intersection": 4167091, "num_union": 4713165, "num_only_computed": 289357, "num_only_roped": 256717, "total_diff": 546074, "diff_percentage": 0.11586142220779455, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:11.790126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.4570693969726562e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.018345141700404858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:46.795547", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8568706490004768, "overlap_percentage": 0.9229190514285056, "num_intersection": 4886364, "num_union": 5702569, "num_only_computed": 408740, "num_only_roped": 407465, "total_diff": 816205, "diff_percentage": 0.1431293509995232, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:41:47.892059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.11279296875, "l2_diff_relative": 0.013671875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:42:27.260237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8281046471409861, "overlap_percentage": 0.9059707259494991, "num_intersection": 5557007, "num_union": 6710513, "num_only_computed": 576753, "num_only_roped": 576753, "total_diff": 1153506, "diff_percentage": 0.17189535285901392, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:42:28.592189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.01951581027667984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:43:14.935185", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.806371483831906, "overlap_percentage": 0.8928080309608606, "num_intersection": 6225029, "num_union": 7719803, "num_only_computed": 747387, "num_only_roped": 747387, "total_diff": 1494774, "diff_percentage": 0.19362851616809393, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:43:16.462298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.017075892857142855}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:44:10.682319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7880691720693397, "overlap_percentage": 0.8814750395336262, "num_intersection": 6885265, "num_union": 8736879, "num_only_computed": 925807, "num_only_roped": 925807, "total_diff": 1851614, "diff_percentage": 0.21193082793066037, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:44:14.013202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 2.4557113647460938e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.13654618473895583}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:45:14.038235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7708806550665301, "overlap_percentage": 0.8706184156013258, "num_intersection": 7531504, "num_union": 9770000, "num_only_computed": 1119248, "num_only_roped": 1119248, "total_diff": 2238496, "diff_percentage": 0.2291193449334698, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:45:16.107076", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.125, "l2_diff_relative": 0.3177570093457944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:46:24.928158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7577801907856934, "overlap_percentage": 0.8622013090806087, "num_intersection": 8181780, "num_union": 10797036, "num_only_computed": 1307628, "num_only_roped": 1307628, "total_diff": 2615256, "diff_percentage": 0.24221980921430658, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:46:27.259895", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.8125, "l2_diff_relative": 0.24786324786324787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:47:44.700263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7511653239538281, "overlap_percentage": 0.8579033786002875, "num_intersection": 8860481, "num_union": 11795647, "num_only_computed": 1467583, "num_only_roped": 1467583, "total_diff": 2935166, "diff_percentage": 0.24883467604617196, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:47:47.280327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.3788659793814433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:49:10.653374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7424453845455871, "overlap_percentage": 0.8521878402968822, "num_intersection": 9516143, "num_union": 12817297, "num_only_computed": 1650577, "num_only_roped": 1650577, "total_diff": 3301154, "diff_percentage": 0.2575546154544129, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:49:13.513289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 4.744529724121094e-05, "l2_diff": 2.296875, "l2_diff_relative": 0.3972972972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:50:45.466016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7336391932570262, "overlap_percentage": 0.8463574152113187, "num_intersection": 10160839, "num_union": 13849913, "num_only_computed": 1844537, "num_only_roped": 1844537, "total_diff": 3689074, "diff_percentage": 0.26636080674297374, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:50:48.565526", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 4.553794860839844e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.4067357512953368}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:52:29.755718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7300804729719037, "overlap_percentage": 0.8439844092544244, "num_intersection": 10841027, "num_union": 14849085, "num_only_computed": 2004029, "num_only_roped": 2004029, "total_diff": 4008058, "diff_percentage": 0.26991952702809635, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:52:33.087667", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 2.015625, "l2_diff_relative": 0.3056872037914692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:54:20.866033", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7219943019985562, "overlap_percentage": 0.838555971016403, "num_intersection": 9670261, "num_union": 13393819, "num_only_computed": 1861779, "num_only_roped": 1861779, "total_diff": 3723558, "diff_percentage": 0.2780056980014438, "num_computed": 11532040, "num_roped": 11532040}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "mask_shape": [1, 32, 871, 16231], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:54:24.423216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12060546875, "mean_diff": 4.029273986816406e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.43157894736842106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 871, "seq_len_k": 16231, "queries_shape": [1, 32, 871, 128], "keys_shape": [1, 8, 16231, 128], "attention_shape": [1, 32, 871, 16231]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:56:10.728761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6882428669800306, "overlap_percentage": 0.8153363244604445, "num_intersection": 367808, "num_union": 534416, "num_only_computed": 83304, "num_only_roped": 83304, "total_diff": 166608, "diff_percentage": 0.31175713301996943, "num_computed": 451112, "num_roped": 451112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "mask_shape": [1, 32, 34, 16265], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:56:14.100459", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.25, "l2_diff_relative": 0.1871345029239766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 16265, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 16265, 128], "attention_shape": [1, 32, 34, 16265]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:57:53.030439", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6854674796747967, "overlap_percentage": 0.8133855893880012, "num_intersection": 10792, "num_union": 15744, "num_only_computed": 2476, "num_only_roped": 2476, "total_diff": 4952, "diff_percentage": 0.31453252032520324, "num_computed": 13268, "num_roped": 13268}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 1, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:57:56.534784", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.019287109375, "l2_diff_relative": 0.07995951417004049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16266, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 1, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:59:33.442846", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6776028826095202, "overlap_percentage": 0.8078227447433869, "num_intersection": 10719, "num_union": 15819, "num_only_computed": 2550, "num_only_roped": 2550, "total_diff": 5100, "diff_percentage": 0.3223971173904798, "num_computed": 13269, "num_roped": 13269}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "mask_shape": [1, 32, 1, 16267], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T07:59:37.987128", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009033203125, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.0191650390625, "l2_diff_relative": 0.1016839378238342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16267, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16267, 128], "attention_shape": [1, 32, 1, 16267]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:01:12.526495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6932499681000382, "overlap_percentage": 0.8188394875659382, "num_intersection": 10866, "num_union": 15674, "num_only_computed": 2404, "num_only_roped": 2404, "total_diff": 4808, "diff_percentage": 0.3067500318999617, "num_computed": 13270, "num_roped": 13270}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "mask_shape": [1, 32, 1, 16268], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:01:15.601783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 1.5079975128173828e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.11935483870967742}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16268, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16268, 128], "attention_shape": [1, 32, 1, 16268]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:02:50.691858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6947832194623588, "overlap_percentage": 0.8199080702283174, "num_intersection": 10881, "num_union": 15661, "num_only_computed": 2390, "num_only_roped": 2390, "total_diff": 4780, "diff_percentage": 0.3052167805376413, "num_computed": 13271, "num_roped": 13271}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "mask_shape": [1, 32, 1, 16269], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:02:53.798022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.023681640625, "mean_diff": 1.5497207641601562e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.17261904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16269, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16269, 128], "attention_shape": [1, 32, 1, 16269]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:04:29.176516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6841570966309244, "overlap_percentage": 0.812462326702833, "num_intersection": 10783, "num_union": 15761, "num_only_computed": 2489, "num_only_roped": 2489, "total_diff": 4978, "diff_percentage": 0.31584290336907556, "num_computed": 13272, "num_roped": 13272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "mask_shape": [1, 32, 1, 16270], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:04:32.281136", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00830078125, "mean_diff": 2.86102294921875e-05, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.12002487562189054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16270, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16270, 128], "attention_shape": [1, 32, 1, 16270]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:06:07.003406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6809575074409474, "overlap_percentage": 0.810201928872815, "num_intersection": 10753, "num_union": 15791, "num_only_computed": 2519, "num_only_roped": 2519, "total_diff": 5038, "diff_percentage": 0.31904249255905265, "num_computed": 13272, "num_roped": 13272}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "mask_shape": [1, 32, 1, 16271], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:06:10.099685", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 3.0040740966796875e-05, "l2_diff": 0.0235595703125, "l2_diff_relative": 0.13477653631284917}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16271, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16271, 128], "attention_shape": [1, 32, 1, 16271]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:07:45.285105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6944976381973701, "overlap_percentage": 0.8197091840578619, "num_intersection": 10880, "num_union": 15666, "num_only_computed": 2393, "num_only_roped": 2393, "total_diff": 4786, "diff_percentage": 0.3055023618026299, "num_computed": 13273, "num_roped": 13273}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "mask_shape": [1, 32, 1, 16272], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:07:48.533936", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.3768672943115234e-05, "l2_diff": 0.0244140625, "l2_diff_relative": 0.09328358208955224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16272, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16272, 128], "attention_shape": [1, 32, 1, 16272]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:08:45.045058", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:08:45.057709", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.159046173095703e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0029829545454545456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:08:51.033559", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8917924626509385, "overlap_percentage": 0.9428015813122376, "num_intersection": 1739039, "num_union": 1950049, "num_only_computed": 200417, "num_only_roped": 10593, "total_diff": 211010, "diff_percentage": 0.10820753734906148, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:08:51.437598", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.9141387939453125e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.016036184210526317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:09:06.799092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9118281595697427, "overlap_percentage": 0.9538808757529231, "num_intersection": 2584483, "num_union": 2834397, "num_only_computed": 193629, "num_only_roped": 56285, "total_diff": 249914, "diff_percentage": 0.0881718404302573, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:09:07.360058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.678964614868164e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.014213709677419355}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:09:27.882074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9037893778112741, "overlap_percentage": 0.9494636206556966, "num_intersection": 3393702, "num_union": 3754970, "num_only_computed": 223066, "num_only_roped": 138202, "total_diff": 361268, "diff_percentage": 0.09621062218872588, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:09:28.617310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.220703125, "l2_diff_relative": 0.024867957746478875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:09:55.090662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8861122633480544, "overlap_percentage": 0.9396177317410669, "num_intersection": 4172023, "num_union": 4708233, "num_only_computed": 284425, "num_only_roped": 251785, "total_diff": 536210, "diff_percentage": 0.11388773665194564, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:09:56.012860", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.017658390410958905}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:10:28.645679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8593493166861195, "overlap_percentage": 0.9243548901480442, "num_intersection": 4893966, "num_union": 5694967, "num_only_computed": 401138, "num_only_roped": 399863, "total_diff": 801001, "diff_percentage": 0.14065068331388048, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:10:29.780431", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.592802047729492e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.01552013422818792}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:11:08.656052", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8279872399471669, "overlap_percentage": 0.9059004590984975, "num_intersection": 5556576, "num_union": 6710944, "num_only_computed": 577184, "num_only_roped": 577184, "total_diff": 1154368, "diff_percentage": 0.1720127600528331, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:11:09.960326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.1552734375, "l2_diff_relative": 0.019639328063241108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:11:55.371376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8048100027929916, "overlap_percentage": 0.8918501133609928, "num_intersection": 6218350, "num_union": 7726482, "num_only_computed": 754066, "num_only_roped": 754066, "total_diff": 1508132, "diff_percentage": 0.1951899972070083, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:11:58.906103", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.3543834686279297e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.01760204081632653}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:12:52.135072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7866007323828976, "overlap_percentage": 0.8805557034937074, "num_intersection": 6878084, "num_union": 8744060, "num_only_computed": 932988, "num_only_roped": 932988, "total_diff": 1865976, "diff_percentage": 0.21339926761710235, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:12:53.908375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.20484581497797358}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:13:54.106366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.774656295369042, "overlap_percentage": 0.8730212124911222, "num_intersection": 7552290, "num_union": 9749214, "num_only_computed": 1098462, "num_only_roped": 1098462, "total_diff": 2196924, "diff_percentage": 0.22534370463095793, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:13:56.184815", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 6.67572021484375e-05, "l2_diff": 2.953125, "l2_diff_relative": 0.48711340206185566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:15:05.439634", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7642799155435414, "overlap_percentage": 0.8663930352662674, "num_intersection": 8221557, "num_union": 10757259, "num_only_computed": 1267851, "num_only_roped": 1267851, "total_diff": 2535702, "diff_percentage": 0.23572008445645865, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:15:09.648082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.982948303222656e-05, "l2_diff": 2.84375, "l2_diff_relative": 0.4272300469483568}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:16:25.526097", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7578283125701646, "overlap_percentage": 0.8622324571187785, "num_intersection": 8905192, "num_union": 11750936, "num_only_computed": 1422872, "num_only_roped": 1422872, "total_diff": 2845744, "diff_percentage": 0.24217168742983539, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:16:28.123715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.4052132701421801}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:17:54.614290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7514975624760117, "overlap_percentage": 0.8581200209193031, "num_intersection": 9582386, "num_union": 12751054, "num_only_computed": 1584334, "num_only_roped": 1584334, "total_diff": 3168668, "diff_percentage": 0.2485024375239882, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:17:57.463715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.234375, "l2_diff_relative": 0.39502762430939226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:19:29.516810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7421348268545627, "overlap_percentage": 0.8519832281804418, "num_intersection": 10228379, "num_union": 13782373, "num_only_computed": 1776997, "num_only_roped": 1776997, "total_diff": 3553994, "diff_percentage": 0.2578651731454373, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:19:32.621633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 4.744529724121094e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.4256410256410256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:21:13.847937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7311950348815073, "overlap_percentage": 0.8447286644760443, "num_intersection": 10850587, "num_union": 14839525, "num_only_computed": 1994469, "num_only_roped": 1994469, "total_diff": 3988938, "diff_percentage": 0.26880496511849267, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:21:18.995597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.45108695652173914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:23:03.422613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7036831539431757, "overlap_percentage": 0.8260727968278616, "num_intersection": 5324135, "num_union": 7566097, "num_only_computed": 1120981, "num_only_roped": 1120981, "total_diff": 2241962, "diff_percentage": 0.2963168460568243, "num_computed": 6445116, "num_roped": 6445116}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "mask_shape": [1, 32, 498, 15858], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:23:09.179111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.5859375, "l2_diff_relative": 0.3476027397260274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 498, "seq_len_k": 15858, "queries_shape": [1, 32, 498, 128], "keys_shape": [1, 8, 15858, 128], "attention_shape": [1, 32, 498, 15858]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:24:52.242507", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6834896754278179, "overlap_percentage": 0.811991526178057, "num_intersection": 273672, "num_union": 400404, "num_only_computed": 63366, "num_only_roped": 63366, "total_diff": 126732, "diff_percentage": 0.3165103245721821, "num_computed": 337038, "num_roped": 337038}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "mask_shape": [1, 32, 26, 15884], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:24:55.479787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 2.467632293701172e-05, "l2_diff": 0.130859375, "l2_diff_relative": 0.11394557823129252}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 15884, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 15884, 128], "attention_shape": [1, 32, 26, 15884]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:26:33.264614", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6796009587355056, "overlap_percentage": 0.8092409750077136, "num_intersection": 10491, "num_union": 15437, "num_only_computed": 2473, "num_only_roped": 2473, "total_diff": 4946, "diff_percentage": 0.3203990412644944, "num_computed": 12964, "num_roped": 12964}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "mask_shape": [1, 32, 1, 15885], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:26:36.284050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.11039719626168225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15885, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15885, 128], "attention_shape": [1, 32, 1, 15885]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:28:10.359198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6809076175040518, "overlap_percentage": 0.8101666152422092, "num_intersection": 10503, "num_union": 15425, "num_only_computed": 2461, "num_only_roped": 2461, "total_diff": 4922, "diff_percentage": 0.3190923824959481, "num_computed": 12964, "num_roped": 12964}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 1, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:28:15.760702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.15092165898617513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15886, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 1, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:08.667250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:08.679841", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.002877058383233533}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:14.847828", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891449100519226, "overlap_percentage": 0.9426096639603068, "num_intersection": 1738685, "num_union": 1950403, "num_only_computed": 200771, "num_only_roped": 10947, "total_diff": 211718, "diff_percentage": 0.10855089948077397, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:15.242819", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.014547413793103448}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:30.341865", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9116750581382222, "overlap_percentage": 0.9537970946025747, "num_intersection": 2584256, "num_union": 2834624, "num_only_computed": 193856, "num_only_roped": 56512, "total_diff": 250368, "diff_percentage": 0.08832494186177779, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:30.894962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.014930555555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:51.425048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9067757527228615, "overlap_percentage": 0.9511089612168526, "num_intersection": 3399583, "num_union": 3749089, "num_only_computed": 217185, "num_only_roped": 132321, "total_diff": 349506, "diff_percentage": 0.09322424727713853, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:29:52.158447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.2080078125, "l2_diff_relative": 0.024652777777777777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:30:18.676140", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8895444180147546, "overlap_percentage": 0.9415438023408335, "num_intersection": 4180575, "num_union": 4699681, "num_only_computed": 275873, "num_only_roped": 243233, "total_diff": 519106, "diff_percentage": 0.11045558198524538, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:30:19.601703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.382563591003418e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.017423561151079136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:30:52.371943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8633813766971853, "overlap_percentage": 0.9266824145548942, "num_intersection": 4906289, "num_union": 5682644, "num_only_computed": 388815, "num_only_roped": 387540, "total_diff": 776355, "diff_percentage": 0.13661862330281468, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:30:53.509300", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.8014183044433594e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.014973958333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:31:35.602209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8358507431460811, "overlap_percentage": 0.9105868178735392, "num_intersection": 5585321, "num_union": 6682199, "num_only_computed": 548439, "num_only_roped": 548439, "total_diff": 1096878, "diff_percentage": 0.1641492568539189, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:31:39.270084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.592802047729492e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.018138111888111888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:32:25.522746", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8102187658533977, "overlap_percentage": 0.8951611607798502, "num_intersection": 6241436, "num_union": 7703396, "num_only_computed": 730980, "num_only_roped": 730980, "total_diff": 1461960, "diff_percentage": 0.18978123414660236, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:32:27.078573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.115964889526367e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:33:20.220944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7892721399197458, "overlap_percentage": 0.8822270489889223, "num_intersection": 6891139, "num_union": 8731005, "num_only_computed": 919933, "num_only_roped": 919933, "total_diff": 1839866, "diff_percentage": 0.2107278600802542, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:33:22.012405", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 2.5153160095214844e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:34:22.743619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7709692941642626, "overlap_percentage": 0.8706749424789891, "num_intersection": 7531993, "num_union": 9769511, "num_only_computed": 1118759, "num_only_roped": 1118759, "total_diff": 2237518, "diff_percentage": 0.2290307058357373, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:34:24.909603", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 4.100799560546875e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.27209302325581397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:35:33.624323", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7642033269856473, "overlap_percentage": 0.8663438225018885, "num_intersection": 8221090, "num_union": 10757726, "num_only_computed": 1268318, "num_only_roped": 1268318, "total_diff": 2536636, "diff_percentage": 0.23579667301435267, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:35:36.215696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.602836608886719e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.4673913043478261}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:36:52.562665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7586870821590236, "overlap_percentage": 0.8627880307480666, "num_intersection": 8910930, "num_union": 11745198, "num_only_computed": 1417134, "num_only_roped": 1417134, "total_diff": 2834268, "diff_percentage": 0.24131291784097636, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:36:55.760566", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1640625, "mean_diff": 5.078315734863281e-05, "l2_diff": 2.59375, "l2_diff_relative": 0.41089108910891087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:38:20.957646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7454014817137374, "overlap_percentage": 0.8541318310121504, "num_intersection": 9537851, "num_union": 12795589, "num_only_computed": 1628869, "num_only_roped": 1628869, "total_diff": 3257738, "diff_percentage": 0.25459851828626257, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:38:23.868592", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.294921875, "mean_diff": 5.4836273193359375e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.478494623655914}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:39:59.112959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7378512189728904, "overlap_percentage": 0.8491534959005033, "num_intersection": 10194407, "num_union": 13816345, "num_only_computed": 1810969, "num_only_roped": 1810969, "total_diff": 3621938, "diff_percentage": 0.26214878102710953, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:40:02.279453", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 4.3392181396484375e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.39572192513368987}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:41:44.855158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7323540214882441, "overlap_percentage": 0.8455015688526387, "num_intersection": 10860515, "num_union": 14829597, "num_only_computed": 1984541, "num_only_roped": 1984541, "total_diff": 3969082, "diff_percentage": 0.2676459785117559, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:41:48.253393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 4.076957702636719e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.3961352657004831}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:43:30.122197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6954178742771135, "overlap_percentage": 0.8203498203339674, "num_intersection": 931458, "num_union": 1339422, "num_only_computed": 203982, "num_only_roped": 203982, "total_diff": 407964, "diff_percentage": 0.30458212572288645, "num_computed": 1135440, "num_roped": 1135440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "mask_shape": [1, 32, 90, 15450], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:43:35.774507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 4.57763671875e-05, "l2_diff": 0.6484375, "l2_diff_relative": 0.31203007518796994}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 90, "seq_len_k": 15450, "queries_shape": [1, 32, 90, 128], "keys_shape": [1, 8, 15450, 128], "attention_shape": [1, 32, 90, 15450]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:45:13.157780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6931355749727229, "overlap_percentage": 0.8187596849518558, "num_intersection": 383069, "num_union": 552661, "num_only_computed": 84796, "num_only_roped": 84796, "total_diff": 169592, "diff_percentage": 0.3068644250272771, "num_computed": 467865, "num_roped": 467865}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "mask_shape": [1, 32, 37, 15487], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:45:16.265605", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.22265625, "l2_diff_relative": 0.17484662576687116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 37, "seq_len_k": 15487, "queries_shape": [1, 32, 37, 128], "keys_shape": [1, 8, 15487, 128], "attention_shape": [1, 32, 37, 15487]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:46:48.509964", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6881591242824723, "overlap_percentage": 0.815277558121145, "num_intersection": 10310, "num_union": 14982, "num_only_computed": 2336, "num_only_roped": 2336, "total_diff": 4672, "diff_percentage": 0.3118408757175277, "num_computed": 12646, "num_roped": 12646}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "mask_shape": [1, 32, 1, 15488], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:46:51.371542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.28104575163398693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15488, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15488, 128], "attention_shape": [1, 32, 1, 15488]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:48:19.832415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6896459585838344, "overlap_percentage": 0.8163200759073298, "num_intersection": 10324, "num_union": 14970, "num_only_computed": 2323, "num_only_roped": 2323, "total_diff": 4646, "diff_percentage": 0.3103540414161657, "num_computed": 12647, "num_roped": 12647}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "mask_shape": [1, 32, 1, 15489], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:48:23.633007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021240234375, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.14130434782608695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15489, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15489, 128], "attention_shape": [1, 32, 1, 15489]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:49:52.222806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6898924443850625, "overlap_percentage": 0.8164927261227072, "num_intersection": 10327, "num_union": 14969, "num_only_computed": 2321, "num_only_roped": 2321, "total_diff": 4642, "diff_percentage": 0.3101075556149375, "num_computed": 12648, "num_roped": 12648}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "mask_shape": [1, 32, 1, 15490], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:49:55.102396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.011962890625, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.02587890625, "l2_diff_relative": 0.09137931034482759}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15490, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15490, 128], "attention_shape": [1, 32, 1, 15490]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:50:43.920756", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:50:43.930235", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.029052734375, "l2_diff_relative": 0.0030784354304635763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:50:50.002448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8919564280878823, "overlap_percentage": 0.9428932028729051, "num_intersection": 1739208, "num_union": 1949880, "num_only_computed": 200248, "num_only_roped": 10424, "total_diff": 210672, "diff_percentage": 0.10804357191211766, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:50:52.856975", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.16908073425293e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.01393581081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:07.993698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9117667811611833, "overlap_percentage": 0.9538472894767922, "num_intersection": 2584392, "num_union": 2834488, "num_only_computed": 193720, "num_only_roped": 56376, "total_diff": 250096, "diff_percentage": 0.08823321883881674, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:08.551503", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.6193599700927734e-06, "l2_diff": 0.12255859375, "l2_diff_relative": 0.014418658088235295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:30.041713", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9044537864377701, "overlap_percentage": 0.9498301222940428, "num_intersection": 3395012, "num_union": 3753660, "num_only_computed": 221756, "num_only_roped": 136892, "total_diff": 358648, "diff_percentage": 0.09554621356222993, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:30.785164", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.228515625, "l2_diff_relative": 0.024054276315789474}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:57.310245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8853502319253627, "overlap_percentage": 0.9391891404932471, "num_intersection": 4170120, "num_union": 4710136, "num_only_computed": 286328, "num_only_roped": 253688, "total_diff": 540016, "diff_percentage": 0.11464976807463734, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:51:58.233666", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.382563591003418e-06, "l2_diff": 0.150390625, "l2_diff_relative": 0.017824074074074076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:52:33.067351", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8599143158804033, "overlap_percentage": 0.9246816463944006, "num_intersection": 4895696, "num_union": 5693237, "num_only_computed": 399408, "num_only_roped": 398133, "total_diff": 797541, "diff_percentage": 0.14008568411959663, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:52:34.192180", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.637505531311035e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.014397321428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:53:13.290904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8310171333967876, "overlap_percentage": 0.9077109309787145, "num_intersection": 5567681, "num_union": 6699839, "num_only_computed": 566079, "num_only_roped": 566079, "total_diff": 1132158, "diff_percentage": 0.1689828666032124, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:53:14.618208", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.428889274597168e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.01752533783783784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:54:00.928668", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8081461824381184, "overlap_percentage": 0.8938947417939492, "num_intersection": 6232606, "num_union": 7712226, "num_only_computed": 739810, "num_only_roped": 739810, "total_diff": 1479620, "diff_percentage": 0.1918538175618816, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:54:04.796208", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.339482307434082e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.016898148148148148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:54:58.697868", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7915676680407779, "overlap_percentage": 0.8836592467717619, "num_intersection": 6902326, "num_union": 8719818, "num_only_computed": 908746, "num_only_roped": 908746, "total_diff": 1817492, "diff_percentage": 0.2084323319592221, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:55:01.243359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.11422413793103449}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:56:01.358081", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.775561449405413, "overlap_percentage": 0.8735957290187026, "num_intersection": 7557260, "num_union": 9744244, "num_only_computed": 1093492, "num_only_roped": 1093492, "total_diff": 2186984, "diff_percentage": 0.22443855059458692, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:56:03.443425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16015625, "mean_diff": 5.14984130859375e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.38333333333333336}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:06.823461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7222572537722006, "overlap_percentage": 0.8387332986291862, "num_intersection": 241681, "num_union": 334619, "num_only_computed": 46469, "num_only_roped": 46469, "total_diff": 92938, "diff_percentage": 0.2777427462277994, "num_computed": 288150, "num_roped": 288150}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "mask_shape": [1, 32, 34, 10274], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:57:08.794601", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 2.586841583251953e-05, "l2_diff": 0.1884765625, "l2_diff_relative": 0.12002487562189054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 10274, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 10274, 128], "attention_shape": [1, 32, 34, 10274]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:58:06.768487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7152814515379987, "overlap_percentage": 0.8340105944673337, "num_intersection": 177123, "num_union": 247627, "num_only_computed": 35252, "num_only_roped": 35252, "total_diff": 70504, "diff_percentage": 0.28471854846200134, "num_computed": 212375, "num_roped": 212375}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "mask_shape": [1, 32, 25, 10299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:58:09.013910", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044677734375, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.1728515625, "l2_diff_relative": 0.16032608695652173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 10299, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 10299, 128], "attention_shape": [1, 32, 25, 10299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:59:05.289908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7141127811964088, "overlap_percentage": 0.8332156308851224, "num_intersection": 7079, "num_union": 9913, "num_only_computed": 1417, "num_only_roped": 1417, "total_diff": 2834, "diff_percentage": 0.28588721880359125, "num_computed": 8496, "num_roped": 8496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "mask_shape": [1, 32, 1, 10300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T08:59:08.027129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0167236328125, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.032958984375, "l2_diff_relative": 0.22651006711409397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10300, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10300, 128], "attention_shape": [1, 32, 1, 10300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:00:02.211682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7165370239418123, "overlap_percentage": 0.8348634651600754, "num_intersection": 7093, "num_union": 9899, "num_only_computed": 1403, "num_only_roped": 1403, "total_diff": 2806, "diff_percentage": 0.2834629760581877, "num_computed": 8496, "num_roped": 8496}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "mask_shape": [1, 32, 1, 10301], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:00:03.957945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0115966796875, "mean_diff": 3.528594970703125e-05, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.16131284916201116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10301, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10301, 128], "attention_shape": [1, 32, 1, 10301]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:00:58.452582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7155259438724005, "overlap_percentage": 0.8341767682711545, "num_intersection": 7088, "num_union": 9906, "num_only_computed": 1409, "num_only_roped": 1409, "total_diff": 2818, "diff_percentage": 0.28447405612759946, "num_computed": 8497, "num_roped": 8497}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10302, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10302, 128], "mask_shape": [1, 32, 1, 10302], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:00.203289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 2.288818359375e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.13995726495726496}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 10302, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 10302, 128], "attention_shape": [1, 32, 1, 10302]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:33.114148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:33.127836", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.032470703125, "l2_diff_relative": 0.00326749213836478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:39.075148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.891441342363225, "overlap_percentage": 0.9426053268450089, "num_intersection": 1738677, "num_union": 1950411, "num_only_computed": 200779, "num_only_roped": 10955, "total_diff": 211734, "diff_percentage": 0.10855865763677502, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:39.461013", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.765127182006836e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.016357421875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:54.312124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9109860680776091, "overlap_percentage": 0.9534198948860281, "num_intersection": 2583234, "num_union": 2835646, "num_only_computed": 194878, "num_only_roped": 57534, "total_diff": 252412, "diff_percentage": 0.08901393192239088, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:01:54.869132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.708766937255859e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.014935661764705883}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:02:16.040685", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9021192480470387, "overlap_percentage": 0.9485412115704847, "num_intersection": 3390405, "num_union": 3758267, "num_only_computed": 226363, "num_only_roped": 141499, "total_diff": 367862, "diff_percentage": 0.0978807519529613, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:02:19.217079", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.2265625, "l2_diff_relative": 0.02465986394557823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:02:46.124862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8824291539170038, "overlap_percentage": 0.9375430167778946, "num_intersection": 4162811, "num_union": 4717445, "num_only_computed": 293637, "num_only_roped": 260997, "total_diff": 554634, "diff_percentage": 0.1175708460829962, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:02:47.048270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.6507844924926758e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.018908514492753624}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:03:19.798597", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.855699156474335, "overlap_percentage": 0.9222390962337754, "num_intersection": 4882764, "num_union": 5706169, "num_only_computed": 412340, "num_only_roped": 411065, "total_diff": 823405, "diff_percentage": 0.14430084352566494, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:03:20.921414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.6673078536987305e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.014732142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:04:01.102645", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8262426207934522, "overlap_percentage": 0.9048552600688647, "num_intersection": 5550165, "num_union": 6717355, "num_only_computed": 583595, "num_only_roped": 583595, "total_diff": 1167190, "diff_percentage": 0.17375737920654782, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:04:02.423347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.01986434108527132}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:04:47.911178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8032327976372129, "overlap_percentage": 0.890880865398737, "num_intersection": 6211592, "num_union": 7733240, "num_only_computed": 760824, "num_only_roped": 760824, "total_diff": 1521648, "diff_percentage": 0.19676720236278714, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:04:50.437162", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.428889274597168e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.018875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:05:43.577169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7879944751457095, "overlap_percentage": 0.8814283109923964, "num_intersection": 6884900, "num_union": 8737244, "num_only_computed": 926172, "num_only_roped": 926172, "total_diff": 1852344, "diff_percentage": 0.21200552485429044, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:05:45.899381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06640625, "mean_diff": 2.7298927307128906e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.15825688073394495}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:06:46.352268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7719100677118047, "overlap_percentage": 0.8712745435310133, "num_intersection": 7537180, "num_union": 9764324, "num_only_computed": 1113572, "num_only_roped": 1113572, "total_diff": 2227144, "diff_percentage": 0.22808993228819527, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:06:48.422655", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1162109375, "mean_diff": 5.555152893066406e-05, "l2_diff": 2.375, "l2_diff_relative": 0.4245810055865922}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:07:58.641139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7577253281886251, "overlap_percentage": 0.8621657958009604, "num_intersection": 8181443, "num_union": 10797373, "num_only_computed": 1307965, "num_only_roped": 1307965, "total_diff": 2615930, "diff_percentage": 0.24227467181137485, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:08:01.320966", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 5.412101745605469e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.4472361809045226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:09:17.770462", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7457858751449671, "overlap_percentage": 0.8543841323988697, "num_intersection": 8824134, "num_union": 11831994, "num_only_computed": 1503930, "num_only_roped": 1503930, "total_diff": 3007860, "diff_percentage": 0.25421412485503286, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:09:20.396645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.887580871582031e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.4170984455958549}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:10:48.001454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7444150021577269, "overlap_percentage": 0.853483834107061, "num_intersection": 9530615, "num_union": 12802825, "num_only_computed": 1636105, "num_only_roped": 1636105, "total_diff": 3272210, "diff_percentage": 0.25558499784227307, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:10:50.924019", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 4.267692565917969e-05, "l2_diff": 2.375, "l2_diff_relative": 0.3619047619047619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:12:23.817960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.738319003329345, "overlap_percentage": 0.8494631904906602, "num_intersection": 10198125, "num_union": 13812627, "num_only_computed": 1807251, "num_only_roped": 1807251, "total_diff": 3614502, "diff_percentage": 0.26168099667065503, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:12:27.384209", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09716796875, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.734375, "l2_diff_relative": 0.2557603686635945}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:14:09.396186", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7312413505699257, "overlap_percentage": 0.8447595713089924, "num_intersection": 10850984, "num_union": 14839128, "num_only_computed": 1994072, "num_only_roped": 1994072, "total_diff": 3988144, "diff_percentage": 0.2687586494300743, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:14:12.759573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11669921875, "mean_diff": 3.647804260253906e-05, "l2_diff": 2.0, "l2_diff_relative": 0.34972677595628415}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:16:01.206375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7173661484908456, "overlap_percentage": 0.8354259796272786, "num_intersection": 9192969, "num_union": 12814891, "num_only_computed": 1810961, "num_only_roped": 1810961, "total_diff": 3621922, "diff_percentage": 0.2826338515091545, "num_computed": 11003930, "num_roped": 11003930}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "mask_shape": [1, 32, 833, 16193], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:16:06.548524", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.6796875, "l2_diff_relative": 0.3317901234567901}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 833, "seq_len_k": 16193, "queries_shape": [1, 32, 833, 128], "keys_shape": [1, 8, 16193, 128], "attention_shape": [1, 32, 833, 16193]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:17:53.073942", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6890982073912405, "overlap_percentage": 0.8159362248753211, "num_intersection": 323943, "num_union": 470097, "num_only_computed": 73077, "num_only_roped": 73077, "total_diff": 146154, "diff_percentage": 0.31090179260875944, "num_computed": 397020, "num_roped": 397020}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "mask_shape": [1, 32, 30, 16223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:17:56.850393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.14453125, "l2_diff_relative": 0.12251655629139073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16223, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16223, 128], "attention_shape": [1, 32, 30, 16223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:19:34.530967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6837351313529674, "overlap_percentage": 0.8121647147714394, "num_intersection": 10749, "num_union": 15721, "num_only_computed": 2486, "num_only_roped": 2486, "total_diff": 4972, "diff_percentage": 0.3162648686470326, "num_computed": 13235, "num_roped": 13235}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "mask_shape": [1, 32, 1, 16224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:19:37.566156", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0164794921875, "mean_diff": 1.7642974853515625e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.11761811023622047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16224, 128], "attention_shape": [1, 32, 1, 16224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:21:11.531302", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6863294687221302, "overlap_percentage": 0.8139921426412814, "num_intersection": 10774, "num_union": 15698, "num_only_computed": 2462, "num_only_roped": 2462, "total_diff": 4924, "diff_percentage": 0.3136705312778698, "num_computed": 13236, "num_roped": 13236}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "mask_shape": [1, 32, 1, 16225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:21:14.584258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00531005859375, "mean_diff": 1.4841556549072266e-05, "l2_diff": 0.0152587890625, "l2_diff_relative": 0.06913716814159292}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16225, 128], "attention_shape": [1, 32, 1, 16225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:22:06.961921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:22:06.974529", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.0286865234375, "l2_diff_relative": 0.00312234268707483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:22:12.996630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8914326145137971, "overlap_percentage": 0.9426004475902987, "num_intersection": 1738668, "num_union": 1950420, "num_only_computed": 200788, "num_only_roped": 10964, "total_diff": 211752, "diff_percentage": 0.10856738548620297, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:22:15.819688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.079673767089844e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.014732142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:22:30.673242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9099871736533658, "overlap_percentage": 0.9528725493090823, "num_intersection": 2581751, "num_union": 2837129, "num_only_computed": 196361, "num_only_roped": 59017, "total_diff": 255378, "diff_percentage": 0.09001282634663423, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:22:31.228836", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.364418029785156e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.017554780876494022}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:22:52.550759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9042914453460061, "overlap_percentage": 0.9497405951762788, "num_intersection": 3394692, "num_union": 3753980, "num_only_computed": 222076, "num_only_roped": 137212, "total_diff": 359288, "diff_percentage": 0.09570855465399389, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:22:53.285561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.25, "l2_diff_relative": 0.02631578947368421}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:23:22.226436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8854046709129512, "overlap_percentage": 0.9392197702408579, "num_intersection": 4170256, "num_union": 4710000, "num_only_computed": 286192, "num_only_roped": 253552, "total_diff": 539744, "diff_percentage": 0.11459532908704884, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:23:25.442522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.546476364135742e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.01885416666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:23:58.157637", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8541936841795601, "overlap_percentage": 0.9213640316734463, "num_intersection": 4878131, "num_union": 5710802, "num_only_computed": 416973, "num_only_roped": 415698, "total_diff": 832671, "diff_percentage": 0.14580631582043993, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:23:59.256859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.60770320892334e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.014539930555555556}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:24:38.960424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8256346516276584, "overlap_percentage": 0.904490557178631, "num_intersection": 5547928, "num_union": 6719592, "num_only_computed": 585832, "num_only_roped": 585832, "total_diff": 1171664, "diff_percentage": 0.17436534837234166, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:24:40.291204", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.1689453125, "l2_diff_relative": 0.018902972027972028}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:25:25.913413", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8063930113445956, "overlap_percentage": 0.8928212258132618, "num_intersection": 6225121, "num_union": 7719711, "num_only_computed": 747295, "num_only_roped": 747295, "total_diff": 1494590, "diff_percentage": 0.19360698865540432, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:25:29.224368", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.115964889526367e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:26:22.099192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8020954732660297, "overlap_percentage": 0.890180886823217, "num_intersection": 6953267, "num_union": 8668877, "num_only_computed": 857805, "num_only_roped": 857805, "total_diff": 1715610, "diff_percentage": 0.19790452673397027, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:26:25.549550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 2.4199485778808594e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.13854166666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:27:25.701005", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7807390598021061, "overlap_percentage": 0.876870820016572, "num_intersection": 7585592, "num_union": 9715912, "num_only_computed": 1065160, "num_only_roped": 1065160, "total_diff": 2130320, "diff_percentage": 0.21926094019789394, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:27:28.088408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11376953125, "mean_diff": 4.6253204345703125e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.31063829787234043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:36.245747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.760303822536949, "overlap_percentage": 0.8638324961894356, "num_intersection": 8197259, "num_union": 10781557, "num_only_computed": 1292149, "num_only_roped": 1292149, "total_diff": 2584298, "diff_percentage": 0.23969617746305102, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:28:38.601609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.6253204345703125e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.35645933014354064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:29:55.930377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7444658272732803, "overlap_percentage": 0.853517237923693, "num_intersection": 8176358, "num_union": 10982852, "num_only_computed": 1403247, "num_only_roped": 1403247, "total_diff": 2806494, "diff_percentage": 0.2555341727267198, "num_computed": 9579605, "num_roped": 9579605}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "mask_shape": [1, 32, 955, 12219], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:29:58.516770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.125, "mean_diff": 4.9591064453125e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.43989071038251365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 955, "seq_len_k": 12219, "queries_shape": [1, 32, 955, 128], "keys_shape": [1, 8, 12219, 128], "attention_shape": [1, 32, 955, 12219]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:31:13.740319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6940080462433311, "overlap_percentage": 0.8193680635489051, "num_intersection": 230639, "num_union": 332329, "num_only_computed": 50845, "num_only_roped": 50845, "total_diff": 101690, "diff_percentage": 0.3059919537566688, "num_computed": 281484, "num_roped": 281484}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "mask_shape": [1, 32, 28, 12247], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:31:17.282064", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.956390380859375e-05, "l2_diff": 0.138671875, "l2_diff_relative": 0.11451612903225807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 12247, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 12247, 128], "attention_shape": [1, 32, 28, 12247]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:32:27.077999", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6863468634686347, "overlap_percentage": 0.8140043763676149, "num_intersection": 8184, "num_union": 11924, "num_only_computed": 1870, "num_only_roped": 1870, "total_diff": 3740, "diff_percentage": 0.31365313653136534, "num_computed": 10054, "num_roped": 10054}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "mask_shape": [1, 32, 1, 12248], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:32:29.269023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.21932515337423314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12248, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12248, 128], "attention_shape": [1, 32, 1, 12248]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:33:36.558740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6842546063651591, "overlap_percentage": 0.8125310790651418, "num_intersection": 8170, "num_union": 11940, "num_only_computed": 1885, "num_only_roped": 1885, "total_diff": 3770, "diff_percentage": 0.3157453936348409, "num_computed": 10055, "num_roped": 10055}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "mask_shape": [1, 32, 1, 12249], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:33:38.732320", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.814697265625e-05, "l2_diff": 0.030517578125, "l2_diff_relative": 0.18601190476190477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12249, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12249, 128], "attention_shape": [1, 32, 1, 12249]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:34:45.866104", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6957841483979764, "overlap_percentage": 0.8206046141607001, "num_intersection": 8252, "num_union": 11860, "num_only_computed": 1804, "num_only_roped": 1804, "total_diff": 3608, "diff_percentage": 0.30421585160202363, "num_computed": 10056, "num_roped": 10056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "mask_shape": [1, 32, 1, 12250], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:34:48.037980", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.016845703125, "l2_diff_relative": 0.07467532467532467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 12250, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 12250, 128], "attention_shape": [1, 32, 1, 12250]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:35:24.217102", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:35:24.225466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.0030423677884615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:35:30.203262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8916547148458792, "overlap_percentage": 0.9427245975157004, "num_intersection": 1738897, "num_union": 1950191, "num_only_computed": 200559, "num_only_roped": 10735, "total_diff": 211294, "diff_percentage": 0.1083452851541208, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:35:30.602743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.258487701416016e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.015168795620437957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:35:45.515412", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9118079244940864, "overlap_percentage": 0.9538698033541987, "num_intersection": 2584453, "num_union": 2834427, "num_only_computed": 193659, "num_only_roped": 56315, "total_diff": 249974, "diff_percentage": 0.08819207550591354, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:35:46.069059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.01473496835443038}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:36:08.885777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.905633619595792, "overlap_percentage": 0.9504803129868037, "num_intersection": 3397336, "num_union": 3751336, "num_only_computed": 219432, "num_only_roped": 134568, "total_diff": 354000, "diff_percentage": 0.094366380404208, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:36:09.628404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 5.3942203521728516e-06, "l2_diff": 0.224609375, "l2_diff_relative": 0.026041666666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:36:36.163804", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8850832862252996, "overlap_percentage": 0.9390389195987142, "num_intersection": 4169453, "num_union": 4710803, "num_only_computed": 286995, "num_only_roped": 254355, "total_diff": 541350, "diff_percentage": 0.1149167137747004, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:36:37.092274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.017922794117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:37:09.748976", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8592242794560475, "overlap_percentage": 0.9242825504703827, "num_intersection": 4893583, "num_union": 5695350, "num_only_computed": 401521, "num_only_roped": 400246, "total_diff": 801767, "diff_percentage": 0.14077572054395251, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:37:12.221825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.015290178571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:37:46.828892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7610258512826675, "overlap_percentage": 0.8642983301220295, "num_intersection": 107657, "num_union": 141463, "num_only_computed": 16903, "num_only_roped": 16903, "total_diff": 33806, "diff_percentage": 0.23897414871733244, "num_computed": 124560, "num_roped": 124560}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "mask_shape": [1, 32, 24, 6168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:37:47.843445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 2.115964889526367e-06, "l2_diff": 0.0203857421875, "l2_diff_relative": 0.01410472972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 6168, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 6168, 128], "attention_shape": [1, 32, 24, 6168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:38:20.464644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7508608175066885, "overlap_percentage": 0.8577047472864817, "num_intersection": 125170, "num_union": 166702, "num_only_computed": 20766, "num_only_roped": 20766, "total_diff": 41532, "diff_percentage": 0.2491391824933114, "num_computed": 145936, "num_roped": 145936}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "mask_shape": [1, 32, 28, 6196], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:38:21.532336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0048828125, "mean_diff": 2.7865171432495117e-06, "l2_diff": 0.0177001953125, "l2_diff_relative": 0.013648343373493976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 6196, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 6196, 128], "attention_shape": [1, 32, 28, 6196]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:38:53.541556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7478625314333612, "overlap_percentage": 0.8557452522539805, "num_intersection": 4461, "num_union": 5965, "num_only_computed": 752, "num_only_roped": 752, "total_diff": 1504, "diff_percentage": 0.2521374685666387, "num_computed": 5213, "num_roped": 5213}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "mask_shape": [1, 32, 1, 6197], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:38:54.583231", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 2.3692846298217773e-06, "l2_diff": 0.00142669677734375, "l2_diff_relative": 0.00825388418079096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6197, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6197, 128], "attention_shape": [1, 32, 1, 6197]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:39:25.923318", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7632735880960433, "overlap_percentage": 0.8657460682777138, "num_intersection": 4514, "num_union": 5914, "num_only_computed": 700, "num_only_roped": 700, "total_diff": 1400, "diff_percentage": 0.2367264119039567, "num_computed": 5214, "num_roped": 5214}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "mask_shape": [1, 32, 1, 6198], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:39:27.693545", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 3.2335519790649414e-06, "l2_diff": 0.00180816650390625, "l2_diff_relative": 0.009351325757575758}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6198, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6198, 128], "attention_shape": [1, 32, 1, 6198]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:39:59.158621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7458988952125879, "overlap_percentage": 0.8544582933844679, "num_intersection": 4456, "num_union": 5974, "num_only_computed": 759, "num_only_roped": 759, "total_diff": 1518, "diff_percentage": 0.2541011047874121, "num_computed": 5215, "num_roped": 5215}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "mask_shape": [1, 32, 1, 6199], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:40:00.201144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 2.0116567611694336e-06, "l2_diff": 0.00159454345703125, "l2_diff_relative": 0.006328730620155039}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 6199, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 6199, 128], "attention_shape": [1, 32, 1, 6199]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:40:23.390487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:40:23.406374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.031494140625, "l2_diff_relative": 0.0031494140625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:40:29.478220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8914869224411444, "overlap_percentage": 0.9426308073973838, "num_intersection": 1738724, "num_union": 1950364, "num_only_computed": 200732, "num_only_roped": 10908, "total_diff": 211640, "diff_percentage": 0.10851307755885568, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:40:29.877120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.4373016357421875e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.015035377358490566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:40:45.463069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9120568456961714, "overlap_percentage": 0.9540059938585095, "num_intersection": 2584822, "num_union": 2834058, "num_only_computed": 193290, "num_only_roped": 55946, "total_diff": 249236, "diff_percentage": 0.08794315430382864, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:40:46.016440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.0067901611328125e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01640625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:41:06.929895", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9044218233471143, "overlap_percentage": 0.949812496642733, "num_intersection": 3394949, "num_union": 3753723, "num_only_computed": 221819, "num_only_roped": 136955, "total_diff": 358774, "diff_percentage": 0.09557817665288568, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:41:07.684637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.27501106262207e-06, "l2_diff": 0.2197265625, "l2_diff_relative": 0.02475792253521127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:41:34.868752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8872510515595725, "overlap_percentage": 0.940257578159909, "num_intersection": 4174864, "num_union": 4705392, "num_only_computed": 281584, "num_only_roped": 248944, "total_diff": 530528, "diff_percentage": 0.11274894844042749, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:41:35.794203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.516674041748047e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.018568840579710144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:42:09.214732", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8617413167125263, "overlap_percentage": 0.9257368990813333, "num_intersection": 4901283, "num_union": 5687650, "num_only_computed": 393821, "num_only_roped": 392546, "total_diff": 786367, "diff_percentage": 0.13825868328747373, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:42:10.340051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.726912498474121e-06, "l2_diff": 0.123046875, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:42:52.694524", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8321769018988296, "overlap_percentage": 0.9084023502712855, "num_intersection": 5571922, "num_union": 6695598, "num_only_computed": 561838, "num_only_roped": 561838, "total_diff": 1123676, "diff_percentage": 0.16782309810117035, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:42:55.546761", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.562999725341797e-06, "l2_diff": 0.15234375, "l2_diff_relative": 0.017922794117647058}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:43:42.090216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.808509421416563, "overlap_percentage": 0.8941169029501396, "num_intersection": 6234155, "num_union": 7710677, "num_only_computed": 738261, "num_only_roped": 738261, "total_diff": 1476522, "diff_percentage": 0.19149057858343696, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:43:43.644894", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.339482307434082e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015407986111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:44:36.689342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7875541971092739, "overlap_percentage": 0.8811528046342423, "num_intersection": 6882748, "num_union": 8739396, "num_only_computed": 928324, "num_only_roped": 928324, "total_diff": 1856648, "diff_percentage": 0.2124458028907261, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:44:38.489156", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 3.0159950256347656e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.16533864541832669}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:45:39.056469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7691005089965256, "overlap_percentage": 0.8694819826068301, "num_intersection": 7521673, "num_union": 9779831, "num_only_computed": 1129079, "num_only_roped": 1129079, "total_diff": 2258158, "diff_percentage": 0.2308994910034744, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:45:41.708464", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.340576171875e-05, "l2_diff": 2.40625, "l2_diff_relative": 0.3811881188118812}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:46:49.953647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.757028041435861, "overlap_percentage": 0.861714239708104, "num_intersection": 8177158, "num_union": 10801658, "num_only_computed": 1312250, "num_only_roped": 1312250, "total_diff": 2624500, "diff_percentage": 0.24297195856413895, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:46:52.314686", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 5.555152893066406e-05, "l2_diff": 2.671875, "l2_diff_relative": 0.4453125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:48:08.875801", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7472466402336911, "overlap_percentage": 0.8553419111268095, "num_intersection": 8834026, "num_union": 11822102, "num_only_computed": 1494038, "num_only_roped": 1494038, "total_diff": 2988076, "diff_percentage": 0.2527533597663089, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:48:12.656862", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 4.744529724121094e-05, "l2_diff": 2.375, "l2_diff_relative": 0.3877551020408163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:49:37.609095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7402118227660384, "overlap_percentage": 0.8507146234525447, "num_intersection": 9499692, "num_union": 12833748, "num_only_computed": 1667028, "num_only_roped": 1667028, "total_diff": 3334056, "diff_percentage": 0.2597881772339616, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:49:40.506024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.6253204345703125e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.39267015706806285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:51:15.802080", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7364950873771031, "overlap_percentage": 0.8482547318801177, "num_intersection": 10183617, "num_union": 13827135, "num_only_computed": 1821759, "num_only_roped": 1821759, "total_diff": 3643518, "diff_percentage": 0.26350491262289694, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:51:18.909284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 4.029273986816406e-05, "l2_diff": 2.5, "l2_diff_relative": 0.3669724770642202}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:52:59.239373", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7300154623245825, "overlap_percentage": 0.843940968416175, "num_intersection": 10840469, "num_union": 14849643, "num_only_computed": 2004587, "num_only_roped": 2004587, "total_diff": 4009174, "diff_percentage": 0.2699845376754175, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:53:02.776221", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.4754601226993865}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:54:51.419015", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7253718468239755, "overlap_percentage": 0.8408295848332326, "num_intersection": 10107451, "num_union": 13934165, "num_only_computed": 1913357, "num_only_roped": 1913357, "total_diff": 3826714, "diff_percentage": 0.2746281531760245, "num_computed": 12020808, "num_roped": 12020808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "mask_shape": [1, 32, 906, 16266], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:54:54.998527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1240234375, "mean_diff": 4.7206878662109375e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.5188679245283019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 906, "seq_len_k": 16266, "queries_shape": [1, 32, 906, 128], "keys_shape": [1, 8, 16266, 128], "attention_shape": [1, 32, 906, 16266]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:56:42.403203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6939726295521634, "overlap_percentage": 0.8193433795156766, "num_intersection": 304917, "num_union": 439379, "num_only_computed": 67231, "num_only_roped": 67231, "total_diff": 134462, "diff_percentage": 0.3060273704478366, "num_computed": 372148, "num_roped": 372148}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 28, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:56:45.766345", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.2041015625, "l2_diff_relative": 0.16964285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 16294, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 28, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:58:24.621369", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6932484076433121, "overlap_percentage": 0.8188383990370147, "num_intersection": 10884, "num_union": 15700, "num_only_computed": 2408, "num_only_roped": 2408, "total_diff": 4816, "diff_percentage": 0.3067515923566879, "num_computed": 13292, "num_roped": 13292}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 1, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T09:58:27.696049", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00634765625, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.01470947265625, "l2_diff_relative": 0.0678490990990991}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16295, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 1, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:00:03.714200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6893746822572445, "overlap_percentage": 0.8161300030093289, "num_intersection": 10848, "num_union": 15736, "num_only_computed": 2444, "num_only_roped": 2444, "total_diff": 4888, "diff_percentage": 0.3106253177427555, "num_computed": 13292, "num_roped": 13292}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 1, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:00:07.515301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.11669921875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16296, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 1, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:02.941617", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:02.954211", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003058667452830189}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:08.944729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8916236758565559, "overlap_percentage": 0.9427072490545089, "num_intersection": 1738865, "num_union": 1950223, "num_only_computed": 200591, "num_only_roped": 10767, "total_diff": 211358, "diff_percentage": 0.10837632414344411, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:09.333456", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.735324859619141e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.015843531468531468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:24.288653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9125643329735652, "overlap_percentage": 0.954283541986536, "num_intersection": 2585574, "num_union": 2833306, "num_only_computed": 192538, "num_only_roped": 55194, "total_diff": 247732, "diff_percentage": 0.08743566702643485, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:27.104182", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.125999450683594e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.015175359712230215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:47.748417", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9043320280241882, "overlap_percentage": 0.9497629769557199, "num_intersection": 3394772, "num_union": 3753900, "num_only_computed": 221996, "num_only_roped": 137132, "total_diff": 359128, "diff_percentage": 0.09566797197581182, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:01:48.489965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.304813385009766e-06, "l2_diff": 0.2041015625, "l2_diff_relative": 0.02437033582089552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:02:15.062741", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8859776717724642, "overlap_percentage": 0.9395420582469695, "num_intersection": 4171687, "num_union": 4708569, "num_only_computed": 284761, "num_only_roped": 252121, "total_diff": 536882, "diff_percentage": 0.1140223282275358, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:02:15.991580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 3.7103891372680664e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.01941872427983539}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:02:48.836672", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8573250000789311, "overlap_percentage": 0.9231825340664636, "num_intersection": 4887759, "num_union": 5701174, "num_only_computed": 407345, "num_only_roped": 406070, "total_diff": 813415, "diff_percentage": 0.14267499992106888, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:02:50.918301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.8014183044433594e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.016715116279069766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:03:30.275027", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8275229346864404, "overlap_percentage": 0.9056224893050918, "num_intersection": 5554871, "num_union": 6712649, "num_only_computed": 578889, "num_only_roped": 578889, "total_diff": 1157778, "diff_percentage": 0.17247706531355952, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:03:32.156067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.7418136596679688e-06, "l2_diff": 0.15625, "l2_diff_relative": 0.018656716417910446}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:04:18.169067", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8058615254656738, "overlap_percentage": 0.8924953703278748, "num_intersection": 6222849, "num_union": 7721983, "num_only_computed": 749567, "num_only_roped": 749567, "total_diff": 1499134, "diff_percentage": 0.19413847453432623, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:04:19.711579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.3990869522094727e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.016530797101449276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:05:12.281295", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7901900962215442, "overlap_percentage": 0.8828002097535396, "num_intersection": 6895616, "num_union": 8726528, "num_only_computed": 915456, "num_only_roped": 915456, "total_diff": 1830912, "diff_percentage": 0.20980990377845576, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:05:14.051298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.1953781512605042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:06:14.237131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7769070434888437, "overlap_percentage": 0.8744487184466738, "num_intersection": 7564639, "num_union": 9736865, "num_only_computed": 1086113, "num_only_roped": 1086113, "total_diff": 2172226, "diff_percentage": 0.22309295651115632, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:06:17.337083", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1484375, "mean_diff": 5.745887756347656e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.42487046632124353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:07:25.159196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7663789281115244, "overlap_percentage": 0.8677401161379087, "num_intersection": 8234340, "num_union": 10744476, "num_only_computed": 1255068, "num_only_roped": 1255068, "total_diff": 2510136, "diff_percentage": 0.23362107188847553, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:07:27.493273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12109375, "mean_diff": 5.173683166503906e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.41148325358851673}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:08:43.607497", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7537061628177374, "overlap_percentage": 0.8595580933658041, "num_intersection": 8877571, "num_union": 11778557, "num_only_computed": 1450493, "num_only_roped": 1450493, "total_diff": 2900986, "diff_percentage": 0.24629383718226264, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:08:48.115730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 5.91278076171875e-05, "l2_diff": 3.171875, "l2_diff_relative": 0.5205128205128206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:10:13.177292", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7428493703063275, "overlap_percentage": 0.8524538987276479, "num_intersection": 9519114, "num_union": 12814326, "num_only_computed": 1647606, "num_only_roped": 1647606, "total_diff": 3295212, "diff_percentage": 0.25715062969367253, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:10:16.069866", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 5.125999450683594e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.4122340425531915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:11:45.442698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7192182019330549, "overlap_percentage": 0.8366805343549529, "num_intersection": 6373588, "num_union": 8861828, "num_only_computed": 1244120, "num_only_roped": 1244120, "total_diff": 2488240, "diff_percentage": 0.2807817980669451, "num_computed": 7617708, "num_roped": 7617708}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "mask_shape": [1, 32, 666, 13978], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:11:48.401610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.546875, "l2_diff_relative": 0.28285714285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 666, "seq_len_k": 13978, "queries_shape": [1, 32, 666, 128], "keys_shape": [1, 8, 13978, 128], "attention_shape": [1, 32, 666, 13978]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:13:16.457643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.690398916621561, "overlap_percentage": 0.8168473250105903, "num_intersection": 327809, "num_union": 474811, "num_only_computed": 73501, "num_only_roped": 73501, "total_diff": 147002, "diff_percentage": 0.309601083378439, "num_computed": 401310, "num_roped": 401310}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "mask_shape": [1, 32, 35, 14013], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:13:19.821846", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.1376953125, "l2_diff_relative": 0.1036764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 35, "seq_len_k": 14013, "queries_shape": [1, 32, 35, 128], "keys_shape": [1, 8, 14013, 128], "attention_shape": [1, 32, 35, 14013]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:14:42.927670", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6912979351032449, "overlap_percentage": 0.8174762361559257, "num_intersection": 9374, "num_union": 13560, "num_only_computed": 2093, "num_only_roped": 2093, "total_diff": 4186, "diff_percentage": 0.30870206489675517, "num_computed": 11467, "num_roped": 11467}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "mask_shape": [1, 32, 1, 14014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:14:45.885251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0264892578125, "mean_diff": 3.0517578125e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.21875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14014, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14014, 128], "attention_shape": [1, 32, 1, 14014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:16:04.665972", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6918197241277568, "overlap_percentage": 0.8178409487268922, "num_intersection": 9379, "num_union": 13557, "num_only_computed": 2089, "num_only_roped": 2089, "total_diff": 4178, "diff_percentage": 0.3081802758722431, "num_computed": 11468, "num_roped": 11468}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "mask_shape": [1, 32, 1, 14015], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:16:08.456063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.17567567567567569}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14015, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14015, 128], "attention_shape": [1, 32, 1, 14015]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:17:27.023142", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7011050953051992, "overlap_percentage": 0.8242936867806069, "num_intersection": 9453, "num_union": 13483, "num_only_computed": 2015, "num_only_roped": 2015, "total_diff": 4030, "diff_percentage": 0.29889490469480084, "num_computed": 11468, "num_roped": 11468}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14016, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14016, 128], "mask_shape": [1, 32, 1, 14016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:17:31.072809", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.024169921875, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.033935546875, "l2_diff_relative": 0.18098958333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14016, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14016, 128], "attention_shape": [1, 32, 1, 14016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:18:49.758124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6891016200294551, "overlap_percentage": 0.8159386171418607, "num_intersection": 9358, "num_union": 13580, "num_only_computed": 2111, "num_only_roped": 2111, "total_diff": 4222, "diff_percentage": 0.3108983799705449, "num_computed": 11469, "num_roped": 11469}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14017, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14017, 128], "mask_shape": [1, 32, 1, 14017], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:18:53.462390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.010498046875, "mean_diff": 2.6702880859375e-05, "l2_diff": 0.024169921875, "l2_diff_relative": 0.13904494382022473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14017, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14017, 128], "attention_shape": [1, 32, 1, 14017]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:20:11.927093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6947399527186762, "overlap_percentage": 0.8198779424585876, "num_intersection": 9404, "num_union": 13536, "num_only_computed": 2066, "num_only_roped": 2066, "total_diff": 4132, "diff_percentage": 0.3052600472813239, "num_computed": 11470, "num_roped": 11470}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14018, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14018, 128], "mask_shape": [1, 32, 1, 14018], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:20:16.165602", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0203857421875, "mean_diff": 2.8967857360839844e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.22109826589595374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14018, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14018, 128], "attention_shape": [1, 32, 1, 14018]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:21:34.647997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6927617501660149, "overlap_percentage": 0.8184988231191701, "num_intersection": 9389, "num_union": 13553, "num_only_computed": 2082, "num_only_roped": 2082, "total_diff": 4164, "diff_percentage": 0.3072382498339851, "num_computed": 11471, "num_roped": 11471}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14019, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14019, 128], "mask_shape": [1, 32, 1, 14019], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:21:38.947751", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.15248691099476439}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14019, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14019, 128], "attention_shape": [1, 32, 1, 14019]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:22:57.705877", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6947850494903235, "overlap_percentage": 0.8199093444909344, "num_intersection": 9406, "num_union": 13538, "num_only_computed": 2066, "num_only_roped": 2066, "total_diff": 4132, "diff_percentage": 0.30521495050967645, "num_computed": 11472, "num_roped": 11472}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14020, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14020, 128], "mask_shape": [1, 32, 1, 14020], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:01.763029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0103759765625, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.19117647058823528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14020, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14020, 128], "attention_shape": [1, 32, 1, 14020]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:46.764720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:46.777364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.248453140258789e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031005859375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:52.731802", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8916886649068074, "overlap_percentage": 0.9427435723951285, "num_intersection": 1738932, "num_union": 1950156, "num_only_computed": 200524, "num_only_roped": 10700, "total_diff": 211224, "diff_percentage": 0.10831133509319255, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:23:55.609825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.616115570068359e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.015097128378378379}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:24:10.416549", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.910870161625323, "overlap_percentage": 0.9533564131333412, "num_intersection": 2583062, "num_union": 2835818, "num_only_computed": 195050, "num_only_roped": 57706, "total_diff": 252756, "diff_percentage": 0.08912983837467708, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:24:10.965977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.066394805908203e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.016160102739726026}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:24:32.365117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9042635457580976, "overlap_percentage": 0.9497252077029132, "num_intersection": 3394637, "num_union": 3754035, "num_only_computed": 222131, "num_only_roped": 137267, "total_diff": 359398, "diff_percentage": 0.09573645424190239, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:24:33.122970", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.2197265625, "l2_diff_relative": 0.02529226618705036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:25:00.057231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8840038680369713, "overlap_percentage": 0.9384310542398777, "num_intersection": 4166754, "num_union": 4713502, "num_only_computed": 289694, "num_only_roped": 257054, "total_diff": 546748, "diff_percentage": 0.11599613196302876, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:25:00.979912", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.814697265625e-06, "l2_diff": 0.1689453125, "l2_diff_relative": 0.019446942446043166}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:25:36.274752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.856578288258703, "overlap_percentage": 0.922749440382709, "num_intersection": 4885466, "num_union": 5703467, "num_only_computed": 409638, "num_only_roped": 408363, "total_diff": 818001, "diff_percentage": 0.143421711741297, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:25:37.414875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.60770320892334e-06, "l2_diff": 0.1494140625, "l2_diff_relative": 0.0159375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:26:16.577581", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8264095638048273, "overlap_percentage": 0.9049553618009182, "num_intersection": 5550779, "num_union": 6716741, "num_only_computed": 582981, "num_only_roped": 582981, "total_diff": 1165962, "diff_percentage": 0.17359043619517264, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:26:17.913550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.5779008865356445e-06, "l2_diff": 0.16015625, "l2_diff_relative": 0.017795138888888888}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:27:04.575588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8051957382627529, "overlap_percentage": 0.8920869035926715, "num_intersection": 6220001, "num_union": 7724831, "num_only_computed": 752415, "num_only_roped": 752415, "total_diff": 1504830, "diff_percentage": 0.19480426173724708, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:27:06.107373", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.2798776626586914e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.01678240740740741}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:28:00.956381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7880609858006009, "overlap_percentage": 0.8814699185976009, "num_intersection": 6885225, "num_union": 8736919, "num_only_computed": 925847, "num_only_roped": 925847, "total_diff": 1851694, "diff_percentage": 0.21193901419939912, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:28:04.351251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 2.7060508728027344e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.14791666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:29:04.870920", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7722040942755204, "overlap_percentage": 0.8714618104876894, "num_intersection": 7538800, "num_union": 9762704, "num_only_computed": 1111952, "num_only_roped": 1111952, "total_diff": 2223904, "diff_percentage": 0.2277959057244796, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:29:06.969238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1435546875, "mean_diff": 5.054473876953125e-05, "l2_diff": 2.5, "l2_diff_relative": 0.36036036036036034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:30:15.996510", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.760414363205972, "overlap_percentage": 0.8639038388906873, "num_intersection": 8197936, "num_union": 10780880, "num_only_computed": 1291472, "num_only_roped": 1291472, "total_diff": 2582944, "diff_percentage": 0.23958563679402795, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:30:18.355075", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 4.601478576660156e-05, "l2_diff": 2.328125, "l2_diff_relative": 0.382051282051282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:31:36.318668", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7490268685136386, "overlap_percentage": 0.8565069891123835, "num_intersection": 8846059, "num_union": 11810069, "num_only_computed": 1482005, "num_only_roped": 1482005, "total_diff": 2964010, "diff_percentage": 0.25097313148636136, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:31:38.940439", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 5.2928924560546875e-05, "l2_diff": 2.421875, "l2_diff_relative": 0.46130952380952384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:33:08.318621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7420996095037372, "overlap_percentage": 0.8519600204894544, "num_intersection": 9513599, "num_union": 12819841, "num_only_computed": 1653121, "num_only_roped": 1653121, "total_diff": 3306242, "diff_percentage": 0.2579003904962628, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:33:11.231616", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1064453125, "mean_diff": 5.3882598876953125e-05, "l2_diff": 2.25, "l2_diff_relative": 0.4585987261146497}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:34:45.278015", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.735479815867094, "overlap_percentage": 0.8475809504008871, "num_intersection": 10175528, "num_union": 13835224, "num_only_computed": 1829848, "num_only_roped": 1829848, "total_diff": 3659696, "diff_percentage": 0.26452018413290596, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:34:48.608134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 5.14984130859375e-05, "l2_diff": 2.5625, "l2_diff_relative": 0.47126436781609193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:36:30.275453", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7272797808562833, "overlap_percentage": 0.8421099915796396, "num_intersection": 10816950, "num_union": 14873162, "num_only_computed": 2028106, "num_only_roped": 2028106, "total_diff": 4056212, "diff_percentage": 0.2727202191437167, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:36:35.013962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.468944099378882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:38:15.559932", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6850378987184165, "overlap_percentage": 0.8130830757449828, "num_intersection": 696539, "num_union": 1016789, "num_only_computed": 160125, "num_only_roped": 160125, "total_diff": 320250, "diff_percentage": 0.3149621012815835, "num_computed": 856664, "num_roped": 856664}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "mask_shape": [1, 32, 68, 15428], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:38:18.748534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.26953125, "l2_diff_relative": 0.13911290322580644}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 68, "seq_len_k": 15428, "queries_shape": [1, 32, 68, 128], "keys_shape": [1, 8, 15428, 128], "attention_shape": [1, 32, 68, 15428]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:39:54.994606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6825201938610662, "overlap_percentage": 0.8113069862119292, "num_intersection": 337984, "num_union": 495200, "num_only_computed": 78608, "num_only_roped": 78608, "total_diff": 157216, "diff_percentage": 0.3174798061389338, "num_computed": 416592, "num_roped": 416592}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "mask_shape": [1, 32, 33, 15461], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:39:58.155959", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.1259765625, "l2_diff_relative": 0.09953703703703703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 33, "seq_len_k": 15461, "queries_shape": [1, 32, 33, 128], "keys_shape": [1, 8, 15461, 128], "attention_shape": [1, 32, 33, 15461]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:41:33.616810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6840069361077764, "overlap_percentage": 0.8123564356435644, "num_intersection": 10256, "num_union": 14994, "num_only_computed": 2369, "num_only_roped": 2369, "total_diff": 4738, "diff_percentage": 0.31599306389222354, "num_computed": 12625, "num_roped": 12625}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "mask_shape": [1, 32, 1, 15462], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:41:37.418628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0074462890625, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.018798828125, "l2_diff_relative": 0.11526946107784432}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15462, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15462, 128], "attention_shape": [1, 32, 1, 15462]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:43:09.380625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.683130040658535, "overlap_percentage": 0.8117376841438302, "num_intersection": 10249, "num_union": 15003, "num_only_computed": 2377, "num_only_roped": 2377, "total_diff": 4754, "diff_percentage": 0.31686995934146506, "num_computed": 12626, "num_roped": 12626}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "mask_shape": [1, 32, 1, 15463], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:43:12.289484", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.026611328125, "l2_diff_relative": 0.14192708333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15463, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15463, 128], "attention_shape": [1, 32, 1, 15463]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:03.109851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:03.121407", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2782554626464844e-06, "l2_diff": 0.029296875, "l2_diff_relative": 0.0030048076923076925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:09.153271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8911960235078927, "overlap_percentage": 0.9424681655737136, "num_intersection": 1738424, "num_union": 1950664, "num_only_computed": 201032, "num_only_roped": 11208, "total_diff": 212240, "diff_percentage": 0.1088039764921073, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:11.548392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.765127182006836e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.016629464285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:26.356848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9115819952433396, "overlap_percentage": 0.9537461615684422, "num_intersection": 2584118, "num_union": 2834762, "num_only_computed": 193994, "num_only_roped": 56650, "total_diff": 250644, "diff_percentage": 0.08841800475666035, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:26.909152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.1201171875, "l2_diff_relative": 0.015436746987951807}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:47.964024", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9042914453460061, "overlap_percentage": 0.9497405951762788, "num_intersection": 3394692, "num_union": 3753980, "num_only_computed": 222076, "num_only_roped": 137212, "total_diff": 359288, "diff_percentage": 0.09570855465399389, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:44:48.704245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 5.27501106262207e-06, "l2_diff": 0.23046875, "l2_diff_relative": 0.025256849315068493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:45:15.329160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8848588222009592, "overlap_percentage": 0.9389125718898194, "num_intersection": 4168892, "num_union": 4711364, "num_only_computed": 287556, "num_only_roped": 254916, "total_diff": 542472, "diff_percentage": 0.11514117779904079, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:45:16.236410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.1689453125, "l2_diff_relative": 0.018141778523489933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:45:49.315589", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8586606780986109, "overlap_percentage": 0.9239563608533551, "num_intersection": 4891856, "num_union": 5697077, "num_only_computed": 403248, "num_only_roped": 401973, "total_diff": 805221, "diff_percentage": 0.1413393219013891, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:45:50.441959", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.592802047729492e-06, "l2_diff": 0.1220703125, "l2_diff_relative": 0.014796401515151516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:46:29.421349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8291551724934875, "overlap_percentage": 0.9065990518050918, "num_intersection": 5560861, "num_union": 6706659, "num_only_computed": 572899, "num_only_roped": 572899, "total_diff": 1145798, "diff_percentage": 0.17084482750651256, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:46:31.347029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.3096799850463867e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.01676324503311258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:17.234460", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8077591851671994, "overlap_percentage": 0.8936579515622706, "num_intersection": 6230955, "num_union": 7713877, "num_only_computed": 741461, "num_only_roped": 741461, "total_diff": 1482922, "diff_percentage": 0.19224081483280067, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:47:18.788172", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.2351741790771484e-06, "l2_diff": 0.1591796875, "l2_diff_relative": 0.017686631944444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:48:11.574202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7874181885000574, "overlap_percentage": 0.8810676690728239, "num_intersection": 6882083, "num_union": 8740061, "num_only_computed": 928989, "num_only_roped": 928989, "total_diff": 1857978, "diff_percentage": 0.21258181149994262, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:48:13.343618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1005859375, "mean_diff": 2.574920654296875e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.14558232931726908}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:49:13.246284", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7719545284301776, "overlap_percentage": 0.8713028647682883, "num_intersection": 7537425, "num_union": 9764079, "num_only_computed": 1113327, "num_only_roped": 1113327, "total_diff": 2226654, "diff_percentage": 0.2280454715698224, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:49:16.416917", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 5.14984130859375e-05, "l2_diff": 2.375, "l2_diff_relative": 0.39378238341968913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:50:22.771382", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7451519329975419, "overlap_percentage": 0.853967977123504, "num_intersection": 5993026, "num_union": 8042690, "num_only_computed": 1024832, "num_only_roped": 1024832, "total_diff": 2049664, "diff_percentage": 0.25484806700245816, "num_computed": 7017858, "num_roped": 7017858}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "mask_shape": [1, 32, 774, 11014], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:50:27.531784", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 5.817413330078125e-05, "l2_diff": 2.125, "l2_diff_relative": 0.4444444444444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 774, "seq_len_k": 11014, "queries_shape": [1, 32, 774, 128], "keys_shape": [1, 8, 11014, 128], "attention_shape": [1, 32, 774, 11014]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:51:33.532219", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7026165802326318, "overlap_percentage": 0.8253374111235684, "num_intersection": 232623, "num_union": 331081, "num_only_computed": 49229, "num_only_roped": 49229, "total_diff": 98458, "diff_percentage": 0.2973834197673681, "num_computed": 281852, "num_roped": 281852}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "mask_shape": [1, 32, 31, 11045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:51:36.961149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.1279296875, "l2_diff_relative": 0.11139455782312925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 11045, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 11045, 128], "attention_shape": [1, 32, 31, 11045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:52:38.229017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7107912315363628, "overlap_percentage": 0.8309502859656841, "num_intersection": 7555, "num_union": 10629, "num_only_computed": 1537, "num_only_roped": 1537, "total_diff": 3074, "diff_percentage": 0.28920876846363724, "num_computed": 9092, "num_roped": 9092}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "mask_shape": [1, 32, 1, 11046], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:52:40.120688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01190185546875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.023193359375, "l2_diff_relative": 0.15728476821192053}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11046, 128], "attention_shape": [1, 32, 1, 11046]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:53:39.601178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7093711815020208, "overlap_percentage": 0.8299791048058947, "num_intersection": 7547, "num_union": 10639, "num_only_computed": 1546, "num_only_roped": 1546, "total_diff": 3092, "diff_percentage": 0.2906288184979791, "num_computed": 9093, "num_roped": 9093}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "mask_shape": [1, 32, 1, 11047], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:53:41.527760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.008056640625, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.01806640625, "l2_diff_relative": 0.08222222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11047, 128], "attention_shape": [1, 32, 1, 11047]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:54:40.557389", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6950605778191985, "overlap_percentage": 0.8201011656036947, "num_intersection": 7458, "num_union": 10730, "num_only_computed": 1636, "num_only_roped": 1636, "total_diff": 3272, "diff_percentage": 0.3049394221808015, "num_computed": 9094, "num_roped": 9094}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "mask_shape": [1, 32, 1, 11048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:54:42.484187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0067138671875, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.0155029296875, "l2_diff_relative": 0.07183257918552036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11048, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11048, 128], "attention_shape": [1, 32, 1, 11048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:55:19.812060", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:55:19.825703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.030029296875, "l2_diff_relative": 0.0030218160377358493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:55:25.824280", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8915198966328776, "overlap_percentage": 0.9426492401373998, "num_intersection": 1738758, "num_union": 1950330, "num_only_computed": 200698, "num_only_roped": 10874, "total_diff": 211572, "diff_percentage": 0.1084801033671225, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:55:26.215688", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.496906280517578e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.014928343949044586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:55:41.302701", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9108593803445477, "overlap_percentage": 0.9533505078540215, "num_intersection": 2583046, "num_union": 2835834, "num_only_computed": 195066, "num_only_roped": 57722, "total_diff": 252788, "diff_percentage": 0.08914061965545234, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:55:43.720265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.015299479166666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:56:04.367071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9016299597205175, "overlap_percentage": 0.9482706718114917, "num_intersection": 3389438, "num_union": 3759234, "num_only_computed": 227330, "num_only_roped": 142466, "total_diff": 369796, "diff_percentage": 0.09837004027948247, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:56:05.108427", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.692243576049805e-06, "l2_diff": 0.2373046875, "l2_diff_relative": 0.024655032467532468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:56:31.800666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8848804260386177, "overlap_percentage": 0.9389247337013708, "num_intersection": 4168946, "num_union": 4711310, "num_only_computed": 287502, "num_only_roped": 254862, "total_diff": 542364, "diff_percentage": 0.1151195739613823, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:56:32.732049", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.3974647521972656e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.016607704402515723}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:57:05.625037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.858709616605584, "overlap_percentage": 0.9239846923198022, "num_intersection": 4892006, "num_union": 5696927, "num_only_computed": 403098, "num_only_roped": 401823, "total_diff": 804921, "diff_percentage": 0.14129038339441596, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:57:06.905520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.682209014892578e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.013724662162162162}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:57:46.234489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8279343980111867, "overlap_percentage": 0.9058688308639399, "num_intersection": 5556382, "num_union": 6711138, "num_only_computed": 577378, "num_only_roped": 577378, "total_diff": 1154756, "diff_percentage": 0.1720656019888132, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:57:49.048147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.473592758178711e-06, "l2_diff": 0.169921875, "l2_diff_relative": 0.018004966887417217}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:58:35.183117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8082519264371691, "overlap_percentage": 0.893959425255177, "num_intersection": 6233057, "num_union": 7711775, "num_only_computed": 739359, "num_only_roped": 739359, "total_diff": 1478718, "diff_percentage": 0.19174807356283086, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:58:36.711934", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.3096799850463867e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.01680222602739726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:59:29.417268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7922965231007018, "overlap_percentage": 0.8841132177503933, "num_intersection": 6905872, "num_union": 8716272, "num_only_computed": 905200, "num_only_roped": 905200, "total_diff": 1810400, "diff_percentage": 0.20770347689929824, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T10:59:31.190845", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.828125, "l2_diff_relative": 0.23975409836065573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:00:31.308160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7797361631627256, "overlap_percentage": 0.8762379270611387, "num_intersection": 7580117, "num_union": 9721387, "num_only_computed": 1070635, "num_only_roped": 1070635, "total_diff": 2141270, "diff_percentage": 0.22026383683727435, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:00:35.699762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 6.341934204101562e-05, "l2_diff": 3.03125, "l2_diff_relative": 0.47783251231527096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:01:43.715504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7640668944667119, "overlap_percentage": 0.8662561457996115, "num_intersection": 8220258, "num_union": 10758558, "num_only_computed": 1269150, "num_only_roped": 1269150, "total_diff": 2538300, "diff_percentage": 0.235933105533288, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:01:46.058665", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1513671875, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.875, "l2_diff_relative": 0.48936170212765956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:03:02.609250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7505768833754872, "overlap_percentage": 0.8575194731558596, "num_intersection": 8856516, "num_union": 11799612, "num_only_computed": 1471548, "num_only_roped": 1471548, "total_diff": 2943096, "diff_percentage": 0.24942311662451275, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:03:05.719271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 6.29425048828125e-05, "l2_diff": 3.921875, "l2_diff_relative": 0.6182266009852216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:04:29.741321", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7419631857338577, "overlap_percentage": 0.8518701104711142, "num_intersection": 9512595, "num_union": 12820845, "num_only_computed": 1654125, "num_only_roped": 1654125, "total_diff": 3308250, "diff_percentage": 0.2580368142661424, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:04:32.618849", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.173828125, "mean_diff": 5.793571472167969e-05, "l2_diff": 3.453125, "l2_diff_relative": 0.5695876288659794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:06:04.837837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7380893574352425, "overlap_percentage": 0.8493111752601501, "num_intersection": 10196300, "num_union": 13814452, "num_only_computed": 1809076, "num_only_roped": 1809076, "total_diff": 3618152, "diff_percentage": 0.26191064256475755, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:06:08.189080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 5.650520324707031e-05, "l2_diff": 3.3125, "l2_diff_relative": 0.5988700564971752}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:07:46.659628", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7256883311125355, "overlap_percentage": 0.8410421720180385, "num_intersection": 8013470, "num_union": 11042578, "num_only_computed": 1514554, "num_only_roped": 1514554, "total_diff": 3029108, "diff_percentage": 0.2743116688874645, "num_computed": 9528024, "num_roped": 9528024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "mask_shape": [1, 32, 772, 15108], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:07:49.875336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.57763671875e-05, "l2_diff": 2.21875, "l2_diff_relative": 0.4057142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 772, "seq_len_k": 15108, "queries_shape": [1, 32, 772, 128], "keys_shape": [1, 8, 15108, 128], "attention_shape": [1, 32, 772, 15108]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:09:26.569645", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7033431680228516, "overlap_percentage": 0.825838481906443, "num_intersection": 224562, "num_union": 319278, "num_only_computed": 47358, "num_only_roped": 47358, "total_diff": 94716, "diff_percentage": 0.2966568319771484, "num_computed": 271920, "num_roped": 271920}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "mask_shape": [1, 32, 22, 15130], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:09:29.615834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.1083984375, "l2_diff_relative": 0.0912828947368421}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 15130, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 15130, 128], "attention_shape": [1, 32, 22, 15130]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:00.364255", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6974524479846186, "overlap_percentage": 0.8217637540453074, "num_intersection": 10157, "num_union": 14563, "num_only_computed": 2203, "num_only_roped": 2203, "total_diff": 4406, "diff_percentage": 0.30254755201538147, "num_computed": 12360, "num_roped": 12360}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "mask_shape": [1, 32, 1, 15131], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:03.167800", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.0196533203125, "l2_diff_relative": 0.0931712962962963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15131, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15131, 128], "attention_shape": [1, 32, 1, 15131]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:49.114872", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:49.135160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0031948468543046356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:57.489501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8916498649366525, "overlap_percentage": 0.9427218868186392, "num_intersection": 1738892, "num_union": 1950196, "num_only_computed": 200564, "num_only_roped": 10740, "total_diff": 211304, "diff_percentage": 0.10835013506334748, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:11:57.878692", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.735324859619141e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.01605603448275862}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:13.898169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9113406134484607, "overlap_percentage": 0.9536140309436636, "num_intersection": 2583760, "num_union": 2835120, "num_only_computed": 194352, "num_only_roped": 57008, "total_diff": 251360, "diff_percentage": 0.08865938655153927, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:14.460662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.015736607142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:35.130330", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9043350717947817, "overlap_percentage": 0.949764655589178, "num_intersection": 3394778, "num_union": 3753894, "num_only_computed": 221990, "num_only_roped": 137126, "total_diff": 359116, "diff_percentage": 0.09566492820521837, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:12:35.872712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.197265625, "l2_diff_relative": 0.02446705426356589}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:02.596221", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8847456101868413, "overlap_percentage": 0.9388488349885409, "num_intersection": 4168609, "num_union": 4711647, "num_only_computed": 287839, "num_only_roped": 255199, "total_diff": 543038, "diff_percentage": 0.11525438981315875, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:03.523028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:31.864549", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7561334751277266, "overlap_percentage": 0.8611344021817381, "num_intersection": 101675, "num_union": 134467, "num_only_computed": 16396, "num_only_roped": 16396, "total_diff": 32792, "diff_percentage": 0.2438665248722735, "num_computed": 118071, "num_roped": 118071}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "mask_shape": [1, 32, 27, 5147], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:32.721261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 2.9653310775756836e-06, "l2_diff": 0.016845703125, "l2_diff_relative": 0.012834821428571428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 5147, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 5147, 128], "attention_shape": [1, 32, 27, 5147]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:58.938049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7482014388489209, "overlap_percentage": 0.8559670781893004, "num_intersection": 3744, "num_union": 5004, "num_only_computed": 630, "num_only_roped": 630, "total_diff": 1260, "diff_percentage": 0.2517985611510791, "num_computed": 4374, "num_roped": 4374}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "mask_shape": [1, 32, 1, 5148], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:13:59.765796", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0029296875, "mean_diff": 4.351139068603516e-06, "l2_diff": 0.004547119140625, "l2_diff_relative": 0.017908653846153845}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5148, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5148, 128], "attention_shape": [1, 32, 1, 5148]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:14:25.212204", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7559702990166566, "overlap_percentage": 0.8610285714285715, "num_intersection": 3767, "num_union": 4983, "num_only_computed": 608, "num_only_roped": 608, "total_diff": 1216, "diff_percentage": 0.24402970098334337, "num_computed": 4375, "num_roped": 4375}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "mask_shape": [1, 32, 1, 5149], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:14:26.037161", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00244140625, "mean_diff": 3.6656856536865234e-06, "l2_diff": 0.00384521484375, "l2_diff_relative": 0.01607142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5149, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5149, 128], "attention_shape": [1, 32, 1, 5149]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:14:51.530901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7521521521521521, "overlap_percentage": 0.8585466179159049, "num_intersection": 3757, "num_union": 4995, "num_only_computed": 619, "num_only_roped": 619, "total_diff": 1238, "diff_percentage": 0.24784784784784786, "num_computed": 4376, "num_roped": 4376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "mask_shape": [1, 32, 1, 5150], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:14:53.563158", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 2.1457672119140625e-06, "l2_diff": 0.0025482177734375, "l2_diff_relative": 0.00980968045112782}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5150, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5150, 128], "attention_shape": [1, 32, 1, 5150]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:19.298845", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7458607620187513, "overlap_percentage": 0.8544332723948812, "num_intersection": 3739, "num_union": 5013, "num_only_computed": 637, "num_only_roped": 637, "total_diff": 1274, "diff_percentage": 0.25413923798124877, "num_computed": 4376, "num_roped": 4376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5151, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5151, 128], "mask_shape": [1, 32, 1, 5151], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:20.872383", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0009765625, "mean_diff": 2.250075340270996e-06, "l2_diff": 0.00201416015625, "l2_diff_relative": 0.008851931330472103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 5151, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 5151, 128], "attention_shape": [1, 32, 1, 5151]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:37.333223", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:37.344743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003076171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:43.352635", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8918264176564886, "overlap_percentage": 0.9428205561916658, "num_intersection": 1739074, "num_union": 1950014, "num_only_computed": 200382, "num_only_roped": 10558, "total_diff": 210940, "diff_percentage": 0.10817358234351138, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:43.744173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 6.5267086029052734e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.015743371212121212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:58.981378", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9125197820829739, "overlap_percentage": 0.9542591827093422, "num_intersection": 2585508, "num_union": 2833372, "num_only_computed": 192604, "num_only_roped": 55260, "total_diff": 247864, "diff_percentage": 0.08748021791702608, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:15:59.548716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.016718106995884774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:16:22.543642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9045111197488669, "overlap_percentage": 0.9498617365575033, "num_intersection": 3395125, "num_union": 3753547, "num_only_computed": 221643, "num_only_roped": 136779, "total_diff": 358422, "diff_percentage": 0.09548888025113313, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:16:23.273090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.543231964111328e-06, "l2_diff": 0.2138671875, "l2_diff_relative": 0.02770748987854251}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:16:49.813658", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.885723362164816, "overlap_percentage": 0.9393990443518745, "num_intersection": 4171052, "num_union": 4709204, "num_only_computed": 285396, "num_only_roped": 252756, "total_diff": 538152, "diff_percentage": 0.11427663783518403, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:16:50.739258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.016183035714285716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:17:23.427160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8623382315360633, "overlap_percentage": 0.9260812208368869, "num_intersection": 4903106, "num_union": 5685827, "num_only_computed": 391998, "num_only_roped": 390723, "total_diff": 782721, "diff_percentage": 0.13766176846393674, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:17:27.113374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.428889274597168e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.015301724137931034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:18:06.386807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8318712980916763, "overlap_percentage": 0.9082202433743739, "num_intersection": 5570805, "num_union": 6696715, "num_only_computed": 562955, "num_only_roped": 562955, "total_diff": 1125910, "diff_percentage": 0.1681287019083237, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:18:08.667545", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.016680743243243243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:18:54.237490", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8042568035015812, "overlap_percentage": 0.891510345911661, "num_intersection": 6215981, "num_union": 7728851, "num_only_computed": 756435, "num_only_roped": 756435, "total_diff": 1512870, "diff_percentage": 0.1957431964984187, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:18:55.788865", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.3245811462402344e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.018845419847328244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:19:48.342411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7829600036065175, "overlap_percentage": 0.878269845675472, "num_intersection": 6860229, "num_union": 8761915, "num_only_computed": 950843, "num_only_roped": 950843, "total_diff": 1901686, "diff_percentage": 0.21703999639348248, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:19:50.110321", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.84375, "l2_diff_relative": 0.1210762331838565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:20:50.352646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7718761338893468, "overlap_percentage": 0.8712529269131747, "num_intersection": 7536993, "num_union": 9764511, "num_only_computed": 1113759, "num_only_roped": 1113759, "total_diff": 2227518, "diff_percentage": 0.22812386611065316, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:20:53.960092", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.8203125, "l2_diff_relative": 0.2956852791878173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:22:02.159255", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7579817629044189, "overlap_percentage": 0.8623317703275062, "num_intersection": 8183018, "num_union": 10795798, "num_only_computed": 1306390, "num_only_roped": 1306390, "total_diff": 2612780, "diff_percentage": 0.24201823709558107, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:22:04.512151", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10400390625, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.609375, "l2_diff_relative": 0.22103004291845493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:23:13.686704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6986276459391049, "overlap_percentage": 0.8225789184690456, "num_intersection": 714585, "num_union": 1022841, "num_only_computed": 154128, "num_only_roped": 154128, "total_diff": 308256, "diff_percentage": 0.3013723540608951, "num_computed": 868713, "num_roped": 868713}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "mask_shape": [1, 32, 93, 11357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:23:15.933351", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.10778443113772455}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 93, "seq_len_k": 11357, "queries_shape": [1, 32, 93, 128], "keys_shape": [1, 8, 11357, 128], "attention_shape": [1, 32, 93, 11357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:24:22.260604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6950578338590957, "overlap_percentage": 0.8200992555831266, "num_intersection": 199622, "num_union": 287202, "num_only_computed": 43790, "num_only_roped": 43790, "total_diff": 87580, "diff_percentage": 0.3049421661409043, "num_computed": 243412, "num_roped": 243412}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "mask_shape": [1, 32, 26, 11383], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:24:24.407715", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.9921531677246094e-05, "l2_diff": 0.1005859375, "l2_diff_relative": 0.09466911764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 11383, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 11383, 128], "attention_shape": [1, 32, 26, 11383]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:25:28.522173", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7012810029980922, "overlap_percentage": 0.8244152515219481, "num_intersection": 7719, "num_union": 11007, "num_only_computed": 1644, "num_only_roped": 1644, "total_diff": 3288, "diff_percentage": 0.2987189970019079, "num_computed": 9363, "num_roped": 9363}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "mask_shape": [1, 32, 1, 11384], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:25:30.783571", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.028564453125, "l2_diff_relative": 0.14772727272727273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11384, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11384, 128], "attention_shape": [1, 32, 1, 11384]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:26:32.653008", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7056466302367942, "overlap_percentage": 0.8274241777018368, "num_intersection": 7748, "num_union": 10980, "num_only_computed": 1616, "num_only_roped": 1616, "total_diff": 3232, "diff_percentage": 0.2943533697632058, "num_computed": 9364, "num_roped": 9364}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "mask_shape": [1, 32, 1, 11385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:26:34.631223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.010986328125, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.0283203125, "l2_diff_relative": 0.10984848484848485}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11385, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11385, 128], "attention_shape": [1, 32, 1, 11385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:27:36.891138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6957624049257516, "overlap_percentage": 0.8205894916702264, "num_intersection": 7684, "num_union": 11044, "num_only_computed": 1680, "num_only_roped": 1680, "total_diff": 3360, "diff_percentage": 0.30423759507424847, "num_computed": 9364, "num_roped": 9364}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "mask_shape": [1, 32, 1, 11386], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:27:38.905365", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.021484375, "l2_diff_relative": 0.05789473684210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 11386, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 11386, 128], "attention_shape": [1, 32, 1, 11386]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:15.525752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:15.538335", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.003117487980769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:21.515624", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8915965175764555, "overlap_percentage": 0.9426920691509663, "num_intersection": 1738837, "num_union": 1950251, "num_only_computed": 200619, "num_only_roped": 10795, "total_diff": 211414, "diff_percentage": 0.10840348242354446, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:21.904379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 7.033348083496094e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.01670258620689655}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:37.560065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9104450670539114, "overlap_percentage": 0.9531235236801701, "num_intersection": 2582431, "num_union": 2836449, "num_only_computed": 195681, "num_only_roped": 58337, "total_diff": 254018, "diff_percentage": 0.08955493294608857, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:38.111387", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.1416015625, "l2_diff_relative": 0.016907649253731342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:58.655994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9050328592606727, "overlap_percentage": 0.95014934242332, "num_intersection": 3396153, "num_union": 3752519, "num_only_computed": 220615, "num_only_roped": 135751, "total_diff": 356366, "diff_percentage": 0.09496714073932737, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:28:59.382117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 5.3942203521728516e-06, "l2_diff": 0.2109375, "l2_diff_relative": 0.02537593984962406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:29:25.881656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8849004300335791, "overlap_percentage": 0.9389359946379924, "num_intersection": 4168996, "num_union": 4711260, "num_only_computed": 287452, "num_only_roped": 254812, "total_diff": 542264, "diff_percentage": 0.11509956996642087, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:29:26.816295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.166015625, "l2_diff_relative": 0.017708333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:29:59.684416", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8564344206753649, "overlap_percentage": 0.9226659569949116, "num_intersection": 4885024, "num_union": 5703909, "num_only_computed": 410080, "num_only_roped": 408805, "total_diff": 818885, "diff_percentage": 0.1435655793246351, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:00.792033", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.7567148208618164e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.016319444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:40.686338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8281847432997343, "overlap_percentage": 0.9060186573977462, "num_intersection": 5557301, "num_union": 6710219, "num_only_computed": 576459, "num_only_roped": 576459, "total_diff": 1152918, "diff_percentage": 0.17181525670026568, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:30:42.020906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.86102294921875e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.02071078431372549}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:31:27.824123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8112246104034254, "overlap_percentage": 0.8957747214165076, "num_intersection": 6245714, "num_union": 7699118, "num_only_computed": 726702, "num_only_roped": 726702, "total_diff": 1453404, "diff_percentage": 0.18877538959657456, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:31:30.996122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.1010637283325195e-06, "l2_diff": 0.1513671875, "l2_diff_relative": 0.016145833333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:32:24.344344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7880704000161156, "overlap_percentage": 0.8814758076740299, "num_intersection": 6885271, "num_union": 8736873, "num_only_computed": 925801, "num_only_roped": 925801, "total_diff": 1851602, "diff_percentage": 0.2119295999838844, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:32:27.140138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10009765625, "mean_diff": 2.777576446533203e-05, "l2_diff": 1.4296875, "l2_diff_relative": 0.17596153846153847}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:33:27.481349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7714701176409878, "overlap_percentage": 0.8709942210804332, "num_intersection": 7534755, "num_union": 9766749, "num_only_computed": 1115997, "num_only_roped": 1115997, "total_diff": 2231994, "diff_percentage": 0.2285298823590122, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:33:29.569277", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 6.437301635742188e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:34:37.178590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.760403422816196, "overlap_percentage": 0.8638967783870185, "num_intersection": 8197869, "num_union": 10780947, "num_only_computed": 1291539, "num_only_roped": 1291539, "total_diff": 2583078, "diff_percentage": 0.23959657718380398, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:34:39.507110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.34536082474226804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:35:56.978122", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7532024646872701, "overlap_percentage": 0.8592304424139897, "num_intersection": 8874187, "num_union": 11781941, "num_only_computed": 1453877, "num_only_roped": 1453877, "total_diff": 2907754, "diff_percentage": 0.24679753531272988, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:35:59.568815", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.8984375, "l2_diff_relative": 0.31153846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:37:23.784621", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.74367151758971, "overlap_percentage": 0.8529949707702889, "num_intersection": 9525156, "num_union": 12808284, "num_only_computed": 1641564, "num_only_roped": 1641564, "total_diff": 3283128, "diff_percentage": 0.2563284824102901, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:37:26.639875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 3.647804260253906e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.28602620087336245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:38:59.876527", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7335949747779069, "overlap_percentage": 0.8463279894681152, "num_intersection": 8667162, "num_union": 11814642, "num_only_computed": 1573740, "num_only_roped": 1573740, "total_diff": 3147480, "diff_percentage": 0.2664050252220931, "num_computed": 10240902, "num_roped": 10240902}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:39:02.898100", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12158203125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 1.9921875, "l2_diff_relative": 0.3236040609137056}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:40:33.528196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6971421128044809, "overlap_percentage": 0.8215483046996844, "num_intersection": 267598, "num_union": 383850, "num_only_computed": 58126, "num_only_roped": 58126, "total_diff": 116252, "diff_percentage": 0.3028578871955191, "num_computed": 325724, "num_roped": 325724}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "mask_shape": [1, 32, 28, 14222], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:40:36.384286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.11083984375, "l2_diff_relative": 0.0870398773006135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 28, "seq_len_k": 14222, "queries_shape": [1, 32, 28, 128], "keys_shape": [1, 8, 14222, 128], "attention_shape": [1, 32, 28, 14222]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:42:00.003270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6965366387167335, "overlap_percentage": 0.8211277290699673, "num_intersection": 9553, "num_union": 13715, "num_only_computed": 2081, "num_only_roped": 2081, "total_diff": 4162, "diff_percentage": 0.3034633612832665, "num_computed": 11634, "num_roped": 11634}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "mask_shape": [1, 32, 1, 14223], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:42:02.592461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.049072265625, "mean_diff": 3.1948089599609375e-05, "l2_diff": 0.05908203125, "l2_diff_relative": 0.3644578313253012}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14223, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14223, 128], "attention_shape": [1, 32, 1, 14223]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:43:23.627656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6981682843173028, "overlap_percentage": 0.8222604211431027, "num_intersection": 9567, "num_union": 13703, "num_only_computed": 2068, "num_only_roped": 2068, "total_diff": 4136, "diff_percentage": 0.30183171568269723, "num_computed": 11635, "num_roped": 11635}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "mask_shape": [1, 32, 1, 14224], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:43:26.236630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.13251072961373392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14224, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14224, 128], "attention_shape": [1, 32, 1, 14224]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:44:48.270959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6920168678202705, "overlap_percentage": 0.8179786868339636, "num_intersection": 9518, "num_union": 13754, "num_only_computed": 2118, "num_only_roped": 2118, "total_diff": 4236, "diff_percentage": 0.30798313217972956, "num_computed": 11636, "num_roped": 11636}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 1, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:44:52.727127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 4.3392181396484375e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.2356687898089172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14225, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 1, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:46:13.057903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6968282901932191, "overlap_percentage": 0.8213303540735648, "num_intersection": 9557, "num_union": 13715, "num_only_computed": 2079, "num_only_roped": 2079, "total_diff": 4158, "diff_percentage": 0.3031717098067809, "num_computed": 11636, "num_roped": 11636}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:46:18.268718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.0264892578125, "l2_diff_relative": 0.14127604166666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:47:38.251183", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.695243644839391, "overlap_percentage": 0.820228581249463, "num_intersection": 9545, "num_union": 13729, "num_only_computed": 2092, "num_only_roped": 2092, "total_diff": 4184, "diff_percentage": 0.30475635516060895, "num_computed": 11637, "num_roped": 11637}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:47:41.692169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00994873046875, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.019775390625, "l2_diff_relative": 0.10227272727272728}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:02.014652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7020840950639854, "overlap_percentage": 0.8249699261041417, "num_intersection": 9601, "num_union": 13675, "num_only_computed": 2037, "num_only_roped": 2037, "total_diff": 4074, "diff_percentage": 0.2979159049360146, "num_computed": 11638, "num_roped": 11638}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:05.369651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.027099609375, "l2_diff_relative": 0.10127737226277372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:49.185871", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:49.196426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1888484954833984e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.003115110759493671}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:55.156073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8918739567120435, "overlap_percentage": 0.9428471210228653, "num_intersection": 1739123, "num_union": 1949965, "num_only_computed": 200333, "num_only_roped": 10509, "total_diff": 210842, "diff_percentage": 0.10812604328795646, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:49:55.558859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.318092346191406e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.014169254658385094}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:50:12.922623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9117418262319084, "overlap_percentage": 0.9538336335183654, "num_intersection": 2584355, "num_union": 2834525, "num_only_computed": 193757, "num_only_roped": 56413, "total_diff": 250170, "diff_percentage": 0.08825817376809166, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:50:13.483810", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 4.798173904418945e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.015517241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:50:34.014679", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9050958121413124, "overlap_percentage": 0.9501840341814536, "num_intersection": 3396277, "num_union": 3752395, "num_only_computed": 220491, "num_only_roped": 135627, "total_diff": 356118, "diff_percentage": 0.09490418785868758, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:50:34.752742", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.513429641723633e-06, "l2_diff": 0.240234375, "l2_diff_relative": 0.02528782894736842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:51:01.205456", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8857553973945048, "overlap_percentage": 0.9394170618504691, "num_intersection": 4171132, "num_union": 4709124, "num_only_computed": 285316, "num_only_roped": 252676, "total_diff": 537992, "diff_percentage": 0.11424460260549521, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:51:02.139185", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.7401914596557617e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.018265845070422535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:51:34.903549", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8580279721923973, "overlap_percentage": 0.9235899405539727, "num_intersection": 4889916, "num_union": 5699017, "num_only_computed": 405188, "num_only_roped": 403913, "total_diff": 809101, "diff_percentage": 0.1419720278076026, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:51:36.045409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.905726432800293e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.014987244897959183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:52:15.232937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8300701176404598, "overlap_percentage": 0.9071456985601002, "num_intersection": 5564214, "num_union": 6703306, "num_only_computed": 569546, "num_only_roped": 569546, "total_diff": 1139092, "diff_percentage": 0.1699298823595402, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:52:17.625785", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.428889274597168e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.01650943396226415}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:53:03.144758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8091086507052365, "overlap_percentage": 0.8944832035265825, "num_intersection": 6236709, "num_union": 7708123, "num_only_computed": 735707, "num_only_roped": 735707, "total_diff": 1471414, "diff_percentage": 0.19089134929476345, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:53:04.700109", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.3245811462402344e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.01680222602739726}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:53:57.547465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7911574597718479, "overlap_percentage": 0.8834035840407053, "num_intersection": 6900329, "num_union": 8721815, "num_only_computed": 910743, "num_only_roped": 910743, "total_diff": 1821486, "diff_percentage": 0.20884254022815205, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:53:59.337771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.4609375, "l2_diff_relative": 0.20964125560538116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:54:52.904468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.731547009382833, "overlap_percentage": 0.8449634984424417, "num_intersection": 142133, "num_union": 194291, "num_only_computed": 26079, "num_only_roped": 26079, "total_diff": 52158, "diff_percentage": 0.26845299061716704, "num_computed": 168212, "num_roped": 168212}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "mask_shape": [1, 32, 22, 9238], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:54:54.593315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.146484375, "l2_diff_relative": 0.10901162790697674}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 22, "seq_len_k": 9238, "queries_shape": [1, 32, 22, 128], "keys_shape": [1, 8, 9238, 128], "attention_shape": [1, 32, 22, 9238]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:55:45.821754", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7253239797200877, "overlap_percentage": 0.8407974250004483, "num_intersection": 375110, "num_union": 517162, "num_only_computed": 71026, "num_only_roped": 71026, "total_diff": 142052, "diff_percentage": 0.2746760202799123, "num_computed": 446136, "num_roped": 446136}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "mask_shape": [1, 32, 58, 9296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:55:47.482354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.353515625, "l2_diff_relative": 0.20291479820627803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 9296, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 9296, 128], "attention_shape": [1, 32, 58, 9296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:56:37.440133", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7070897592366582, "overlap_percentage": 0.8284154426101651, "num_intersection": 6373, "num_union": 9013, "num_only_computed": 1320, "num_only_roped": 1320, "total_diff": 2640, "diff_percentage": 0.2929102407633418, "num_computed": 7693, "num_roped": 7693}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "mask_shape": [1, 32, 1, 9297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:56:40.332694", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 8.58306884765625e-05, "l2_diff": 0.062255859375, "l2_diff_relative": 0.6967213114754098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9297, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9297, 128], "attention_shape": [1, 32, 1, 9297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:57:28.636134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7133949448836433, "overlap_percentage": 0.8327268001039771, "num_intersection": 6407, "num_union": 8981, "num_only_computed": 1287, "num_only_roped": 1287, "total_diff": 2574, "diff_percentage": 0.28660505511635676, "num_computed": 7694, "num_roped": 7694}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "mask_shape": [1, 32, 1, 9298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:57:30.202227", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015869140625, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.04052734375, "l2_diff_relative": 0.3143939393939394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9298, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9298, 128], "attention_shape": [1, 32, 1, 9298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:58:18.194728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7138084632516704, "overlap_percentage": 0.8330084470435347, "num_intersection": 6410, "num_union": 8980, "num_only_computed": 1285, "num_only_roped": 1285, "total_diff": 2570, "diff_percentage": 0.28619153674832964, "num_computed": 7695, "num_roped": 7695}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9299, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9299, 128], "mask_shape": [1, 32, 1, 9299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:58:19.740665", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.058837890625, "l2_diff_relative": 0.32219251336898397}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9299, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9299, 128], "attention_shape": [1, 32, 1, 9299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:58:49.110459", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:58:49.124087", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0031115301724137933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:58:55.137289", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8912367439719228, "overlap_percentage": 0.9424909354290274, "num_intersection": 1738466, "num_union": 1950622, "num_only_computed": 200990, "num_only_roped": 11166, "total_diff": 212156, "diff_percentage": 0.1087632560280772, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:58:55.531232", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.586313247680664e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.015997023809523808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:59:12.948371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9106889175120509, "overlap_percentage": 0.9532571306247786, "num_intersection": 2582793, "num_union": 2836087, "num_only_computed": 195319, "num_only_roped": 57975, "total_diff": 253294, "diff_percentage": 0.08931108248794907, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:59:13.498610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.857778549194336e-06, "l2_diff": 0.11669921875, "l2_diff_relative": 0.015367798353909464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:59:34.379662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9039977797658793, "overlap_percentage": 0.9495786070475747, "num_intersection": 3394113, "num_union": 3754559, "num_only_computed": 222655, "num_only_roped": 137791, "total_diff": 360446, "diff_percentage": 0.09600222023412071, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T11:59:35.116989", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.424022674560547e-06, "l2_diff": 0.1982421875, "l2_diff_relative": 0.02547690763052209}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:00:01.585362", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8848584221345619, "overlap_percentage": 0.9389123466710869, "num_intersection": 4168891, "num_union": 4711365, "num_only_computed": 287557, "num_only_roped": 254917, "total_diff": 542474, "diff_percentage": 0.11514157786543815, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:00:02.489531", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.0200098814229249}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:00:35.176590", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8562840670776848, "overlap_percentage": 0.9225786960782545, "num_intersection": 4884562, "num_union": 5704371, "num_only_computed": 410542, "num_only_roped": 409267, "total_diff": 819809, "diff_percentage": 0.1437159329223152, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:00:36.321821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.8014183044433594e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.017908653846153845}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:01:15.658959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8272343945798067, "overlap_percentage": 0.9054496752399833, "num_intersection": 5553811, "num_union": 6713709, "num_only_computed": 579949, "num_only_roped": 579949, "total_diff": 1159898, "diff_percentage": 0.17276560542019323, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:01:18.051550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.1591796875, "l2_diff_relative": 0.019591346153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:02:03.692651", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8103574203997868, "overlap_percentage": 0.8952457799419885, "num_intersection": 6242026, "num_union": 7702806, "num_only_computed": 730390, "num_only_roped": 730390, "total_diff": 1460780, "diff_percentage": 0.18964257960021322, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:02:05.240030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.2202730178833008e-06, "l2_diff": 0.150390625, "l2_diff_relative": 0.017563868613138685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:02:57.714071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7927617709871804, "overlap_percentage": 0.8844028066826167, "num_intersection": 6908134, "num_union": 8714010, "num_only_computed": 902938, "num_only_roped": 902938, "total_diff": 1805876, "diff_percentage": 0.20723822901281957, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:02:59.513380", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11474609375, "mean_diff": 3.0040740966796875e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.1728110599078341}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:03:59.474135", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7779491402770359, "overlap_percentage": 0.8751084298798533, "num_intersection": 7570346, "num_union": 9731158, "num_only_computed": 1080406, "num_only_roped": 1080406, "total_diff": 2160812, "diff_percentage": 0.22205085972296412, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:04:02.896718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10791015625, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.28125, "l2_diff_relative": 0.4506172839506173}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:05:10.456394", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7687430190636354, "overlap_percentage": 0.8692534876780511, "num_intersection": 8248701, "num_union": 10730115, "num_only_computed": 1240707, "num_only_roped": 1240707, "total_diff": 2481414, "diff_percentage": 0.23125698093636463, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:05:14.961666", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1123046875, "mean_diff": 4.220008850097656e-05, "l2_diff": 2.0, "l2_diff_relative": 0.3033175355450237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:06:31.101118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7552359981581013, "overlap_percentage": 0.8605520841079218, "num_intersection": 8887837, "num_union": 11768291, "num_only_computed": 1440227, "num_only_roped": 1440227, "total_diff": 2880454, "diff_percentage": 0.2447640018418987, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:06:33.699424", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 3.933906555175781e-05, "l2_diff": 2.046875, "l2_diff_relative": 0.3075117370892019}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:07:57.440584", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7418896833774445, "overlap_percentage": 0.8518216629413113, "num_intersection": 9512054, "num_union": 12821386, "num_only_computed": 1654666, "num_only_roped": 1654666, "total_diff": 3309332, "diff_percentage": 0.25811031662255546, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:08:02.203826", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.875, "l2_diff_relative": 0.33707865168539325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:09:33.909948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7309246863725417, "overlap_percentage": 0.8445482257282071, "num_intersection": 10139119, "num_union": 13871633, "num_only_computed": 1866257, "num_only_roped": 1866257, "total_diff": 3732514, "diff_percentage": 0.2690753136274583, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:09:39.234342", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11279296875, "mean_diff": 4.0531158447265625e-05, "l2_diff": 1.7578125, "l2_diff_relative": 0.31424581005586594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:11:19.641582", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7272990593152853, "overlap_percentage": 0.842122914839764, "num_intersection": 10817116, "num_union": 14872996, "num_only_computed": 2027940, "num_only_roped": 2027940, "total_diff": 4055880, "diff_percentage": 0.2727009406847148, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:11:24.317860", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10400390625, "mean_diff": 4.100799560546875e-05, "l2_diff": 1.921875, "l2_diff_relative": 0.36176470588235293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:13:15.042449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7211262913184029, "overlap_percentage": 0.8379702232844422, "num_intersection": 10237985, "num_union": 14197215, "num_only_computed": 1979615, "num_only_roped": 1979615, "total_diff": 3959230, "diff_percentage": 0.27887370868159705, "num_computed": 12217600, "num_roped": 12217600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "mask_shape": [1, 32, 920, 16280], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:13:21.149104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11474609375, "mean_diff": 4.267692565917969e-05, "l2_diff": 2.15625, "l2_diff_relative": 0.42592592592592593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 920, "seq_len_k": 16280, "queries_shape": [1, 32, 920, 128], "keys_shape": [1, 8, 16280, 128], "attention_shape": [1, 32, 920, 16280]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:15:08.601208", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6881605528868553, "overlap_percentage": 0.8152785606914694, "num_intersection": 347113, "num_union": 504407, "num_only_computed": 78647, "num_only_roped": 78647, "total_diff": 157294, "diff_percentage": 0.31183944711314476, "num_computed": 425760, "num_roped": 425760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "mask_shape": [1, 32, 32, 16312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:15:12.102804", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.586841583251953e-05, "l2_diff": 0.1474609375, "l2_diff_relative": 0.11651234567901235}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 32, "seq_len_k": 16312, "queries_shape": [1, 32, 32, 128], "keys_shape": [1, 8, 16312, 128], "attention_shape": [1, 32, 32, 16312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:16:52.115333", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6890073622746891, "overlap_percentage": 0.815872538704344, "num_intersection": 10856, "num_union": 15756, "num_only_computed": 2450, "num_only_roped": 2450, "total_diff": 4900, "diff_percentage": 0.310992637725311, "num_computed": 13306, "num_roped": 13306}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "mask_shape": [1, 32, 1, 16313], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:16:55.215905", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.024658203125, "l2_diff_relative": 0.12081339712918661}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16313, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16313, 128], "attention_shape": [1, 32, 1, 16313]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:18:31.693036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6870998415213946, "overlap_percentage": 0.8145337040655294, "num_intersection": 10839, "num_union": 15775, "num_only_computed": 2468, "num_only_roped": 2468, "total_diff": 4936, "diff_percentage": 0.31290015847860536, "num_computed": 13307, "num_roped": 13307}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "mask_shape": [1, 32, 1, 16314], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:18:35.739472", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.0224609375, "l2_diff_relative": 0.08041958041958042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16314, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16314, 128], "attention_shape": [1, 32, 1, 16314]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:19:28.625665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:19:28.635160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.031005859375, "l2_diff_relative": 0.0031398338607594935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:19:34.654594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8916867248704977, "overlap_percentage": 0.9427424881163041, "num_intersection": 1738930, "num_union": 1950158, "num_only_computed": 200526, "num_only_roped": 10702, "total_diff": 211228, "diff_percentage": 0.10831327512950233, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:19:35.047671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.16908073425293e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.015074823943661973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:19:49.980904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.913260541437537, "overlap_percentage": 0.9546640634226999, "num_intersection": 2586605, "num_union": 2832275, "num_only_computed": 191507, "num_only_roped": 54163, "total_diff": 245670, "diff_percentage": 0.08673945856246304, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:19:50.533786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 4.708766937255859e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.015082465277777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:20:11.192757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9061422512922179, "overlap_percentage": 0.9507603650020591, "num_intersection": 3398337, "num_union": 3750335, "num_only_computed": 218431, "num_only_roped": 133567, "total_diff": 351998, "diff_percentage": 0.0938577487077821, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:20:14.134461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.27501106262207e-06, "l2_diff": 0.2314453125, "l2_diff_relative": 0.0253638698630137}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:20:41.246122", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8873645647741636, "overlap_percentage": 0.9403213150611874, "num_intersection": 4175147, "num_union": 4705109, "num_only_computed": 281301, "num_only_roped": 248661, "total_diff": 529962, "diff_percentage": 0.11263543522583642, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:20:42.822969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 3.6656856536865234e-06, "l2_diff": 0.1533203125, "l2_diff_relative": 0.018870192307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:21:15.841351", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8618323190394439, "overlap_percentage": 0.9257894067324819, "num_intersection": 4901561, "num_union": 5687372, "num_only_computed": 393543, "num_only_roped": 392268, "total_diff": 785811, "diff_percentage": 0.13816768096055612, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:21:16.943717", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.8759241104125977e-06, "l2_diff": 0.1435546875, "l2_diff_relative": 0.01640625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:21:56.764506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8323331631074826, "overlap_percentage": 0.9084954416214525, "num_intersection": 5572493, "num_union": 6695027, "num_only_computed": 561267, "num_only_roped": 561267, "total_diff": 1122534, "diff_percentage": 0.16766683689251738, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:21:58.098753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.7120113372802734e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.019222122302158272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:43.737956", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8089924808830844, "overlap_percentage": 0.8944122094837714, "num_intersection": 6236214, "num_union": 7708618, "num_only_computed": 736202, "num_only_roped": 736202, "total_diff": 1472404, "diff_percentage": 0.19100751911691563, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:22:46.744969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.2351741790771484e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.017096920289855072}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:23:40.172265", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7905282364915047, "overlap_percentage": 0.8830111923177766, "num_intersection": 6897264, "num_union": 8724880, "num_only_computed": 913808, "num_only_roped": 913808, "total_diff": 1827616, "diff_percentage": 0.20947176350849525, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:23:43.634348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 2.4199485778808594e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.14144736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:24:40.269681", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7511249273450409, "overlap_percentage": 0.857877031633437, "num_intersection": 3220364, "num_union": 4287388, "num_only_computed": 533512, "num_only_roped": 533512, "total_diff": 1067024, "diff_percentage": 0.24887507265495915, "num_computed": 3753876, "num_roped": 3753876}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "mask_shape": [1, 32, 469, 9685], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:24:42.165476", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 4.482269287109375e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.23958333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 469, "seq_len_k": 9685, "queries_shape": [1, 32, 469, 128], "keys_shape": [1, 8, 9685, 128], "attention_shape": [1, 32, 469, 9685]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:25:37.996593", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7296772889577579, "overlap_percentage": 0.8437149445344634, "num_intersection": 162459, "num_union": 222645, "num_only_computed": 30093, "num_only_roped": 30093, "total_diff": 60186, "diff_percentage": 0.27032271104224215, "num_computed": 192552, "num_roped": 192552}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "mask_shape": [1, 32, 24, 9709], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:25:39.796214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.10107421875, "l2_diff_relative": 0.08567880794701986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 9709, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 9709, 128], "attention_shape": [1, 32, 24, 9709]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:26:32.768916", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7396205962059621, "overlap_percentage": 0.8503240279162513, "num_intersection": 6823, "num_union": 9225, "num_only_computed": 1201, "num_only_roped": 1201, "total_diff": 2402, "diff_percentage": 0.26037940379403796, "num_computed": 8024, "num_roped": 8024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "mask_shape": [1, 32, 1, 9710], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:26:34.428155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 9.059906005859375e-06, "l2_diff": 0.010009765625, "l2_diff_relative": 0.042008196721311473}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9710, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9710, 128], "attention_shape": [1, 32, 1, 9710]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:27:25.300541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.724664159054272, "overlap_percentage": 0.8403539381854437, "num_intersection": 6743, "num_union": 9305, "num_only_computed": 1281, "num_only_roped": 1281, "total_diff": 2562, "diff_percentage": 0.2753358409457281, "num_computed": 8024, "num_roped": 8024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "mask_shape": [1, 32, 1, 9711], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:27:26.935121", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.005859375, "mean_diff": 1.233816146850586e-05, "l2_diff": 0.01214599609375, "l2_diff_relative": 0.04640858208955224}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 9711, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 9711, 128], "attention_shape": [1, 32, 1, 9711]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:27:54.007788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:27:54.016079", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.029541015625, "l2_diff_relative": 0.0030298477564102565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:00.034224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8916159162683805, "overlap_percentage": 0.942702911939211, "num_intersection": 1738857, "num_union": 1950231, "num_only_computed": 200599, "num_only_roped": 10775, "total_diff": 211374, "diff_percentage": 0.10838408373161948, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:00.426526", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 6.198883056640625e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.014641608391608392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:15.262438", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9115840182534035, "overlap_percentage": 0.9537472688083146, "num_intersection": 2584121, "num_union": 2834759, "num_only_computed": 193991, "num_only_roped": 56647, "total_diff": 250638, "diff_percentage": 0.08841598174659644, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:18.368841", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 4.827976226806641e-06, "l2_diff": 0.1162109375, "l2_diff_relative": 0.015494791666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:35.340099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8146908578474547, "overlap_percentage": 0.8978839060376625, "num_intersection": 41625, "num_union": 51093, "num_only_computed": 4734, "num_only_roped": 4734, "total_diff": 9468, "diff_percentage": 0.18530914215254535, "num_computed": 46359, "num_roped": 46359}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "mask_shape": [1, 32, 17, 3089], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:35.867959", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00439453125, "mean_diff": 3.874301910400391e-06, "l2_diff": 0.0150146484375, "l2_diff_relative": 0.013254310344827587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 17, "seq_len_k": 3089, "queries_shape": [1, 32, 17, 128], "keys_shape": [1, 8, 3089, 128], "attention_shape": [1, 32, 17, 3089]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:52.113089", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.808535412342429, "overlap_percentage": 0.8941327958795208, "num_intersection": 63884, "num_union": 79012, "num_only_computed": 7564, "num_only_roped": 7564, "total_diff": 15128, "diff_percentage": 0.191464587657571, "num_computed": 71448, "num_roped": 71448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "mask_shape": [1, 32, 26, 3115], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:28:52.649709", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00390625, "mean_diff": 4.351139068603516e-06, "l2_diff": 0.016845703125, "l2_diff_relative": 0.013147865853658536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 26, "seq_len_k": 3115, "queries_shape": [1, 32, 26, 128], "keys_shape": [1, 8, 3115, 128], "attention_shape": [1, 32, 26, 3115]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:08.636715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7996070726915521, "overlap_percentage": 0.888646288209607, "num_intersection": 2442, "num_union": 3054, "num_only_computed": 306, "num_only_roped": 306, "total_diff": 612, "diff_percentage": 0.20039292730844793, "num_computed": 2748, "num_roped": 2748}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "mask_shape": [1, 32, 1, 3116], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:09.149404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 9.417533874511719e-06, "l2_diff": 0.004058837890625, "l2_diff_relative": 0.012907608695652174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3116, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3116, 128], "attention_shape": [1, 32, 1, 3116]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:25.064630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8008516213560433, "overlap_percentage": 0.8894143324845398, "num_intersection": 2445, "num_union": 3053, "num_only_computed": 304, "num_only_roped": 304, "total_diff": 608, "diff_percentage": 0.19914837864395676, "num_computed": 2749, "num_roped": 2749}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "mask_shape": [1, 32, 1, 3117], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:28.134785", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00170135498046875, "mean_diff": 5.781650543212891e-06, "l2_diff": 0.0026702880859375, "l2_diff_relative": 0.013209541062801932}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3117, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3117, 128], "attention_shape": [1, 32, 1, 3117]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:44.079474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7985611510791367, "overlap_percentage": 0.888, "num_intersection": 2442, "num_union": 3058, "num_only_computed": 308, "num_only_roped": 308, "total_diff": 616, "diff_percentage": 0.2014388489208633, "num_computed": 2750, "num_roped": 2750}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3118, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3118, 128], "mask_shape": [1, 32, 1, 3118], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:44.589639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 5.245208740234375e-06, "l2_diff": 0.0029449462890625, "l2_diff_relative": 0.0120625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 3118, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 3118, 128], "attention_shape": [1, 32, 1, 3118]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:57.271067", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:29:57.284769", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3229589462280273e-06, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.003087197580645161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:30:03.240977", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8915519020949118, "overlap_percentage": 0.9426671307380036, "num_intersection": 1738791, "num_union": 1950297, "num_only_computed": 200665, "num_only_roped": 10841, "total_diff": 211506, "diff_percentage": 0.1084480979050883, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:30:03.628995", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.645917892456055e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.015982824427480915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:30:19.131389", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9114208425323307, "overlap_percentage": 0.953657951458604, "num_intersection": 2583879, "num_union": 2835001, "num_only_computed": 194233, "num_only_roped": 56889, "total_diff": 251122, "diff_percentage": 0.08857915746766933, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:30:19.696762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 4.9173831939697266e-06, "l2_diff": 0.1201171875, "l2_diff_relative": 0.015625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:30:40.186446", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9026558824147831, "overlap_percentage": 0.9488377701480779, "num_intersection": 3391465, "num_union": 3757207, "num_only_computed": 225303, "num_only_roped": 140439, "total_diff": 365742, "diff_percentage": 0.0973441175852169, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:30:40.913311", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.245208740234375e-06, "l2_diff": 0.208984375, "l2_diff_relative": 0.025920542635658916}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:31:07.445267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.883345786103472, "overlap_percentage": 0.9380601189875607, "num_intersection": 4165107, "num_union": 4715149, "num_only_computed": 291341, "num_only_roped": 258701, "total_diff": 550042, "diff_percentage": 0.11665421389652798, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:31:08.371120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.1650390625, "l2_diff_relative": 0.0206298828125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:31:40.948093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8576899446917521, "overlap_percentage": 0.9233940756826018, "num_intersection": 4888879, "num_union": 5700054, "num_only_computed": 406225, "num_only_roped": 404950, "total_diff": 811175, "diff_percentage": 0.14231005530824795, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:31:42.073167", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 2.637505531311035e-06, "l2_diff": 0.12890625, "l2_diff_relative": 0.014732142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:32:22.268197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8289487337597669, "overlap_percentage": 0.9064756364774624, "num_intersection": 5560104, "num_union": 6707416, "num_only_computed": 573656, "num_only_roped": 573656, "total_diff": 1147312, "diff_percentage": 0.1710512662402332, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:32:23.606317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.162109375, "l2_diff_relative": 0.01866007194244604}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:33:09.359189", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8052915551858191, "overlap_percentage": 0.8921457067392422, "num_intersection": 6220411, "num_union": 7724421, "num_only_computed": 752005, "num_only_roped": 752005, "total_diff": 1504010, "diff_percentage": 0.1947084448141809, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:33:11.658635", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.4139881134033203e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.01610949612403101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:34:04.843807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7900440459985059, "overlap_percentage": 0.8827090570922915, "num_intersection": 6894904, "num_union": 8727240, "num_only_computed": 916168, "num_only_roped": 916168, "total_diff": 1832336, "diff_percentage": 0.20995595400149417, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:34:07.036146", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.16063829787234044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:35:07.792032", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7717075728282596, "overlap_percentage": 0.871145537405303, "num_intersection": 7536064, "num_union": 9765440, "num_only_computed": 1114688, "num_only_roped": 1114688, "total_diff": 2229376, "diff_percentage": 0.22829242717174034, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:35:09.916590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 5.698204040527344e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.42138364779874216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:36:18.948554", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.759175860895938, "overlap_percentage": 0.8631039997437142, "num_intersection": 8190346, "num_union": 10788470, "num_only_computed": 1299062, "num_only_roped": 1299062, "total_diff": 2598124, "diff_percentage": 0.24082413910406203, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:36:23.521550", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1171875, "mean_diff": 5.221366882324219e-05, "l2_diff": 2.25, "l2_diff_relative": 0.41379310344827586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:37:39.622154", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7468626056591199, "overlap_percentage": 0.855090266675342, "num_intersection": 8831427, "num_union": 11824701, "num_only_computed": 1496637, "num_only_roped": 1496637, "total_diff": 2993274, "diff_percentage": 0.2531373943408802, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:37:42.247287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12890625, "mean_diff": 4.7206878662109375e-05, "l2_diff": 2.265625, "l2_diff_relative": 0.3553921568627451}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:39:11.987030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7436705646366092, "overlap_percentage": 0.8529943439076112, "num_intersection": 9525149, "num_union": 12808291, "num_only_computed": 1641571, "num_only_roped": 1641571, "total_diff": 3283142, "diff_percentage": 0.2563294353633908, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:39:14.897460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 4.2438507080078125e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.3153153153153153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:40:47.734696", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7352553086959368, "overlap_percentage": 0.8474318505309621, "num_intersection": 10173738, "num_union": 13837014, "num_only_computed": 1831638, "num_only_roped": 1831638, "total_diff": 3663276, "diff_percentage": 0.26474469130406314, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:40:50.847996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.123046875, "mean_diff": 4.363059997558594e-05, "l2_diff": 2.515625, "l2_diff_relative": 0.4192708333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:42:32.353320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7243855854344087, "overlap_percentage": 0.8401665979502152, "num_intersection": 10791987, "num_union": 14898125, "num_only_computed": 2053069, "num_only_roped": 2053069, "total_diff": 4106138, "diff_percentage": 0.2756144145655913, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:42:35.719915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 5.173683166503906e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.562874251497006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:44:24.007171", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7146889104300037, "overlap_percentage": 0.8336076661868379, "num_intersection": 9033973, "num_union": 12640427, "num_only_computed": 1803227, "num_only_roped": 1803227, "total_diff": 3606454, "diff_percentage": 0.28531108956999635, "num_computed": 10837200, "num_roped": 10837200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "mask_shape": [1, 32, 821, 16181], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:44:27.555652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.315376281738281e-05, "l2_diff": 2.4375, "l2_diff_relative": 0.44571428571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 821, "seq_len_k": 16181, "queries_shape": [1, 32, 821, 128], "keys_shape": [1, 8, 16181, 128], "attention_shape": [1, 32, 821, 16181]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:46:14.231650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6827210607352361, "overlap_percentage": 0.8114488808227466, "num_intersection": 321918, "num_union": 471522, "num_only_computed": 74802, "num_only_roped": 74802, "total_diff": 149604, "diff_percentage": 0.3172789392647639, "num_computed": 396720, "num_roped": 396720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "mask_shape": [1, 32, 30, 16211], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:46:17.612409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 2.956390380859375e-05, "l2_diff": 0.1611328125, "l2_diff_relative": 0.13842281879194632}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 16211, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 16211, 128], "attention_shape": [1, 32, 30, 16211]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:47:56.765334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6828911369854298, "overlap_percentage": 0.8115689981096408, "num_intersection": 10733, "num_union": 15717, "num_only_computed": 2492, "num_only_roped": 2492, "total_diff": 4984, "diff_percentage": 0.3171088630145702, "num_computed": 13225, "num_roped": 13225}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "mask_shape": [1, 32, 1, 16212], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:47:59.948495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.014892578125, "mean_diff": 2.9921531677246094e-05, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.16164921465968587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16212, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16212, 128], "attention_shape": [1, 32, 1, 16212]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:48:56.307067", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:48:56.320738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.0030691964285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:49:02.323197", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8919612795692031, "overlap_percentage": 0.9428959135699664, "num_intersection": 1739213, "num_union": 1949875, "num_only_computed": 200243, "num_only_roped": 10419, "total_diff": 210662, "diff_percentage": 0.10803872043079685, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:49:02.711141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.377696990966797e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.015299479166666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:49:18.139904", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.912509657170023, "overlap_percentage": 0.9542536465099799, "num_intersection": 2585493, "num_union": 2833387, "num_only_computed": 192619, "num_only_roped": 55275, "total_diff": 247894, "diff_percentage": 0.08749034282997699, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:49:18.692468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.887580871582031e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.016163793103448277}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:49:39.194661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9044659631354772, "overlap_percentage": 0.9498368368278751, "num_intersection": 3395036, "num_union": 3753636, "num_only_computed": 221732, "num_only_roped": 136868, "total_diff": 358600, "diff_percentage": 0.09553403686452283, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:49:39.933041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.304813385009766e-06, "l2_diff": 0.251953125, "l2_diff_relative": 0.024431818181818183}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:50:06.615016", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8852081449683271, "overlap_percentage": 0.9391091878432334, "num_intersection": 4169765, "num_union": 4710491, "num_only_computed": 286683, "num_only_roped": 254043, "total_diff": 540726, "diff_percentage": 0.11479185503167291, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:50:07.563226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.427267074584961e-06, "l2_diff": 0.1748046875, "l2_diff_relative": 0.018897804054054054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:50:40.554476", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8631646550730605, "overlap_percentage": 0.9265575672260841, "num_intersection": 4905628, "num_union": 5683305, "num_only_computed": 389476, "num_only_roped": 388201, "total_diff": 777677, "diff_percentage": 0.13683534492693952, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:50:41.683438", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.562999725341797e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.015396897810218978}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:51:22.165521", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8324108931440685, "overlap_percentage": 0.9085417427483305, "num_intersection": 5572777, "num_union": 6694743, "num_only_computed": 560983, "num_only_roped": 560983, "total_diff": 1121966, "diff_percentage": 0.1675891068559316, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:51:23.500563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.562999725341797e-06, "l2_diff": 0.1640625, "l2_diff_relative": 0.018356643356643356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:52:09.509065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8084193601892139, "overlap_percentage": 0.8940618287835952, "num_intersection": 6233771, "num_union": 7711061, "num_only_computed": 738645, "num_only_roped": 738645, "total_diff": 1477290, "diff_percentage": 0.1915806398107861, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:52:13.297477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.205371856689453e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.016304347826086956}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:53:06.410400", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7844139016235253, "overlap_percentage": 0.8791838047325642, "num_intersection": 6867368, "num_union": 8754776, "num_only_computed": 943704, "num_only_roped": 943704, "total_diff": 1887408, "diff_percentage": 0.21558609837647474, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:53:09.056516", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 3.039836883544922e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.18139097744360902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:54:09.395157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7670575167054126, "overlap_percentage": 0.8681749286073627, "num_intersection": 7510366, "num_union": 9791138, "num_only_computed": 1140386, "num_only_roped": 1140386, "total_diff": 2280772, "diff_percentage": 0.23294248329458742, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:54:11.479355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1015625, "mean_diff": 4.649162292480469e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.31447963800904977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:55:19.728098", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7548528452997014, "overlap_percentage": 0.860303298161487, "num_intersection": 8163769, "num_union": 10815047, "num_only_computed": 1325639, "num_only_roped": 1325639, "total_diff": 2651278, "diff_percentage": 0.24514715470029858, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:55:22.090398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 5.626678466796875e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.44416243654822335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:56:40.106424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7444828201261533, "overlap_percentage": 0.8535284057108864, "num_intersection": 8815296, "num_union": 11840832, "num_only_computed": 1512768, "num_only_roped": 1512768, "total_diff": 3025536, "diff_percentage": 0.2555171798738467, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:56:42.722245", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 2.796875, "l2_diff_relative": 0.46134020618556704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:58:07.811754", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7393853477681898, "overlap_percentage": 0.8501685365084823, "num_intersection": 9493594, "num_union": 12839846, "num_only_computed": 1673126, "num_only_roped": 1673126, "total_diff": 3346252, "diff_percentage": 0.26061465223181024, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:58:10.705491", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 4.9114227294921875e-05, "l2_diff": 2.734375, "l2_diff_relative": 0.42892156862745096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:59:45.110017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7348073459601099, "overlap_percentage": 0.8471342338632293, "num_intersection": 10170165, "num_union": 13840587, "num_only_computed": 1835211, "num_only_roped": 1835211, "total_diff": 3670422, "diff_percentage": 0.26519265403989006, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T12:59:48.257673", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 4.5299530029296875e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.39901477832512317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:01:31.535275", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7315096103082404, "overlap_percentage": 0.8449385506766183, "num_intersection": 10853283, "num_union": 14836829, "num_only_computed": 1991773, "num_only_roped": 1991773, "total_diff": 3983546, "diff_percentage": 0.2684903896917596, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:01:34.908898", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.12451171875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.4015151515151515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:03:24.705272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7222821594496334, "overlap_percentage": 0.8387500915418451, "num_intersection": 10765911, "num_union": 14905409, "num_only_computed": 2069749, "num_only_roped": 2069749, "total_diff": 4139498, "diff_percentage": 0.27771784055036663, "num_computed": 12835660, "num_roped": 12835660}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "mask_shape": [1, 32, 964, 16324], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:03:28.342973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.115234375, "mean_diff": 3.2901763916015625e-05, "l2_diff": 1.796875, "l2_diff_relative": 0.2948717948717949}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 964, "seq_len_k": 16324, "queries_shape": [1, 32, 964, 128], "keys_shape": [1, 8, 16324, 128], "attention_shape": [1, 32, 964, 16324]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:05:16.850424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6799927214872428, "overlap_percentage": 0.8095186518251906, "num_intersection": 291485, "num_union": 428659, "num_only_computed": 68587, "num_only_roped": 68587, "total_diff": 137174, "diff_percentage": 0.32000727851275723, "num_computed": 360072, "num_roped": 360072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 27, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:05:20.282875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.1318359375, "l2_diff_relative": 0.10227272727272728}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 16351, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 27, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:07:00.443075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6778211095735313, "overlap_percentage": 0.8079778061033216, "num_intersection": 10776, "num_union": 15898, "num_only_computed": 2561, "num_only_roped": 2561, "total_diff": 5122, "diff_percentage": 0.32217889042646874, "num_computed": 13337, "num_roped": 13337}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:07:03.601024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013427734375, "mean_diff": 2.8014183044433594e-05, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.21066433566433568}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:08:41.290993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6695456252346977, "overlap_percentage": 0.8020692757534863, "num_intersection": 10698, "num_union": 15978, "num_only_computed": 2640, "num_only_roped": 2640, "total_diff": 5280, "diff_percentage": 0.3304543747653023, "num_computed": 13338, "num_roped": 13338}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:08:45.976166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.18579234972677597}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:10:22.074322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6734412244385899, "overlap_percentage": 0.8048579353774645, "num_intersection": 10736, "num_union": 15942, "num_only_computed": 2603, "num_only_roped": 2603, "total_diff": 5206, "diff_percentage": 0.3265587755614101, "num_computed": 13339, "num_roped": 13339}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:10:25.194083", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.12745098039215685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:12:01.982405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6751428392038676, "overlap_percentage": 0.806071964017991, "num_intersection": 10753, "num_union": 15927, "num_only_computed": 2587, "num_only_roped": 2587, "total_diff": 5174, "diff_percentage": 0.32485716079613236, "num_computed": 13340, "num_roped": 13340}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:12:05.326973", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.026611328125, "mean_diff": 1.6927719116210938e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.1464041095890411}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:12:59.295267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:12:59.308987", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.293156623840332e-06, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.003022989649681529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:13:05.279629", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8914811035854735, "overlap_percentage": 0.9426275545609104, "num_intersection": 1738718, "num_union": 1950370, "num_only_computed": 200738, "num_only_roped": 10914, "total_diff": 211652, "diff_percentage": 0.10851889641452647, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:13:05.666270", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.467103958129883e-06, "l2_diff": 0.1318359375, "l2_diff_relative": 0.015510110294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:13:20.614435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9111370370971235, "overlap_percentage": 0.9535025687965041, "num_intersection": 2583458, "num_union": 2835422, "num_only_computed": 194654, "num_only_roped": 57310, "total_diff": 251964, "diff_percentage": 0.08886296290287654, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:13:23.487396", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.6193599700927734e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.014331896551724137}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:13:44.192683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9034446766871247, "overlap_percentage": 0.9492733755304482, "num_intersection": 3393022, "num_union": 3755650, "num_only_computed": 223746, "num_only_roped": 138882, "total_diff": 362628, "diff_percentage": 0.09655532331287527, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:13:44.914512", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.364418029785156e-06, "l2_diff": 0.23828125, "l2_diff_relative": 0.026475694444444444}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:14:11.550159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8853958643929901, "overlap_percentage": 0.9392148154287444, "num_intersection": 4170234, "num_union": 4710022, "num_only_computed": 286214, "num_only_roped": 253574, "total_diff": 539788, "diff_percentage": 0.11460413560700991, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:14:12.477085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.7103891372680664e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.020552884615384615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:14:45.370919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8575537253757233, "overlap_percentage": 0.9233151253294359, "num_intersection": 4888461, "num_union": 5700472, "num_only_computed": 406643, "num_only_roped": 405368, "total_diff": 812011, "diff_percentage": 0.14244627462427673, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:14:47.701694", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.995133399963379e-06, "l2_diff": 0.142578125, "l2_diff_relative": 0.01677389705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:15:27.016888", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8273176807648819, "overlap_percentage": 0.9054995630738731, "num_intersection": 5554117, "num_union": 6713403, "num_only_computed": 579643, "num_only_roped": 579643, "total_diff": 1159286, "diff_percentage": 0.17268231923511818, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:15:30.351153", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.518296241760254e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.01763091216216216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:16:16.462048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8081961220760391, "overlap_percentage": 0.8939252907457043, "num_intersection": 6232819, "num_union": 7712013, "num_only_computed": 739597, "num_only_roped": 739597, "total_diff": 1479194, "diff_percentage": 0.19180387792396097, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:16:18.017716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.130866050720215e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.016861510791366906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:17:10.964437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7879789225986916, "overlap_percentage": 0.8814185812139486, "num_intersection": 6884824, "num_union": 8737320, "num_only_computed": 926248, "num_only_roped": 926248, "total_diff": 1852496, "diff_percentage": 0.2120210774013084, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:17:12.756514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 2.8848648071289062e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.17405063291139242}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:18:12.848881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7743323398619669, "overlap_percentage": 0.8728154500325521, "num_intersection": 7550510, "num_union": 9750994, "num_only_computed": 1100242, "num_only_roped": 1100242, "total_diff": 2200484, "diff_percentage": 0.2256676601380331, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:18:16.739143", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1337890625, "mean_diff": 5.936622619628906e-05, "l2_diff": 2.75, "l2_diff_relative": 0.46808510638297873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:19:24.570239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.76454089137002, "overlap_percentage": 0.8665606958832416, "num_intersection": 8223148, "num_union": 10755668, "num_only_computed": 1266260, "num_only_roped": 1266260, "total_diff": 2532520, "diff_percentage": 0.23545910862998, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:19:29.312537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 5.7220458984375e-05, "l2_diff": 2.78125, "l2_diff_relative": 0.47593582887700536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:20:45.966555", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7560107247248365, "overlap_percentage": 0.8610547920694527, "num_intersection": 8893029, "num_union": 11763099, "num_only_computed": 1435035, "num_only_roped": 1435035, "total_diff": 2870070, "diff_percentage": 0.24398927527516345, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:20:50.776243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.134765625, "mean_diff": 5.2928924560546875e-05, "l2_diff": 2.578125, "l2_diff_relative": 0.43882978723404253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:22:16.074709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7449541830610189, "overlap_percentage": 0.8538381010717561, "num_intersection": 9534571, "num_union": 12798869, "num_only_computed": 1632149, "num_only_roped": 1632149, "total_diff": 3264298, "diff_percentage": 0.2550458169389811, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:22:18.986718", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.142578125, "mean_diff": 4.76837158203125e-05, "l2_diff": 2.359375, "l2_diff_relative": 0.438953488372093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:23:53.151758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7321426626217123, "overlap_percentage": 0.8453606950752729, "num_intersection": 10148873, "num_union": 13861879, "num_only_computed": 1856503, "num_only_roped": 1856503, "total_diff": 3713006, "diff_percentage": 0.2678573373782876, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:23:56.338587", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1220703125, "mean_diff": 4.4345855712890625e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.39166666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:25:31.089312", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6854133151155872, "overlap_percentage": 0.8133474548568889, "num_intersection": 497632, "num_union": 726032, "num_only_computed": 114200, "num_only_roped": 114200, "total_diff": 228400, "diff_percentage": 0.3145866848844128, "num_computed": 611832, "num_roped": 611832}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "mask_shape": [1, 32, 52, 14388], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:25:34.068348", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.2275390625, "l2_diff_relative": 0.11557539682539683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 52, "seq_len_k": 14388, "queries_shape": [1, 32, 52, 128], "keys_shape": [1, 8, 14388, 128], "attention_shape": [1, 32, 52, 14388]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:27:04.181245", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6808080424074949, "overlap_percentage": 0.8100961266610122, "num_intersection": 286531, "num_union": 420869, "num_only_computed": 67169, "num_only_roped": 67169, "total_diff": 134338, "diff_percentage": 0.319191957592505, "num_computed": 353700, "num_roped": 353700}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "mask_shape": [1, 32, 30, 14418], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:27:07.558455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.111328125, "l2_diff_relative": 0.07579787234042554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 14418, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 14418, 128], "attention_shape": [1, 32, 30, 14418]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:28:33.571996", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.673075558708762, "overlap_percentage": 0.8045967263166822, "num_intersection": 9487, "num_union": 14095, "num_only_computed": 2304, "num_only_roped": 2304, "total_diff": 4608, "diff_percentage": 0.32692444129123804, "num_computed": 11791, "num_roped": 11791}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "mask_shape": [1, 32, 1, 14419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:28:36.222750", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009521484375, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.01483154296875, "l2_diff_relative": 0.07631909547738694}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14419, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14419, 128], "attention_shape": [1, 32, 1, 14419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:29:57.888207", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6890353075986536, "overlap_percentage": 0.8158921302578019, "num_intersection": 9621, "num_union": 13963, "num_only_computed": 2171, "num_only_roped": 2171, "total_diff": 4342, "diff_percentage": 0.31096469240134644, "num_computed": 11792, "num_roped": 11792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "mask_shape": [1, 32, 1, 14420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:30:00.730193", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.1244877049180328}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14420, 128], "attention_shape": [1, 32, 1, 14420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:31:22.903920", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6819283982313508, "overlap_percentage": 0.8108887381275441, "num_intersection": 9562, "num_union": 14022, "num_only_computed": 2230, "num_only_roped": 2230, "total_diff": 4460, "diff_percentage": 0.3180716017686493, "num_computed": 11792, "num_roped": 11792}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "mask_shape": [1, 32, 1, 14421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:31:25.587205", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 1.3887882232666016e-05, "l2_diff": 0.02294921875, "l2_diff_relative": 0.091796875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14421, 128], "attention_shape": [1, 32, 1, 14421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:13.114541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:14.487008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4421682357788086e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:20.484850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8914878922539035, "overlap_percentage": 0.9426313495367961, "num_intersection": 1738725, "num_union": 1950363, "num_only_computed": 200731, "num_only_roped": 10907, "total_diff": 211638, "diff_percentage": 0.1085121077460965, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:20.871336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 6.377696990966797e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.015299479166666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:36.372108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9112367975722981, "overlap_percentage": 0.9535571926302114, "num_intersection": 2583606, "num_union": 2835274, "num_only_computed": 194506, "num_only_roped": 57162, "total_diff": 251668, "diff_percentage": 0.08876320242770187, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:36.922481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.6193599700927734e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.014187116564417178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:57.442939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9034132542644377, "overlap_percentage": 0.9492560296513814, "num_intersection": 3392960, "num_union": 3755712, "num_only_computed": 223808, "num_only_roped": 138944, "total_diff": 362752, "diff_percentage": 0.09658674573556225, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:32:58.177019", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.21540641784668e-06, "l2_diff": 0.2236328125, "l2_diff_relative": 0.02519806338028169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:33:24.671723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8850992928321803, "overlap_percentage": 0.9390479283480115, "num_intersection": 4169493, "num_union": 4710763, "num_only_computed": 286955, "num_only_roped": 254315, "total_diff": 541270, "diff_percentage": 0.11490070716781974, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:33:25.598155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 3.4570693969726562e-06, "l2_diff": 0.1796875, "l2_diff_relative": 0.01903973509933775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:33:58.248772", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.857961791262664, "overlap_percentage": 0.9235515986360476, "num_intersection": 4889713, "num_union": 5699220, "num_only_computed": 405391, "num_only_roped": 404116, "total_diff": 809507, "diff_percentage": 0.142038208737336, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:33:59.371850", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.86102294921875e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.017652671755725192}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:34:40.070086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8285872373687944, "overlap_percentage": 0.9062594558639399, "num_intersection": 5558778, "num_union": 6708742, "num_only_computed": 574982, "num_only_roped": 574982, "total_diff": 1149964, "diff_percentage": 0.17141276263120567, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:34:41.401196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.637505531311035e-06, "l2_diff": 0.1630859375, "l2_diff_relative": 0.01877248201438849}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:35:27.492290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8085870595171735, "overlap_percentage": 0.8941643757343222, "num_intersection": 6234486, "num_union": 7710346, "num_only_computed": 737930, "num_only_roped": 737930, "total_diff": 1475860, "diff_percentage": 0.1914129404828266, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:35:31.305919", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.2649765014648438e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.016285211267605633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:36:24.830943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7857938221614034, "overlap_percentage": 0.8800498830378212, "num_intersection": 6874133, "num_union": 8748011, "num_only_computed": 936939, "num_only_roped": 936939, "total_diff": 1873878, "diff_percentage": 0.2142061778385967, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:36:27.865068", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.6875, "l2_diff_relative": 0.20149253731343283}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:37:28.262042", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7777783257928177, "overlap_percentage": 0.8750003467906605, "num_intersection": 7569411, "num_union": 9732093, "num_only_computed": 1081341, "num_only_roped": 1081341, "total_diff": 2162682, "diff_percentage": 0.22222167420718236, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:37:30.364938", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.154296875, "mean_diff": 6.532669067382812e-05, "l2_diff": 3.171875, "l2_diff_relative": 0.5}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:38:39.107937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7647553397175342, "overlap_percentage": 0.8666984283951117, "num_intersection": 8224455, "num_union": 10754361, "num_only_computed": 1264953, "num_only_roped": 1264953, "total_diff": 2529906, "diff_percentage": 0.23524466028246588, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:38:41.475815", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.150390625, "mean_diff": 6.818771362304688e-05, "l2_diff": 3.328125, "l2_diff_relative": 0.5949720670391061}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:40:00.199240", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.751763370936309, "overlap_percentage": 0.8582932871058894, "num_intersection": 8864508, "num_union": 11791620, "num_only_computed": 1463556, "num_only_roped": 1463556, "total_diff": 2927112, "diff_percentage": 0.24823662906369098, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:40:02.818588", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 5.5789947509765625e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.45792079207920794}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:41:28.255668", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7454649130403113, "overlap_percentage": 0.85417347260431, "num_intersection": 9538316, "num_union": 12795124, "num_only_computed": 1628404, "num_only_roped": 1628404, "total_diff": 3256808, "diff_percentage": 0.2545350869596887, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:41:33.936236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.158203125, "mean_diff": 5.602836608886719e-05, "l2_diff": 2.890625, "l2_diff_relative": 0.4920212765957447}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:43:06.811118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7374695831755144, "overlap_percentage": 0.8489007120661832, "num_intersection": 8693509, "num_union": 11788295, "num_only_computed": 1547393, "num_only_roped": 1547393, "total_diff": 3094786, "diff_percentage": 0.26253041682448564, "num_computed": 10240902, "num_roped": 10240902}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "mask_shape": [1, 32, 882, 14194], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:43:12.090495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 5.507469177246094e-05, "l2_diff": 2.484375, "l2_diff_relative": 0.48773006134969327}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 882, "seq_len_k": 14194, "queries_shape": [1, 32, 882, 128], "keys_shape": [1, 8, 14194, 128], "attention_shape": [1, 32, 882, 14194]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:44:44.521073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6981703226474653, "overlap_percentage": 0.8222618347952406, "num_intersection": 296603, "num_union": 424829, "num_only_computed": 64113, "num_only_roped": 64113, "total_diff": 128226, "diff_percentage": 0.3018296773525348, "num_computed": 360716, "num_roped": 360716}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "mask_shape": [1, 32, 31, 14225], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:44:47.983345", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.86102294921875e-05, "l2_diff": 0.1708984375, "l2_diff_relative": 0.14112903225806453}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 31, "seq_len_k": 14225, "queries_shape": [1, 32, 31, 128], "keys_shape": [1, 8, 14225, 128], "attention_shape": [1, 32, 31, 14225]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:46:12.168915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.689928109795948, "overlap_percentage": 0.81651770367824, "num_intersection": 9501, "num_union": 13771, "num_only_computed": 2135, "num_only_roped": 2135, "total_diff": 4270, "diff_percentage": 0.310071890204052, "num_computed": 11636, "num_roped": 11636}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "mask_shape": [1, 32, 1, 14226], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:46:16.278471", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.23129251700680273}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14226, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14226, 128], "attention_shape": [1, 32, 1, 14226]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:47:36.605741", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6865217391304348, "overlap_percentage": 0.814127352410415, "num_intersection": 9474, "num_union": 13800, "num_only_computed": 2163, "num_only_roped": 2163, "total_diff": 4326, "diff_percentage": 0.3134782608695652, "num_computed": 11637, "num_roped": 11637}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "mask_shape": [1, 32, 1, 14227], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:47:40.285767", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017333984375, "mean_diff": 3.0279159545898438e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.2046783625730994}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14227, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14227, 128], "attention_shape": [1, 32, 1, 14227]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:49:00.237730", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6907096680467786, "overlap_percentage": 0.8170647877642206, "num_intersection": 9509, "num_union": 13767, "num_only_computed": 2129, "num_only_roped": 2129, "total_diff": 4258, "diff_percentage": 0.3092903319532215, "num_computed": 11638, "num_roped": 11638}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "mask_shape": [1, 32, 1, 14228], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:49:04.165192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.17702312138728324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14228, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14228, 128], "attention_shape": [1, 32, 1, 14228]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:50:24.024638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6903638080023238, "overlap_percentage": 0.816822751095455, "num_intersection": 9507, "num_union": 13771, "num_only_computed": 2132, "num_only_roped": 2132, "total_diff": 4264, "diff_percentage": 0.3096361919976763, "num_computed": 11639, "num_roped": 11639}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "mask_shape": [1, 32, 1, 14229], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:50:27.448967", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.16482300884955753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 14229, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 14229, 128], "attention_shape": [1, 32, 1, 14229]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:13.360774", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:13.373334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3676624298095703e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.003142528044871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:19.264015", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8915616009336061, "overlap_percentage": 0.9426725521321259, "num_intersection": 1738801, "num_union": 1950287, "num_only_computed": 200655, "num_only_roped": 10831, "total_diff": 211486, "diff_percentage": 0.10843839906639381, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:20.765795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.556510925292969e-06, "l2_diff": 0.134765625, "l2_diff_relative": 0.015854779411764705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:35.763283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9125110071522226, "overlap_percentage": 0.9542543846698949, "num_intersection": 2585495, "num_union": 2833385, "num_only_computed": 192617, "num_only_roped": 55273, "total_diff": 247890, "diff_percentage": 0.08748899284777749, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:36.314336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 5.066394805908203e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.016571969696969696}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:57.250617", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9054639667134903, "overlap_percentage": 0.9503868690576376, "num_intersection": 3397002, "num_union": 3751670, "num_only_computed": 219766, "num_only_roped": 134902, "total_diff": 354668, "diff_percentage": 0.09453603328650974, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:51:57.982319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 5.245208740234375e-06, "l2_diff": 0.1904296875, "l2_diff_relative": 0.02427788844621514}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:52:24.598153", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8885470367573391, "overlap_percentage": 0.9409848094469349, "num_intersection": 4178093, "num_union": 4702163, "num_only_computed": 278355, "num_only_roped": 245715, "total_diff": 524070, "diff_percentage": 0.11145296324266088, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:52:25.521176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.635883331298828e-06, "l2_diff": 0.158203125, "l2_diff_relative": 0.019322519083969467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:52:58.456974", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8642513933118215, "overlap_percentage": 0.9271833148816788, "num_intersection": 4908941, "num_union": 5679992, "num_only_computed": 386163, "num_only_roped": 384888, "total_diff": 771051, "diff_percentage": 0.13574860668817842, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:52:59.580940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.905726432800293e-06, "l2_diff": 0.1240234375, "l2_diff_relative": 0.016067813765182185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:53:38.825270", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8331507532604776, "overlap_percentage": 0.9089822555822203, "num_intersection": 5575479, "num_union": 6692041, "num_only_computed": 558281, "num_only_roped": 558281, "total_diff": 1116562, "diff_percentage": 0.16684924673952237, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:53:41.893243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.816319465637207e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.019313304721030045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:54:28.479594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8066366355861826, "overlap_percentage": 0.8929705284366279, "num_intersection": 6226162, "num_union": 7718670, "num_only_computed": 746254, "num_only_roped": 746254, "total_diff": 1492508, "diff_percentage": 0.1933633644138174, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:54:30.034871", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.60770320892334e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.01768617021276596}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:55:23.760156", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7854841998334081, "overlap_percentage": 0.8798556715390666, "num_intersection": 6872616, "num_union": 8749528, "num_only_computed": 938456, "num_only_roped": 938456, "total_diff": 1876912, "diff_percentage": 0.21451580016659183, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:55:25.585160", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.19144144144144143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:56:26.812545", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7708070677922698, "overlap_percentage": 0.8705714832652699, "num_intersection": 7531098, "num_union": 9770406, "num_only_computed": 1119654, "num_only_roped": 1119654, "total_diff": 2239308, "diff_percentage": 0.22919293220773015, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:56:30.367319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.9609375, "l2_diff_relative": 0.29050925925925924}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:57:38.655074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7599324618558597, "overlap_percentage": 0.8635927552066472, "num_intersection": 8194984, "num_union": 10783832, "num_only_computed": 1294424, "num_only_roped": 1294424, "total_diff": 2588848, "diff_percentage": 0.24006753814414022, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:57:40.997371", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 4.6253204345703125e-05, "l2_diff": 1.9453125, "l2_diff_relative": 0.3598265895953757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:58:57.321207", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.750496624916643, "overlap_percentage": 0.8574670916059389, "num_intersection": 8855975, "num_union": 11800153, "num_only_computed": 1472089, "num_only_roped": 1472089, "total_diff": 2944178, "diff_percentage": 0.24950337508335696, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T13:59:01.745913", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.126953125, "mean_diff": 5.8650970458984375e-05, "l2_diff": 2.8125, "l2_diff_relative": 0.5294117647058824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:00:26.429065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7470236335185378, "overlap_percentage": 0.8551957960797799, "num_intersection": 9549732, "num_union": 12783708, "num_only_computed": 1616988, "num_only_roped": 1616988, "total_diff": 3233976, "diff_percentage": 0.2529763664814622, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:00:29.295792", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.8125, "l2_diff_relative": 0.3258426966292135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:02:02.012909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7459702327579568, "overlap_percentage": 0.8545050983825913, "num_intersection": 10258655, "num_union": 13752097, "num_only_computed": 1746721, "num_only_roped": 1746721, "total_diff": 3493442, "diff_percentage": 0.2540297672420432, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:02:07.331284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.875, "l2_diff_relative": 0.38461538461538464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:03:47.640391", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7359042352635279, "overlap_percentage": 0.8478627107581314, "num_intersection": 10890844, "num_union": 14799268, "num_only_computed": 1954212, "num_only_roped": 1954212, "total_diff": 3908424, "diff_percentage": 0.2640957647364721, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:03:51.008241", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 1.8203125, "l2_diff_relative": 0.3551829268292683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:05:36.104721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.710288787848949, "overlap_percentage": 0.8306068459260473, "num_intersection": 5143145, "num_union": 7240921, "num_only_computed": 1048888, "num_only_roped": 1048888, "total_diff": 2097776, "diff_percentage": 0.28971121215105095, "num_computed": 6192033, "num_roped": 6192033}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "mask_shape": [1, 32, 479, 15839], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:05:39.488250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 3.790855407714844e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.2545045045045045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 479, "seq_len_k": 15839, "queries_shape": [1, 32, 479, 128], "keys_shape": [1, 8, 15839, 128], "attention_shape": [1, 32, 479, 15839]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:07:22.039750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6948997899831708, "overlap_percentage": 0.8199892336880527, "num_intersection": 499626, "num_union": 718990, "num_only_computed": 109682, "num_only_roped": 109682, "total_diff": 219364, "diff_percentage": 0.3051002100168292, "num_computed": 609308, "num_roped": 609308}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "mask_shape": [1, 32, 47, 15886], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:07:25.334780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 2.7894973754882812e-05, "l2_diff": 0.169921875, "l2_diff_relative": 0.11269430051813471}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 47, "seq_len_k": 15886, "queries_shape": [1, 32, 47, 128], "keys_shape": [1, 8, 15886, 128], "attention_shape": [1, 32, 47, 15886]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:09:01.469851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6971005955887165, "overlap_percentage": 0.8215194755109911, "num_intersection": 10651, "num_union": 15279, "num_only_computed": 2314, "num_only_roped": 2314, "total_diff": 4628, "diff_percentage": 0.30289940441128343, "num_computed": 12965, "num_roped": 12965}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "mask_shape": [1, 32, 1, 15887], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:09:05.599797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0123291015625, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.0311279296875, "l2_diff_relative": 0.19675925925925927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15887, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15887, 128], "attention_shape": [1, 32, 1, 15887]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:10:37.691348", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6965652600588813, "overlap_percentage": 0.8211476168440537, "num_intersection": 10647, "num_union": 15285, "num_only_computed": 2319, "num_only_roped": 2319, "total_diff": 4638, "diff_percentage": 0.30343473994111875, "num_computed": 12966, "num_roped": 12966}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "mask_shape": [1, 32, 1, 15888], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:10:42.915474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.28189300411522633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15888, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15888, 128], "attention_shape": [1, 32, 1, 15888]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:12:15.050420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6922675367047308, "overlap_percentage": 0.8181537749672245, "num_intersection": 10609, "num_union": 15325, "num_only_computed": 2358, "num_only_roped": 2358, "total_diff": 4716, "diff_percentage": 0.30773246329526915, "num_computed": 12967, "num_roped": 12967}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "mask_shape": [1, 32, 1, 15889], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:12:17.978129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01409912109375, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.19047619047619047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15889, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15889, 128], "attention_shape": [1, 32, 1, 15889]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:09.394013", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:09.407714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.4123659133911133e-06, "l2_diff": 0.03076171875, "l2_diff_relative": 0.0031754032258064515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:15.325071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8917391072476135, "overlap_percentage": 0.9427717636445647, "num_intersection": 1738984, "num_union": 1950104, "num_only_computed": 200472, "num_only_roped": 10648, "total_diff": 211120, "diff_percentage": 0.10826089275238654, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:15.711117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.3478946685791016e-06, "l2_diff": 0.130859375, "l2_diff_relative": 0.014744718309859154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:30.769574", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.910920026631459, "overlap_percentage": 0.9533837250501949, "num_intersection": 2583136, "num_union": 2835744, "num_only_computed": 194976, "num_only_roped": 57632, "total_diff": 252608, "diff_percentage": 0.08907997336854102, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:31.321215", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 4.559755325317383e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.013854166666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:53.036734", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9047308448397784, "overlap_percentage": 0.9499828779387276, "num_intersection": 3395558, "num_union": 3753114, "num_only_computed": 221210, "num_only_roped": 136346, "total_diff": 357556, "diff_percentage": 0.09526915516022162, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:13:55.824716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.0961971282958984e-06, "l2_diff": 0.236328125, "l2_diff_relative": 0.023781446540880505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:14:23.614202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.884404056359882, "overlap_percentage": 0.9386564981910431, "num_intersection": 4167755, "num_union": 4712501, "num_only_computed": 288693, "num_only_roped": 256053, "total_diff": 544746, "diff_percentage": 0.11559594364011806, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:14:25.294464", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.0171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:14:58.060608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8582001298940825, "overlap_percentage": 0.9236896673158664, "num_intersection": 4890444, "num_union": 5698489, "num_only_computed": 404660, "num_only_roped": 403385, "total_diff": 808045, "diff_percentage": 0.14179987010591755, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:14:59.184012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.6971101760864258e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.01466181506849315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:15:38.786821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8296162144821251, "overlap_percentage": 0.9068745761164441, "num_intersection": 5562551, "num_union": 6704969, "num_only_computed": 571209, "num_only_roped": 571209, "total_diff": 1142418, "diff_percentage": 0.17038378551787486, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:15:40.089477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.771615982055664e-06, "l2_diff": 0.1767578125, "l2_diff_relative": 0.020493659420289856}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:16:25.973168", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8093281233051536, "overlap_percentage": 0.8946173033852254, "num_intersection": 6237644, "num_union": 7707188, "num_only_computed": 734772, "num_only_roped": 734772, "total_diff": 1469544, "diff_percentage": 0.19067187669484642, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:16:29.682014", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.2649765014648438e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.01695736434108527}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:17:23.254608", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7931019126052801, "overlap_percentage": 0.8846144293638568, "num_intersection": 6909787, "num_union": 8712357, "num_only_computed": 901285, "num_only_roped": 901285, "total_diff": 1802570, "diff_percentage": 0.20689808739471993, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:17:26.954495", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 2.586841583251953e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.14642857142857144}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:18:26.925599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7729662949465528, "overlap_percentage": 0.8719469706217448, "num_intersection": 7542997, "num_union": 9758507, "num_only_computed": 1107755, "num_only_roped": 1107755, "total_diff": 2215510, "diff_percentage": 0.22703370505344722, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:18:29.014282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 6.437301635742188e-05, "l2_diff": 3.171875, "l2_diff_relative": 0.49033816425120774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:19:37.330663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7631801057769676, "overlap_percentage": 0.8656859310928564, "num_intersection": 8214847, "num_union": 10763969, "num_only_computed": 1274561, "num_only_roped": 1274561, "total_diff": 2549122, "diff_percentage": 0.2368198942230324, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:19:39.664510", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 6.4849853515625e-05, "l2_diff": 3.3125, "l2_diff_relative": 0.5549738219895288}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:20:55.532603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.758692622434039, "overlap_percentage": 0.8627916132200575, "num_intersection": 8910967, "num_union": 11745161, "num_only_computed": 1417097, "num_only_roped": 1417097, "total_diff": 2834194, "diff_percentage": 0.241307377565961, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:20:58.129888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.3882598876953125e-05, "l2_diff": 3.03125, "l2_diff_relative": 0.46411483253588515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:22:22.270054", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7461270565629878, "overlap_percentage": 0.8546079779917469, "num_intersection": 9543168, "num_union": 12790272, "num_only_computed": 1623552, "num_only_roped": 1623552, "total_diff": 3247104, "diff_percentage": 0.2538729434370121, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:22:25.144729", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.16796875, "mean_diff": 5.650520324707031e-05, "l2_diff": 3.109375, "l2_diff_relative": 0.5718390804597702}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:23:53.343198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.718502162346903, "overlap_percentage": 0.8361958199292199, "num_intersection": 4736469, "num_union": 6592143, "num_only_computed": 927837, "num_only_roped": 927837, "total_diff": 1855674, "diff_percentage": 0.28149783765309705, "num_computed": 5664306, "num_roped": 5664306}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "mask_shape": [1, 32, 501, 13813], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:23:59.010755", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1328125, "mean_diff": 5.459785461425781e-05, "l2_diff": 1.9296875, "l2_diff_relative": 0.4442446043165468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 501, "seq_len_k": 13813, "queries_shape": [1, 32, 501, 128], "keys_shape": [1, 8, 13813, 128], "attention_shape": [1, 32, 501, 13813]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:25:24.826317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7008947336816189, "overlap_percentage": 0.8241482789055604, "num_intersection": 280128, "num_union": 399672, "num_only_computed": 59772, "num_only_roped": 59772, "total_diff": 119544, "diff_percentage": 0.2991052663183811, "num_computed": 339900, "num_roped": 339900}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "mask_shape": [1, 32, 30, 13843], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:25:27.539720", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.1220703125, "l2_diff_relative": 0.09527439024390244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 13843, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 13843, 128], "attention_shape": [1, 32, 30, 13843]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:26:47.586131", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6916990146312332, "overlap_percentage": 0.8177565969464301, "num_intersection": 9266, "num_union": 13396, "num_only_computed": 2065, "num_only_roped": 2065, "total_diff": 4130, "diff_percentage": 0.3083009853687668, "num_computed": 11331, "num_roped": 11331}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "mask_shape": [1, 32, 1, 13844], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:26:50.068407", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012939453125, "mean_diff": 1.4424324035644531e-05, "l2_diff": 0.024658203125, "l2_diff_relative": 0.09421641791044776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13844, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13844, 128], "attention_shape": [1, 32, 1, 13844]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:28:07.587839", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6946313743083595, "overlap_percentage": 0.8198023296858454, "num_intersection": 9290, "num_union": 13374, "num_only_computed": 2042, "num_only_roped": 2042, "total_diff": 4084, "diff_percentage": 0.30536862569164047, "num_computed": 11332, "num_roped": 11332}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "mask_shape": [1, 32, 1, 13845], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:28:10.990760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.019287109375, "mean_diff": 1.2576580047607422e-05, "l2_diff": 0.0238037109375, "l2_diff_relative": 0.08234797297297297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13845, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13845, 128], "attention_shape": [1, 32, 1, 13845]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:29:27.994105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6904602073543671, "overlap_percentage": 0.8168902223791035, "num_intersection": 9257, "num_union": 13407, "num_only_computed": 2075, "num_only_roped": 2075, "total_diff": 4150, "diff_percentage": 0.30953979264563286, "num_computed": 11332, "num_roped": 11332}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "mask_shape": [1, 32, 1, 13846], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:29:31.881264", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 1.1682510375976562e-05, "l2_diff": 0.02490234375, "l2_diff_relative": 0.09239130434782608}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13846, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13846, 128], "attention_shape": [1, 32, 1, 13846]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:30:49.100405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6978277153558052, "overlap_percentage": 0.8220241771816819, "num_intersection": 9316, "num_union": 13350, "num_only_computed": 2017, "num_only_roped": 2017, "total_diff": 4034, "diff_percentage": 0.30217228464419477, "num_computed": 11333, "num_roped": 11333}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "mask_shape": [1, 32, 1, 13847], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:30:51.580999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 1.4424324035644531e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.12679856115107913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13847, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13847, 128], "attention_shape": [1, 32, 1, 13847]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:32:09.368698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6937906299036091, "overlap_percentage": 0.8192165166754897, "num_intersection": 9285, "num_union": 13383, "num_only_computed": 2049, "num_only_roped": 2049, "total_diff": 4098, "diff_percentage": 0.30620937009639093, "num_computed": 11334, "num_roped": 11334}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "mask_shape": [1, 32, 1, 13848], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:32:11.848134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.05126953125, "l2_diff_relative": 0.1875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13848, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13848, 128], "attention_shape": [1, 32, 1, 13848]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:33:29.058958", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6925489024936539, "overlap_percentage": 0.8183502426113807, "num_intersection": 9276, "num_union": 13394, "num_only_computed": 2059, "num_only_roped": 2059, "total_diff": 4118, "diff_percentage": 0.30745109750634614, "num_computed": 11335, "num_roped": 11335}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "mask_shape": [1, 32, 1, 13849], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:33:33.062770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.0311279296875, "l2_diff_relative": 0.12073863636363637}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13849, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13849, 128], "attention_shape": [1, 32, 1, 13849]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:34:49.934931", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7087729876394332, "overlap_percentage": 0.8295695130557516, "num_intersection": 9404, "num_union": 13268, "num_only_computed": 1932, "num_only_roped": 1932, "total_diff": 3864, "diff_percentage": 0.29122701236056675, "num_computed": 11336, "num_roped": 11336}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "mask_shape": [1, 32, 1, 13850], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:34:53.510689", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.1615720524017467}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13850, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13850, 128], "attention_shape": [1, 32, 1, 13850]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:35:40.808976", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:35:40.821542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.2633543014526367e-06, "l2_diff": 0.0289306640625, "l2_diff_relative": 0.003045333059210526}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:35:46.771474", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8914626774453711, "overlap_percentage": 0.942617253912078, "num_intersection": 1738699, "num_union": 1950389, "num_only_computed": 200757, "num_only_roped": 10933, "total_diff": 211690, "diff_percentage": 0.10853732255462885, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:35:47.170677", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.467103958129883e-06, "l2_diff": 0.1279296875, "l2_diff_relative": 0.015745192307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:36:04.582268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9112455608143307, "overlap_percentage": 0.9535619906696586, "num_intersection": 2583619, "num_union": 2835261, "num_only_computed": 194493, "num_only_roped": 57149, "total_diff": 251642, "diff_percentage": 0.08875443918566933, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:36:05.144527", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.066394805908203e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.016255040322580645}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:36:25.775638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9030246142730999, "overlap_percentage": 0.9490414443409909, "num_intersection": 3392193, "num_union": 3756479, "num_only_computed": 224575, "num_only_roped": 139711, "total_diff": 364286, "diff_percentage": 0.0969753857269001, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:36:26.513843", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.245208740234375e-06, "l2_diff": 0.19140625, "l2_diff_relative": 0.025102459016393443}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:36:53.555561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8843652694331238, "overlap_percentage": 0.9386346519739971, "num_intersection": 4167658, "num_union": 4712598, "num_only_computed": 288790, "num_only_roped": 256150, "total_diff": 544940, "diff_percentage": 0.11563473056687627, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:36:54.478041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 3.4868717193603516e-06, "l2_diff": 0.1279296875, "l2_diff_relative": 0.017798913043478262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:37:27.242291", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8572448618063571, "overlap_percentage": 0.9231360704614903, "num_intersection": 4887513, "num_union": 5701420, "num_only_computed": 407591, "num_only_roped": 406316, "total_diff": 813907, "diff_percentage": 0.142755138193643, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:37:29.778582", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 2.9653310775756836e-06, "l2_diff": 0.11181640625, "l2_diff_relative": 0.015693530701754384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:38:09.650193", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8277143469271058, "overlap_percentage": 0.9057371008973288, "num_intersection": 5555574, "num_union": 6711946, "num_only_computed": 578186, "num_only_roped": 578186, "total_diff": 1156372, "diff_percentage": 0.1722856530728942, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:38:11.781323", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.7120113372802734e-06, "l2_diff": 0.14453125, "l2_diff_relative": 0.018800813008130083}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:38:57.494777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8104246402476073, "overlap_percentage": 0.8952867987222793, "num_intersection": 6242312, "num_union": 7702520, "num_only_computed": 730104, "num_only_roped": 730104, "total_diff": 1460208, "diff_percentage": 0.18957535975239273, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:38:59.033708", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.2649765014648438e-06, "l2_diff": 0.126953125, "l2_diff_relative": 0.016057312252964428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:39:51.487599", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7962671057450237, "overlap_percentage": 0.8865798446103172, "num_intersection": 6925139, "num_union": 8697005, "num_only_computed": 885933, "num_only_roped": 885933, "total_diff": 1771866, "diff_percentage": 0.2037328942549763, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:39:53.269094", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 2.8848648071289062e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:40:53.496011", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7797191374152906, "overlap_percentage": 0.8762271765506628, "num_intersection": 7580024, "num_union": 9721480, "num_only_computed": 1070728, "num_only_roped": 1070728, "total_diff": 2141456, "diff_percentage": 0.22028086258470933, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:40:58.268830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 6.008148193359375e-05, "l2_diff": 2.53125, "l2_diff_relative": 0.44021739130434784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:42:06.001091", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7679569210143452, "overlap_percentage": 0.8687507165884321, "num_intersection": 8243930, "num_union": 10734886, "num_only_computed": 1245478, "num_only_roped": 1245478, "total_diff": 2490956, "diff_percentage": 0.23204307898565482, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:42:09.949012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1708984375, "mean_diff": 6.437301635742188e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.5467836257309941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:43:26.267209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7543232300138248, "overlap_percentage": 0.8599592334052152, "num_intersection": 8881714, "num_union": 11774414, "num_only_computed": 1446350, "num_only_roped": 1446350, "total_diff": 2892700, "diff_percentage": 0.2456767699861751, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:43:31.150823", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 5.7697296142578125e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.4567901234567901}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:44:56.166170", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7471320117516231, "overlap_percentage": 0.8552668106659789, "num_intersection": 9550525, "num_union": 12782915, "num_only_computed": 1616195, "num_only_roped": 1616195, "total_diff": 3232390, "diff_percentage": 0.25286798824837686, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:44:59.027274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 5.030632019042969e-05, "l2_diff": 2.140625, "l2_diff_relative": 0.4126506024096386}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:46:30.894418", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7375073982860941, "overlap_percentage": 0.8489257645907966, "num_intersection": 10191673, "num_union": 13819079, "num_only_computed": 1813703, "num_only_roped": 1813703, "total_diff": 3627406, "diff_percentage": 0.2624926017139058, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:46:36.377327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1044921875, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.796875, "l2_diff_relative": 0.33236994219653176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:48:18.970106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7286626494220142, "overlap_percentage": 0.8430362623565051, "num_intersection": 10828848, "num_union": 14861264, "num_only_computed": 2016208, "num_only_roped": 2016208, "total_diff": 4032416, "diff_percentage": 0.2713373505779858, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:48:22.338651", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.671875, "l2_diff_relative": 0.3203592814371258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:50:12.970293", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7279894580966593, "overlap_percentage": 0.8425855316253179, "num_intersection": 11445740, "num_union": 15722398, "num_only_computed": 2138329, "num_only_roped": 2138329, "total_diff": 4276658, "diff_percentage": 0.2720105419033407, "num_computed": 13584069, "num_roped": 13584069}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1017, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:50:17.062279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1025390625, "mean_diff": 4.482269287109375e-05, "l2_diff": 2.1875, "l2_diff_relative": 0.445859872611465}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1017, "seq_len_k": 16377, "queries_shape": [1, 32, 1017, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1017, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:52:06.006219", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6932439856105272, "overlap_percentage": 0.8188353143455184, "num_intersection": 273839, "num_union": 395011, "num_only_computed": 60586, "num_only_roped": 60586, "total_diff": 121172, "diff_percentage": 0.3067560143894727, "num_computed": 334425, "num_roped": 334425}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "mask_shape": [1, 32, 25, 16402], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:52:11.992930", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.1416015625, "l2_diff_relative": 0.11471518987341772}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 25, "seq_len_k": 16402, "queries_shape": [1, 32, 25, 128], "keys_shape": [1, 8, 16402, 128], "attention_shape": [1, 32, 25, 16402]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:53:51.766073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6846744742475759, "overlap_percentage": 0.812827029451338, "num_intersection": 10874, "num_union": 15882, "num_only_computed": 2504, "num_only_roped": 2504, "total_diff": 5008, "diff_percentage": 0.3153255257524241, "num_computed": 13378, "num_roped": 13378}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "mask_shape": [1, 32, 1, 16403], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:53:54.888637", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0068359375, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.0181884765625, "l2_diff_relative": 0.0917487684729064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16403, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16403, 128], "attention_shape": [1, 32, 1, 16403]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:55:30.871480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6861806036927343, "overlap_percentage": 0.8138874355332985, "num_intersection": 10889, "num_union": 15869, "num_only_computed": 2490, "num_only_roped": 2490, "total_diff": 4980, "diff_percentage": 0.31381939630726574, "num_computed": 13379, "num_roped": 13379}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "mask_shape": [1, 32, 1, 16404], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:55:33.990528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.019287109375, "l2_diff_relative": 0.08229166666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16404, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16404, 128], "attention_shape": [1, 32, 1, 16404]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:57:10.091196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6841840266851281, "overlap_percentage": 0.8124813153961136, "num_intersection": 10871, "num_union": 15889, "num_only_computed": 2509, "num_only_roped": 2509, "total_diff": 5018, "diff_percentage": 0.31581597331487193, "num_computed": 13380, "num_roped": 13380}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "mask_shape": [1, 32, 1, 16405], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:57:13.211811", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.1676829268292683}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16405, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16405, 128], "attention_shape": [1, 32, 1, 16405]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:58:50.155258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6858816858816859, "overlap_percentage": 0.8136771300448431, "num_intersection": 10887, "num_union": 15873, "num_only_computed": 2493, "num_only_roped": 2493, "total_diff": 4986, "diff_percentage": 0.31411831411831415, "num_computed": 13380, "num_roped": 13380}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "mask_shape": [1, 32, 1, 16406], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T14:58:53.923299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01373291015625, "mean_diff": 3.1948089599609375e-05, "l2_diff": 0.030517578125, "l2_diff_relative": 0.15782828282828282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16406, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16406, 128], "attention_shape": [1, 32, 1, 16406]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:00:33.428867", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6889870621647207, "overlap_percentage": 0.8158583065540692, "num_intersection": 10917, "num_union": 15845, "num_only_computed": 2464, "num_only_roped": 2464, "total_diff": 4928, "diff_percentage": 0.3110129378352793, "num_computed": 13381, "num_roped": 13381}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "mask_shape": [1, 32, 1, 16407], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:00:36.687182", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.0439453125, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16407, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16407, 128], "attention_shape": [1, 32, 1, 16407]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:02:16.697723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.686983926883076, "overlap_percentage": 0.8144522492900912, "num_intersection": 10899, "num_union": 15865, "num_only_computed": 2483, "num_only_roped": 2483, "total_diff": 4966, "diff_percentage": 0.31301607311692403, "num_computed": 13382, "num_roped": 13382}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "mask_shape": [1, 32, 1, 16408], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:02:19.966774", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.159}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16408, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16408, 128], "attention_shape": [1, 32, 1, 16408]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:03:16.045469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:03:16.057085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.1739473342895508e-06, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.0029779128086419755}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:03:21.989478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8917119456529097, "overlap_percentage": 0.9427565837410222, "num_intersection": 1738956, "num_union": 1950132, "num_only_computed": 200500, "num_only_roped": 10676, "total_diff": 211176, "diff_percentage": 0.10828805434709035, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:03:22.379398", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 6.467103958129883e-06, "l2_diff": 0.140625, "l2_diff_relative": 0.014331210191082803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:03:37.218092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9127499840277075, "overlap_percentage": 0.9543850389748435, "num_intersection": 2585849, "num_union": 2833031, "num_only_computed": 192263, "num_only_roped": 54919, "total_diff": 247182, "diff_percentage": 0.08725001597229257, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:03:37.754930", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 4.678964614868164e-06, "l2_diff": 0.1474609375, "l2_diff_relative": 0.015124198717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:03:59.358172", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9076713040141391, "overlap_percentage": 0.9516013603645544, "num_intersection": 3401343, "num_union": 3747329, "num_only_computed": 215425, "num_only_roped": 130561, "total_diff": 345986, "diff_percentage": 0.09232869598586087, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:04:02.539493", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.692243576049805e-06, "l2_diff": 0.2255859375, "l2_diff_relative": 0.028645833333333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:04:29.691332", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8890407735994592, "overlap_percentage": 0.9412616032690949, "num_intersection": 4179322, "num_union": 4700934, "num_only_computed": 277126, "num_only_roped": 244486, "total_diff": 521612, "diff_percentage": 0.11095922640054083, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:04:31.249100", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.5017728805541992e-06, "l2_diff": 0.1572265625, "l2_diff_relative": 0.018229166666666668}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:05:04.082830", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8640206876095267, "overlap_percentage": 0.9270505347422635, "num_intersection": 4908238, "num_union": 5680695, "num_only_computed": 386866, "num_only_roped": 385591, "total_diff": 772457, "diff_percentage": 0.13597931239047334, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:05:05.208394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.652406692504883e-06, "l2_diff": 0.1259765625, "l2_diff_relative": 0.013900862068965517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:05:44.643361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.834465463729832, "overlap_percentage": 0.9097641577107679, "num_intersection": 5580275, "num_union": 6687245, "num_only_computed": 553485, "num_only_roped": 553485, "total_diff": 1106970, "diff_percentage": 0.16553453627016806, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:05:46.947602", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.294778823852539e-06, "l2_diff": 0.1611328125, "l2_diff_relative": 0.01685049019607843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:06:33.183656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8103404987071067, "overlap_percentage": 0.8952354535357615, "num_intersection": 6241954, "num_union": 7702878, "num_only_computed": 730462, "num_only_roped": 730462, "total_diff": 1460924, "diff_percentage": 0.18965950129289338, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:06:36.919819", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.339482307434082e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.017930327868852458}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:07:30.272552", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7850606585946988, "overlap_percentage": 0.8795898949593602, "num_intersection": 6870540, "num_union": 8751604, "num_only_computed": 940532, "num_only_roped": 940532, "total_diff": 1881064, "diff_percentage": 0.21493934140530124, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:07:34.195597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 2.682209014892578e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.1525974025974026}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:08:34.260138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7707479849002101, "overlap_percentage": 0.870533798680161, "num_intersection": 7530772, "num_union": 9770732, "num_only_computed": 1119980, "num_only_roped": 1119980, "total_diff": 2239960, "diff_percentage": 0.22925201509978987, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:08:36.313051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 2.453125, "l2_diff_relative": 0.4067357512953368}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:09:44.533096", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7632533291612169, "overlap_percentage": 0.8657330362441998, "num_intersection": 8215294, "num_union": 10763522, "num_only_computed": 1274114, "num_only_roped": 1274114, "total_diff": 2548228, "diff_percentage": 0.23674667083878306, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:09:46.867084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 5.125999450683594e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.42134831460674155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:11:02.369968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.75546810563848, "overlap_percentage": 0.8607027415786734, "num_intersection": 8889393, "num_union": 11766735, "num_only_computed": 1438671, "num_only_roped": 1438671, "total_diff": 2877342, "diff_percentage": 0.24453189436152, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:11:04.968990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1572265625, "mean_diff": 5.2928924560546875e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.45027624309392267}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:12:28.636113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7492539010851771, "overlap_percentage": 0.8566554010488309, "num_intersection": 9566031, "num_union": 12767409, "num_only_computed": 1600689, "num_only_roped": 1600689, "total_diff": 3201378, "diff_percentage": 0.2507460989148229, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:12:31.474253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11962890625, "mean_diff": 4.363059997558594e-05, "l2_diff": 2.375, "l2_diff_relative": 0.35023041474654376}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:14:04.112994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7433553449557255, "overlap_percentage": 0.8527869514457523, "num_intersection": 10238028, "num_union": 13772724, "num_only_computed": 1767348, "num_only_roped": 1767348, "total_diff": 3534696, "diff_percentage": 0.2566446550442745, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:14:07.313746", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.130859375, "mean_diff": 4.029273986816406e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.351010101010101}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:15:50.300447", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7403004752171521, "overlap_percentage": 0.850773169069874, "num_intersection": 10928229, "num_union": 14761883, "num_only_computed": 1916827, "num_only_roped": 1916827, "total_diff": 3833654, "diff_percentage": 0.2596995247828478, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:15:55.567326", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0947265625, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.7890625, "l2_diff_relative": 0.3029100529100529}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:17:38.678442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7036775215825292, "overlap_percentage": 0.826068915822626, "num_intersection": 1632484, "num_union": 2319932, "num_only_computed": 343724, "num_only_roped": 343724, "total_diff": 687448, "diff_percentage": 0.29632247841747084, "num_computed": 1976208, "num_roped": 1976208}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "mask_shape": [1, 32, 156, 15516], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:17:41.914287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08984375, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.54296875, "l2_diff_relative": 0.1800518134715026}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 156, "seq_len_k": 15516, "queries_shape": [1, 32, 156, 128], "keys_shape": [1, 8, 15516, 128], "attention_shape": [1, 32, 156, 15516]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:19:22.070666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7006185935371491, "overlap_percentage": 0.8239573484609728, "num_intersection": 313730, "num_union": 447790, "num_only_computed": 67030, "num_only_roped": 67030, "total_diff": 134060, "diff_percentage": 0.2993814064628509, "num_computed": 380760, "num_roped": 380760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "mask_shape": [1, 32, 30, 15546], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:19:25.268344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.1513671875, "l2_diff_relative": 0.11814024390243902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 30, "seq_len_k": 15546, "queries_shape": [1, 32, 30, 128], "keys_shape": [1, 8, 15546, 128], "attention_shape": [1, 32, 30, 15546]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:20:58.940317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7012464817048653, "overlap_percentage": 0.8243913968329, "num_intersection": 10464, "num_union": 14922, "num_only_computed": 2229, "num_only_roped": 2229, "total_diff": 4458, "diff_percentage": 0.2987535182951347, "num_computed": 12693, "num_roped": 12693}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "mask_shape": [1, 32, 1, 15547], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:21:02.533926", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.0216064453125, "l2_diff_relative": 0.10243055555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15547, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15547, 128], "attention_shape": [1, 32, 1, 15547]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:22:33.385803", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7083641746854182, "overlap_percentage": 0.8292894280762565, "num_intersection": 10527, "num_union": 14861, "num_only_computed": 2167, "num_only_roped": 2167, "total_diff": 4334, "diff_percentage": 0.29163582531458176, "num_computed": 12694, "num_roped": 12694}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "mask_shape": [1, 32, 1, 15548], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:22:36.285325", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.5735626220703125e-05, "l2_diff": 0.021240234375, "l2_diff_relative": 0.07552083333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15548, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15548, 128], "attention_shape": [1, 32, 1, 15548]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:23:27.640292", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:23:27.651828", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.3080577850341797e-06, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.0030976313694267518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:23:33.638231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8912280180105823, "overlap_percentage": 0.9424860561743174, "num_intersection": 1738457, "num_union": 1950631, "num_only_computed": 200999, "num_only_roped": 11175, "total_diff": 212174, "diff_percentage": 0.10877198198941779, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:23:34.024232", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.467103958129883e-06, "l2_diff": 0.1357421875, "l2_diff_relative": 0.01585310218978102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:23:48.960617", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9130106314063358, "overlap_percentage": 0.9545275038384315, "num_intersection": 2586235, "num_union": 2832645, "num_only_computed": 191877, "num_only_roped": 54533, "total_diff": 246410, "diff_percentage": 0.08698936859366423, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:23:52.115273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.245208740234375e-06, "l2_diff": 0.146484375, "l2_diff_relative": 0.01775568181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:24:12.844007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9066145410766399, "overlap_percentage": 0.9510202734158176, "num_intersection": 3399266, "num_union": 3749406, "num_only_computed": 217502, "num_only_roped": 132638, "total_diff": 350140, "diff_percentage": 0.09338545892336013, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:24:13.584638", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.632638931274414e-06, "l2_diff": 0.224609375, "l2_diff_relative": 0.02743320610687023}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:24:40.743813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8874592364129701, "overlap_percentage": 0.9403744666820416, "num_intersection": 4175383, "num_union": 4704873, "num_only_computed": 281065, "num_only_roped": 248425, "total_diff": 529490, "diff_percentage": 0.11254076358702987, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:24:41.679169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 3.5315752029418945e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.017857142857142856}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:25:15.069256", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8647133044587693, "overlap_percentage": 0.9274490640369526, "num_intersection": 4910348, "num_union": 5678585, "num_only_computed": 384756, "num_only_roped": 383481, "total_diff": 768237, "diff_percentage": 0.1352866955412308, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:25:17.129477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.6226043701171875e-06, "l2_diff": 0.1337890625, "l2_diff_relative": 0.016094924812030075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:25:56.742682", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8412296076742715, "overlap_percentage": 0.9137693682178631, "num_intersection": 5604842, "num_union": 6662678, "num_only_computed": 528918, "num_only_roped": 528918, "total_diff": 1057836, "diff_percentage": 0.15877039232572848, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:25:58.960784", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.5331974029541016e-06, "l2_diff": 0.1708984375, "l2_diff_relative": 0.01810844370860927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:26:45.283081", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.816880712429073, "overlap_percentage": 0.8992122673116464, "num_intersection": 6269682, "num_union": 7675150, "num_only_computed": 702734, "num_only_roped": 702734, "total_diff": 1405468, "diff_percentage": 0.18311928757092696, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:26:46.841473", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.0563602447509766e-06, "l2_diff": 0.154296875, "l2_diff_relative": 0.017025862068965517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:27:39.758357", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7844542592458483, "overlap_percentage": 0.8792091533658888, "num_intersection": 6867566, "num_union": 8754578, "num_only_computed": 943506, "num_only_roped": 943506, "total_diff": 1887012, "diff_percentage": 0.21554574075415173, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:27:41.539199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0927734375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.18813131313131312}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:28:42.195991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7672165296580059, "overlap_percentage": 0.8682767694646661, "num_intersection": 7511247, "num_union": 9790257, "num_only_computed": 1139505, "num_only_roped": 1139505, "total_diff": 2279010, "diff_percentage": 0.2327834703419941, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:28:45.155388", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.146484375, "mean_diff": 5.0067901611328125e-05, "l2_diff": 2.09375, "l2_diff_relative": 0.3383838383838384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:29:53.694069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7576502843070193, "overlap_percentage": 0.862117215320492, "num_intersection": 8180982, "num_union": 10797834, "num_only_computed": 1308426, "num_only_roped": 1308426, "total_diff": 2616852, "diff_percentage": 0.24234971569298064, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:29:57.628887", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.162109375, "mean_diff": 4.887580871582031e-05, "l2_diff": 2.609375, "l2_diff_relative": 0.3883720930232558}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:31:14.185759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.748738276558671, "overlap_percentage": 0.8563182799796748, "num_intersection": 8844110, "num_union": 11812018, "num_only_computed": 1483954, "num_only_roped": 1483954, "total_diff": 2967908, "diff_percentage": 0.25126172344132897, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:31:19.009477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1416015625, "mean_diff": 6.151199340820312e-05, "l2_diff": 3.0625, "l2_diff_relative": 0.5568181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:32:43.922213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7397315368172304, "overlap_percentage": 0.8503973413858322, "num_intersection": 9496149, "num_union": 12837291, "num_only_computed": 1670571, "num_only_roped": 1670571, "total_diff": 3341142, "diff_percentage": 0.26026846318276964, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:32:46.799444", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.138671875, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.42142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:34:11.480557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6958273433121701, "overlap_percentage": 0.8206346548854783, "num_intersection": 656813, "num_union": 943931, "num_only_computed": 143559, "num_only_roped": 143559, "total_diff": 287118, "diff_percentage": 0.30417265668782995, "num_computed": 800372, "num_roped": 800372}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "mask_shape": [1, 32, 73, 13385], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:34:14.173511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.341796875, "l2_diff_relative": 0.16084558823529413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 73, "seq_len_k": 13385, "queries_shape": [1, 32, 73, 128], "keys_shape": [1, 8, 13385, 128], "attention_shape": [1, 32, 73, 13385]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:35:35.005981", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6901162567190775, "overlap_percentage": 0.8166494511552232, "num_intersection": 305177, "num_union": 442211, "num_only_computed": 68517, "num_only_roped": 68517, "total_diff": 137034, "diff_percentage": 0.30988374328092244, "num_computed": 373694, "num_roped": 373694}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "mask_shape": [1, 32, 34, 13419], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:35:37.590874", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 2.9802322387695312e-05, "l2_diff": 0.154296875, "l2_diff_relative": 0.11285714285714285}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 34, "seq_len_k": 13419, "queries_shape": [1, 32, 34, 128], "keys_shape": [1, 8, 13419, 128], "attention_shape": [1, 32, 34, 13419]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:36:55.310993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6891279293123319, "overlap_percentage": 0.8159570596797671, "num_intersection": 8969, "num_union": 13015, "num_only_computed": 2023, "num_only_roped": 2023, "total_diff": 4046, "diff_percentage": 0.3108720706876681, "num_computed": 10992, "num_roped": 10992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "mask_shape": [1, 32, 1, 13420], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:36:57.950291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0040283203125, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.01312255859375, "l2_diff_relative": 0.06619458128078817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13420, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13420, 128], "attention_shape": [1, 32, 1, 13420]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:38:12.311721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6972130008492241, "overlap_percentage": 0.8215975254730713, "num_intersection": 9031, "num_union": 12953, "num_only_computed": 1961, "num_only_roped": 1961, "total_diff": 3922, "diff_percentage": 0.3027869991507759, "num_computed": 10992, "num_roped": 10992}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "mask_shape": [1, 32, 1, 13421], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:38:14.733000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015380859375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.021728515625, "l2_diff_relative": 0.12027027027027028}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13421, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13421, 128], "attention_shape": [1, 32, 1, 13421]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:39:29.660030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6969743748070392, "overlap_percentage": 0.8214318202492495, "num_intersection": 9030, "num_union": 12956, "num_only_computed": 1963, "num_only_roped": 1963, "total_diff": 3926, "diff_percentage": 0.3030256251929608, "num_computed": 10993, "num_roped": 10993}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "mask_shape": [1, 32, 1, 13422], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:39:32.093504", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017333984375, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.1795774647887324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13422, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13422, 128], "attention_shape": [1, 32, 1, 13422]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:40:46.840007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.697783954906957, "overlap_percentage": 0.8219938148080771, "num_intersection": 9037, "num_union": 12951, "num_only_computed": 1957, "num_only_roped": 1957, "total_diff": 3914, "diff_percentage": 0.302216045093043, "num_computed": 10994, "num_roped": 10994}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "mask_shape": [1, 32, 1, 13423], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:40:49.258450", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0096435546875, "mean_diff": 4.267692565917969e-05, "l2_diff": 0.0272216796875, "l2_diff_relative": 0.16691616766467066}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13423, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13423, 128], "attention_shape": [1, 32, 1, 13423]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:42:04.864797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6928406466512702, "overlap_percentage": 0.8185538881309686, "num_intersection": 9000, "num_union": 12990, "num_only_computed": 1995, "num_only_roped": 1995, "total_diff": 3990, "diff_percentage": 0.3071593533487298, "num_computed": 10995, "num_roped": 10995}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "mask_shape": [1, 32, 1, 13424], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:42:07.284674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.9311904907226562e-05, "l2_diff": 0.018798828125, "l2_diff_relative": 0.07403846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 13424, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 13424, 128], "attention_shape": [1, 32, 1, 13424]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:42:50.367922", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:42:50.380515", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.0032252261513157896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:42:56.395566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8912929798765895, "overlap_percentage": 0.942522379514937, "num_intersection": 1738524, "num_union": 1950564, "num_only_computed": 200932, "num_only_roped": 11108, "total_diff": 212040, "diff_percentage": 0.10870702012341046, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:42:58.991110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 6.616115570068359e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.016077898550724636}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:43:13.872121", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9116049229414603, "overlap_percentage": 0.9537587102869965, "num_intersection": 2584152, "num_union": 2834728, "num_only_computed": 193960, "num_only_roped": 56616, "total_diff": 250576, "diff_percentage": 0.08839507705853966, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:43:14.421386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 5.066394805908203e-06, "l2_diff": 0.1376953125, "l2_diff_relative": 0.016319444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:43:34.987748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9047191722551029, "overlap_percentage": 0.9499764431771384, "num_intersection": 3395535, "num_union": 3753137, "num_only_computed": 221233, "num_only_roped": 136369, "total_diff": 357602, "diff_percentage": 0.09528082774489713, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:43:35.722269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.334615707397461e-06, "l2_diff": 0.2275390625, "l2_diff_relative": 0.024598817567567568}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:44:02.166172", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8872406234685207, "overlap_percentage": 0.9402517224728656, "num_intersection": 4174838, "num_union": 4705418, "num_only_computed": 281610, "num_only_roped": 248970, "total_diff": 530580, "diff_percentage": 0.11275937653147924, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:44:03.088777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 3.337860107421875e-06, "l2_diff": 0.1669921875, "l2_diff_relative": 0.01769453642384106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:44:35.837929", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8600250698326231, "overlap_percentage": 0.9247456755085711, "num_intersection": 4896035, "num_union": 5692898, "num_only_computed": 399069, "num_only_roped": 397794, "total_diff": 796863, "diff_percentage": 0.13997493016737697, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:44:38.239303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01123046875, "mean_diff": 2.8908252716064453e-06, "l2_diff": 0.138671875, "l2_diff_relative": 0.01655783582089552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:45:18.072038", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.829584561567825, "overlap_percentage": 0.9068556643885642, "num_intersection": 5562435, "num_union": 6705085, "num_only_computed": 571325, "num_only_roped": 571325, "total_diff": 1142650, "diff_percentage": 0.170415438432175, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:45:20.289250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.8014183044433594e-06, "l2_diff": 0.171875, "l2_diff_relative": 0.020072992700729927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:46:06.294338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.808702708080167, "overlap_percentage": 0.8942350829325157, "num_intersection": 6234979, "num_union": 7709853, "num_only_computed": 737437, "num_only_roped": 737437, "total_diff": 1474874, "diff_percentage": 0.19129729191983297, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:46:07.847546", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 2.2649765014648438e-06, "l2_diff": 0.1484375, "l2_diff_relative": 0.017335766423357664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:47:00.884747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7886034881682714, "overlap_percentage": 0.8818091806092685, "num_intersection": 6887875, "num_union": 8734269, "num_only_computed": 923197, "num_only_roped": 923197, "total_diff": 1846394, "diff_percentage": 0.21139651183172856, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:47:02.691327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0849609375, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.19617224880382775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:48:02.938329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7743827453919543, "overlap_percentage": 0.8728474703702059, "num_intersection": 7550787, "num_union": 9750717, "num_only_computed": 1099965, "num_only_roped": 1099965, "total_diff": 2199930, "diff_percentage": 0.22561725460804574, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:48:06.028021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.14453125, "mean_diff": 7.343292236328125e-05, "l2_diff": 2.921875, "l2_diff_relative": 0.62751677852349}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:49:14.609740", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7611656563150125, "overlap_percentage": 0.8643884845082012, "num_intersection": 8202535, "num_union": 10776281, "num_only_computed": 1286873, "num_only_roped": 1286873, "total_diff": 2573746, "diff_percentage": 0.23883434368498743, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:49:18.553957", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1357421875, "mean_diff": 6.198883056640625e-05, "l2_diff": 2.71875, "l2_diff_relative": 0.5403726708074534}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:50:35.017958", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.753410368825073, "overlap_percentage": 0.8593657049375372, "num_intersection": 8875584, "num_union": 11780544, "num_only_computed": 1452480, "num_only_roped": 1452480, "total_diff": 2904960, "diff_percentage": 0.24658963117492708, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:50:40.139304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1455078125, "mean_diff": 6.628036499023438e-05, "l2_diff": 2.9375, "l2_diff_relative": 0.6308724832214765}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:52:05.034444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7446214488985893, "overlap_percentage": 0.8536195051008711, "num_intersection": 9532130, "num_union": 12801310, "num_only_computed": 1634590, "num_only_roped": 1634590, "total_diff": 3269180, "diff_percentage": 0.2553785511014107, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:52:07.901847", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 5.626678466796875e-05, "l2_diff": 2.765625, "l2_diff_relative": 0.5057142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:53:40.239075", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.737279098061305, "overlap_percentage": 0.848774499024437, "num_intersection": 10189857, "num_union": 13820895, "num_only_computed": 1815519, "num_only_roped": 1815519, "total_diff": 3631038, "diff_percentage": 0.262720901938695, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:53:45.564441", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.140625, "mean_diff": 4.839897155761719e-05, "l2_diff": 2.6875, "l2_diff_relative": 0.47513812154696133}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:55:27.127434", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.732088886719386, "overlap_percentage": 0.8453248471629863, "num_intersection": 10858245, "num_union": 14831867, "num_only_computed": 1986811, "num_only_roped": 1986811, "total_diff": 3973622, "diff_percentage": 0.26791111328061396, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:55:30.489294", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 3.7670135498046875e-05, "l2_diff": 2.34375, "l2_diff_relative": 0.3472222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:57:16.834541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7186041441444151, "overlap_percentage": 0.8362648799525185, "num_intersection": 7168971, "num_union": 9976245, "num_only_computed": 1403637, "num_only_roped": 1403637, "total_diff": 2807274, "diff_percentage": 0.28139585585558496, "num_computed": 8572608, "num_roped": 8572608}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "mask_shape": [1, 32, 656, 16016], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:57:20.286777", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 3.4809112548828125e-05, "l2_diff": 1.515625, "l2_diff_relative": 0.3108974358974359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 656, "seq_len_k": 16016, "queries_shape": [1, 32, 656, 128], "keys_shape": [1, 8, 16016, 128], "attention_shape": [1, 32, 656, 16016]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:59:06.353236", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6863760942101151, "overlap_percentage": 0.8140249337815811, "num_intersection": 255695, "num_union": 372529, "num_only_computed": 58417, "num_only_roped": 58417, "total_diff": 116834, "diff_percentage": 0.3136239057898848, "num_computed": 314112, "num_roped": 314112}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "mask_shape": [1, 32, 24, 16040], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T15:59:09.629186", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.197265625, "l2_diff_relative": 0.1558641975308642}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 24, "seq_len_k": 16040, "queries_shape": [1, 32, 24, 128], "keys_shape": [1, 8, 16040, 128], "attention_shape": [1, 32, 24, 16040]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:00:46.674960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6894281657415774, "overlap_percentage": 0.8161674816625917, "num_intersection": 10682, "num_union": 15494, "num_only_computed": 2406, "num_only_roped": 2406, "total_diff": 4812, "diff_percentage": 0.3105718342584226, "num_computed": 13088, "num_roped": 13088}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "mask_shape": [1, 32, 1, 16041], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:00:49.763536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.018798828125, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.19328703703703703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16041, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16041, 128], "attention_shape": [1, 32, 1, 16041]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:02:23.039260", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6833644138640602, "overlap_percentage": 0.8119031247612499, "num_intersection": 10627, "num_union": 15551, "num_only_computed": 2462, "num_only_roped": 2462, "total_diff": 4924, "diff_percentage": 0.3166355861359398, "num_computed": 13089, "num_roped": 13089}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "mask_shape": [1, 32, 1, 16042], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:02:26.049128", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.029052734375, "l2_diff_relative": 0.11442307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16042, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16042, 128], "attention_shape": [1, 32, 1, 16042]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:03:59.206583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6823030458809921, "overlap_percentage": 0.811153552330023, "num_intersection": 10618, "num_union": 15562, "num_only_computed": 2472, "num_only_roped": 2472, "total_diff": 4944, "diff_percentage": 0.31769695411900783, "num_computed": 13090, "num_roped": 13090}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "mask_shape": [1, 32, 1, 16043], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:04:02.214559", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0098876953125, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.02197265625, "l2_diff_relative": 0.07922535211267606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16043, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16043, 128], "attention_shape": [1, 32, 1, 16043]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:05:35.111457", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.687201959015337, "overlap_percentage": 0.8146054541287908, "num_intersection": 10664, "num_union": 15518, "num_only_computed": 2427, "num_only_roped": 2427, "total_diff": 4854, "diff_percentage": 0.31279804098466296, "num_computed": 13091, "num_roped": 13091}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16044, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16044, 128], "mask_shape": [1, 32, 1, 16044], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:05:38.107470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.8967857360839844e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.12406015037593984}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16044, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16044, 128], "attention_shape": [1, 32, 1, 16044]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:07:10.587954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6793227296049256, "overlap_percentage": 0.8090436908035441, "num_intersection": 10592, "num_union": 15592, "num_only_computed": 2500, "num_only_roped": 2500, "total_diff": 5000, "diff_percentage": 0.3206772703950744, "num_computed": 13092, "num_roped": 13092}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16045, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16045, 128], "mask_shape": [1, 32, 1, 16045], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:07:15.274730", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.0238037109375, "l2_diff_relative": 0.09989754098360656}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16045, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16045, 128], "attention_shape": [1, 32, 1, 16045]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:08:48.113683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6824519694146373, "overlap_percentage": 0.811258783990223, "num_intersection": 10621, "num_union": 15563, "num_only_computed": 2471, "num_only_roped": 2471, "total_diff": 4942, "diff_percentage": 0.31754803058536274, "num_computed": 13092, "num_roped": 13092}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16046, 128], "mask_shape": [1, 32, 1, 16046], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:08:53.727812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 3.838539123535156e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.17738589211618258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16046, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16046, 128], "attention_shape": [1, 32, 1, 16046]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:10:26.598192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6925861288863034, "overlap_percentage": 0.8183762315741235, "num_intersection": 10715, "num_union": 15471, "num_only_computed": 2378, "num_only_roped": 2378, "total_diff": 4756, "diff_percentage": 0.3074138711136966, "num_computed": 13093, "num_roped": 13093}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16047, 128], "mask_shape": [1, 32, 1, 16047], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:10:31.956693", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.1419753086419753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16047, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16047, 128], "attention_shape": [1, 32, 1, 16047]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:11:25.123258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:11:25.136999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.471970558166504e-06, "l2_diff": 0.02880859375, "l2_diff_relative": 0.0031788793103448274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:11:31.118980", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8913744309093147, "overlap_percentage": 0.9425679192255647, "num_intersection": 1738608, "num_union": 1950480, "num_only_computed": 200848, "num_only_roped": 11024, "total_diff": 211872, "diff_percentage": 0.10862556909068537, "num_computed": 1939456, "num_roped": 1749632}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:11:31.514878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0078125, "mean_diff": 5.811452865600586e-06, "l2_diff": 0.12353515625, "l2_diff_relative": 0.013538099315068493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:11:47.407540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9102423548074381, "overlap_percentage": 0.953012430612968, "num_intersection": 2582130, "num_union": 2836750, "num_only_computed": 195982, "num_only_roped": 58638, "total_diff": 254620, "diff_percentage": 0.08975764519256191, "num_computed": 2778112, "num_roped": 2640768}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:11:47.967412", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 5.036592483520508e-06, "l2_diff": 0.1396484375, "l2_diff_relative": 0.016674440298507464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:12:08.550864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.9033265945717691, "overlap_percentage": 0.9492081885978263, "num_intersection": 3392789, "num_union": 3755883, "num_only_computed": 223979, "num_only_roped": 139115, "total_diff": 363094, "diff_percentage": 0.09667340542823086, "num_computed": 3616768, "num_roped": 3531904}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:12:09.304712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 5.364418029785156e-06, "l2_diff": 0.2080078125, "l2_diff_relative": 0.024652777777777777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:12:36.005752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8838324107841206, "overlap_percentage": 0.938334435403664, "num_intersection": 4166325, "num_union": 4713931, "num_only_computed": 290123, "num_only_roped": 257483, "total_diff": 547606, "diff_percentage": 0.11616758921587948, "num_computed": 4456448, "num_roped": 4423808}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:12:36.932381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 3.635883331298828e-06, "l2_diff": 0.1572265625, "l2_diff_relative": 0.018362226277372263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:13:09.899441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8551246895550335, "overlap_percentage": 0.9219053515590286, "num_intersection": 4880997, "num_union": 5707936, "num_only_computed": 414107, "num_only_roped": 412832, "total_diff": 826939, "diff_percentage": 0.14487531044496646, "num_computed": 5295104, "num_roped": 5293829}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:13:11.029016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.7865171432495117e-06, "l2_diff": 0.1298828125, "l2_diff_relative": 0.014634683098591549}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:13:50.799071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8239053649269257, "overlap_percentage": 0.9034518794344741, "num_intersection": 5541557, "num_union": 6725963, "num_only_computed": 592203, "num_only_roped": 592203, "total_diff": 1184406, "diff_percentage": 0.1760946350730743, "num_computed": 6133760, "num_roped": 6133760}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:13:52.108829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 2.562999725341797e-06, "l2_diff": 0.13671875, "l2_diff_relative": 0.018776824034334765}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:14:37.845902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.8040985420974551, "overlap_percentage": 0.8914131055863563, "num_intersection": 6215303, "num_union": 7729529, "num_only_computed": 757113, "num_only_roped": 757113, "total_diff": 1514226, "diff_percentage": 0.1959014579025449, "num_computed": 6972416, "num_roped": 6972416}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:14:41.581085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.1904706954956055e-06, "l2_diff": 0.1455078125, "l2_diff_relative": 0.01674910071942446}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:15:35.090838", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7887484841521116, "overlap_percentage": 0.881899821176914, "num_intersection": 6888583, "num_union": 8733561, "num_only_computed": 922489, "num_only_roped": 922489, "total_diff": 1844978, "diff_percentage": 0.2112515158478884, "num_computed": 7811072, "num_roped": 7811072}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:15:38.379966", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 2.7179718017578125e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.1588345864661654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:16:38.351640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7749333893602711, "overlap_percentage": 0.8731971509528883, "num_intersection": 7553812, "num_union": 9747692, "num_only_computed": 1096940, "num_only_roped": 1096940, "total_diff": 2193880, "diff_percentage": 0.22506661063972888, "num_computed": 8650752, "num_roped": 8650752}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:16:40.423740", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1142578125, "mean_diff": 5.316734313964844e-05, "l2_diff": 2.546875, "l2_diff_relative": 0.4075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:17:49.066624", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7608453921191779, "overlap_percentage": 0.8641819384307219, "num_intersection": 8200575, "num_union": 10778241, "num_only_computed": 1288833, "num_only_roped": 1288833, "total_diff": 2577666, "diff_percentage": 0.2391546078808221, "num_computed": 9489408, "num_roped": 9489408}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:17:51.394393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1083984375, "mean_diff": 5.650520324707031e-05, "l2_diff": 2.171875, "l2_diff_relative": 0.4426751592356688}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:19:11.649372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7524186170927117, "overlap_percentage": 0.8587201822142078, "num_intersection": 8868917, "num_union": 11787211, "num_only_computed": 1459147, "num_only_roped": 1459147, "total_diff": 2918294, "diff_percentage": 0.24758138290728823, "num_computed": 10328064, "num_roped": 10328064}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:19:14.349358", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 5.412101745605469e-05, "l2_diff": 2.0625, "l2_diff_relative": 0.4074074074074074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:20:40.990603", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7562160906108811, "overlap_percentage": 0.861187976415635, "num_intersection": 9616645, "num_union": 12716795, "num_only_computed": 1550075, "num_only_roped": 1550075, "total_diff": 3100150, "diff_percentage": 0.24378390938911887, "num_computed": 11166720, "num_roped": 11166720}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:20:46.360919", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 4.38690185546875e-05, "l2_diff": 2.3125, "l2_diff_relative": 0.37755102040816324}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:22:19.029493", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7496590967800796, "overlap_percentage": 0.8569201830913085, "num_intersection": 10287649, "num_union": 13723103, "num_only_computed": 1717727, "num_only_roped": 1717727, "total_diff": 3435454, "diff_percentage": 0.2503409032199205, "num_computed": 12005376, "num_roped": 12005376}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:22:22.467980", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.111328125, "mean_diff": 4.458427429199219e-05, "l2_diff": 2.203125, "l2_diff_relative": 0.4147058823529412}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:24:03.226525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7439612634560722, "overlap_percentage": 0.8531855369100765, "num_intersection": 10959216, "num_union": 14730896, "num_only_computed": 1885840, "num_only_roped": 1885840, "total_diff": 3771680, "diff_percentage": 0.25603873654392784, "num_computed": 12845056, "num_roped": 12845056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:24:06.588852", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10791015625, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.703125, "l2_diff_relative": 0.315028901734104}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:25:49.557036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7217362765645869, "overlap_percentage": 0.8383819129427661, "num_intersection": 2779672, "num_union": 3851368, "num_only_computed": 535848, "num_only_roped": 535848, "total_diff": 1071696, "diff_percentage": 0.27826372343541306, "num_computed": 3315520, "num_roped": 3315520}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "mask_shape": [1, 32, 260, 15620], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:25:55.260023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.107421875, "mean_diff": 2.968311309814453e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.1869747899159664}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 260, "seq_len_k": 15620, "queries_shape": [1, 32, 260, 128], "keys_shape": [1, 8, 15620, 128], "attention_shape": [1, 32, 260, 15620]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:27:33.966020", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7188803660341812, "overlap_percentage": 0.83645189070696, "num_intersection": 288468, "num_union": 401274, "num_only_computed": 56403, "num_only_roped": 56403, "total_diff": 112806, "diff_percentage": 0.28111963396581885, "num_computed": 344871, "num_roped": 344871}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "mask_shape": [1, 32, 27, 15647], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:27:37.103716", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.11767578125, "l2_diff_relative": 0.09975165562913907}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 27, "seq_len_k": 15647, "queries_shape": [1, 32, 27, 128], "keys_shape": [1, 8, 15647, 128], "attention_shape": [1, 32, 27, 15647]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:29:10.703824", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7101546288238838, "overlap_percentage": 0.83051510881478, "num_intersection": 10609, "num_union": 14939, "num_only_computed": 2165, "num_only_roped": 2165, "total_diff": 4330, "diff_percentage": 0.2898453711761162, "num_computed": 12774, "num_roped": 12774}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "mask_shape": [1, 32, 1, 15648], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:29:13.613613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.023681640625, "l2_diff_relative": 0.0885036496350365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15648, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15648, 128], "attention_shape": [1, 32, 1, 15648]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:30:43.241119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7033333333333334, "overlap_percentage": 0.8258317025440313, "num_intersection": 10550, "num_union": 15000, "num_only_computed": 2225, "num_only_roped": 2225, "total_diff": 4450, "diff_percentage": 0.2966666666666667, "num_computed": 12775, "num_roped": 12775}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "mask_shape": [1, 32, 1, 15649], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:30:48.523909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0137939453125, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.09841417910447761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15649, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15649, 128], "attention_shape": [1, 32, 1, 15649]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:32:18.926196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6987102778885786, "overlap_percentage": 0.8226361928616155, "num_intersection": 10510, "num_union": 15042, "num_only_computed": 2266, "num_only_roped": 2266, "total_diff": 4532, "diff_percentage": 0.30128972211142135, "num_computed": 12776, "num_roped": 12776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "mask_shape": [1, 32, 1, 15650], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:32:22.705378", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.9206275939941406e-05, "l2_diff": 0.050537109375, "l2_diff_relative": 0.19903846153846153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15650, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15650, 128], "attention_shape": [1, 32, 1, 15650]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:33:52.692099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7098501070663812, "overlap_percentage": 0.8303068252974327, "num_intersection": 10608, "num_union": 14944, "num_only_computed": 2168, "num_only_roped": 2168, "total_diff": 4336, "diff_percentage": 0.29014989293361887, "num_computed": 12776, "num_roped": 12776}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "mask_shape": [1, 32, 1, 15651], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:33:55.603564", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0223388671875, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.05029296875, "l2_diff_relative": 0.22294372294372294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15651, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15651, 128], "attention_shape": [1, 32, 1, 15651]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:35:27.108099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6987303064548295, "overlap_percentage": 0.8226500743523519, "num_intersection": 10511, "num_union": 15043, "num_only_computed": 2266, "num_only_roped": 2266, "total_diff": 4532, "diff_percentage": 0.3012696935451705, "num_computed": 12777, "num_roped": 12777}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "mask_shape": [1, 32, 1, 15652], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:35:30.018293", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.1455223880597015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15652, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15652, 128], "attention_shape": [1, 32, 1, 15652]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:37:00.660902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.6930109307717788, "overlap_percentage": 0.8186727187353263, "num_intersection": 10461, "num_union": 15095, "num_only_computed": 2317, "num_only_roped": 2317, "total_diff": 4634, "diff_percentage": 0.3069890692282213, "num_computed": 12778, "num_roped": 12778}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "mask_shape": [1, 32, 1, 15653], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-13T16:37:05.135979", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.028076171875, "l2_diff_relative": 0.11546184738955824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 15653, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 15653, 128], "attention_shape": [1, 32, 1, 15653]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
