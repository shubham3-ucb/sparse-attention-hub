{"timestamp": "2025-11-18T19:37:40.436158", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:37:40.480465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.003127937030075188}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:37:46.282007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7171993889508355, "overlap_percentage": 0.8353128862793572, "num_intersection": 1081229, "num_union": 1507571, "num_only_computed": 229491, "num_only_roped": 196851, "total_diff": 426342, "diff_percentage": 0.28280061104916454, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:37:46.651426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.48828125, "l2_diff_relative": 0.07233796296296297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:38:01.251650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5682951082653065, "overlap_percentage": 0.7247298104422433, "num_intersection": 1329885, "num_union": 2340131, "num_only_computed": 505123, "num_only_roped": 505123, "total_diff": 1010246, "diff_percentage": 0.4317048917346935, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:38:01.787470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.11722488038277512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:38:23.344789", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4906454620152654, "overlap_percentage": 0.6582993401421441, "num_intersection": 1553123, "num_union": 3165469, "num_only_computed": 806173, "num_only_roped": 806173, "total_diff": 1612346, "diff_percentage": 0.5093545379847346, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:38:24.079176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.90234375, "l2_diff_relative": 0.14016990291262135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:38:52.409760", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4450929535792133, "overlap_percentage": 0.6160059842196378, "num_intersection": 1776305, "num_union": 3990863, "num_only_computed": 1107279, "num_only_roped": 1107279, "total_diff": 2214558, "diff_percentage": 0.5549070464207867, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:38:53.327422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.1539408866995074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:39:25.444908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42965581673204817, "overlap_percentage": 0.6010618943434495, "num_intersection": 2048342, "num_union": 4767402, "num_only_computed": 1359530, "num_only_roped": 1359530, "total_diff": 2719060, "diff_percentage": 0.5703441832679518, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:39:27.311907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.15875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:40:04.757231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3949953915938983, "overlap_percentage": 0.5663035074869792, "num_intersection": 2226796, "num_union": 5637524, "num_only_computed": 1705364, "num_only_roped": 1705364, "total_diff": 3410728, "diff_percentage": 0.6050046084061017, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:40:08.491275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.21256684491978609}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:40:53.222027", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3781749769180444, "overlap_percentage": 0.548805461210363, "num_intersection": 2445723, "num_union": 6467173, "num_only_computed": 2010725, "num_only_roped": 2010725, "total_diff": 4021450, "diff_percentage": 0.6218250230819556, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:40:54.769470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 3.337860107421875e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.19743589743589743}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:41:46.877848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37738183747940973, "overlap_percentage": 0.5479698181152344, "num_intersection": 2729293, "num_union": 7232179, "num_only_computed": 2251443, "num_only_roped": 2251443, "total_diff": 4502886, "diff_percentage": 0.6226181625205902, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:41:49.790239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06005859375, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.1919191919191919}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:42:48.898304", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3678021279727981, "overlap_percentage": 0.5378001985095796, "num_intersection": 2960603, "num_union": 8049445, "num_only_computed": 2544421, "num_only_roped": 2544421, "total_diff": 5088842, "diff_percentage": 0.6321978720272019, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:42:50.924701", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.1484832763671875e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.19625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:43:56.938565", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3616782940085981, "overlap_percentage": 0.5312242922575577, "num_intersection": 3202917, "num_union": 8855707, "num_only_computed": 2826395, "num_only_roped": 2826395, "total_diff": 5652790, "diff_percentage": 0.6383217059914019, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:43:59.217914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 3.814697265625e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.16304347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:45:12.312567", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36196686336450246, "overlap_percentage": 0.5315354919433594, "num_intersection": 3483471, "num_union": 9623729, "num_only_computed": 3070129, "num_only_roped": 3070129, "total_diff": 6140258, "diff_percentage": 0.6380331366354975, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:45:15.449461", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1748046875, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.953125, "l2_diff_relative": 0.14454976303317535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:46:37.657322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35243136249679824, "overlap_percentage": 0.5211818836353443, "num_intersection": 3688867, "num_union": 10466909, "num_only_computed": 3389021, "num_only_roped": 3389021, "total_diff": 6778042, "diff_percentage": 0.6475686375032017, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:46:41.559458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.17682926829268292}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:48:10.376573", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34708896331393935, "overlap_percentage": 0.5153170618517645, "num_intersection": 3917531, "num_union": 11286821, "num_only_computed": 3684645, "num_only_roped": 3684645, "total_diff": 7369290, "diff_percentage": 0.6529110366860607, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:48:13.418255", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11669921875, "mean_diff": 3.0517578125e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.17574257425742573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:49:50.135616", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3462423412610652, "overlap_percentage": 0.5143833775674144, "num_intersection": 4180118, "num_union": 12072810, "num_only_computed": 3946346, "num_only_roped": 3946346, "total_diff": 7892692, "diff_percentage": 0.6537576587389349, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:49:53.846237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.9087066650390625e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.1875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:51:37.717759", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33508993215743166, "overlap_percentage": 0.5019735735943193, "num_intersection": 3952815, "num_union": 11796281, "num_only_computed": 3921733, "num_only_roped": 3921733, "total_diff": 7843466, "diff_percentage": 0.6649100678425683, "num_computed": 7874548, "num_roped": 7874548}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 937, "seq_len_k": 16297, "queries_shape": [1, 32, 937, 128], "keys_shape": [1, 8, 16297, 128], "mask_shape": [1, 32, 937, 16297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:51:41.182048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.16779891304347827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 937, "seq_len_k": 16297, "queries_shape": [1, 32, 937, 128], "keys_shape": [1, 8, 16297, 128], "attention_shape": [1, 32, 937, 16297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:53:24.034640", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4310219474624298, "overlap_percentage": 0.6023973961080648, "num_intersection": 294641, "num_union": 683587, "num_only_computed": 194473, "num_only_roped": 194473, "total_diff": 388946, "diff_percentage": 0.5689780525375702, "num_computed": 489114, "num_roped": 489114}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16355, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 58, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:53:27.238057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.2734375, "l2_diff_relative": 0.16355140186915887}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16355, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 58, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:54:57.102807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4291281877488774, "overlap_percentage": 0.6005454114299265, "num_intersection": 5065, "num_union": 11803, "num_only_computed": 3369, "num_only_roped": 3369, "total_diff": 6738, "diff_percentage": 0.5708718122511226, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:54:59.833203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.18619791666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:56:16.815910", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.441586189214597, "overlap_percentage": 0.6126393170500356, "num_intersection": 5167, "num_union": 11701, "num_only_computed": 3267, "num_only_roped": 3267, "total_diff": 6534, "diff_percentage": 0.558413810785403, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:56:19.282230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.4199485778808594e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.20875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:57:36.859184", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45921633076723467, "overlap_percentage": 0.6294013040901008, "num_intersection": 5309, "num_union": 11561, "num_only_computed": 3126, "num_only_roped": 3126, "total_diff": 6252, "diff_percentage": 0.5407836692327653, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:57:39.314303", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.7894973754882812e-05, "l2_diff": 0.037841796875, "l2_diff_relative": 0.26182432432432434}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:58:56.887532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3852849400558384, "overlap_percentage": 0.5562537048014227, "num_intersection": 4692, "num_union": 12178, "num_only_computed": 3743, "num_only_roped": 3743, "total_diff": 7486, "diff_percentage": 0.6147150599441616, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T19:58:59.370787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.12226277372262774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:00:18.358113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.459641837529198, "overlap_percentage": 0.629800853485064, "num_intersection": 5313, "num_union": 11559, "num_only_computed": 3123, "num_only_roped": 3123, "total_diff": 6246, "diff_percentage": 0.5403581624708019, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:00:22.565124", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.20295698924731181}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:01:42.323162", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41508009729095025, "overlap_percentage": 0.5866524419155998, "num_intersection": 4949, "num_union": 11923, "num_only_computed": 3487, "num_only_roped": 3487, "total_diff": 6974, "diff_percentage": 0.5849199027090497, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:01:46.402232", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.234472049689441}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:03:05.802377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4428388200085507, "overlap_percentage": 0.6138437833353088, "num_intersection": 5179, "num_union": 11695, "num_only_computed": 3258, "num_only_roped": 3258, "total_diff": 6516, "diff_percentage": 0.5571611799914493, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:03:10.271239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.24157303370786518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:04:29.526945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4685813751087903, "overlap_percentage": 0.6381415194974517, "num_intersection": 5384, "num_union": 11490, "num_only_computed": 3053, "num_only_roped": 3053, "total_diff": 6106, "diff_percentage": 0.5314186248912097, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:04:34.244727", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 2.384185791015625e-05, "l2_diff": 0.055908203125, "l2_diff_relative": 0.2848258706467662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:05:53.689725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40003318400530946, "overlap_percentage": 0.5714624318558901, "num_intersection": 4822, "num_union": 12054, "num_only_computed": 3616, "num_only_roped": 3616, "total_diff": 7232, "diff_percentage": 0.5999668159946906, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:05:57.437399", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2215909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:07:17.024322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36526171021761994, "overlap_percentage": 0.5350794027020621, "num_intersection": 4515, "num_union": 12361, "num_only_computed": 3923, "num_only_roped": 3923, "total_diff": 7846, "diff_percentage": 0.6347382897823801, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:07:20.676672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.16233766233766234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:08:40.854888", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38095238095238093, "overlap_percentage": 0.5517241379310345, "num_intersection": 4656, "num_union": 12222, "num_only_computed": 3783, "num_only_roped": 3783, "total_diff": 7566, "diff_percentage": 0.6190476190476191, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:08:44.515961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 1.4424324035644531e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.13354037267080746}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:10:05.464447", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39142621599340477, "overlap_percentage": 0.5626259035430738, "num_intersection": 4748, "num_union": 12130, "num_only_computed": 3691, "num_only_roped": 3691, "total_diff": 7382, "diff_percentage": 0.6085737840065952, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:10:07.956082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.20689655172413793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:11:27.786609", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42591653995607365, "overlap_percentage": 0.5973933649289099, "num_intersection": 5042, "num_union": 11838, "num_only_computed": 3398, "num_only_roped": 3398, "total_diff": 6796, "diff_percentage": 0.5740834600439263, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:11:31.392347", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.03564453125, "l2_diff_relative": 0.16820276497695852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:12:50.962388", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.502313990744037, "overlap_percentage": 0.6687203791469194, "num_intersection": 5644, "num_union": 11236, "num_only_computed": 2796, "num_only_roped": 2796, "total_diff": 5592, "diff_percentage": 0.49768600925596296, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:12:55.009496", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01123046875, "mean_diff": 2.4199485778808594e-05, "l2_diff": 0.0218505859375, "l2_diff_relative": 0.12570224719101122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:13:40.514890", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:13:40.528544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7848949432373047e-06, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.003181226325757576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:13:46.360174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7192761082517019, "overlap_percentage": 0.8367197156983931, "num_intersection": 1083050, "num_union": 1505750, "num_only_computed": 227670, "num_only_roped": 195030, "total_diff": 422700, "diff_percentage": 0.2807238917482982, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:13:48.363236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.458984375, "l2_diff_relative": 0.06799768518518519}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:14:02.937667", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5712043592810679, "overlap_percentage": 0.7270911080496651, "num_intersection": 1334218, "num_union": 2335798, "num_only_computed": 500790, "num_only_roped": 500790, "total_diff": 1001580, "diff_percentage": 0.42879564071893206, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:14:03.485507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.1171116504854369}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:14:23.862787", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49309585181538057, "overlap_percentage": 0.6605012681749132, "num_intersection": 1558318, "num_union": 3160274, "num_only_computed": 800978, "num_only_roped": 800978, "total_diff": 1601956, "diff_percentage": 0.5069041481846195, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:14:24.594933", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.034912109375, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.14100985221674878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:14:50.140910", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4465497019697786, "overlap_percentage": 0.6173997358842329, "num_intersection": 1780324, "num_union": 3986844, "num_only_computed": 1103260, "num_only_roped": 1103260, "total_diff": 2206520, "diff_percentage": 0.5534502980302214, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:14:51.039626", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.553794860839844e-05, "l2_diff": 1.0, "l2_diff_relative": 0.15841584158415842}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:15:22.359800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4256868382993695, "overlap_percentage": 0.5971673818734976, "num_intersection": 2035070, "num_union": 4780674, "num_only_computed": 1372802, "num_only_roped": 1372802, "total_diff": 2745604, "diff_percentage": 0.5743131617006305, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:15:25.682707", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.16792929292929293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:16:02.645102", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40692229843536354, "overlap_percentage": 0.5784573872884115, "num_intersection": 2274587, "num_union": 5589733, "num_only_computed": 1657573, "num_only_roped": 1657573, "total_diff": 3315146, "diff_percentage": 0.5930777015646365, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:16:03.928863", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.1670854271356784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:16:49.085693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38267051351303555, "overlap_percentage": 0.5535237929400276, "num_intersection": 2466750, "num_union": 6446146, "num_only_computed": 1989698, "num_only_roped": 1989698, "total_diff": 3979396, "diff_percentage": 0.6173294864869645, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:16:50.568987", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.1970899470899471}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:17:42.137003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37942918626396793, "overlap_percentage": 0.5501249212967722, "num_intersection": 2740027, "num_union": 7221445, "num_only_computed": 2240709, "num_only_roped": 2240709, "total_diff": 4481418, "diff_percentage": 0.6205708137360321, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:17:46.248958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.232421875, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.21173469387755103}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:18:43.207472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36239482475360374, "overlap_percentage": 0.5319967724028087, "num_intersection": 2928655, "num_union": 8081393, "num_only_computed": 2576369, "num_only_roped": 2576369, "total_diff": 5152738, "diff_percentage": 0.6376051752463963, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:18:45.182209", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.22883597883597884}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:19:49.388922", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35654146400125725, "overlap_percentage": 0.5256624636442765, "num_intersection": 3169383, "num_union": 8889241, "num_only_computed": 2859929, "num_only_roped": 2859929, "total_diff": 5719858, "diff_percentage": 0.6434585359987427, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:19:51.583372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 3.981590270996094e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.191025641025641}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:21:03.525896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3554557320724661, "overlap_percentage": 0.5244815063476562, "num_intersection": 3437242, "num_union": 9669958, "num_only_computed": 3116358, "num_only_roped": 3116358, "total_diff": 6232716, "diff_percentage": 0.6445442679275339, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:21:06.026081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:22:25.856263", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3533734437656118, "overlap_percentage": 0.5222112867567275, "num_intersection": 3696153, "num_union": 10459623, "num_only_computed": 3381735, "num_only_roped": 3381735, "total_diff": 6763470, "diff_percentage": 0.6466265562343881, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:22:28.651968", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 3.218650817871094e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.19125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:23:55.569387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3434147781040124, "overlap_percentage": 0.5112565139244343, "num_intersection": 3886662, "num_union": 11317690, "num_only_computed": 3715514, "num_only_roped": 3715514, "total_diff": 7431028, "diff_percentage": 0.6565852218959876, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:23:59.030671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 3.4332275390625e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.21045918367346939}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:25:35.674101", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3449916898625592, "overlap_percentage": 0.513001964938256, "num_intersection": 4168892, "num_union": 12084036, "num_only_computed": 3957572, "num_only_roped": 3957572, "total_diff": 7915144, "diff_percentage": 0.6550083101374409, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:25:39.734275", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05712890625, "mean_diff": 3.0517578125e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.18401015228426396}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:27:25.254106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34787689253974735, "overlap_percentage": 0.5161849638719714, "num_intersection": 4046408, "num_union": 11631724, "num_only_computed": 3792658, "num_only_roped": 3792658, "total_diff": 7585316, "diff_percentage": 0.6521231074602527, "num_computed": 7839066, "num_roped": 7839066}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "mask_shape": [1, 32, 933, 16293], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:27:28.760144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 2.8014183044433594e-05, "l2_diff": 0.93359375, "l2_diff_relative": 0.15559895833333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "attention_shape": [1, 32, 933, 16293]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:29:14.155532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4337006045608871, "overlap_percentage": 0.6050086094421654, "num_intersection": 295848, "num_union": 682148, "num_only_computed": 193150, "num_only_roped": 193150, "total_diff": 386300, "diff_percentage": 0.5662993954391129, "num_computed": 488998, "num_roped": 488998}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 58, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:29:18.925315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.271484375, "l2_diff_relative": 0.16391509433962265}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 58, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:30:48.121716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40967984619242664, "overlap_percentage": 0.5812381404174574, "num_intersection": 4901, "num_union": 11963, "num_only_computed": 3531, "num_only_roped": 3531, "total_diff": 7062, "diff_percentage": 0.5903201538075733, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:30:50.554771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.042236328125, "l2_diff_relative": 0.21305418719211822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:32:07.429873", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44668439564210344, "overlap_percentage": 0.6175284629981025, "num_intersection": 5207, "num_union": 11657, "num_only_computed": 3225, "num_only_roped": 3225, "total_diff": 6450, "diff_percentage": 0.5533156043578965, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:32:09.904194", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013916015625, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.2077922077922078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:33:26.846850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47031645017871154, "overlap_percentage": 0.639748606664295, "num_intersection": 5395, "num_union": 11471, "num_only_computed": 3038, "num_only_roped": 3038, "total_diff": 6076, "diff_percentage": 0.5296835498212885, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:33:31.826038", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.2132768361581921}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:34:49.472451", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4232911392405063, "overlap_percentage": 0.5948061188189256, "num_intersection": 5016, "num_union": 11850, "num_only_computed": 3417, "num_only_roped": 3417, "total_diff": 6834, "diff_percentage": 0.5767088607594937, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:34:52.450039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.032958984375, "l2_diff_relative": 0.22804054054054054}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:36:09.617827", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3896852858790575, "overlap_percentage": 0.5608252312070192, "num_intersection": 4730, "num_union": 12138, "num_only_computed": 3704, "num_only_roped": 3704, "total_diff": 7408, "diff_percentage": 0.6103147141209425, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:36:12.071529", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.4603137969970703e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.09827302631578948}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:37:29.491347", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44244911920643065, "overlap_percentage": 0.6134692909651411, "num_intersection": 5174, "num_union": 11694, "num_only_computed": 3260, "num_only_roped": 3260, "total_diff": 6520, "diff_percentage": 0.5575508807935694, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:37:31.909514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.7642974853515625e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.20680628272251309}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:38:48.812854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4257944557133198, "overlap_percentage": 0.5972732661529342, "num_intersection": 5038, "num_union": 11832, "num_only_computed": 3397, "num_only_roped": 3397, "total_diff": 6794, "diff_percentage": 0.5742055442866801, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:38:51.838964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.23676470588235293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:40:08.873557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38985005767012687, "overlap_percentage": 0.5609958506224066, "num_intersection": 4732, "num_union": 12138, "num_only_computed": 3703, "num_only_roped": 3703, "total_diff": 7406, "diff_percentage": 0.6101499423298731, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:40:12.716049", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.027587890625, "l2_diff_relative": 0.1266816143497758}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:41:32.886934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4519793459552496, "overlap_percentage": 0.622569938359412, "num_intersection": 5252, "num_union": 11620, "num_only_computed": 3184, "num_only_roped": 3184, "total_diff": 6368, "diff_percentage": 0.5480206540447504, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:41:35.919801", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.5735626220703125e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.18333333333333332}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:42:56.449047", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4173387096774194, "overlap_percentage": 0.5889046941678521, "num_intersection": 4968, "num_union": 11904, "num_only_computed": 3468, "num_only_roped": 3468, "total_diff": 6936, "diff_percentage": 0.5826612903225806, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:42:59.908507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.2576219512195122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:44:19.491297", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44135987016315026, "overlap_percentage": 0.6124214768282565, "num_intersection": 5167, "num_union": 11707, "num_only_computed": 3270, "num_only_roped": 3270, "total_diff": 6540, "diff_percentage": 0.5586401298368497, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:44:23.095932", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.04736328125, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:45:42.432954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46577484364141764, "overlap_percentage": 0.6355339575678559, "num_intersection": 5362, "num_union": 11512, "num_only_computed": 3075, "num_only_roped": 3075, "total_diff": 6150, "diff_percentage": 0.5342251563585824, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:45:44.975859", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.18636363636363637}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:47:04.679094", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4343022267550569, "overlap_percentage": 0.6055937425930316, "num_intersection": 5110, "num_union": 11766, "num_only_computed": 3328, "num_only_roped": 3328, "total_diff": 6656, "diff_percentage": 0.5656977732449431, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:47:07.199049", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.19617224880382775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:48:27.307445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37169795984719173, "overlap_percentage": 0.5419530694477365, "num_intersection": 4573, "num_union": 12303, "num_only_computed": 3865, "num_only_roped": 3865, "total_diff": 7730, "diff_percentage": 0.6283020401528082, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:48:29.837382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.4126300811767578e-05, "l2_diff": 0.0252685546875, "l2_diff_relative": 0.09512867647058823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:49:49.979284", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44330425859415085, "overlap_percentage": 0.614290792747956, "num_intersection": 5184, "num_union": 11694, "num_only_computed": 3255, "num_only_roped": 3255, "total_diff": 6510, "diff_percentage": 0.5566957414058491, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:49:52.491444", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.5854835510253906e-05, "l2_diff": 0.0245361328125, "l2_diff_relative": 0.10297131147540983}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:50:40.125343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:50:40.139048", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7848949432373047e-06, "l2_diff": 0.0269775390625, "l2_diff_relative": 0.003270004734848485}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:50:46.063968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7175423115964624, "overlap_percentage": 0.8355454264524104, "num_intersection": 1081530, "num_union": 1507270, "num_only_computed": 229190, "num_only_roped": 196550, "total_diff": 425740, "diff_percentage": 0.2824576884035375, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:50:46.452196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.071553738317757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:51:01.236684", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5695479935319508, "overlap_percentage": 0.725747789655413, "num_intersection": 1331753, "num_union": 2338263, "num_only_computed": 503255, "num_only_roped": 503255, "total_diff": 1006510, "diff_percentage": 0.43045200646804915, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:51:01.780712", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 5.555152893066406e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.12009803921568628}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:51:21.833517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4922525189275346, "overlap_percentage": 0.6597442626953125, "num_intersection": 1556532, "num_union": 3162060, "num_only_computed": 802764, "num_only_roped": 802764, "total_diff": 1605528, "diff_percentage": 0.5077474810724654, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:51:22.563377", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.90234375, "l2_diff_relative": 0.14294554455445543}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:51:49.190974", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4465943315321037, "overlap_percentage": 0.6174423911354758, "num_intersection": 1780447, "num_union": 3986721, "num_only_computed": 1103137, "num_only_roped": 1103137, "total_diff": 2206274, "diff_percentage": 0.5534056684678963, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:51:50.092062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.553794860839844e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.15796019900497513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:52:21.993272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42491874250379086, "overlap_percentage": 0.5964111915001502, "num_intersection": 2032493, "num_union": 4783251, "num_only_computed": 1375379, "num_only_roped": 1375379, "total_diff": 2750758, "diff_percentage": 0.5750812574962092, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:52:23.094169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.98828125, "l2_diff_relative": 0.16135204081632654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:53:01.079678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.404138254140111, "overlap_percentage": 0.5756388346354167, "num_intersection": 2263504, "num_union": 5600816, "num_only_computed": 1668656, "num_only_roped": 1668656, "total_diff": 3337312, "diff_percentage": 0.5958617458598889, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:53:02.376222", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.211340206185567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:53:46.393784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37531065595044444, "overlap_percentage": 0.545783099006204, "num_intersection": 2432254, "num_union": 6480642, "num_only_computed": 2024194, "num_only_roped": 2024194, "total_diff": 4048388, "diff_percentage": 0.6246893440495556, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:53:47.925828", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.34375, "l2_diff_relative": 0.22872340425531915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:54:38.805299", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37300681550287074, "overlap_percentage": 0.5433429918791118, "num_intersection": 2706248, "num_union": 7255224, "num_only_computed": 2274488, "num_only_roped": 2274488, "total_diff": 4548976, "diff_percentage": 0.6269931844971293, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:54:40.533475", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.25, "l2_diff_relative": 0.20618556701030927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:55:38.927305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3693219249373578, "overlap_percentage": 0.539423079717727, "num_intersection": 2969537, "num_union": 8040511, "num_only_computed": 2535487, "num_only_roped": 2535487, "total_diff": 5070974, "diff_percentage": 0.6306780750626422, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:55:40.937978", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.2}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:56:46.747990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3654007376269934, "overlap_percentage": 0.535228563391644, "num_intersection": 3227060, "num_union": 8831564, "num_only_computed": 2802252, "num_only_roped": 2802252, "total_diff": 5604504, "diff_percentage": 0.6345992623730067, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:56:48.977877", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.17202970297029702}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:58:01.867336", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36055382113915657, "overlap_percentage": 0.5300103759765625, "num_intersection": 3473476, "num_union": 9633724, "num_only_computed": 3080124, "num_only_roped": 3080124, "total_diff": 6160248, "diff_percentage": 0.6394461788608434, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:58:05.000628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.14553140096618358}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:59:26.076851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35974850210132303, "overlap_percentage": 0.5291397659866898, "num_intersection": 3745192, "num_union": 10410584, "num_only_computed": 3332696, "num_only_roped": 3332696, "total_diff": 6665392, "diff_percentage": 0.640251497898677, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T20:59:30.647004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.9802322387695312e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.14100985221674878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:00:58.111699", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35534085890821815, "overlap_percentage": 0.5243564474171606, "num_intersection": 3986250, "num_union": 11218102, "num_only_computed": 3615926, "num_only_roped": 3615926, "total_diff": 7231852, "diff_percentage": 0.6446591410917818, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:01:01.092390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04833984375, "mean_diff": 3.0517578125e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.17625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:02:39.007793", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3447632232395442, "overlap_percentage": 0.5127493335354713, "num_intersection": 4166839, "num_union": 12086089, "num_only_computed": 3959625, "num_only_roped": 3959625, "total_diff": 7919250, "diff_percentage": 0.6552367767604558, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:02:43.507328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 2.9921531677246094e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.1713197969543147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:04:28.392997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3425655820802653, "overlap_percentage": 0.5103148578402704, "num_intersection": 4036614, "num_union": 11783478, "num_only_computed": 3873432, "num_only_roped": 3873432, "total_diff": 7746864, "diff_percentage": 0.6574344179197348, "num_computed": 7910046, "num_roped": 7910046}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 941, "seq_len_k": 16301, "queries_shape": [1, 32, 941, 128], "keys_shape": [1, 8, 16301, 128], "mask_shape": [1, 32, 941, 16301], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:04:31.864342", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 2.86102294921875e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.16172680412371135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 941, "seq_len_k": 16301, "queries_shape": [1, 32, 941, 128], "keys_shape": [1, 8, 16301, 128], "attention_shape": [1, 32, 941, 16301]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:06:14.979527", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43068114026365967, "overlap_percentage": 0.6020644686548249, "num_intersection": 294548, "num_union": 683912, "num_only_computed": 194682, "num_only_roped": 194682, "total_diff": 389364, "diff_percentage": 0.5693188597363403, "num_computed": 489230, "num_roped": 489230}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16359, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 58, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:06:18.188051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.2890625, "l2_diff_relative": 0.1761904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16359, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 58, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:07:48.013641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43432797755674574, "overlap_percentage": 0.6056187766714083, "num_intersection": 5109, "num_union": 11763, "num_only_computed": 3327, "num_only_roped": 3327, "total_diff": 6654, "diff_percentage": 0.5656720224432543, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:07:53.124773", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.2398190045248869}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:09:11.802709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3849942538171072, "overlap_percentage": 0.555950687529635, "num_intersection": 4690, "num_union": 12182, "num_only_computed": 3746, "num_only_roped": 3746, "total_diff": 7492, "diff_percentage": 0.6150057461828928, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:09:15.997743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.10392441860465117}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:10:35.290638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46361349640038163, "overlap_percentage": 0.6335190233495318, "num_intersection": 5345, "num_union": 11529, "num_only_computed": 3092, "num_only_roped": 3092, "total_diff": 6184, "diff_percentage": 0.5363865035996184, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:10:39.549225", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.21596858638743455}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:11:58.950458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4556590752242926, "overlap_percentage": 0.6260519141875074, "num_intersection": 5282, "num_union": 11592, "num_only_computed": 3155, "num_only_roped": 3155, "total_diff": 6310, "diff_percentage": 0.5443409247757074, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:12:02.441294", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.04443359375, "l2_diff_relative": 0.2556179775280899}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:13:21.378556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4346680268638953, "overlap_percentage": 0.6059492770798768, "num_intersection": 5113, "num_union": 11763, "num_only_computed": 3325, "num_only_roped": 3325, "total_diff": 6650, "diff_percentage": 0.5653319731361047, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:13:25.632324", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0194091796875, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.046630859375, "l2_diff_relative": 0.28422619047619047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:14:44.626022", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37505092479426383, "overlap_percentage": 0.5455084143161887, "num_intersection": 4603, "num_union": 12273, "num_only_computed": 3835, "num_only_roped": 3835, "total_diff": 7670, "diff_percentage": 0.6249490752057362, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:14:49.248700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.17063492063492064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:16:08.149690", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45638105099663473, "overlap_percentage": 0.6267330252399573, "num_intersection": 5289, "num_union": 11589, "num_only_computed": 3150, "num_only_roped": 3150, "total_diff": 6300, "diff_percentage": 0.5436189490033653, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:16:12.046990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.20876288659793815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:17:30.996816", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46028724692853434, "overlap_percentage": 0.6304064462614054, "num_intersection": 5320, "num_union": 11558, "num_only_computed": 3119, "num_only_roped": 3119, "total_diff": 6238, "diff_percentage": 0.5397127530714656, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:17:34.906731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.03076171875, "l2_diff_relative": 0.20588235294117646}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:18:53.515196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.463245492371706, "overlap_percentage": 0.633175355450237, "num_intersection": 5344, "num_union": 11536, "num_only_computed": 3096, "num_only_roped": 3096, "total_diff": 6192, "diff_percentage": 0.536754507628294, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:18:58.698734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0135498046875, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.029541015625, "l2_diff_relative": 0.19145569620253164}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:20:18.155477", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47333507899100985, "overlap_percentage": 0.6425355450236967, "num_intersection": 5423, "num_union": 11457, "num_only_computed": 3017, "num_only_roped": 3017, "total_diff": 6034, "diff_percentage": 0.5266649210089901, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:20:22.343512", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.25170068027210885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:21:45.469380", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4450055636394762, "overlap_percentage": 0.6159222840895628, "num_intersection": 5199, "num_union": 11683, "num_only_computed": 3242, "num_only_roped": 3242, "total_diff": 6484, "diff_percentage": 0.5549944363605238, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:21:48.079111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.21301775147928995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:23:05.451123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43383726855783933, "overlap_percentage": 0.6051415709039213, "num_intersection": 5108, "num_union": 11774, "num_only_computed": 3333, "num_only_roped": 3333, "total_diff": 6666, "diff_percentage": 0.5661627314421607, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:23:08.992533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.2469879518072289}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:24:26.023796", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45627048473348286, "overlap_percentage": 0.6266287609571192, "num_intersection": 5290, "num_union": 11594, "num_only_computed": 3152, "num_only_roped": 3152, "total_diff": 6304, "diff_percentage": 0.5437295152665171, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:24:29.472149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.22023809523809523}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:25:47.338005", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40279162512462613, "overlap_percentage": 0.574271499644634, "num_intersection": 4848, "num_union": 12036, "num_only_computed": 3594, "num_only_roped": 3594, "total_diff": 7188, "diff_percentage": 0.5972083748753739, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:25:49.821259", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.17724867724867724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:27:08.596128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45581515647900683, "overlap_percentage": 0.6261992182873386, "num_intersection": 5287, "num_union": 11599, "num_only_computed": 3156, "num_only_roped": 3156, "total_diff": 6312, "diff_percentage": 0.5441848435209932, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:27:11.164104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.18523316062176165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:28:30.947665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.497782508426468, "overlap_percentage": 0.6646926447945043, "num_intersection": 5612, "num_union": 11274, "num_only_computed": 2831, "num_only_roped": 2831, "total_diff": 5662, "diff_percentage": 0.502217491573532, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "mask_shape": [1, 32, 1, 16375], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:28:33.493359", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012939453125, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.025634765625, "l2_diff_relative": 0.15}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "attention_shape": [1, 32, 1, 16375]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:29:19.560643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:29:19.574274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7848949432373047e-06, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.003205510496183206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:29:28.119755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7168326930359117, "overlap_percentage": 0.8350641223733004, "num_intersection": 1080907, "num_union": 1507893, "num_only_computed": 229813, "num_only_roped": 197173, "total_diff": 426986, "diff_percentage": 0.2831673069640883, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:29:28.507127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.1961669921875e-05, "l2_diff": 0.4921875, "l2_diff_relative": 0.07429245283018868}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:29:44.422396", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.573222245179831, "overlap_percentage": 0.7287237984793526, "num_intersection": 1337214, "num_union": 2332802, "num_only_computed": 497794, "num_only_roped": 497794, "total_diff": 995588, "diff_percentage": 0.42677775482016905, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:29:44.975573", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 5.2928924560546875e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.1181592039800995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:30:05.232798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49255697211533445, "overlap_percentage": 0.6600176493326823, "num_intersection": 1557177, "num_union": 3161415, "num_only_computed": 802119, "num_only_roped": 802119, "total_diff": 1604238, "diff_percentage": 0.5074430278846656, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:30:05.966966", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 5.125999450683594e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.14871794871794872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:30:32.363458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44186409320466025, "overlap_percentage": 0.6129067160866477, "num_intersection": 1767368, "num_union": 3999800, "num_only_computed": 1116216, "num_only_roped": 1116216, "total_diff": 2232432, "diff_percentage": 0.5581359067953398, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:30:33.289019", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 5.078315734863281e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.19010416666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:31:05.481560", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4237201181966036, "overlap_percentage": 0.5952295156625601, "num_intersection": 2028466, "num_union": 4787278, "num_only_computed": 1379406, "num_only_roped": 1379406, "total_diff": 2758812, "diff_percentage": 0.5762798818033964, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:31:06.576839", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.076957702636719e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.17578125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:31:44.549005", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40318547969094776, "overlap_percentage": 0.5746716817220052, "num_intersection": 2259701, "num_union": 5604619, "num_only_computed": 1672459, "num_only_roped": 1672459, "total_diff": 3344918, "diff_percentage": 0.5968145203090522, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:31:45.863738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.18229166666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:32:30.141233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3921109978208281, "overlap_percentage": 0.5633329503676471, "num_intersection": 2510464, "num_union": 6402432, "num_only_computed": 1945984, "num_only_roped": 1945984, "total_diff": 3891968, "diff_percentage": 0.607889002179172, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:32:31.626857", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.170967102050781e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.1933497536945813}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:33:21.733601", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3731710988542608, "overlap_percentage": 0.5435172633120888, "num_intersection": 2707116, "num_union": 7254356, "num_only_computed": 2273620, "num_only_roped": 2273620, "total_diff": 4547240, "diff_percentage": 0.6268289011457392, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:33:23.453327", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.6253204345703125e-05, "l2_diff": 1.3828125, "l2_diff_relative": 0.22692307692307692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:34:21.088188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3700972416366879, "overlap_percentage": 0.5402495974586123, "num_intersection": 2974087, "num_union": 8035961, "num_only_computed": 2530937, "num_only_roped": 2530937, "total_diff": 5061874, "diff_percentage": 0.6299027583633121, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:34:23.090961", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 4.172325134277344e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.2022613065326633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:35:28.498906", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3648366638317985, "overlap_percentage": 0.5346231875212296, "num_intersection": 3223410, "num_union": 8835214, "num_only_computed": 2805902, "num_only_roped": 2805902, "total_diff": 5611804, "diff_percentage": 0.6351633361682014, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:35:30.769322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.19458128078817735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:36:43.064448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3539441246002119, "overlap_percentage": 0.5228341674804687, "num_intersection": 3426446, "num_union": 9680754, "num_only_computed": 3127154, "num_only_roped": 3127154, "total_diff": 6254308, "diff_percentage": 0.646055875399788, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:36:48.008481", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04833984375, "mean_diff": 3.552436828613281e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.17279411764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:38:09.808056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3477881680683022, "overlap_percentage": 0.5160872847945602, "num_intersection": 3652808, "num_union": 10502968, "num_only_computed": 3425080, "num_only_roped": 3425080, "total_diff": 6850160, "diff_percentage": 0.6522118319316977, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:38:13.915463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09423828125, "mean_diff": 3.337860107421875e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1678743961352657}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:39:42.815230", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34976965050528636, "overlap_percentage": 0.5182656912968077, "num_intersection": 3939947, "num_union": 11264405, "num_only_computed": 3662229, "num_only_roped": 3662229, "total_diff": 7324458, "diff_percentage": 0.6502303494947137, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:39:45.860783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 3.218650817871094e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.17067307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:41:24.064097", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3497400038616371, "overlap_percentage": 0.518233145436933, "num_intersection": 4211403, "num_union": 12041525, "num_only_computed": 3915061, "num_only_roped": 3915061, "total_diff": 7830122, "diff_percentage": 0.6502599961383628, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:41:28.903372", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06103515625, "mean_diff": 2.9325485229492188e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:43:14.750408", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3391643855315586, "overlap_percentage": 0.5065313701527883, "num_intersection": 3997695, "num_union": 11786895, "num_only_computed": 3894600, "num_only_roped": 3894600, "total_diff": 7789200, "diff_percentage": 0.6608356144684414, "num_computed": 7892295, "num_roped": 7892295}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 939, "seq_len_k": 16299, "queries_shape": [1, 32, 939, 128], "keys_shape": [1, 8, 16299, 128], "mask_shape": [1, 32, 939, 16299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:43:18.265129", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.7298927307128906e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.16062176165803108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 939, "seq_len_k": 16299, "queries_shape": [1, 32, 939, 128], "keys_shape": [1, 8, 16299, 128], "attention_shape": [1, 32, 939, 16299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:45:03.134520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43807289553677997, "overlap_percentage": 0.6092499161849002, "num_intersection": 298028, "num_union": 680316, "num_only_computed": 191144, "num_only_roped": 191144, "total_diff": 382288, "diff_percentage": 0.56192710446322, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16357, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 58, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:45:08.470786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.283203125, "l2_diff_relative": 0.17261904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16357, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 58, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:46:39.029812", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.423148304369833, "overlap_percentage": 0.594665085951393, "num_intersection": 5016, "num_union": 11854, "num_only_computed": 3419, "num_only_roped": 3419, "total_diff": 6838, "diff_percentage": 0.576851695630167, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:46:41.546106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.23161764705882354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:48:00.449182", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3610326744655103, "overlap_percentage": 0.5305275637225845, "num_intersection": 4475, "num_union": 12395, "num_only_computed": 3960, "num_only_roped": 3960, "total_diff": 7920, "diff_percentage": 0.6389673255344898, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:48:03.006244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.0302734375, "l2_diff_relative": 0.11151079136690648}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:49:21.735218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44824034334763946, "overlap_percentage": 0.6190137505926979, "num_intersection": 5222, "num_union": 11650, "num_only_computed": 3214, "num_only_roped": 3214, "total_diff": 6428, "diff_percentage": 0.5517596566523605, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:49:24.261732", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.1865079365079365}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:50:43.205334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3999336209757717, "overlap_percentage": 0.5713608345187292, "num_intersection": 4820, "num_union": 12052, "num_only_computed": 3616, "num_only_roped": 3616, "total_diff": 7232, "diff_percentage": 0.6000663790242283, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:50:45.723520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.2886473429951691}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:52:04.396089", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4608259025192624, "overlap_percentage": 0.630911461419936, "num_intersection": 5323, "num_union": 11551, "num_only_computed": 3114, "num_only_roped": 3114, "total_diff": 6228, "diff_percentage": 0.5391740974807376, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:52:07.807392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.091796875, "l2_diff_relative": 0.6025641025641025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:53:26.369673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4598148628774115, "overlap_percentage": 0.6299632570819012, "num_intersection": 5315, "num_union": 11559, "num_only_computed": 3122, "num_only_roped": 3122, "total_diff": 6244, "diff_percentage": 0.5401851371225884, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:53:29.709434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.1915137614678899}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:54:47.428694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42101717750084205, "overlap_percentage": 0.5925574780753733, "num_intersection": 5000, "num_union": 11876, "num_only_computed": 3438, "num_only_roped": 3438, "total_diff": 6876, "diff_percentage": 0.578982822499158, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:54:49.872179", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.2526178010471204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:56:07.881495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38464063012799476, "overlap_percentage": 0.55558189144347, "num_intersection": 4688, "num_union": 12188, "num_only_computed": 3750, "num_only_roped": 3750, "total_diff": 7500, "diff_percentage": 0.6153593698720052, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:56:10.333741", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.1296487603305785}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:57:28.015444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42082666891152454, "overlap_percentage": 0.5923687640715725, "num_intersection": 4999, "num_union": 11879, "num_only_computed": 3440, "num_only_roped": 3440, "total_diff": 6880, "diff_percentage": 0.5791733310884755, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:57:30.485399", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 1.4781951904296875e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.13900414937759337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:58:48.724712", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43569241238516504, "overlap_percentage": 0.6069439507050598, "num_intersection": 5122, "num_union": 11756, "num_only_computed": 3317, "num_only_roped": 3317, "total_diff": 6634, "diff_percentage": 0.564307587614835, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T21:58:52.591954", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 1.728534698486328e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.17894736842105263}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:00:13.039639", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44150298889837747, "overlap_percentage": 0.6125592417061612, "num_intersection": 5170, "num_union": 11710, "num_only_computed": 3270, "num_only_roped": 3270, "total_diff": 6540, "diff_percentage": 0.5584970111016225, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:00:16.557370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.14676113360323886}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:01:38.269165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42615748563703953, "overlap_percentage": 0.5976303317535545, "num_intersection": 5044, "num_union": 11836, "num_only_computed": 3396, "num_only_roped": 3396, "total_diff": 6792, "diff_percentage": 0.5738425143629604, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:01:40.816507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 1.52587890625e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.14177489177489178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:02:58.074190", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47132647725291965, "overlap_percentage": 0.6406823836038384, "num_intersection": 5408, "num_union": 11474, "num_only_computed": 3033, "num_only_roped": 3033, "total_diff": 6066, "diff_percentage": 0.5286735227470803, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:03:01.005126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.0303955078125, "l2_diff_relative": 0.20612582781456953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:04:19.940440", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4847845206684257, "overlap_percentage": 0.6530031986731429, "num_intersection": 5512, "num_union": 11370, "num_only_computed": 2929, "num_only_roped": 2929, "total_diff": 5858, "diff_percentage": 0.5152154793315743, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:04:23.324405", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.20260663507109006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:05:44.360557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3945651276121252, "overlap_percentage": 0.5658611703387822, "num_intersection": 4777, "num_union": 12107, "num_only_computed": 3665, "num_only_roped": 3665, "total_diff": 7330, "diff_percentage": 0.6054348723878747, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:05:47.268289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.13729508196721313}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:07:07.909515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39238000989609106, "overlap_percentage": 0.5636105188343994, "num_intersection": 4758, "num_union": 12126, "num_only_computed": 3684, "num_only_roped": 3684, "total_diff": 7368, "diff_percentage": 0.607619990103909, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:07:11.624733", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 1.519918441772461e-05, "l2_diff": 0.018798828125, "l2_diff_relative": 0.08517699115044247}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:08:31.175623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5084866892978381, "overlap_percentage": 0.6741679497808836, "num_intersection": 5692, "num_union": 11194, "num_only_computed": 2751, "num_only_roped": 2751, "total_diff": 5502, "diff_percentage": 0.49151331070216187, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:08:34.191102", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.0228271484375, "l2_diff_relative": 0.1408132530120482}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:09:22.152517", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:09:22.166238", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7103891372680664e-06, "l2_diff": 0.0252685546875, "l2_diff_relative": 0.0030628551136363635}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:09:28.132365", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7170684081433402, "overlap_percentage": 0.835224042027194, "num_intersection": 1081114, "num_union": 1507686, "num_only_computed": 229606, "num_only_roped": 196966, "total_diff": 426572, "diff_percentage": 0.2829315918566598, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:09:28.550293", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.45703125, "l2_diff_relative": 0.06898584905660378}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:09:45.643081", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5702967890779702, "overlap_percentage": 0.7263554164341518, "num_intersection": 1332868, "num_union": 2337148, "num_only_computed": 502140, "num_only_roped": 502140, "total_diff": 1004280, "diff_percentage": 0.42970321092202973, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:09:46.275432", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 5.412101745605469e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.1188423645320197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:10:06.525981", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49356373152904265, "overlap_percentage": 0.6609208848741319, "num_intersection": 1559308, "num_union": 3159284, "num_only_computed": 799988, "num_only_roped": 799988, "total_diff": 1599976, "diff_percentage": 0.5064362684709574, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:10:07.252304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.145}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:10:33.333896", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44519181374182765, "overlap_percentage": 0.6161006580699574, "num_intersection": 1776578, "num_union": 3990590, "num_only_computed": 1107006, "num_only_roped": 1107006, "total_diff": 2214012, "diff_percentage": 0.5548081862581723, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:10:34.245230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.15858208955223882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:11:06.353473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42391434465829264, "overlap_percentage": 0.595421130840595, "num_intersection": 2029119, "num_union": 4786625, "num_only_computed": 1378753, "num_only_roped": 1378753, "total_diff": 2757506, "diff_percentage": 0.5760856553417074, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:11:09.935969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16287878787878787}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:11:47.921307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40682540153892993, "overlap_percentage": 0.5783594767252604, "num_intersection": 2274202, "num_union": 5590118, "num_only_computed": 1657958, "num_only_roped": 1657958, "total_diff": 3315916, "diff_percentage": 0.59317459846107, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:11:51.602561", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.16959798994974876}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:12:35.790742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38725463415848943, "overlap_percentage": 0.5583036086138558, "num_intersection": 2488051, "num_union": 6424845, "num_only_computed": 1968397, "num_only_roped": 1968397, "total_diff": 3936794, "diff_percentage": 0.6127453658415106, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:12:37.302515", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.19642857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:13:28.381072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3697679947648493, "overlap_percentage": 0.539898721795333, "num_intersection": 2689093, "num_union": 7272379, "num_only_computed": 2291643, "num_only_roped": 2291643, "total_diff": 4583286, "diff_percentage": 0.6302320052351507, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:13:30.141042", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.4453125, "l2_diff_relative": 0.24342105263157895}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:14:29.170463", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3630666265547991, "overlap_percentage": 0.5327202933175224, "num_intersection": 2932638, "num_union": 8077410, "num_only_computed": 2572386, "num_only_roped": 2572386, "total_diff": 5144772, "diff_percentage": 0.6369333734452008, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:14:31.192156", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08203125, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.390625, "l2_diff_relative": 0.23056994818652848}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:15:40.168913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3587330475611959, "overlap_percentage": 0.5280405127483866, "num_intersection": 3183721, "num_union": 8874903, "num_only_computed": 2845591, "num_only_roped": 2845591, "total_diff": 5691182, "diff_percentage": 0.6412669524388042, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:15:42.455078", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06494140625, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.18846153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:16:57.333755", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3557331889115605, "overlap_percentage": 0.5247834777832031, "num_intersection": 3439221, "num_union": 9667979, "num_only_computed": 3114379, "num_only_roped": 3114379, "total_diff": 6228758, "diff_percentage": 0.6442668110884395, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:16:59.884805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.083984375, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.1834975369458128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:18:21.846267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35279247217753246, "overlap_percentage": 0.5215766341597946, "num_intersection": 3691661, "num_union": 10464115, "num_only_computed": 3386227, "num_only_roped": 3386227, "total_diff": 6772454, "diff_percentage": 0.6472075278224676, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:18:24.645997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.1830808080808081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:19:53.476922", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3504863512460488, "overlap_percentage": 0.5190520450986665, "num_intersection": 3945925, "num_union": 11258427, "num_only_computed": 3656251, "num_only_roped": 3656251, "total_diff": 7312502, "diff_percentage": 0.6495136487539511, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:19:57.561795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.19065656565656566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:21:33.032079", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35374327123394833, "overlap_percentage": 0.522615002047631, "num_intersection": 4247012, "num_union": 12005916, "num_only_computed": 3879452, "num_only_roped": 3879452, "total_diff": 7758904, "diff_percentage": 0.6462567287660517, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:21:36.258544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04443359375, "mean_diff": 2.8848648071289062e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.17277486910994763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:23:19.752677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34576898788260163, "overlap_percentage": 0.5138608349515108, "num_intersection": 4028189, "num_union": 11649943, "num_only_computed": 3810877, "num_only_roped": 3810877, "total_diff": 7621754, "diff_percentage": 0.6542310121173983, "num_computed": 7839066, "num_roped": 7839066}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "mask_shape": [1, 32, 933, 16293], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:23:25.924726", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.9206275939941406e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.15542328042328044}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "attention_shape": [1, 32, 933, 16293]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:25:09.313123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44470295574434265, "overlap_percentage": 0.6156323747745389, "num_intersection": 301043, "num_union": 676953, "num_only_computed": 187955, "num_only_roped": 187955, "total_diff": 375910, "diff_percentage": 0.5552970442556573, "num_computed": 488998, "num_roped": 488998}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 58, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:25:14.644443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.296875, "l2_diff_relative": 0.18269230769230768}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 58, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:26:43.574613", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4458161865569273, "overlap_percentage": 0.6166982922201139, "num_intersection": 5200, "num_union": 11664, "num_only_computed": 3232, "num_only_roped": 3232, "total_diff": 6464, "diff_percentage": 0.5541838134430727, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:26:46.049357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.21171171171171171}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:28:03.592581", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.467838802332666, "overlap_percentage": 0.6374525616698292, "num_intersection": 5375, "num_union": 11489, "num_only_computed": 3057, "num_only_roped": 3057, "total_diff": 6114, "diff_percentage": 0.5321611976673339, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:28:06.076308", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.044921875, "l2_diff_relative": 0.18181818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:29:23.188057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49760255727224295, "overlap_percentage": 0.664532194948417, "num_intersection": 5604, "num_union": 11262, "num_only_computed": 2829, "num_only_roped": 2829, "total_diff": 5658, "diff_percentage": 0.5023974427277571, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:29:27.403428", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.04541015625, "l2_diff_relative": 0.24473684210526317}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:30:46.462393", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42293090356871677, "overlap_percentage": 0.5944503735325507, "num_intersection": 5013, "num_union": 11853, "num_only_computed": 3420, "num_only_roped": 3420, "total_diff": 6840, "diff_percentage": 0.5770690964312832, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:30:51.282054", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.020263671875, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.2872340425531915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:32:10.276070", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37968264354654013, "overlap_percentage": 0.5503912734171211, "num_intersection": 4642, "num_union": 12226, "num_only_computed": 3792, "num_only_roped": 3792, "total_diff": 7584, "diff_percentage": 0.6203173564534599, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:32:15.110511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.288818359375e-05, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.15891959798994976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:33:34.534588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4630930696504467, "overlap_percentage": 0.6330329618212, "num_intersection": 5339, "num_union": 11529, "num_only_computed": 3095, "num_only_roped": 3095, "total_diff": 6190, "diff_percentage": 0.5369069303495533, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:33:38.335700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.23410404624277456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:34:58.329930", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44249679350149634, "overlap_percentage": 0.6135151155898044, "num_intersection": 5175, "num_union": 11695, "num_only_computed": 3260, "num_only_roped": 3260, "total_diff": 6520, "diff_percentage": 0.5575032064985036, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:35:02.414823", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.24835526315789475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:36:24.020906", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4082978545788463, "overlap_percentage": 0.5798458802608181, "num_intersection": 4891, "num_union": 11979, "num_only_computed": 3544, "num_only_roped": 3544, "total_diff": 7088, "diff_percentage": 0.5917021454211537, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:36:26.565034", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.038330078125, "l2_diff_relative": 0.1684549356223176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:37:46.350583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5041454934474459, "overlap_percentage": 0.6703413940256046, "num_intersection": 5655, "num_union": 11217, "num_only_computed": 2781, "num_only_roped": 2781, "total_diff": 5562, "diff_percentage": 0.49585450655255414, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:37:48.997622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.18857142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:39:08.906664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4455106237148732, "overlap_percentage": 0.6164058795637744, "num_intersection": 5200, "num_union": 11672, "num_only_computed": 3236, "num_only_roped": 3236, "total_diff": 6472, "diff_percentage": 0.5544893762851268, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:39:12.819130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.039794921875, "l2_diff_relative": 0.20897435897435898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:40:32.079821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46310587011185295, "overlap_percentage": 0.6330449211805144, "num_intersection": 5341, "num_union": 11533, "num_only_computed": 3096, "num_only_roped": 3096, "total_diff": 6192, "diff_percentage": 0.5368941298881471, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:40:35.698182", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.23170731707317074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:41:54.592397", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5043237942408844, "overlap_percentage": 0.6704989925328908, "num_intersection": 5657, "num_union": 11217, "num_only_computed": 2780, "num_only_roped": 2780, "total_diff": 5560, "diff_percentage": 0.49567620575911564, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:41:58.365669", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.0267333984375, "l2_diff_relative": 0.16590909090909092}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:43:17.680957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48295254833040424, "overlap_percentage": 0.6513391799004503, "num_intersection": 5496, "num_union": 11380, "num_only_computed": 2942, "num_only_roped": 2942, "total_diff": 5884, "diff_percentage": 0.5170474516695958, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:43:21.909320", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.16705069124423963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:44:41.205757", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39332892998679, "overlap_percentage": 0.5645887651102157, "num_intersection": 4764, "num_union": 12112, "num_only_computed": 3674, "num_only_roped": 3674, "total_diff": 7348, "diff_percentage": 0.6066710700132101, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:44:45.394002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.6689300537109375e-05, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.11889097744360902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:46:04.222537", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5091201716738197, "overlap_percentage": 0.6747244934233914, "num_intersection": 5694, "num_union": 11184, "num_only_computed": 2745, "num_only_roped": 2745, "total_diff": 5490, "diff_percentage": 0.49087982832618027, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:46:08.202838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.032470703125, "l2_diff_relative": 0.1646039603960396}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:46:54.014725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:46:54.028325", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7401914596557617e-06, "l2_diff": 0.025146484375, "l2_diff_relative": 0.003048058712121212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:46:59.934118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.719179060122789, "overlap_percentage": 0.8366540482076638, "num_intersection": 1082965, "num_union": 1505835, "num_only_computed": 227755, "num_only_roped": 195115, "total_diff": 422870, "diff_percentage": 0.28082093987721096, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:47:02.169904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.07093023255813953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:47:16.478294", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5698836879529704, "overlap_percentage": 0.726020268031529, "num_intersection": 1332253, "num_union": 2337763, "num_only_computed": 502755, "num_only_roped": 502755, "total_diff": 1005510, "diff_percentage": 0.43011631204702955, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:47:16.999935", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 5.435943603515625e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.11835748792270531}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:47:36.653360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4956334756722216, "overlap_percentage": 0.6627739800347222, "num_intersection": 1563680, "num_union": 3154912, "num_only_computed": 795616, "num_only_roped": 795616, "total_diff": 1591232, "diff_percentage": 0.5043665243277784, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:47:37.372631", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.13480392156862744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:48:02.856813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44391636194751527, "overlap_percentage": 0.6148782209916548, "num_intersection": 1773053, "num_union": 3994115, "num_only_computed": 1110531, "num_only_roped": 1110531, "total_diff": 2221062, "diff_percentage": 0.5560836380524847, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:48:03.736200", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.7206878662109375e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.17317708333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:48:35.234875", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4205335245790084, "overlap_percentage": 0.5920782822829026, "num_intersection": 2017727, "num_union": 4798017, "num_only_computed": 1390145, "num_only_roped": 1390145, "total_diff": 2780290, "diff_percentage": 0.5794664754209916, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:48:36.304321", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.17447916666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:49:15.435522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40481773570958896, "overlap_percentage": 0.5763277689615885, "num_intersection": 2266213, "num_union": 5598107, "num_only_computed": 1665947, "num_only_roped": 1665947, "total_diff": 3331894, "diff_percentage": 0.595182264290411, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:49:16.728116", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.18229166666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:50:00.192319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.388235389403558, "overlap_percentage": 0.5593221327837776, "num_intersection": 2492590, "num_union": 6420306, "num_only_computed": 1963858, "num_only_roped": 1963858, "total_diff": 3927716, "diff_percentage": 0.6117646105964419, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:50:04.086258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.18434343434343434}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:50:56.166784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38208332703209413, "overlap_percentage": 0.5529092487535978, "num_intersection": 2753895, "num_union": 7207577, "num_only_computed": 2226841, "num_only_roped": 2226841, "total_diff": 4453682, "diff_percentage": 0.6179166729679059, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:50:59.590972", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15625, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.20959595959595959}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:51:58.074530", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36600413893727574, "overlap_percentage": 0.5358755929129464, "num_intersection": 2950008, "num_union": 8060040, "num_only_computed": 2555016, "num_only_roped": 2555016, "total_diff": 5110032, "diff_percentage": 0.6339958610627242, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:52:00.103442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.21923076923076923}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:53:06.486937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36440287607307653, "overlap_percentage": 0.5341572968856149, "num_intersection": 3220601, "num_union": 8838023, "num_only_computed": 2808711, "num_only_roped": 2808711, "total_diff": 5617422, "diff_percentage": 0.6355971239269235, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:53:08.795502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.21484375, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.17632850241545894}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:54:22.695924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3559899972564045, "overlap_percentage": 0.5250628662109375, "num_intersection": 3441052, "num_union": 9666148, "num_only_computed": 3112548, "num_only_roped": 3112548, "total_diff": 6225096, "diff_percentage": 0.6440100027435954, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:54:26.964446", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.552436828613281e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.19776119402985073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:55:50.331274", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34644018542665644, "overlap_percentage": 0.5146016721372251, "num_intersection": 3642293, "num_union": 10513483, "num_only_computed": 3435595, "num_only_roped": 3435595, "total_diff": 6871190, "diff_percentage": 0.6535598145733436, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:55:53.221584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052490234375, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.1865671641791045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:57:24.084893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34275868525030867, "overlap_percentage": 0.5105290906182651, "num_intersection": 3881132, "num_union": 11323220, "num_only_computed": 3721044, "num_only_roped": 3721044, "total_diff": 7442088, "diff_percentage": 0.6572413147496914, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:57:27.353505", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05517578125, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.18625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:59:06.691960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35036014887011835, "overlap_percentage": 0.5189136382072203, "num_intersection": 4216933, "num_union": 12035995, "num_only_computed": 3909531, "num_only_roped": 3909531, "total_diff": 7819062, "diff_percentage": 0.6496398511298817, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T22:59:10.051600", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.039836883544922e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.1724137931034483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:00:55.813295", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3414692689138928, "overlap_percentage": 0.509097415538054, "num_intersection": 4036023, "num_union": 11819579, "num_only_computed": 3891778, "num_only_roped": 3891778, "total_diff": 7783556, "diff_percentage": 0.6585307310861072, "num_computed": 7927801, "num_roped": 7927801}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 943, "seq_len_k": 16303, "queries_shape": [1, 32, 943, 128], "keys_shape": [1, 8, 16303, 128], "mask_shape": [1, 32, 943, 16303], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:01:00.125291", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 2.9325485229492188e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.16968911917098445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 943, "seq_len_k": 16303, "queries_shape": [1, 32, 943, 128], "keys_shape": [1, 8, 16303, 128], "attention_shape": [1, 32, 943, 16303]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:02:45.542025", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43999717467567634, "overlap_percentage": 0.611108386063014, "num_intersection": 299008, "num_union": 679568, "num_only_computed": 190280, "num_only_roped": 190280, "total_diff": 380560, "diff_percentage": 0.5600028253243237, "num_computed": 489288, "num_roped": 489288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16361, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 58, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:02:51.492381", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.271484375, "l2_diff_relative": 0.16626794258373206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16361, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 58, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:04:21.759808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42504856008783043, "overlap_percentage": 0.5965390541661728, "num_intersection": 5033, "num_union": 11841, "num_only_computed": 3404, "num_only_roped": 3404, "total_diff": 6808, "diff_percentage": 0.5749514399121696, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:04:24.737195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.0478515625, "l2_diff_relative": 0.23113207547169812}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:05:43.406968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4712703810271166, "overlap_percentage": 0.6406305558847931, "num_intersection": 5405, "num_union": 11469, "num_only_computed": 3032, "num_only_roped": 3032, "total_diff": 6064, "diff_percentage": 0.5287296189728834, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:05:45.868811", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013427734375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.21646341463414634}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:07:03.612903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44424475823705606, "overlap_percentage": 0.6151931737378525, "num_intersection": 5191, "num_union": 11685, "num_only_computed": 3247, "num_only_roped": 3247, "total_diff": 6494, "diff_percentage": 0.555755241762944, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:07:06.069891", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0113525390625, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.029052734375, "l2_diff_relative": 0.19572368421052633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:08:23.356876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47724089635854344, "overlap_percentage": 0.646124674093387, "num_intersection": 5452, "num_union": 11424, "num_only_computed": 2986, "num_only_roped": 2986, "total_diff": 5972, "diff_percentage": 0.5227591036414566, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:08:25.815728", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.23265895953757226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:09:43.396714", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4211855843718424, "overlap_percentage": 0.5927242564284868, "num_intersection": 5002, "num_union": 11876, "num_only_computed": 3437, "num_only_roped": 3437, "total_diff": 6874, "diff_percentage": 0.5788144156281576, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:09:46.673825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.042236328125, "l2_diff_relative": 0.2902684563758389}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:11:06.043285", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44813384813384816, "overlap_percentage": 0.6189121933878422, "num_intersection": 5223, "num_union": 11655, "num_only_computed": 3216, "num_only_roped": 3216, "total_diff": 6432, "diff_percentage": 0.5518661518661518, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:11:09.153731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0150146484375, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.24044585987261147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:12:30.793445", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4514187446259673, "overlap_percentage": 0.6220379146919431, "num_intersection": 5250, "num_union": 11630, "num_only_computed": 3190, "num_only_roped": 3190, "total_diff": 6380, "diff_percentage": 0.5485812553740327, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:12:35.341500", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.19915254237288135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:13:56.540316", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4312362218076988, "overlap_percentage": 0.60260663507109, "num_intersection": 5086, "num_union": 11794, "num_only_computed": 3354, "num_only_roped": 3354, "total_diff": 6708, "diff_percentage": 0.5687637781923012, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:13:59.091567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.7881393432617188e-05, "l2_diff": 0.0311279296875, "l2_diff_relative": 0.16954787234042554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:15:19.021444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4823074896830275, "overlap_percentage": 0.6507522805354816, "num_intersection": 5493, "num_union": 11389, "num_only_computed": 2948, "num_only_roped": 2948, "total_diff": 5896, "diff_percentage": 0.5176925103169725, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:15:22.567832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021240234375, "mean_diff": 1.633167266845703e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.17063492063492064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:16:39.621673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4682553487563054, "overlap_percentage": 0.637839118587845, "num_intersection": 5384, "num_union": 11498, "num_only_computed": 3057, "num_only_roped": 3057, "total_diff": 6114, "diff_percentage": 0.5317446512436945, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:16:42.981266", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.037109375, "l2_diff_relative": 0.19895287958115182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:18:01.209911", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4236087689713322, "overlap_percentage": 0.5951196398957593, "num_intersection": 5024, "num_union": 11860, "num_only_computed": 3418, "num_only_roped": 3418, "total_diff": 6836, "diff_percentage": 0.5763912310286677, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:18:03.672013", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.21766169154228857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:19:21.300893", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38212180746561886, "overlap_percentage": 0.5529495380241649, "num_intersection": 4668, "num_union": 12216, "num_only_computed": 3774, "num_only_roped": 3774, "total_diff": 7548, "diff_percentage": 0.6178781925343811, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:19:23.754108", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.02099609375, "l2_diff_relative": 0.08669354838709678}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:20:42.469760", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4477023319615912, "overlap_percentage": 0.6185005329859055, "num_intersection": 5222, "num_union": 11664, "num_only_computed": 3221, "num_only_roped": 3221, "total_diff": 6442, "diff_percentage": 0.5522976680384087, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:20:44.996921", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.15046296296296297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:22:04.269538", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5252461385602023, "overlap_percentage": 0.6887362311974417, "num_intersection": 5815, "num_union": 11071, "num_only_computed": 2628, "num_only_roped": 2628, "total_diff": 5256, "diff_percentage": 0.47475386143979764, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "mask_shape": [1, 32, 1, 16375], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:22:06.821829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.0263671875, "l2_diff_relative": 0.13917525773195877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "attention_shape": [1, 32, 1, 16375]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:22:52.251045", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:22:52.264753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7401914596557617e-06, "l2_diff": 0.0255126953125, "l2_diff_relative": 0.0031160543893129773}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:22:58.189318", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.72139448379776, "overlap_percentage": 0.8381512669962917, "num_intersection": 1084903, "num_union": 1503897, "num_only_computed": 225817, "num_only_roped": 193177, "total_diff": 418994, "diff_percentage": 0.2786055162022399, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:23:00.269783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.39453125, "l2_diff_relative": 0.06099033816425121}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:23:14.819050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5731588549168073, "overlap_percentage": 0.7286725725446429, "num_intersection": 1337120, "num_union": 2332896, "num_only_computed": 497888, "num_only_roped": 497888, "total_diff": 995776, "diff_percentage": 0.4268411450831927, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:23:15.357467", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 5.269050598144531e-05, "l2_diff": 0.69921875, "l2_diff_relative": 0.11653645833333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:23:36.191305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49291492243543034, "overlap_percentage": 0.6603389316134982, "num_intersection": 1557935, "num_union": 3160657, "num_only_computed": 801361, "num_only_roped": 801361, "total_diff": 1602722, "diff_percentage": 0.5070850775645697, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:23:36.932234", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.14094387755102042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:24:02.978627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44915843461274524, "overlap_percentage": 0.619888652454723, "num_intersection": 1787501, "num_union": 3979667, "num_only_computed": 1096083, "num_only_roped": 1096083, "total_diff": 2192166, "diff_percentage": 0.5508415653872548, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:24:03.895449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.95703125, "l2_diff_relative": 0.15545685279187818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:24:35.870643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42535052685159275, "overlap_percentage": 0.5968363835261419, "num_intersection": 2033942, "num_union": 4781802, "num_only_computed": 1373930, "num_only_roped": 1373930, "total_diff": 2747860, "diff_percentage": 0.5746494731484072, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:24:38.669675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.984375, "l2_diff_relative": 0.16237113402061856}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:25:16.441278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40478084774288553, "overlap_percentage": 0.5762903849283855, "num_intersection": 2266066, "num_union": 5598254, "num_only_computed": 1666094, "num_only_roped": 1666094, "total_diff": 3332188, "diff_percentage": 0.5952191522571144, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:25:19.198910", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.17746113989637305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:26:03.420464", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38671439604639424, "overlap_percentage": 0.5577419505399817, "num_intersection": 2485548, "num_union": 6427348, "num_only_computed": 1970900, "num_only_roped": 1970900, "total_diff": 3941800, "diff_percentage": 0.6132856039536058, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:26:04.943028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.17676767676767677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:26:56.088308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37648044781512563, "overlap_percentage": 0.5470189546283922, "num_intersection": 2724557, "num_union": 7236915, "num_only_computed": 2256179, "num_only_roped": 2256179, "total_diff": 4512358, "diff_percentage": 0.6235195521848743, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:26:57.850502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.125, "l2_diff_relative": 0.18274111675126903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:27:56.908350", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.370479088024206, "overlap_percentage": 0.5406563168480283, "num_intersection": 2976326, "num_union": 8033722, "num_only_computed": 2528698, "num_only_roped": 2528698, "total_diff": 5057396, "diff_percentage": 0.6295209119757941, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:27:58.946914", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052978515625, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.21744791666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:29:06.120118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3622312957630902, "overlap_percentage": 0.5318205460258152, "num_intersection": 3206512, "num_union": 8852112, "num_only_computed": 2822800, "num_only_roped": 2822800, "total_diff": 5645600, "diff_percentage": 0.6377687042369098, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:29:08.429641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.2002551020408163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:30:22.576248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3474710604498143, "overlap_percentage": 0.5157380676269532, "num_intersection": 3379941, "num_union": 9727259, "num_only_computed": 3173659, "num_only_roped": 3173659, "total_diff": 6347318, "diff_percentage": 0.6525289395501858, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:30:27.202522", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.19444444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:31:48.804692", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34619331569636225, "overlap_percentage": 0.5143292744954427, "num_intersection": 3640365, "num_union": 10515411, "num_only_computed": 3437523, "num_only_roped": 3437523, "total_diff": 6875046, "diff_percentage": 0.6538066843036378, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:31:51.606683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.17929292929292928}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:33:20.478142", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3495263275804345, "overlap_percentage": 0.5179985309469288, "num_intersection": 3937916, "num_union": 11266436, "num_only_computed": 3664260, "num_only_roped": 3664260, "total_diff": 7328520, "diff_percentage": 0.6504736724195656, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:33:24.811299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.20558375634517767}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:35:02.094356", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33931193358341405, "overlap_percentage": 0.5066959011939264, "num_intersection": 4117646, "num_union": 12135282, "num_only_computed": 4008818, "num_only_roped": 4008818, "total_diff": 8017636, "diff_percentage": 0.660688066416586, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:35:05.400562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.19948186528497408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:36:49.193239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3373474672780825, "overlap_percentage": 0.504502345923142, "num_intersection": 3977441, "num_union": 11790339, "num_only_computed": 3906449, "num_only_roped": 3906449, "total_diff": 7812898, "diff_percentage": 0.6626525327219175, "num_computed": 7883890, "num_roped": 7883890}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "mask_shape": [1, 32, 938, 16298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:36:53.213232", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.15725806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "attention_shape": [1, 32, 938, 16298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:38:36.325403", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43663692591439596, "overlap_percentage": 0.6078598120906348, "num_intersection": 297348, "num_union": 680996, "num_only_computed": 191824, "num_only_roped": 191824, "total_diff": 383648, "diff_percentage": 0.563363074085604, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 58, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:38:39.629627", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.32421875, "l2_diff_relative": 0.1966824644549763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 58, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:40:10.124690", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41308536483203484, "overlap_percentage": 0.5846573393407636, "num_intersection": 4931, "num_union": 11937, "num_only_computed": 3503, "num_only_roped": 3503, "total_diff": 7006, "diff_percentage": 0.5869146351679652, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:40:12.645649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 2.8014183044433594e-05, "l2_diff": 0.056396484375, "l2_diff_relative": 0.27240566037735847}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:41:31.683436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46035318559556787, "overlap_percentage": 0.6304682868998222, "num_intersection": 5318, "num_union": 11552, "num_only_computed": 3117, "num_only_roped": 3117, "total_diff": 6234, "diff_percentage": 0.5396468144044322, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:41:34.194589", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.2388268156424581}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:42:52.907529", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39053742169469174, "overlap_percentage": 0.5617071724955542, "num_intersection": 4738, "num_union": 12132, "num_only_computed": 3697, "num_only_roped": 3697, "total_diff": 7394, "diff_percentage": 0.6094625783053083, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:42:56.914788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.02197265625, "l2_diff_relative": 0.07867132867132867}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:44:15.673907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44452054794520546, "overlap_percentage": 0.6154575628259839, "num_intersection": 5192, "num_union": 11680, "num_only_computed": 3244, "num_only_roped": 3244, "total_diff": 6488, "diff_percentage": 0.5554794520547945, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:44:20.750717", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.046630859375, "l2_diff_relative": 0.26675977653631283}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:45:39.676220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39414972731779874, "overlap_percentage": 0.5654338549075392, "num_intersection": 4770, "num_union": 12102, "num_only_computed": 3666, "num_only_roped": 3666, "total_diff": 7332, "diff_percentage": 0.6058502726822013, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:45:44.645639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.046630859375, "l2_diff_relative": 0.2581081081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:47:04.076987", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43828844186839416, "overlap_percentage": 0.6094583382718975, "num_intersection": 5142, "num_union": 11732, "num_only_computed": 3295, "num_only_roped": 3295, "total_diff": 6590, "diff_percentage": 0.5617115581316059, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:47:08.474915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.29239766081871343}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:48:27.888540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4435794336555736, "overlap_percentage": 0.6145549365888349, "num_intersection": 5185, "num_union": 11689, "num_only_computed": 3252, "num_only_roped": 3252, "total_diff": 6504, "diff_percentage": 0.5564205663444264, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:48:31.679581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.21279761904761904}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:49:51.235416", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4181512605042017, "overlap_percentage": 0.5897132021806115, "num_intersection": 4976, "num_union": 11900, "num_only_computed": 3462, "num_only_roped": 3462, "total_diff": 6924, "diff_percentage": 0.5818487394957983, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:49:54.922949", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.21256684491978609}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:51:14.644379", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3837323712692686, "overlap_percentage": 0.5546337994785494, "num_intersection": 4680, "num_union": 12196, "num_only_computed": 3758, "num_only_roped": 3758, "total_diff": 7516, "diff_percentage": 0.6162676287307314, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:51:18.754081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.1976284584980237}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:52:38.389663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4441687344913151, "overlap_percentage": 0.6151202749140894, "num_intersection": 5191, "num_union": 11687, "num_only_computed": 3248, "num_only_roped": 3248, "total_diff": 6496, "diff_percentage": 0.5558312655086849, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:52:42.559392", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.20256410256410257}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:54:01.967711", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41748551272360795, "overlap_percentage": 0.5890508354070387, "num_intersection": 4971, "num_union": 11907, "num_only_computed": 3468, "num_only_roped": 3468, "total_diff": 6936, "diff_percentage": 0.582514487276392, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:54:06.394236", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.054443359375, "l2_diff_relative": 0.26421800947867297}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:55:25.850683", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44992269369524135, "overlap_percentage": 0.6206161137440759, "num_intersection": 5238, "num_union": 11642, "num_only_computed": 3202, "num_only_roped": 3202, "total_diff": 6404, "diff_percentage": 0.5500773063047586, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:55:29.303405", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 2.586841583251953e-05, "l2_diff": 0.0703125, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:56:48.798891", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5098389982110912, "overlap_percentage": 0.6753554502369669, "num_intersection": 5700, "num_union": 11180, "num_only_computed": 2740, "num_only_roped": 2740, "total_diff": 5480, "diff_percentage": 0.49016100178890876, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:56:52.462834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.0255126953125, "l2_diff_relative": 0.16430817610062892}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:57:38.035376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:57:38.049110", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.026123046875, "l2_diff_relative": 0.003142622180451128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:57:43.978811", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7250581893952368, "overlap_percentage": 0.8406188195302843, "num_intersection": 1088097, "num_union": 1500703, "num_only_computed": 222623, "num_only_roped": 189983, "total_diff": 412606, "diff_percentage": 0.27494181060476325, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:57:46.286571", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 3.528594970703125e-05, "l2_diff": 0.439453125, "l2_diff_relative": 0.06696428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:58:01.008630", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5779639795820091, "overlap_percentage": 0.7325439453125, "num_intersection": 1344224, "num_union": 2325792, "num_only_computed": 490784, "num_only_roped": 490784, "total_diff": 981568, "diff_percentage": 0.42203602041799093, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:58:01.555963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.11224489795918367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:58:22.551218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49694114123793365, "overlap_percentage": 0.6639421251085069, "num_intersection": 1566436, "num_union": 3152156, "num_only_computed": 792860, "num_only_roped": 792860, "total_diff": 1585720, "diff_percentage": 0.5030588587620664, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:58:23.282619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 4.9114227294921875e-05, "l2_diff": 0.921875, "l2_diff_relative": 0.15206185567010308}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:58:49.306375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4585559123789272, "overlap_percentage": 0.6287807117808949, "num_intersection": 1813142, "num_union": 3954026, "num_only_computed": 1070442, "num_only_roped": 1070442, "total_diff": 2140884, "diff_percentage": 0.5414440876210728, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:58:50.223832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 4.291534423828125e-05, "l2_diff": 0.9296875, "l2_diff_relative": 0.15414507772020725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:59:22.044307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4344881930199931, "overlap_percentage": 0.6057745126577524, "num_intersection": 2064402, "num_union": 4751342, "num_only_computed": 1343470, "num_only_roped": 1343470, "total_diff": 2686940, "diff_percentage": 0.5655118069800069, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-18T23:59:23.923277", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.1600765306122449}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:00:01.594220", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4135755247128387, "overlap_percentage": 0.5851481119791667, "num_intersection": 2300896, "num_union": 5563424, "num_only_computed": 1631264, "num_only_roped": 1631264, "total_diff": 3262528, "diff_percentage": 0.5864244752871612, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:00:05.118083", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.17219387755102042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:00:49.070800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39973578559811646, "overlap_percentage": 0.5711589140050551, "num_intersection": 2545340, "num_union": 6367556, "num_only_computed": 1911108, "num_only_roped": 1911108, "total_diff": 3822216, "diff_percentage": 0.6002642144018836, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:00:50.577510", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 2.9921531677246094e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.18137254901960784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:01:41.840358", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38229083625257493, "overlap_percentage": 0.5531264857241982, "num_intersection": 2754977, "num_union": 7206495, "num_only_computed": 2225759, "num_only_roped": 2225759, "total_diff": 4451518, "diff_percentage": 0.617709163747425, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:01:44.346279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.20707070707070707}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:02:42.557713", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3682634600311605, "overlap_percentage": 0.538293202718099, "num_intersection": 2963317, "num_union": 8046731, "num_only_computed": 2541707, "num_only_roped": 2541707, "total_diff": 5083414, "diff_percentage": 0.6317365399688395, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:02:44.546829", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060791015625, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.19065656565656566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:03:48.903720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36629524726534146, "overlap_percentage": 0.5361875451129415, "num_intersection": 3232842, "num_union": 8825782, "num_only_computed": 2796470, "num_only_roped": 2796470, "total_diff": 5592940, "diff_percentage": 0.6337047527346585, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:03:51.121334", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.15808823529411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:05:03.688334", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3550213386500939, "overlap_percentage": 0.5240084838867187, "num_intersection": 3434142, "num_union": 9673058, "num_only_computed": 3119458, "num_only_roped": 3119458, "total_diff": 6238916, "diff_percentage": 0.6449786613499061, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:05:06.193580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.14423076923076922}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:06:26.669337", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3499496621782387, "overlap_percentage": 0.518463276050709, "num_intersection": 3669625, "num_union": 10486151, "num_only_computed": 3408263, "num_only_roped": 3408263, "total_diff": 6816526, "diff_percentage": 0.6500503378217612, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:06:29.390955", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.123283386230469e-05, "l2_diff": 0.9609375, "l2_diff_relative": 0.14855072463768115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:07:58.608069", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34992807919465746, "overlap_percentage": 0.5184395888756061, "num_intersection": 3941269, "num_union": 11263083, "num_only_computed": 3660907, "num_only_roped": 3660907, "total_diff": 7321814, "diff_percentage": 0.6500719208053426, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:08:01.581923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0859375, "mean_diff": 3.0040740966796875e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.15808823529411764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:09:36.295899", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3467947667266221, "overlap_percentage": 0.5149927446919103, "num_intersection": 4185070, "num_union": 12067858, "num_only_computed": 3941394, "num_only_roped": 3941394, "total_diff": 7882788, "diff_percentage": 0.6532052332733779, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:09:39.514762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.0040740966796875e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.14987864077669902}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:11:22.611991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3386965701168704, "overlap_percentage": 0.5060094687286778, "num_intersection": 3993576, "num_union": 11791014, "num_only_computed": 3898719, "num_only_roped": 3898719, "total_diff": 7797438, "diff_percentage": 0.6613034298831296, "num_computed": 7892295, "num_roped": 7892295}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 939, "seq_len_k": 16299, "queries_shape": [1, 32, 939, 128], "keys_shape": [1, 8, 16299, 128], "mask_shape": [1, 32, 939, 16299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:11:27.940445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.7890625, "l2_diff_relative": 0.1281725888324873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 939, "seq_len_k": 16299, "queries_shape": [1, 32, 939, 128], "keys_shape": [1, 8, 16299, 128], "attention_shape": [1, 32, 939, 16299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:13:11.433305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4393401959933325, "overlap_percentage": 0.6104744343502899, "num_intersection": 298627, "num_union": 679717, "num_only_computed": 190545, "num_only_roped": 190545, "total_diff": 381090, "diff_percentage": 0.5606598040066675, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16357, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 58, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:13:15.172216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.3046875, "l2_diff_relative": 0.18932038834951456}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16357, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 58, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:14:45.854821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43391415214619633, "overlap_percentage": 0.6052163604030824, "num_intersection": 5105, "num_union": 11765, "num_only_computed": 3330, "num_only_roped": 3330, "total_diff": 6660, "diff_percentage": 0.5660858478538037, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:14:48.376907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.048095703125, "l2_diff_relative": 0.20780590717299577}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:16:08.122892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3954834973943254, "overlap_percentage": 0.566804979253112, "num_intersection": 4781, "num_union": 12089, "num_only_computed": 3654, "num_only_roped": 3654, "total_diff": 7308, "diff_percentage": 0.6045165026056746, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:16:10.646279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.467632293701172e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.1879432624113475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:17:29.521607", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4807793575566087, "overlap_percentage": 0.6493598862019915, "num_intersection": 5478, "num_union": 11394, "num_only_computed": 2958, "num_only_roped": 2958, "total_diff": 5916, "diff_percentage": 0.5192206424433913, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:17:32.022644", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.22604790419161677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:18:51.489556", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4038941587618572, "overlap_percentage": 0.5753911806543386, "num_intersection": 4854, "num_union": 12018, "num_only_computed": 3582, "num_only_roped": 3582, "total_diff": 7164, "diff_percentage": 0.5961058412381428, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:18:54.011746", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.24044585987261147}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:20:13.374139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4363295880149813, "overlap_percentage": 0.6075619295958279, "num_intersection": 5126, "num_union": 11748, "num_only_computed": 3311, "num_only_roped": 3311, "total_diff": 6622, "diff_percentage": 0.5636704119850188, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:20:15.893676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016357421875, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:21:35.036192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46032020770229337, "overlap_percentage": 0.6304373592509186, "num_intersection": 5319, "num_union": 11555, "num_only_computed": 3118, "num_only_roped": 3118, "total_diff": 6236, "diff_percentage": 0.5396797922977066, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:21:39.240675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.1853448275862069}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:22:58.496998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4222147311646722, "overlap_percentage": 0.5937425930315241, "num_intersection": 5010, "num_union": 11866, "num_only_computed": 3428, "num_only_roped": 3428, "total_diff": 6856, "diff_percentage": 0.5777852688353279, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:23:02.288233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.019287109375, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.2568027210884354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:24:20.712708", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38203259356318076, "overlap_percentage": 0.5528561270443233, "num_intersection": 4665, "num_union": 12211, "num_only_computed": 3773, "num_only_roped": 3773, "total_diff": 7546, "diff_percentage": 0.6179674064368192, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:24:23.388612", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.2159090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:25:42.906159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44950188938509106, "overlap_percentage": 0.6202156653631947, "num_intersection": 5234, "num_union": 11644, "num_only_computed": 3205, "num_only_roped": 3205, "total_diff": 6410, "diff_percentage": 0.5504981106149089, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:25:45.596220", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.030029296875, "l2_diff_relative": 0.1921875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:27:06.683035", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48143596945492845, "overlap_percentage": 0.6499585258916933, "num_intersection": 5485, "num_union": 11393, "num_only_computed": 2954, "num_only_roped": 2954, "total_diff": 5908, "diff_percentage": 0.5185640305450715, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:27:10.108792", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.22540983606557377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:28:29.914857", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46578673150399447, "overlap_percentage": 0.6355450236966824, "num_intersection": 5364, "num_union": 11516, "num_only_computed": 3076, "num_only_roped": 3076, "total_diff": 6152, "diff_percentage": 0.5342132684960056, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:28:33.227874", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.020263671875, "mean_diff": 2.849102020263672e-05, "l2_diff": 0.044921875, "l2_diff_relative": 0.27380952380952384}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:29:52.790917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5285701349271031, "overlap_percentage": 0.6915876777251185, "num_intersection": 5837, "num_union": 11043, "num_only_computed": 2603, "num_only_roped": 2603, "total_diff": 5206, "diff_percentage": 0.47142986507289686, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:29:56.057336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.02734375, "l2_diff_relative": 0.13725490196078433}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:30:43.787134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:30:43.800796", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.0031220407196969695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:30:49.768733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7181122533631543, "overlap_percentage": 0.8359317058096415, "num_intersection": 1082030, "num_union": 1506770, "num_only_computed": 228690, "num_only_roped": 196050, "total_diff": 424740, "diff_percentage": 0.2818877466368457, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:30:50.180455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.478515625, "l2_diff_relative": 0.07122093023255814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:31:07.262537", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5738611534593703, "overlap_percentage": 0.7292398725237165, "num_intersection": 1338161, "num_union": 2331855, "num_only_computed": 496847, "num_only_roped": 496847, "total_diff": 993694, "diff_percentage": 0.42613884654062967, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:31:07.813639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 5.14984130859375e-05, "l2_diff": 0.7421875, "l2_diff_relative": 0.11699507389162561}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:31:28.286203", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4925031527466615, "overlap_percentage": 0.6599693298339844, "num_intersection": 1557063, "num_union": 3161529, "num_only_computed": 802233, "num_only_roped": 802233, "total_diff": 1604466, "diff_percentage": 0.5074968472533385, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:31:29.037748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 5.1975250244140625e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.15897435897435896}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:31:55.437043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4415656741891523, "overlap_percentage": 0.6126195734197443, "num_intersection": 1766540, "num_union": 4000628, "num_only_computed": 1117044, "num_only_roped": 1117044, "total_diff": 2234088, "diff_percentage": 0.5584343258108477, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:31:56.359012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 4.982948303222656e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.18386243386243387}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:32:28.724078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42484695281187884, "overlap_percentage": 0.5963404728816106, "num_intersection": 2032252, "num_union": 4783492, "num_only_computed": 1375620, "num_only_roped": 1375620, "total_diff": 2751240, "diff_percentage": 0.5751530471881211, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:32:31.599584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 4.0531158447265625e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.17328042328042328}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:33:10.528387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40751705945425853, "overlap_percentage": 0.5790580749511719, "num_intersection": 2276949, "num_union": 5587371, "num_only_computed": 1655211, "num_only_roped": 1655211, "total_diff": 3310422, "diff_percentage": 0.5924829405457415, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:33:13.421729", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.18253968253968253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:33:59.100889", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3913562564540061, "overlap_percentage": 0.5625536301556755, "num_intersection": 2506991, "num_union": 6405905, "num_only_computed": 1949457, "num_only_roped": 1949457, "total_diff": 3898914, "diff_percentage": 0.6086437435459939, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:34:00.616488", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.170967102050781e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.19375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:34:52.428473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3753623944779352, "overlap_percentage": 0.5458378038908306, "num_intersection": 2718674, "num_union": 7242798, "num_only_computed": 2262062, "num_only_roped": 2262062, "total_diff": 4524124, "diff_percentage": 0.6246376055220648, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:34:54.185895", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.050048828125, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.2128205128205128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:35:52.814066", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37092703524811116, "overlap_percentage": 0.5411331540062314, "num_intersection": 2978951, "num_union": 8031097, "num_only_computed": 2526073, "num_only_roped": 2526073, "total_diff": 5052146, "diff_percentage": 0.6290729647518888, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:35:54.843039", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.19923857868020303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:37:02.980992", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3664390783619852, "overlap_percentage": 0.5363416257111923, "num_intersection": 3233771, "num_union": 8824853, "num_only_computed": 2795541, "num_only_roped": 2795541, "total_diff": 5591082, "diff_percentage": 0.6335609216380148, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:37:06.028228", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 3.814697265625e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.1670792079207921}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:38:22.048858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3586304732837847, "overlap_percentage": 0.5279293823242187, "num_intersection": 3459838, "num_union": 9647362, "num_only_computed": 3093762, "num_only_roped": 3093762, "total_diff": 6187524, "diff_percentage": 0.6413695267162153, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:38:24.584721", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.457069396972656e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.1497584541062802}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:39:46.496947", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34991129981178565, "overlap_percentage": 0.5184211730957031, "num_intersection": 3669327, "num_union": 10486449, "num_only_computed": 3408561, "num_only_roped": 3408561, "total_diff": 6817122, "diff_percentage": 0.6500887001882143, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:39:49.308558", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0908203125, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.15625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:41:19.284959", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3490071487560923, "overlap_percentage": 0.5174281679350754, "num_intersection": 3933580, "num_union": 11270772, "num_only_computed": 3668596, "num_only_roped": 3668596, "total_diff": 7337192, "diff_percentage": 0.6509928512439077, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:41:22.368909", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.170967102050781e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.1642512077294686}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:43:00.285955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3515286444597433, "overlap_percentage": 0.5201941459409652, "num_intersection": 4227339, "num_union": 12025589, "num_only_computed": 3899125, "num_only_roped": 3899125, "total_diff": 7798250, "diff_percentage": 0.6484713555402567, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:43:03.632778", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 2.956390380859375e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.1595238095238095}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:44:50.222074", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3427703264608469, "overlap_percentage": 0.5105420036564109, "num_intersection": 3993118, "num_union": 11649544, "num_only_computed": 3828213, "num_only_roped": 3828213, "total_diff": 7656426, "diff_percentage": 0.6572296735391531, "num_computed": 7821331, "num_roped": 7821331}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 931, "seq_len_k": 16291, "queries_shape": [1, 32, 931, 128], "keys_shape": [1, 8, 16291, 128], "mask_shape": [1, 32, 931, 16291], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:44:53.814002", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.16042780748663102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 931, "seq_len_k": 16291, "queries_shape": [1, 32, 931, 128], "keys_shape": [1, 8, 16291, 128], "attention_shape": [1, 32, 931, 16291]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:46:39.155514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4362023208235237, "overlap_percentage": 0.6074385405162187, "num_intersection": 297001, "num_union": 680879, "num_only_computed": 191939, "num_only_roped": 191939, "total_diff": 383878, "diff_percentage": 0.5637976791764763, "num_computed": 488940, "num_roped": 488940}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16349, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16349, 128], "mask_shape": [1, 32, 58, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:46:42.444974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.27734375, "l2_diff_relative": 0.16824644549763032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16349, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16349, 128], "attention_shape": [1, 32, 58, 16349]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:48:12.758951", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43469752403641626, "overlap_percentage": 0.6059779385600759, "num_intersection": 5109, "num_union": 11753, "num_only_computed": 3322, "num_only_roped": 3322, "total_diff": 6644, "diff_percentage": 0.5653024759635837, "num_computed": 8431, "num_roped": 8431}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16350, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16350, 128], "mask_shape": [1, 32, 1, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:48:15.468706", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.2185929648241206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16350, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16350, 128], "attention_shape": [1, 32, 1, 16350]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:49:34.415723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46346120465197016, "overlap_percentage": 0.6333768236270905, "num_intersection": 5340, "num_union": 11522, "num_only_computed": 3091, "num_only_roped": 3091, "total_diff": 6182, "diff_percentage": 0.5365387953480298, "num_computed": 8431, "num_roped": 8431}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:49:37.696317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.032958984375, "l2_diff_relative": 0.18342391304347827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 1, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:50:59.581344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49437306158617633, "overlap_percentage": 0.661646110056926, "num_intersection": 5579, "num_union": 11285, "num_only_computed": 2853, "num_only_roped": 2853, "total_diff": 5706, "diff_percentage": 0.5056269384138237, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:51:02.521567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.21893491124260356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:52:24.450045", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45996017660808586, "overlap_percentage": 0.6300996204933587, "num_intersection": 5313, "num_union": 11551, "num_only_computed": 3119, "num_only_roped": 3119, "total_diff": 6238, "diff_percentage": 0.5400398233919141, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:52:28.283648", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.20943708609271522}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:53:47.672594", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48324685603728784, "overlap_percentage": 0.6516067828767935, "num_intersection": 5495, "num_union": 11371, "num_only_computed": 2938, "num_only_roped": 2938, "total_diff": 5876, "diff_percentage": 0.5167531439627122, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:53:52.118097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01202392578125, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.0247802734375, "l2_diff_relative": 0.16916666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:55:11.886509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45597375690607733, "overlap_percentage": 0.6263488675441717, "num_intersection": 5282, "num_union": 11584, "num_only_computed": 3151, "num_only_roped": 3151, "total_diff": 6302, "diff_percentage": 0.5440262430939227, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:55:15.964542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.18461538461538463}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:56:35.797662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.439494794333504, "overlap_percentage": 0.6106236661133507, "num_intersection": 5150, "num_union": 11718, "num_only_computed": 3284, "num_only_roped": 3284, "total_diff": 6568, "diff_percentage": 0.560505205666496, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:56:39.767867", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0174560546875, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.032958984375, "l2_diff_relative": 0.19285714285714287}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:57:58.955718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4697220528012547, "overlap_percentage": 0.6391984823334124, "num_intersection": 5391, "num_union": 11477, "num_only_computed": 3043, "num_only_roped": 3043, "total_diff": 6086, "diff_percentage": 0.5302779471987453, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:58:02.963638", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.5735626220703125e-05, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.16644021739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:59:22.529742", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4324530865245818, "overlap_percentage": 0.6037937166567872, "num_intersection": 5093, "num_union": 11777, "num_only_computed": 3342, "num_only_roped": 3342, "total_diff": 6684, "diff_percentage": 0.5675469134754182, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T00:59:26.202259", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.18435754189944134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:00:46.135085", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37355479563588995, "overlap_percentage": 0.5439241256668642, "num_intersection": 4588, "num_union": 12282, "num_only_computed": 3847, "num_only_roped": 3847, "total_diff": 7694, "diff_percentage": 0.6264452043641101, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:00:50.270350", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013427734375, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.026611328125, "l2_diff_relative": 0.13974358974358975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:02:09.860554", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45674322224140906, "overlap_percentage": 0.6270744428639166, "num_intersection": 5290, "num_union": 11582, "num_only_computed": 3146, "num_only_roped": 3146, "total_diff": 6292, "diff_percentage": 0.5432567777585909, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:02:14.055710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.1511627906976744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:03:33.935034", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4160302140159463, "overlap_percentage": 0.5876007586533902, "num_intersection": 4957, "num_union": 11915, "num_only_computed": 3479, "num_only_roped": 3479, "total_diff": 6958, "diff_percentage": 0.5839697859840537, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:03:37.252535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.1474514563106796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:04:57.119850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4486607142857143, "overlap_percentage": 0.6194144838212635, "num_intersection": 5226, "num_union": 11648, "num_only_computed": 3211, "num_only_roped": 3211, "total_diff": 6422, "diff_percentage": 0.5513392857142857, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:05:01.267586", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0087890625, "mean_diff": 1.5974044799804688e-05, "l2_diff": 0.0228271484375, "l2_diff_relative": 0.1113095238095238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:06:21.244688", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5105183063288873, "overlap_percentage": 0.6759511674765912, "num_intersection": 5703, "num_union": 11171, "num_only_computed": 2734, "num_only_roped": 2734, "total_diff": 5468, "diff_percentage": 0.4894816936711127, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:06:24.504144", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00927734375, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.0208740234375, "l2_diff_relative": 0.11875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:07:10.215341", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:07:10.229010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.025634765625, "l2_diff_relative": 0.003107244318181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:07:16.180276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7182274275238955, "overlap_percentage": 0.8360097342398022, "num_intersection": 1082131, "num_union": 1506669, "num_only_computed": 228589, "num_only_roped": 195949, "total_diff": 424538, "diff_percentage": 0.2817725724761046, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:07:18.063189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 4.100799560546875e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.07126168224299065}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:07:32.813227", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5689367272379053, "overlap_percentage": 0.7252513340541294, "num_intersection": 1330842, "num_union": 2339174, "num_only_computed": 504166, "num_only_roped": 504166, "total_diff": 1008332, "diff_percentage": 0.43106327276209466, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:07:33.368725", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.1183252427184466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:07:54.318611", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49244225656285406, "overlap_percentage": 0.6599146525065104, "num_intersection": 1556934, "num_union": 3161658, "num_only_computed": 802362, "num_only_roped": 802362, "total_diff": 1604724, "diff_percentage": 0.507557743437146, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:07:55.073505", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.921875, "l2_diff_relative": 0.14974619289340102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:08:21.456728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44215794757919824, "overlap_percentage": 0.6131893504749645, "num_intersection": 1768183, "num_union": 3998985, "num_only_computed": 1115401, "num_only_roped": 1115401, "total_diff": 2230802, "diff_percentage": 0.5578420524208018, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:08:22.390117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 4.7206878662109375e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.16881443298969073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:08:54.637753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42215841929166925, "overlap_percentage": 0.5936869107759916, "num_intersection": 2023209, "num_union": 4792535, "num_only_computed": 1384663, "num_only_roped": 1384663, "total_diff": 2769326, "diff_percentage": 0.5778415807083308, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:08:55.737582", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.16282051282051282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:09:33.955363", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4072654459171458, "overlap_percentage": 0.5788040161132812, "num_intersection": 2275950, "num_union": 5588370, "num_only_computed": 1656210, "num_only_roped": 1656210, "total_diff": 3312420, "diff_percentage": 0.5927345540828542, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:09:36.786765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.17746113989637305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:10:21.313222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38666067583266345, "overlap_percentage": 0.557686076444738, "num_intersection": 2485299, "num_union": 6427597, "num_only_computed": 1971149, "num_only_roped": 1971149, "total_diff": 3942298, "diff_percentage": 0.6133393241673366, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:10:22.841645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.125, "l2_diff_relative": 0.18}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:11:14.434178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.378826977109733, "overlap_percentage": 0.5494916815506784, "num_intersection": 2736873, "num_union": 7224599, "num_only_computed": 2243863, "num_only_roped": 2243863, "total_diff": 4487726, "diff_percentage": 0.621173022890267, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:11:16.198465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.059326171875, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.18316831683168316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:12:14.671007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3719559470728868, "overlap_percentage": 0.5422272455124628, "num_intersection": 2984974, "num_union": 8025074, "num_only_computed": 2520050, "num_only_roped": 2520050, "total_diff": 5040100, "diff_percentage": 0.6280440529271132, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:12:16.698729", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.11328125, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.17980295566502463}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:13:22.962387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36549103270531696, "overlap_percentage": 0.5353254235309103, "num_intersection": 3227644, "num_union": 8830980, "num_only_computed": 2801668, "num_only_roped": 2801668, "total_diff": 5603336, "diff_percentage": 0.6345089672946831, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:13:25.236304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.15625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:14:39.688849", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3569409363381105, "overlap_percentage": 0.5260964965820313, "num_intersection": 3447826, "num_union": 9659374, "num_only_computed": 3105774, "num_only_roped": 3105774, "total_diff": 6211548, "diff_percentage": 0.6430590636618895, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:14:43.702482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.9609375, "l2_diff_relative": 0.1457345971563981}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:16:05.241374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35994183553166537, "overlap_percentage": 0.5293488679108797, "num_intersection": 3746672, "num_union": 10409104, "num_only_computed": 3331216, "num_only_roped": 3331216, "total_diff": 6662432, "diff_percentage": 0.6400581644683346, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:16:08.080528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.86102294921875e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.1625615763546798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:17:37.772980", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3468250114956702, "overlap_percentage": 0.5150260925292969, "num_intersection": 3915319, "num_union": 11289033, "num_only_computed": 3686857, "num_only_roped": 3686857, "total_diff": 7373714, "diff_percentage": 0.6531749885043299, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:17:41.139820", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1376953125, "mean_diff": 3.218650817871094e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.21391752577319587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:19:18.908733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34146353139342306, "overlap_percentage": 0.5090910388577369, "num_intersection": 4137110, "num_union": 12115818, "num_only_computed": 3989354, "num_only_roped": 3989354, "total_diff": 7978708, "diff_percentage": 0.658536468606577, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:19:22.230216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 2.968311309814453e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.19716494845360824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:21:07.172764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3372736391967335, "overlap_percentage": 0.5044197826247816, "num_intersection": 3994699, "num_union": 11844089, "num_only_computed": 3924695, "num_only_roped": 3924695, "total_diff": 7849390, "diff_percentage": 0.6627263608032665, "num_computed": 7919394, "num_roped": 7919394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 942, "seq_len_k": 16302, "queries_shape": [1, 32, 942, 128], "keys_shape": [1, 8, 16302, 128], "mask_shape": [1, 32, 942, 16302], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:21:10.608523", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 2.8371810913085938e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.17972972972972973}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 942, "seq_len_k": 16302, "queries_shape": [1, 32, 942, 128], "keys_shape": [1, 8, 16302, 128], "attention_shape": [1, 32, 942, 16302]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:22:54.079931", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43251804964310603, "overlap_percentage": 0.6038570330766339, "num_intersection": 295460, "num_union": 683116, "num_only_computed": 193828, "num_only_roped": 193828, "total_diff": 387656, "diff_percentage": 0.567481950356894, "num_computed": 489288, "num_roped": 489288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16360, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 58, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:22:57.327512", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.17142857142857143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16360, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 58, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:24:26.397908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4262045646661031, "overlap_percentage": 0.5976766239924135, "num_intersection": 5042, "num_union": 11830, "num_only_computed": 3394, "num_only_roped": 3394, "total_diff": 6788, "diff_percentage": 0.5737954353338969, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:24:28.852354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.21025641025641026}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:25:45.405584", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44049854874509137, "overlap_percentage": 0.611591798032476, "num_intersection": 5160, "num_union": 11714, "num_only_computed": 3277, "num_only_roped": 3277, "total_diff": 6554, "diff_percentage": 0.5595014512549087, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:25:50.056964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.1793478260869565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:27:08.914399", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.452276443755917, "overlap_percentage": 0.6228517245466398, "num_intersection": 5255, "num_union": 11619, "num_only_computed": 3182, "num_only_roped": 3182, "total_diff": 6364, "diff_percentage": 0.547723556244083, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:27:13.933293", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01123046875, "mean_diff": 2.467632293701172e-05, "l2_diff": 0.0267333984375, "l2_diff_relative": 0.17109375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:28:32.710764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4564598256666954, "overlap_percentage": 0.6268073003081299, "num_intersection": 5289, "num_union": 11587, "num_only_computed": 3149, "num_only_roped": 3149, "total_diff": 6298, "diff_percentage": 0.5435401743333046, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:28:37.509456", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:29:58.202368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41103678929765886, "overlap_percentage": 0.5826025124437071, "num_intersection": 4916, "num_union": 11960, "num_only_computed": 3522, "num_only_roped": 3522, "total_diff": 7044, "diff_percentage": 0.5889632107023411, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:30:01.597230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.21212121212121213}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:31:20.867009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40661721810150847, "overlap_percentage": 0.5781490697949994, "num_intersection": 4879, "num_union": 11999, "num_only_computed": 3560, "num_only_roped": 3560, "total_diff": 7120, "diff_percentage": 0.5933827818984916, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:31:23.419907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.04833984375, "l2_diff_relative": 0.21063829787234042}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:32:41.852850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4475128644939966, "overlap_percentage": 0.6183197061263183, "num_intersection": 5218, "num_union": 11660, "num_only_computed": 3221, "num_only_roped": 3221, "total_diff": 6442, "diff_percentage": 0.5524871355060035, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:32:44.329736", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.04931640625, "l2_diff_relative": 0.23708920187793428}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:34:01.981673", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.432937181663837, "overlap_percentage": 0.6042654028436019, "num_intersection": 5100, "num_union": 11780, "num_only_computed": 3340, "num_only_roped": 3340, "total_diff": 6680, "diff_percentage": 0.567062818336163, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:34:04.460837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.23204419889502761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:35:22.244509", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44731201234673756, "overlap_percentage": 0.6181279620853081, "num_intersection": 5217, "num_union": 11663, "num_only_computed": 3223, "num_only_roped": 3223, "total_diff": 6446, "diff_percentage": 0.5526879876532624, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:35:26.973615", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.05419921875, "l2_diff_relative": 0.27205882352941174}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:36:44.787741", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4276532769556025, "overlap_percentage": 0.5990996327449354, "num_intersection": 5057, "num_union": 11825, "num_only_computed": 3384, "num_only_roped": 3384, "total_diff": 6768, "diff_percentage": 0.5723467230443975, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:36:48.226082", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0189208984375, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.045654296875, "l2_diff_relative": 0.2611731843575419}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:38:06.051663", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45159071367153913, "overlap_percentage": 0.6222011609998815, "num_intersection": 5252, "num_union": 11630, "num_only_computed": 3189, "num_only_roped": 3189, "total_diff": 6378, "diff_percentage": 0.5484092863284609, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:38:08.518088", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.037109375, "l2_diff_relative": 0.22093023255813954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:39:28.233241", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4010455563853622, "overlap_percentage": 0.5724946695095949, "num_intersection": 4833, "num_union": 12051, "num_only_computed": 3609, "num_only_roped": 3609, "total_diff": 7218, "diff_percentage": 0.5989544436146378, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:39:30.763299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.21446700507614214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:40:51.214085", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3671255060728745, "overlap_percentage": 0.537076522151149, "num_intersection": 4534, "num_union": 12350, "num_only_computed": 3908, "num_only_roped": 3908, "total_diff": 7816, "diff_percentage": 0.6328744939271255, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:40:53.740343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.032958984375, "l2_diff_relative": 0.11800699300699301}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:42:14.660487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4305320230430363, "overlap_percentage": 0.6019187492597418, "num_intersection": 5082, "num_union": 11804, "num_only_computed": 3361, "num_only_roped": 3361, "total_diff": 6722, "diff_percentage": 0.5694679769569637, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:42:17.166252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.15450643776824036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:43:36.978995", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42473844076949036, "overlap_percentage": 0.5962335662679142, "num_intersection": 5034, "num_union": 11852, "num_only_computed": 3409, "num_only_roped": 3409, "total_diff": 6818, "diff_percentage": 0.5752615592305096, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "mask_shape": [1, 32, 1, 16375], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:43:39.551166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.1619047619047619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "attention_shape": [1, 32, 1, 16375]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:44:57.344002", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4514825956166738, "overlap_percentage": 0.622098531501658, "num_intersection": 5253, "num_union": 11635, "num_only_computed": 3191, "num_only_roped": 3191, "total_diff": 6382, "diff_percentage": 0.5485174043833262, "num_computed": 8444, "num_roped": 8444}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16376, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16376, 128], "mask_shape": [1, 32, 1, 16376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:44:59.817075", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.011474609375, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.029541015625, "l2_diff_relative": 0.171875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16376, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16376, 128], "attention_shape": [1, 32, 1, 16376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:46:17.631421", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4926639561605091, "overlap_percentage": 0.6601136901942207, "num_intersection": 5574, "num_union": 11314, "num_only_computed": 2870, "num_only_roped": 2870, "total_diff": 5740, "diff_percentage": 0.5073360438394909, "num_computed": 8444, "num_roped": 8444}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16377, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:46:21.013745", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.02392578125, "l2_diff_relative": 0.12894736842105264}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16377, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:47:06.379724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:47:06.393382", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.02587890625, "l2_diff_relative": 0.0031607824427480917}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:47:12.249761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7235616901663509, "overlap_percentage": 0.83961217552534, "num_intersection": 1086794, "num_union": 1502006, "num_only_computed": 223926, "num_only_roped": 191286, "total_diff": 415212, "diff_percentage": 0.27643830983364914, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:47:15.147288", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 3.7670135498046875e-05, "l2_diff": 0.44140625, "l2_diff_relative": 0.06600467289719626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:47:29.684426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5774756373489585, "overlap_percentage": 0.7321515764508929, "num_intersection": 1343504, "num_union": 2326512, "num_only_computed": 491504, "num_only_roped": 491504, "total_diff": 983008, "diff_percentage": 0.42252436265104154, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:47:30.238364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.74609375, "l2_diff_relative": 0.12119289340101523}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:47:50.222971", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49333589892416085, "overlap_percentage": 0.6607165866427951, "num_intersection": 1558826, "num_union": 3159766, "num_only_computed": 800470, "num_only_roped": 800470, "total_diff": 1600940, "diff_percentage": 0.5066641010758391, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:47:50.927915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 5.269050598144531e-05, "l2_diff": 1.0, "l2_diff_relative": 0.16580310880829016}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:48:16.588085", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44520448909988714, "overlap_percentage": 0.6161127957430753, "num_intersection": 1776613, "num_union": 3990555, "num_only_computed": 1106971, "num_only_roped": 1106971, "total_diff": 2213942, "diff_percentage": 0.5547955109001129, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:48:17.473041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.17592592592592593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:48:48.854686", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43079327199612394, "overlap_percentage": 0.6021740253155048, "num_intersection": 2052132, "num_union": 4763612, "num_only_computed": 1355740, "num_only_roped": 1355740, "total_diff": 2711480, "diff_percentage": 0.5692067280038761, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:48:51.946661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.16776315789473684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:49:30.082915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41146673137420725, "overlap_percentage": 0.5830342610677083, "num_intersection": 2292584, "num_union": 5571736, "num_only_computed": 1639576, "num_only_roped": 1639576, "total_diff": 3279152, "diff_percentage": 0.5885332686257928, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:49:31.389888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.1806282722513089}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:50:17.585709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39024985637972714, "overlap_percentage": 0.5614096697639016, "num_intersection": 2501893, "num_union": 6411003, "num_only_computed": 1954555, "num_only_roped": 1954555, "total_diff": 3909110, "diff_percentage": 0.6097501436202728, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:50:19.130928", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.337860107421875e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.20959595959595959}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:51:10.899539", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3817775467141025, "overlap_percentage": 0.5525890149568257, "num_intersection": 2752300, "num_union": 7209172, "num_only_computed": 2228436, "num_only_roped": 2228436, "total_diff": 4456872, "diff_percentage": 0.6182224532858974, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:51:13.544102", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.20790816326530612}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:52:12.537179", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37797053984420115, "overlap_percentage": 0.5485901605515253, "num_intersection": 3020002, "num_union": 7990046, "num_only_computed": 2485022, "num_only_roped": 2485022, "total_diff": 4970044, "diff_percentage": 0.6220294601557989, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:52:14.565343", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 4.100799560546875e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.19318181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:53:21.384037", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3728443400538658, "overlap_percentage": 0.5431705972422725, "num_intersection": 3274945, "num_union": 8783679, "num_only_computed": 2754367, "num_only_roped": 2754367, "total_diff": 5508734, "diff_percentage": 0.6271556599461342, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:53:23.662899", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.18226600985221675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:54:38.337402", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3532218567547681, "overlap_percentage": 0.5220457458496094, "num_intersection": 3421279, "num_union": 9685921, "num_only_computed": 3132321, "num_only_roped": 3132321, "total_diff": 6264642, "diff_percentage": 0.646778143245232, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:54:42.398830", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052001953125, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.17574257425742573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:56:03.840018", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3490996361490468, "overlap_percentage": 0.5175298055013021, "num_intersection": 3663018, "num_union": 10492758, "num_only_computed": 3414870, "num_only_roped": 3414870, "total_diff": 6829740, "diff_percentage": 0.6509003638509532, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:56:06.679623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07861328125, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.17034313725490197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:57:36.111915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34983028523249365, "overlap_percentage": 0.5183322511870285, "num_intersection": 3940453, "num_union": 11263899, "num_only_computed": 3661723, "num_only_roped": 3661723, "total_diff": 7323446, "diff_percentage": 0.6501697147675064, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:57:40.373322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.17326732673267325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:59:17.994169", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3477294104252676, "overlap_percentage": 0.5160225898988785, "num_intersection": 4193439, "num_union": 12059489, "num_only_computed": 3933025, "num_only_roped": 3933025, "total_diff": 7866050, "diff_percentage": 0.6522705895747324, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T01:59:21.279055", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.053466796875, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.16748768472906403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:01:06.436965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3394434309825075, "overlap_percentage": 0.5068425035815349, "num_intersection": 4004887, "num_union": 11798393, "num_only_computed": 3896753, "num_only_roped": 3896753, "total_diff": 7793506, "diff_percentage": 0.6605565690174925, "num_computed": 7901640, "num_roped": 7901640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 940, "seq_len_k": 16300, "queries_shape": [1, 32, 940, 128], "keys_shape": [1, 8, 16300, 128], "mask_shape": [1, 32, 940, 16300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:01:09.988996", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.7894973754882812e-05, "l2_diff": 0.875, "l2_diff_relative": 0.14213197969543148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 940, "seq_len_k": 16300, "queries_shape": [1, 32, 940, 128], "keys_shape": [1, 8, 16300, 128], "attention_shape": [1, 32, 940, 16300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:02:56.858753", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4458646727646181, "overlap_percentage": 0.6167446804161641, "num_intersection": 301730, "num_union": 676730, "num_only_computed": 187500, "num_only_roped": 187500, "total_diff": 375000, "diff_percentage": 0.554135327235382, "num_computed": 489230, "num_roped": 489230}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16358, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 58, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:03:00.169609", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04150390625, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.287109375, "l2_diff_relative": 0.17753623188405798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16358, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 58, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:04:31.092091", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4209905660377358, "overlap_percentage": 0.5925311203319502, "num_intersection": 4998, "num_union": 11872, "num_only_computed": 3437, "num_only_roped": 3437, "total_diff": 6874, "diff_percentage": 0.5790094339622641, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:04:33.627345", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.2639664804469274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:05:53.180725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4649648345923418, "overlap_percentage": 0.6347795163584637, "num_intersection": 5355, "num_union": 11517, "num_only_computed": 3081, "num_only_roped": 3081, "total_diff": 6162, "diff_percentage": 0.5350351654076583, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:05:55.714731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.23214285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:07:15.269370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3913904007916873, "overlap_percentage": 0.5625889046941679, "num_intersection": 4746, "num_union": 12126, "num_only_computed": 3690, "num_only_roped": 3690, "total_diff": 7380, "diff_percentage": 0.6086095992083127, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:07:17.802166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.018798828125, "l2_diff_relative": 0.07077205882352941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:08:37.432230", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4895833333333333, "overlap_percentage": 0.6573426573426573, "num_intersection": 5546, "num_union": 11328, "num_only_computed": 2891, "num_only_roped": 2891, "total_diff": 5782, "diff_percentage": 0.5104166666666666, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:08:39.927403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.2234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:09:58.903288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4448154807774638, "overlap_percentage": 0.6157401920113784, "num_intersection": 5195, "num_union": 11679, "num_only_computed": 3242, "num_only_roped": 3242, "total_diff": 6484, "diff_percentage": 0.5551845192225362, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:10:01.352974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.2708333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:11:18.412248", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4319898175647009, "overlap_percentage": 0.6033420241763451, "num_intersection": 5091, "num_union": 11785, "num_only_computed": 3347, "num_only_roped": 3347, "total_diff": 6694, "diff_percentage": 0.5680101824352991, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:11:20.879571", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.052001953125, "l2_diff_relative": 0.3008474576271186}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:12:38.023216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4530738763561219, "overlap_percentage": 0.6236074899265228, "num_intersection": 5262, "num_union": 11614, "num_only_computed": 3176, "num_only_roped": 3176, "total_diff": 6352, "diff_percentage": 0.546926123643878, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:12:41.577163", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.019775390625, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.26143790849673204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:14:02.723988", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4418247052793439, "overlap_percentage": 0.6128688233202986, "num_intersection": 5172, "num_union": 11706, "num_only_computed": 3267, "num_only_roped": 3267, "total_diff": 6534, "diff_percentage": 0.5581752947206561, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:14:05.318879", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.023193359375, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.3333333333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:15:24.737574", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46383347788378143, "overlap_percentage": 0.6337243749259391, "num_intersection": 5348, "num_union": 11530, "num_only_computed": 3091, "num_only_roped": 3091, "total_diff": 6182, "diff_percentage": 0.5361665221162185, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:15:27.197625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.035400390625, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.0625, "l2_diff_relative": 0.463768115942029}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:16:44.622487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4684645498042627, "overlap_percentage": 0.6380331753554502, "num_intersection": 5385, "num_union": 11495, "num_only_computed": 3055, "num_only_roped": 3055, "total_diff": 6110, "diff_percentage": 0.5315354501957372, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:16:47.451106", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017822265625, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.033935546875, "l2_diff_relative": 0.24645390070921985}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:18:04.928623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4367180185547706, "overlap_percentage": 0.6079383886255925, "num_intersection": 5131, "num_union": 11749, "num_only_computed": 3309, "num_only_roped": 3309, "total_diff": 6618, "diff_percentage": 0.5632819814452293, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:18:07.398681", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 2.288818359375e-05, "l2_diff": 0.046875, "l2_diff_relative": 0.26373626373626374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:19:25.233289", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4613919667590028, "overlap_percentage": 0.6314417723018599, "num_intersection": 5330, "num_union": 11552, "num_only_computed": 3111, "num_only_roped": 3111, "total_diff": 6222, "diff_percentage": 0.5386080332409973, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:19:27.717878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.2635542168674699}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:20:47.334763", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49147451188267516, "overlap_percentage": 0.6590451368321288, "num_intersection": 5563, "num_union": 11319, "num_only_computed": 2878, "num_only_roped": 2878, "total_diff": 5756, "diff_percentage": 0.5085254881173249, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:20:49.909389", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.9311904907226562e-05, "l2_diff": 0.032958984375, "l2_diff_relative": 0.21496815286624205}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:22:10.985495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45238709677419353, "overlap_percentage": 0.6229566453447051, "num_intersection": 5259, "num_union": 11625, "num_only_computed": 3183, "num_only_roped": 3183, "total_diff": 6366, "diff_percentage": 0.5476129032258065, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:22:13.575458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.17857142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:23:35.043734", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41846593295807777, "overlap_percentage": 0.5900260601753139, "num_intersection": 4981, "num_union": 11903, "num_only_computed": 3461, "num_only_roped": 3461, "total_diff": 6922, "diff_percentage": 0.5815340670419222, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:23:37.655999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0107421875, "mean_diff": 1.424551010131836e-05, "l2_diff": 0.0186767578125, "l2_diff_relative": 0.06879496402877698}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:24:58.715851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5293904537632461, "overlap_percentage": 0.6922894705673339, "num_intersection": 5845, "num_union": 11041, "num_only_computed": 2598, "num_only_roped": 2598, "total_diff": 5196, "diff_percentage": 0.47060954623675394, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:25:01.244178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.17676767676767677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:25:48.258250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:25:48.271939", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.025634765625, "l2_diff_relative": 0.003107244318181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:25:54.155689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7202837723973132, "overlap_percentage": 0.8374011124845488, "num_intersection": 1083932, "num_union": 1504868, "num_only_computed": 226788, "num_only_roped": 194148, "total_diff": 420936, "diff_percentage": 0.2797162276026868, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:25:54.536022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.07038551401869159}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:26:09.143650", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5770194462408447, "overlap_percentage": 0.7317848205566406, "num_intersection": 1342831, "num_union": 2327185, "num_only_computed": 492177, "num_only_roped": 492177, "total_diff": 984354, "diff_percentage": 0.4229805537591554, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:26:09.704247", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 5.340576171875e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.12755102040816327}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:26:29.949431", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4902853042447273, "overlap_percentage": 0.657975090874566, "num_intersection": 1552358, "num_union": 3166234, "num_only_computed": 806938, "num_only_roped": 806938, "total_diff": 1613876, "diff_percentage": 0.5097146957552726, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:26:30.675211", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.9765625, "l2_diff_relative": 0.16276041666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:26:56.796656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4485443896724582, "overlap_percentage": 0.6193036166104403, "num_intersection": 1785814, "num_union": 3981354, "num_only_computed": 1097770, "num_only_roped": 1097770, "total_diff": 2195540, "diff_percentage": 0.5514556103275419, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:26:57.720939", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16538461538461538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:27:29.717720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4288151436614805, "overlap_percentage": 0.6002388000488281, "num_intersection": 2045537, "num_union": 4770207, "num_only_computed": 1362335, "num_only_roped": 1362335, "total_diff": 2724670, "diff_percentage": 0.5711848563385195, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:27:30.814010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16538461538461538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:28:09.148496", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4070109015649497, "overlap_percentage": 0.5785469055175781, "num_intersection": 2274939, "num_union": 5589381, "num_only_computed": 1657221, "num_only_roped": 1657221, "total_diff": 3314442, "diff_percentage": 0.5929890984350503, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:28:10.445888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.1798469387755102}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:28:55.893095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.389443844955401, "overlap_percentage": 0.560575148638557, "num_intersection": 2498174, "num_union": 6414722, "num_only_computed": 1958274, "num_only_roped": 1958274, "total_diff": 3916548, "diff_percentage": 0.6105561550445989, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:28:59.696323", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.17574257425742573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:29:52.787665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3889297186898751, "overlap_percentage": 0.560042331093236, "num_intersection": 2789423, "num_union": 7172049, "num_only_computed": 2191313, "num_only_roped": 2191313, "total_diff": 4382626, "diff_percentage": 0.6110702813101249, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:29:54.642908", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.1875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:30:54.036797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36654973884243686, "overlap_percentage": 0.5364601498558408, "num_intersection": 2953226, "num_union": 8056822, "num_only_computed": 2551798, "num_only_roped": 2551798, "total_diff": 5103596, "diff_percentage": 0.6334502611575631, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:30:56.047572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.2135678391959799}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:32:01.655641", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3565803793593555, "overlap_percentage": 0.525704757027004, "num_intersection": 3169638, "num_union": 8888986, "num_only_computed": 2859674, "num_only_roped": 2859674, "total_diff": 5719348, "diff_percentage": 0.6434196206406445, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:32:03.921222", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.076171875, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.125, "l2_diff_relative": 0.17647058823529413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:33:17.485375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3530552030253799, "overlap_percentage": 0.5218637084960938, "num_intersection": 3420086, "num_union": 9687114, "num_only_computed": 3133514, "num_only_roped": 3133514, "total_diff": 6267028, "diff_percentage": 0.6469447969746202, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:33:21.047216", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.15324519230769232}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:34:43.821017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34918128580841074, "overlap_percentage": 0.5176195215295862, "num_intersection": 3663653, "num_union": 10492123, "num_only_computed": 3414235, "num_only_roped": 3414235, "total_diff": 6828470, "diff_percentage": 0.6508187141915892, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:34:46.915511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08251953125, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.15264423076923078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:36:15.162514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34536952828033296, "overlap_percentage": 0.5134195788153286, "num_intersection": 3903106, "num_union": 11301246, "num_only_computed": 3699070, "num_only_roped": 3699070, "total_diff": 7398140, "diff_percentage": 0.654630471719667, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:36:20.160754", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 3.24249267578125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.16747572815533981}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:37:56.147038", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3468405250223577, "overlap_percentage": 0.5150431971396169, "num_intersection": 4185480, "num_union": 12067448, "num_only_computed": 3940984, "num_only_roped": 3940984, "total_diff": 7881968, "diff_percentage": 0.6531594749776424, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:37:59.407138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.15701970443349753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:39:43.252998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34432103741816394, "overlap_percentage": 0.5122601340516842, "num_intersection": 4015641, "num_union": 11662491, "num_only_computed": 3823425, "num_only_roped": 3823425, "total_diff": 7646850, "diff_percentage": 0.6556789625818361, "num_computed": 7839066, "num_roped": 7839066}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "mask_shape": [1, 32, 933, 16293], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:39:49.224894", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.055419921875, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.14497422680412372}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "attention_shape": [1, 32, 933, 16293]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:41:33.357259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4439777171770563, "overlap_percentage": 0.6149370754072614, "num_intersection": 300703, "num_union": 677293, "num_only_computed": 188295, "num_only_roped": 188295, "total_diff": 376590, "diff_percentage": 0.5560222828229436, "num_computed": 488998, "num_roped": 488998}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 58, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:41:36.607846", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.29296875, "l2_diff_relative": 0.1820388349514563}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 58, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:43:06.473382", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4358450404427416, "overlap_percentage": 0.6070920303605313, "num_intersection": 5119, "num_union": 11745, "num_only_computed": 3313, "num_only_roped": 3313, "total_diff": 6626, "diff_percentage": 0.5641549595572584, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:43:08.987429", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.22487437185929648}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:44:27.266090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4325518178729188, "overlap_percentage": 0.6038899430740038, "num_intersection": 5092, "num_union": 11772, "num_only_computed": 3340, "num_only_roped": 3340, "total_diff": 6680, "diff_percentage": 0.5674481821270813, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:44:29.722026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.1871584699453552}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:45:46.256870", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4666086956521739, "overlap_percentage": 0.6363097355626705, "num_intersection": 5366, "num_union": 11500, "num_only_computed": 3067, "num_only_roped": 3067, "total_diff": 6134, "diff_percentage": 0.5333913043478261, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:45:48.697839", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.21524064171122995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:47:05.545698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45246296934205993, "overlap_percentage": 0.6230285782046722, "num_intersection": 5254, "num_union": 11612, "num_only_computed": 3179, "num_only_roped": 3179, "total_diff": 6358, "diff_percentage": 0.54753703065794, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:47:08.382475", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.23136645962732919}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:48:25.430876", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40543242792867856, "overlap_percentage": 0.576950438700498, "num_intersection": 4866, "num_union": 12002, "num_only_computed": 3568, "num_only_roped": 3568, "total_diff": 7136, "diff_percentage": 0.5945675720713215, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:48:27.917528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.03564453125, "l2_diff_relative": 0.1738095238095238}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:49:46.423480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46831476323119775, "overlap_percentage": 0.6378942376096751, "num_intersection": 5380, "num_union": 11488, "num_only_computed": 3054, "num_only_roped": 3054, "total_diff": 6108, "diff_percentage": 0.5316852367688022, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:49:48.956109", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.21518987341772153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:51:10.474460", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44608263329333103, "overlap_percentage": 0.6169531713100178, "num_intersection": 5204, "num_union": 11666, "num_only_computed": 3231, "num_only_roped": 3231, "total_diff": 6462, "diff_percentage": 0.5539173667066689, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:51:13.075113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017333984375, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:52:35.426260", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42087088351722396, "overlap_percentage": 0.5924125666864256, "num_intersection": 4997, "num_union": 11873, "num_only_computed": 3438, "num_only_roped": 3438, "total_diff": 6876, "diff_percentage": 0.5791291164827761, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:52:38.867748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.19651741293532338}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:54:00.876967", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4662379421221865, "overlap_percentage": 0.6359649122807017, "num_intersection": 5365, "num_union": 11507, "num_only_computed": 3071, "num_only_roped": 3071, "total_diff": 6142, "diff_percentage": 0.5337620578778135, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:54:04.657581", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0299072265625, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.045166015625, "l2_diff_relative": 0.26734104046242774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:55:23.749654", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4399590338823931, "overlap_percentage": 0.6110715979137031, "num_intersection": 5155, "num_union": 11717, "num_only_computed": 3281, "num_only_roped": 3281, "total_diff": 6562, "diff_percentage": 0.5600409661176069, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:55:28.328455", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.18401015228426396}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:56:45.777397", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4720404780598447, "overlap_percentage": 0.6413417091383193, "num_intersection": 5411, "num_union": 11463, "num_only_computed": 3026, "num_only_roped": 3026, "total_diff": 6052, "diff_percentage": 0.5279595219401553, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:56:48.463904", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.7762184143066406e-05, "l2_diff": 0.032470703125, "l2_diff_relative": 0.1670854271356784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:58:06.313495", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4783599088838269, "overlap_percentage": 0.6471494607087828, "num_intersection": 5460, "num_union": 11414, "num_only_computed": 2977, "num_only_roped": 2977, "total_diff": 5954, "diff_percentage": 0.5216400911161732, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:58:09.365880", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.20079787234042554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:59:27.815518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5116445718380509, "overlap_percentage": 0.6769376629533065, "num_intersection": 5712, "num_union": 11164, "num_only_computed": 2726, "num_only_roped": 2726, "total_diff": 5452, "diff_percentage": 0.4883554281619491, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T02:59:30.335586", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.16589506172839505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:00:15.961519", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:00:15.975294", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.725290298461914e-06, "l2_diff": 0.0252685546875, "l2_diff_relative": 0.003086235687022901}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:00:21.726971", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7187487551553168, "overlap_percentage": 0.8363627935723115, "num_intersection": 1082588, "num_union": 1506212, "num_only_computed": 228132, "num_only_roped": 195492, "total_diff": 423624, "diff_percentage": 0.2812512448446832, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:00:22.103288", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.032470703125, "mean_diff": 3.981590270996094e-05, "l2_diff": 0.46484375, "l2_diff_relative": 0.0698356807511737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:00:36.526093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5691849338379787, "overlap_percentage": 0.7254529680524554, "num_intersection": 1331212, "num_union": 2338804, "num_only_computed": 503796, "num_only_roped": 503796, "total_diff": 1007592, "diff_percentage": 0.43081506616202125, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:00:37.049839", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 5.507469177246094e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.11951219512195121}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:00:56.683694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49398649311832926, "overlap_percentage": 0.661299811469184, "num_intersection": 1560202, "num_union": 3158390, "num_only_computed": 799094, "num_only_roped": 799094, "total_diff": 1598188, "diff_percentage": 0.5060135068816707, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:00:57.392921", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 4.8160552978515625e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.13613861386138615}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:01:23.299961", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4417300056097588, "overlap_percentage": 0.6127777099609375, "num_intersection": 1766996, "num_union": 4000172, "num_only_computed": 1116588, "num_only_roped": 1116588, "total_diff": 2233176, "diff_percentage": 0.5582699943902412, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:01:24.184387", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 4.601478576660156e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.1642670157068063}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:01:55.352665", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4198242068288277, "overlap_percentage": 0.5913749107947717, "num_intersection": 2015330, "num_union": 4800414, "num_only_computed": 1392542, "num_only_roped": 1392542, "total_diff": 2785084, "diff_percentage": 0.5801757931711723, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:01:56.420548", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.17063492063492064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:02:33.415810", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40341084197833615, "overlap_percentage": 0.5749005635579427, "num_intersection": 2260601, "num_union": 5603719, "num_only_computed": 1671559, "num_only_roped": 1671559, "total_diff": 3343118, "diff_percentage": 0.5965891580216638, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:02:34.688965", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.17989417989417988}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:03:18.141346", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3940649958129075, "overlap_percentage": 0.5653466617359835, "num_intersection": 2519438, "num_union": 6393458, "num_only_computed": 1937010, "num_only_roped": 1937010, "total_diff": 3874020, "diff_percentage": 0.6059350041870925, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:03:19.622765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.0279159545898438e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.18341708542713567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:04:09.852099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3722277622093349, "overlap_percentage": 0.5425160056666324, "num_intersection": 2702129, "num_union": 7259343, "num_only_computed": 2278607, "num_only_roped": 2278607, "total_diff": 4557214, "diff_percentage": 0.627772237790665, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:04:11.560289", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 4.696846008300781e-05, "l2_diff": 1.5078125, "l2_diff_relative": 0.2526178010471204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:05:09.547752", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3673119001193567, "overlap_percentage": 0.5372759501139323, "num_intersection": 2957717, "num_union": 8052331, "num_only_computed": 2547307, "num_only_roped": 2547307, "total_diff": 5094614, "diff_percentage": 0.6326880998806432, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:05:11.586242", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.4453125, "l2_diff_relative": 0.23717948717948717}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:06:18.357275", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35915220702588296, "overlap_percentage": 0.528494461722996, "num_intersection": 3186458, "num_union": 8872166, "num_only_computed": 2842854, "num_only_roped": 2842854, "total_diff": 5685708, "diff_percentage": 0.640847792974117, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:06:20.642506", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 4.076957702636719e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.21153846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:07:34.639368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.354237053476411, "overlap_percentage": 0.5231536865234375, "num_intersection": 3428540, "num_union": 9678660, "num_only_computed": 3125060, "num_only_roped": 3125060, "total_diff": 6250120, "diff_percentage": 0.645762946523589, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:07:37.215814", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.17964824120603015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:08:58.726226", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35457939959872964, "overlap_percentage": 0.5235269334581163, "num_intersection": 3705465, "num_union": 10450311, "num_only_computed": 3372423, "num_only_roped": 3372423, "total_diff": 6744846, "diff_percentage": 0.6454206004012704, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:09:01.510615", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.17625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:10:30.890522", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3535906668861467, "overlap_percentage": 0.522448441077923, "num_intersection": 3971745, "num_union": 11232607, "num_only_computed": 3630431, "num_only_roped": 3630431, "total_diff": 7260862, "diff_percentage": 0.6464093331138533, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:10:33.967855", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 3.170967102050781e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.17625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:12:14.002700", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.352552710093901, "overlap_percentage": 0.5213145594443044, "num_intersection": 4236444, "num_union": 12016484, "num_only_computed": 3890020, "num_only_roped": 3890020, "total_diff": 7780040, "diff_percentage": 0.647447289906099, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:12:17.407295", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.17698019801980197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:14:05.632077", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35079127973389124, "overlap_percentage": 0.5193863552376469, "num_intersection": 4104004, "num_union": 11699276, "num_only_computed": 3797636, "num_only_roped": 3797636, "total_diff": 7595272, "diff_percentage": 0.6492087202661088, "num_computed": 7901640, "num_roped": 7901640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 940, "seq_len_k": 16300, "queries_shape": [1, 32, 940, 128], "keys_shape": [1, 8, 16300, 128], "mask_shape": [1, 32, 940, 16300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:14:09.244210", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 2.8014183044433594e-05, "l2_diff": 0.94140625, "l2_diff_relative": 0.15291878172588833}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 940, "seq_len_k": 16300, "queries_shape": [1, 32, 940, 128], "keys_shape": [1, 8, 16300, 128], "attention_shape": [1, 32, 940, 16300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:15:55.365799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44301374347962663, "overlap_percentage": 0.614011814483985, "num_intersection": 300393, "num_union": 678067, "num_only_computed": 188837, "num_only_roped": 188837, "total_diff": 377674, "diff_percentage": 0.5569862565203734, "num_computed": 489230, "num_roped": 489230}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16358, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 58, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:15:58.601091", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 2.384185791015625e-05, "l2_diff": 0.2890625, "l2_diff_relative": 0.17703349282296652}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16358, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 58, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:17:27.152864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4232683708765713, "overlap_percentage": 0.5947836395969176, "num_intersection": 5017, "num_union": 11853, "num_only_computed": 3418, "num_only_roped": 3418, "total_diff": 6836, "diff_percentage": 0.5767316291234287, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:17:30.245008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 2.9206275939941406e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.2982456140350877}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:18:47.696692", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46103221337028055, "overlap_percentage": 0.6311047889995258, "num_intersection": 5324, "num_union": 11548, "num_only_computed": 3112, "num_only_roped": 3112, "total_diff": 6224, "diff_percentage": 0.5389677866297194, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:18:50.151425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.044921875, "l2_diff_relative": 0.26436781609195403}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:20:07.606111", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39784589892294947, "overlap_percentage": 0.5692271218587008, "num_intersection": 4802, "num_union": 12070, "num_only_computed": 3634, "num_only_roped": 3634, "total_diff": 7268, "diff_percentage": 0.6021541010770506, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:20:10.070705", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.17391304347826086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:21:26.953114", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47191207257501744, "overlap_percentage": 0.641223183596065, "num_intersection": 5410, "num_union": 11464, "num_only_computed": 3027, "num_only_roped": 3027, "total_diff": 6054, "diff_percentage": 0.5280879274249826, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:21:30.489312", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.491474151611328e-05, "l2_diff": 0.04345703125, "l2_diff_relative": 0.239247311827957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:22:46.761039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4177449168207024, "overlap_percentage": 0.5893089960886571, "num_intersection": 4972, "num_union": 11902, "num_only_computed": 3465, "num_only_roped": 3465, "total_diff": 6930, "diff_percentage": 0.5822550831792976, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:22:49.200570", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 3.039836883544922e-05, "l2_diff": 0.06005859375, "l2_diff_relative": 0.3236842105263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:24:05.747017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45507846180375927, "overlap_percentage": 0.6255036738563641, "num_intersection": 5278, "num_union": 11598, "num_only_computed": 3160, "num_only_roped": 3160, "total_diff": 6320, "diff_percentage": 0.5449215381962408, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:24:08.199706", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.06982421875, "l2_diff_relative": 0.39502762430939226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:25:24.561569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4611255411255411, "overlap_percentage": 0.6311922256458876, "num_intersection": 5326, "num_union": 11550, "num_only_computed": 3112, "num_only_roped": 3112, "total_diff": 6224, "diff_percentage": 0.5388744588744588, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:25:27.451845", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.046630859375, "l2_diff_relative": 0.20851528384279475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:26:46.655387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4167715940569126, "overlap_percentage": 0.58833985069321, "num_intersection": 4965, "num_union": 11913, "num_only_computed": 3474, "num_only_roped": 3474, "total_diff": 6948, "diff_percentage": 0.5832284059430873, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:26:50.597402", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.05859375, "l2_diff_relative": 0.32786885245901637}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:28:09.670830", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45537639044580497, "overlap_percentage": 0.6257850456215192, "num_intersection": 5281, "num_union": 11597, "num_only_computed": 3158, "num_only_roped": 3158, "total_diff": 6316, "diff_percentage": 0.5446236095541951, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:28:12.632265", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 3.218650817871094e-05, "l2_diff": 0.07568359375, "l2_diff_relative": 0.37259615384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:29:31.851978", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47051136858611375, "overlap_percentage": 0.6399289099526067, "num_intersection": 5401, "num_union": 11479, "num_only_computed": 3039, "num_only_roped": 3039, "total_diff": 6078, "diff_percentage": 0.5294886314138862, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:29:35.842770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.2215568862275449}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:30:55.496817", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43916787449910477, "overlap_percentage": 0.6103080568720379, "num_intersection": 5151, "num_union": 11729, "num_only_computed": 3289, "num_only_roped": 3289, "total_diff": 6578, "diff_percentage": 0.5608321255008952, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:30:59.060524", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 2.3245811462402344e-05, "l2_diff": 0.05126953125, "l2_diff_relative": 0.24764150943396226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:32:19.677473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44414029084687767, "overlap_percentage": 0.6150929984598981, "num_intersection": 5192, "num_union": 11690, "num_only_computed": 3249, "num_only_roped": 3249, "total_diff": 6498, "diff_percentage": 0.5558597091531223, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:32:22.622669", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.054931640625, "l2_diff_relative": 0.2580275229357798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:33:42.726733", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4495964279580972, "overlap_percentage": 0.6203056509892193, "num_intersection": 5236, "num_union": 11646, "num_only_computed": 3205, "num_only_roped": 3205, "total_diff": 6410, "diff_percentage": 0.5504035720419028, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:33:46.273779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.05126953125, "l2_diff_relative": 0.23127753303964757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:35:06.158384", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48679112363508276, "overlap_percentage": 0.6548211324330727, "num_intersection": 5528, "num_union": 11356, "num_only_computed": 2914, "num_only_roped": 2914, "total_diff": 5828, "diff_percentage": 0.5132088763649172, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:35:08.820316", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.0281982421875, "l2_diff_relative": 0.1793478260869565}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:36:29.651808", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4836555360281195, "overlap_percentage": 0.6519782042170101, "num_intersection": 5504, "num_union": 11380, "num_only_computed": 2938, "num_only_roped": 2938, "total_diff": 5876, "diff_percentage": 0.5163444639718805, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:36:33.157746", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.2}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:37:52.527520", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4798001927964245, "overlap_percentage": 0.6484661850053298, "num_intersection": 5475, "num_union": 11411, "num_only_computed": 2968, "num_only_roped": 2968, "total_diff": 5936, "diff_percentage": 0.5201998072035755, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:37:55.908509", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2635135135135135}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:39:15.636465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5159350031421133, "overlap_percentage": 0.6806822219590193, "num_intersection": 5747, "num_union": 11139, "num_only_computed": 2696, "num_only_roped": 2696, "total_diff": 5392, "diff_percentage": 0.48406499685788673, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "mask_shape": [1, 32, 1, 16375], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:39:18.578322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "attention_shape": [1, 32, 1, 16375]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:40:06.827178", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:40:06.840868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.725290298461914e-06, "l2_diff": 0.0250244140625, "l2_diff_relative": 0.0030564169847328245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:40:12.734352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7188799924573251, "overlap_percentage": 0.8364516378244746, "num_intersection": 1082703, "num_union": 1506097, "num_only_computed": 228017, "num_only_roped": 195377, "total_diff": 423394, "diff_percentage": 0.28112000754267485, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:40:13.123535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.462890625, "l2_diff_relative": 0.0688953488372093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:40:30.281018", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5701946690625936, "overlap_percentage": 0.7262725830078125, "num_intersection": 1332716, "num_union": 2337300, "num_only_computed": 502292, "num_only_roped": 502292, "total_diff": 1004584, "diff_percentage": 0.4298053309374064, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:40:30.854018", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.75, "l2_diff_relative": 0.11707317073170732}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:40:51.203807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4938848004103077, "overlap_percentage": 0.6612086825900607, "num_intersection": 1559987, "num_union": 3158605, "num_only_computed": 799309, "num_only_roped": 799309, "total_diff": 1598618, "diff_percentage": 0.5061151995896923, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:40:51.924490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.15141752577319587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:41:18.101463", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44237904827264696, "overlap_percentage": 0.6134019331498579, "num_intersection": 1768796, "num_union": 3998372, "num_only_computed": 1114788, "num_only_roped": 1114788, "total_diff": 2229576, "diff_percentage": 0.557620951727353, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:41:19.033357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.17277486910994763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:41:50.548048", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42238962084046017, "overlap_percentage": 0.5939154991736779, "num_intersection": 2023988, "num_union": 4791756, "num_only_computed": 1383884, "num_only_roped": 1383884, "total_diff": 2767768, "diff_percentage": 0.5776103791595398, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:41:53.768537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.16839378238341968}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:42:31.239937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4057001108034132, "overlap_percentage": 0.577221425374349, "num_intersection": 2269727, "num_union": 5594593, "num_only_computed": 1662433, "num_only_roped": 1662433, "total_diff": 3324866, "diff_percentage": 0.5942998891965868, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:42:32.535817", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.2421875, "l2_diff_relative": 0.20703125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:43:17.410180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3781468478755834, "overlap_percentage": 0.5487758412080652, "num_intersection": 2445591, "num_union": 6467305, "num_only_computed": 2010857, "num_only_roped": 2010857, "total_diff": 4021714, "diff_percentage": 0.6218531521244166, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:43:18.898547", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.4332275390625e-05, "l2_diff": 1.25, "l2_diff_relative": 0.20618556701030927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:44:10.593777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3731362705285242, "overlap_percentage": 0.5434803209806743, "num_intersection": 2706932, "num_union": 7254540, "num_only_computed": 2273804, "num_only_roped": 2273804, "total_diff": 4547608, "diff_percentage": 0.6268637294714758, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:44:14.296266", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.19444444444444445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:45:11.994632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37388501793030676, "overlap_percentage": 0.5442741030738467, "num_intersection": 2996242, "num_union": 8013806, "num_only_computed": 2508782, "num_only_roped": 2508782, "total_diff": 5017564, "diff_percentage": 0.6261149820696932, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:45:14.008409", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.19125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:46:19.185892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3583499504247074, "overlap_percentage": 0.5276253741720448, "num_intersection": 3181218, "num_union": 8877406, "num_only_computed": 2848094, "num_only_roped": 2848094, "total_diff": 5696188, "diff_percentage": 0.6416500495752926, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:46:21.441650", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.1984924623115578}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:47:35.148623", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35225519442434083, "overlap_percentage": 0.5209892272949219, "num_intersection": 3414355, "num_union": 9692845, "num_only_computed": 3139245, "num_only_roped": 3139245, "total_diff": 6278490, "diff_percentage": 0.6477448055756592, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:47:37.677467", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 3.552436828613281e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.16951219512195123}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:48:58.803764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35842212493554926, "overlap_percentage": 0.527703603108724, "num_intersection": 3735027, "num_union": 10420749, "num_only_computed": 3342861, "num_only_roped": 3342861, "total_diff": 6685722, "diff_percentage": 0.6415778750644507, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:49:03.852524", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.18382352941176472}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:50:31.917490", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3448292759123514, "overlap_percentage": 0.5128223813813308, "num_intersection": 3898566, "num_union": 11305786, "num_only_computed": 3703610, "num_only_roped": 3703610, "total_diff": 7407220, "diff_percentage": 0.6551707240876485, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:50:34.916226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.337860107421875e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.2058080808080808}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:52:11.816925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34087896313040894, "overlap_percentage": 0.5084410636655746, "num_intersection": 4131828, "num_union": 12121100, "num_only_computed": 3994636, "num_only_roped": 3994636, "total_diff": 7989272, "diff_percentage": 0.659121036869591, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:52:15.168047", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.18564356435643564}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:54:00.518948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3419313434238702, "overlap_percentage": 0.5096107861247947, "num_intersection": 3972518, "num_union": 11617882, "num_only_computed": 3822682, "num_only_roped": 3822682, "total_diff": 7645364, "diff_percentage": 0.6580686565761298, "num_computed": 7795200, "num_roped": 7795200}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 928, "seq_len_k": 16288, "queries_shape": [1, 32, 928, 128], "keys_shape": [1, 8, 16288, 128], "mask_shape": [1, 32, 928, 16288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:54:04.070816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 2.8848648071289062e-05, "l2_diff": 0.97265625, "l2_diff_relative": 0.1596153846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 928, "seq_len_k": 16288, "queries_shape": [1, 32, 928, 128], "keys_shape": [1, 8, 16288, 128], "attention_shape": [1, 32, 928, 16288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:55:51.245475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4364982120242471, "overlap_percentage": 0.6077253815849223, "num_intersection": 297106, "num_union": 680658, "num_only_computed": 191776, "num_only_roped": 191776, "total_diff": 383552, "diff_percentage": 0.5635017879757529, "num_computed": 488882, "num_roped": 488882}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16346, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16346, 128], "mask_shape": [1, 32, 58, 16346], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:55:54.536977", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.30859375, "l2_diff_relative": 0.18372093023255814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16346, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16346, 128], "attention_shape": [1, 32, 58, 16346]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:57:25.263982", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4296132971506106, "overlap_percentage": 0.6010202871040455, "num_intersection": 5066, "num_union": 11792, "num_only_computed": 3363, "num_only_roped": 3363, "total_diff": 6726, "diff_percentage": 0.5703867028493894, "num_computed": 8429, "num_roped": 8429}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16347, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16347, 128], "mask_shape": [1, 32, 1, 16347], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:57:27.859521", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.052978515625, "l2_diff_relative": 0.2546948356807512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16347, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16347, 128], "attention_shape": [1, 32, 1, 16347]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:58:46.570491", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4484536082474227, "overlap_percentage": 0.6192170818505338, "num_intersection": 5220, "num_union": 11640, "num_only_computed": 3210, "num_only_roped": 3210, "total_diff": 6420, "diff_percentage": 0.5515463917525774, "num_computed": 8430, "num_roped": 8430}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16348, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16348, 128], "mask_shape": [1, 32, 1, 16348], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T03:58:51.227690", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.044677734375, "l2_diff_relative": 0.26598837209302323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16348, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16348, 128], "attention_shape": [1, 32, 1, 16348]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:00:11.020196", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4477073673364245, "overlap_percentage": 0.6185053380782918, "num_intersection": 5214, "num_union": 11646, "num_only_computed": 3216, "num_only_roped": 3216, "total_diff": 6432, "diff_percentage": 0.5522926326635754, "num_computed": 8430, "num_roped": 8430}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16349, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16349, 128], "mask_shape": [1, 32, 1, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:00:14.299147", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 3.0517578125e-05, "l2_diff": 0.061279296875, "l2_diff_relative": 0.4450354609929078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16349, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16349, 128], "attention_shape": [1, 32, 1, 16349]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:01:33.272941", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4658784664870034, "overlap_percentage": 0.6356304115763255, "num_intersection": 5359, "num_union": 11503, "num_only_computed": 3072, "num_only_roped": 3072, "total_diff": 6144, "diff_percentage": 0.5341215335129966, "num_computed": 8431, "num_roped": 8431}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16350, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16350, 128], "mask_shape": [1, 32, 1, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:01:38.050465", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.968311309814453e-05, "l2_diff": 0.06396484375, "l2_diff_relative": 0.39457831325301207}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16350, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16350, 128], "attention_shape": [1, 32, 1, 16350]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:02:57.648349", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4550004314436103, "overlap_percentage": 0.6254299608587356, "num_intersection": 5273, "num_union": 11589, "num_only_computed": 3158, "num_only_roped": 3158, "total_diff": 6316, "diff_percentage": 0.5449995685563896, "num_computed": 8431, "num_roped": 8431}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:03:01.238554", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.2376847290640394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 1, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:04:20.936151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42927366725993726, "overlap_percentage": 0.6006878557874763, "num_intersection": 5065, "num_union": 11799, "num_only_computed": 3367, "num_only_roped": 3367, "total_diff": 6734, "diff_percentage": 0.5707263327400627, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:04:25.058447", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.2747093023255814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:05:44.627064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4703984654285465, "overlap_percentage": 0.6398244781783681, "num_intersection": 5395, "num_union": 11469, "num_only_computed": 3037, "num_only_roped": 3037, "total_diff": 6074, "diff_percentage": 0.5296015345714535, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:05:48.697202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.467632293701172e-05, "l2_diff": 0.045654296875, "l2_diff_relative": 0.26264044943820225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:07:07.916541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4310198540641439, "overlap_percentage": 0.6023953515949247, "num_intersection": 5080, "num_union": 11786, "num_only_computed": 3353, "num_only_roped": 3353, "total_diff": 6706, "diff_percentage": 0.5689801459358561, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:07:11.542469", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.0625, "l2_diff_relative": 0.23357664233576642}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:08:28.754569", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4437596302003082, "overlap_percentage": 0.6147278548559232, "num_intersection": 5184, "num_union": 11682, "num_only_computed": 3249, "num_only_roped": 3249, "total_diff": 6498, "diff_percentage": 0.5562403697996918, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:08:31.432051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.058837890625, "l2_diff_relative": 0.25638297872340426}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:09:48.666870", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4537619581142808, "overlap_percentage": 0.6242589518615129, "num_intersection": 5265, "num_union": 11603, "num_only_computed": 3169, "num_only_roped": 3169, "total_diff": 6338, "diff_percentage": 0.5462380418857192, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:09:51.124610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.04296875, "l2_diff_relative": 0.23404255319148937}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:11:09.900251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45942204533656344, "overlap_percentage": 0.6295944984586199, "num_intersection": 5310, "num_union": 11558, "num_only_computed": 3124, "num_only_roped": 3124, "total_diff": 6248, "diff_percentage": 0.5405779546634366, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:11:12.366024", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.20098039215686275}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:12:29.415236", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5127331420373027, "overlap_percentage": 0.6778897451096622, "num_intersection": 5718, "num_union": 11152, "num_only_computed": 2717, "num_only_roped": 2717, "total_diff": 5434, "diff_percentage": 0.48726685796269725, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:12:31.932501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.1745049504950495}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:13:16.796052", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:13:16.809729", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.0031516335227272725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:13:22.523540", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7216955721937652, "overlap_percentage": 0.8383544499381953, "num_intersection": 1085166, "num_union": 1503634, "num_only_computed": 225554, "num_only_roped": 192914, "total_diff": 418468, "diff_percentage": 0.27830442780623477, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:13:25.300044", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.4375, "l2_diff_relative": 0.06451612903225806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:13:39.491595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5762838604269005, "overlap_percentage": 0.7311929975237165, "num_intersection": 1341745, "num_union": 2328271, "num_only_computed": 493263, "num_only_roped": 493263, "total_diff": 986526, "diff_percentage": 0.4237161395730995, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:13:40.013738", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 5.14984130859375e-05, "l2_diff": 0.80078125, "l2_diff_relative": 0.12685643564356436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:13:59.700164", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4900749396607994, "overlap_percentage": 0.65778562757704, "num_intersection": 1551911, "num_union": 3166681, "num_only_computed": 807385, "num_only_roped": 807385, "total_diff": 1614770, "diff_percentage": 0.5099250603392006, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:14:00.399776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.15248691099476439}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:14:25.760317", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44625768215808365, "overlap_percentage": 0.6171205694025214, "num_intersection": 1779519, "num_union": 3987649, "num_only_computed": 1104065, "num_only_roped": 1104065, "total_diff": 2208130, "diff_percentage": 0.5537423178419164, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:14:26.636720", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.984375, "l2_diff_relative": 0.16321243523316062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:14:57.588873", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43352905581866186, "overlap_percentage": 0.6048416724571815, "num_intersection": 2061223, "num_union": 4754521, "num_only_computed": 1346649, "num_only_roped": 1346649, "total_diff": 2693298, "diff_percentage": 0.5664709441813381, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:14:58.654935", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.16752577319587628}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:15:37.632206", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4070894454872538, "overlap_percentage": 0.5786262512207031, "num_intersection": 2275251, "num_union": 5589069, "num_only_computed": 1656909, "num_only_roped": 1656909, "total_diff": 3313818, "diff_percentage": 0.5929105545127462, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:15:38.882827", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.21693121693121692}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:16:21.748207", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3812768397480105, "overlap_percentage": 0.5520643346449908, "num_intersection": 2460246, "num_union": 6452650, "num_only_computed": 1996202, "num_only_roped": 1996202, "total_diff": 3992404, "diff_percentage": 0.6187231602519895, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:16:25.888709", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.21391752577319587}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:17:16.061561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3778209689408142, "overlap_percentage": 0.5484326011256168, "num_intersection": 2731598, "num_union": 7229874, "num_only_computed": 2249138, "num_only_roped": 2249138, "total_diff": 4498276, "diff_percentage": 0.6221790310591858, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:17:17.756474", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.19923857868020303}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:18:18.199558", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37405733650442585, "overlap_percentage": 0.5444566635858445, "num_intersection": 2997247, "num_union": 8012801, "num_only_computed": 2507777, "num_only_roped": 2507777, "total_diff": 5015554, "diff_percentage": 0.6259426634955741, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:18:20.294080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.059814453125, "mean_diff": 4.1484832763671875e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.1919191919191919}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:19:27.648254", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36722131240104655, "overlap_percentage": 0.5371790346891984, "num_intersection": 3238820, "num_union": 8819804, "num_only_computed": 2790492, "num_only_roped": 2790492, "total_diff": 5580984, "diff_percentage": 0.6327786875989534, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:19:29.962831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.16304347826086957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:20:45.079501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35552175622140036, "overlap_percentage": 0.5245533752441406, "num_intersection": 3437713, "num_union": 9669487, "num_only_computed": 3115887, "num_only_roped": 3115887, "total_diff": 6231774, "diff_percentage": 0.6444782437785996, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:20:47.678725", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06982421875, "mean_diff": 3.528594970703125e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.17892156862745098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:22:10.726395", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3478800546777967, "overlap_percentage": 0.5161884449146412, "num_intersection": 3653524, "num_union": 10502252, "num_only_computed": 3424364, "num_only_roped": 3424364, "total_diff": 6848728, "diff_percentage": 0.6521199453222033, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:22:14.512744", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.1715686274509804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:23:44.003425", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3485423104223925, "overlap_percentage": 0.5169171300427667, "num_intersection": 3929695, "num_union": 11274657, "num_only_computed": 3672481, "num_only_roped": 3672481, "total_diff": 7344962, "diff_percentage": 0.6514576895776075, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:23:47.023203", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.17202970297029702}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:25:24.500707", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3467588319034022, "overlap_percentage": 0.514953121062248, "num_intersection": 4184748, "num_union": 12068180, "num_only_computed": 3941716, "num_only_roped": 3941716, "total_diff": 7883432, "diff_percentage": 0.6532411680965978, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:25:29.684661", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.15114795918367346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:27:13.811897", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3377300521367323, "overlap_percentage": 0.504930051615843, "num_intersection": 3958180, "num_union": 11719952, "num_only_computed": 3880886, "num_only_roped": 3880886, "total_diff": 7761772, "diff_percentage": 0.6622699478632676, "num_computed": 7839066, "num_roped": 7839066}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "mask_shape": [1, 32, 933, 16293], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:27:17.307355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05419921875, "mean_diff": 2.8014183044433594e-05, "l2_diff": 0.8203125, "l2_diff_relative": 0.13530927835051546}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "attention_shape": [1, 32, 933, 16293]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:29:01.816813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4407846857809586, "overlap_percentage": 0.6118675332005448, "num_intersection": 299202, "num_union": 678794, "num_only_computed": 189796, "num_only_roped": 189796, "total_diff": 379592, "diff_percentage": 0.5592153142190415, "num_computed": 488998, "num_roped": 488998}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 58, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:29:05.139722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.28515625, "l2_diff_relative": 0.17464114832535885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 58, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:30:35.791492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43682371986027096, "overlap_percentage": 0.6080407969639469, "num_intersection": 5127, "num_union": 11737, "num_only_computed": 3305, "num_only_roped": 3305, "total_diff": 6610, "diff_percentage": 0.5631762801397291, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:30:38.322406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.19369369369369369}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:31:57.247654", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4331605336959293, "overlap_percentage": 0.6044829222011385, "num_intersection": 5097, "num_union": 11767, "num_only_computed": 3335, "num_only_roped": 3335, "total_diff": 6670, "diff_percentage": 0.5668394663040707, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:32:01.135827", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.4199485778808594e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.17486338797814208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:33:20.313990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49151043509020165, "overlap_percentage": 0.6590774338906676, "num_intersection": 5558, "num_union": 11308, "num_only_computed": 2875, "num_only_roped": 2875, "total_diff": 5750, "diff_percentage": 0.5084895649097984, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:33:24.678776", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.18970588235294117}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:34:44.774856", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4362598995146044, "overlap_percentage": 0.607494367366299, "num_intersection": 5123, "num_union": 11743, "num_only_computed": 3310, "num_only_roped": 3310, "total_diff": 6620, "diff_percentage": 0.5637401004853956, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:34:48.546878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.037841796875, "l2_diff_relative": 0.23628048780487804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:36:09.914072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4015787287079352, "overlap_percentage": 0.5730377045292863, "num_intersection": 4833, "num_union": 12035, "num_only_computed": 3601, "num_only_roped": 3601, "total_diff": 7202, "diff_percentage": 0.5984212712920648, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:36:12.523477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.1574468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:37:34.323994", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4671653474819518, "overlap_percentage": 0.6368271282902538, "num_intersection": 5371, "num_union": 11497, "num_only_computed": 3063, "num_only_roped": 3063, "total_diff": 6126, "diff_percentage": 0.5328346525180482, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:37:36.946713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.20714285714285716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:38:58.848463", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44819297793802043, "overlap_percentage": 0.618968583283936, "num_intersection": 5221, "num_union": 11649, "num_only_computed": 3214, "num_only_roped": 3214, "total_diff": 6428, "diff_percentage": 0.5518070220619796, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:39:01.418941", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.045166015625, "l2_diff_relative": 0.2945859872611465}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:40:18.808343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.424109404018234, "overlap_percentage": 0.5956135151155898, "num_intersection": 5024, "num_union": 11846, "num_only_computed": 3411, "num_only_roped": 3411, "total_diff": 6822, "diff_percentage": 0.575890595981766, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:40:21.769534", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.052490234375, "l2_diff_relative": 0.26741293532338306}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:41:38.159202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4690465824989116, "overlap_percentage": 0.6385727833096254, "num_intersection": 5387, "num_union": 11485, "num_only_computed": 3049, "num_only_roped": 3049, "total_diff": 6098, "diff_percentage": 0.5309534175010884, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:41:40.616703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.7642974853515625e-05, "l2_diff": 0.029052734375, "l2_diff_relative": 0.18949044585987262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:42:57.883744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4242782373797062, "overlap_percentage": 0.5957799905168326, "num_intersection": 5026, "num_union": 11846, "num_only_computed": 3410, "num_only_roped": 3410, "total_diff": 6820, "diff_percentage": 0.5757217626202937, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:43:00.334964", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.22443181818181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:44:18.782511", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46768722275376184, "overlap_percentage": 0.6373118407016712, "num_intersection": 5377, "num_union": 11497, "num_only_computed": 3060, "num_only_roped": 3060, "total_diff": 6120, "diff_percentage": 0.5323127772462382, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:44:21.256940", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0301513671875, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.056396484375, "l2_diff_relative": 0.3023560209424084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:45:40.581448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46259859582213747, "overlap_percentage": 0.632570819011497, "num_intersection": 5337, "num_union": 11537, "num_only_computed": 3100, "num_only_roped": 3100, "total_diff": 6200, "diff_percentage": 0.5374014041778625, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:45:43.085849", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.537799835205078e-05, "l2_diff": 0.025390625, "l2_diff_relative": 0.1566265060240964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:47:02.407224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.475045887597238, "overlap_percentage": 0.6441099786679307, "num_intersection": 5435, "num_union": 11441, "num_only_computed": 3003, "num_only_roped": 3003, "total_diff": 6006, "diff_percentage": 0.524954112402762, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:47:06.567805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.1783980582524272}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:48:25.793255", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4373562728898731, "overlap_percentage": 0.6085565299834084, "num_intersection": 5135, "num_union": 11741, "num_only_computed": 3303, "num_only_roped": 3303, "total_diff": 6606, "diff_percentage": 0.5626437271101269, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:48:30.343120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.029052734375, "l2_diff_relative": 0.13340807174887892}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:49:49.319055", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46142523162178545, "overlap_percentage": 0.6314729233321483, "num_intersection": 5329, "num_union": 11549, "num_only_computed": 3110, "num_only_roped": 3110, "total_diff": 6220, "diff_percentage": 0.5385747683782146, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:49:53.511404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.018310546875, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.030029296875, "l2_diff_relative": 0.13914027149321267}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:50:38.885921", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:50:38.899625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7848949432373047e-06, "l2_diff": 0.02587890625, "l2_diff_relative": 0.003136837121212121}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:50:44.705411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7216646571268391, "overlap_percentage": 0.8383335908529048, "num_intersection": 1085139, "num_union": 1503661, "num_only_computed": 225581, "num_only_roped": 192941, "total_diff": 418522, "diff_percentage": 0.2783353428731609, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:50:46.952988", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.423828125, "l2_diff_relative": 0.06337616822429906}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:51:01.378312", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5740737881400276, "overlap_percentage": 0.7294115339006696, "num_intersection": 1338476, "num_union": 2331540, "num_only_computed": 496532, "num_only_roped": 496532, "total_diff": 993064, "diff_percentage": 0.42592621185997237, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:51:01.908692", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 5.125999450683594e-05, "l2_diff": 0.6953125, "l2_diff_relative": 0.11469072164948453}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:51:21.929922", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4937977813649471, "overlap_percentage": 0.6611306932237413, "num_intersection": 1559803, "num_union": 3158789, "num_only_computed": 799493, "num_only_roped": 799493, "total_diff": 1598986, "diff_percentage": 0.5062022186350529, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:51:22.637571", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 4.887580871582031e-05, "l2_diff": 0.84765625, "l2_diff_relative": 0.13769035532994925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:51:48.463006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4500427432088584, "overlap_percentage": 0.6207303133877841, "num_intersection": 1789928, "num_union": 3977240, "num_only_computed": 1093656, "num_only_roped": 1093656, "total_diff": 2187312, "diff_percentage": 0.5499572567911416, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:51:49.366727", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.17336683417085427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:52:21.050452", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42344062028921825, "overlap_percentage": 0.5949536837064303, "num_intersection": 2027526, "num_union": 4788218, "num_only_computed": 1380346, "num_only_roped": 1380346, "total_diff": 2760692, "diff_percentage": 0.5765593797107817, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:52:24.266406", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 3.981590270996094e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.17277486910994763}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:53:01.686969", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4030695715067148, "overlap_percentage": 0.5745539347330729, "num_intersection": 2259238, "num_union": 5605082, "num_only_computed": 1672922, "num_only_roped": 1672922, "total_diff": 3345844, "diff_percentage": 0.5969304284932851, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:53:02.963722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.17578125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:53:48.038678", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3936122623048736, "overlap_percentage": 0.5648805954877067, "num_intersection": 2517361, "num_union": 6395535, "num_only_computed": 1939087, "num_only_roped": 1939087, "total_diff": 3878174, "diff_percentage": 0.6063877376951263, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:53:49.595239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.1771356783919598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:54:41.181200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3811108590848415, "overlap_percentage": 0.5518903230365954, "num_intersection": 2748820, "num_union": 7212652, "num_only_computed": 2231916, "num_only_roped": 2231916, "total_diff": 4463832, "diff_percentage": 0.6188891409151586, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:54:44.251029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08642578125, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.18125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:55:41.790766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3768458063222833, "overlap_percentage": 0.5474045163109189, "num_intersection": 3013475, "num_union": 7996573, "num_only_computed": 2491549, "num_only_roped": 2491549, "total_diff": 4983098, "diff_percentage": 0.6231541936777167, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:55:43.776714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.21375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:56:48.744198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3604132337508526, "overlap_percentage": 0.5298584647800612, "num_intersection": 3194682, "num_union": 8863942, "num_only_computed": 2834630, "num_only_roped": 2834630, "total_diff": 5669260, "diff_percentage": 0.6395867662491473, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:56:50.994301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.20351758793969849}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:58:03.774296", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3552254688753186, "overlap_percentage": 0.5242308044433593, "num_intersection": 3435599, "num_union": 9671601, "num_only_computed": 3118001, "num_only_roped": 3118001, "total_diff": 6236002, "diff_percentage": 0.6447745311246814, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:58:06.307127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 3.4809112548828125e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.16826923076923078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:59:29.030784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3514912370312167, "overlap_percentage": 0.5201531869393808, "num_intersection": 3681586, "num_union": 10474190, "num_only_computed": 3396302, "num_only_roped": 3396302, "total_diff": 6792604, "diff_percentage": 0.6485087629687832, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T04:59:33.963397", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 3.24249267578125e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1748768472906404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:01:03.737506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3464718454508566, "overlap_percentage": 0.5146365987843481, "num_intersection": 3912358, "num_union": 11291994, "num_only_computed": 3689818, "num_only_roped": 3689818, "total_diff": 7379636, "diff_percentage": 0.6535281545491434, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:01:06.795687", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.9802322387695312e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.16923076923076924}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:02:45.575167", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3462697733472359, "overlap_percentage": 0.5144136490360383, "num_intersection": 4180364, "num_union": 12072564, "num_only_computed": 3946100, "num_only_roped": 3946100, "total_diff": 7892200, "diff_percentage": 0.653730226652764, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:02:48.925357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.0040740966796875e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.16540404040404041}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:04:34.233044", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3477802899426305, "overlap_percentage": 0.5160786109395236, "num_intersection": 4068707, "num_union": 11699073, "num_only_computed": 3815183, "num_only_roped": 3815183, "total_diff": 7630366, "diff_percentage": 0.6522197100573695, "num_computed": 7883890, "num_roped": 7883890}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "mask_shape": [1, 32, 938, 16298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:04:39.729374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.83984375, "l2_diff_relative": 0.13853092783505155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "attention_shape": [1, 32, 938, 16298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:06:25.373412", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44346640620619854, "overlap_percentage": 0.6144464523725806, "num_intersection": 300570, "num_union": 677774, "num_only_computed": 188602, "num_only_roped": 188602, "total_diff": 377204, "diff_percentage": 0.5565335937938015, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 58, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:06:31.211802", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.30078125, "l2_diff_relative": 0.18689320388349515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 58, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:08:02.038405", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4335004674088553, "overlap_percentage": 0.604813848707612, "num_intersection": 5101, "num_union": 11767, "num_only_computed": 3333, "num_only_roped": 3333, "total_diff": 6666, "diff_percentage": 0.5664995325911447, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:08:04.581007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.25870646766169153}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:09:24.260165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4544357272178636, "overlap_percentage": 0.624896265560166, "num_intersection": 5271, "num_union": 11599, "num_only_computed": 3164, "num_only_roped": 3164, "total_diff": 6328, "diff_percentage": 0.5455642727821364, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:09:26.802838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.19642857142857142}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:10:45.902576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4142006874004527, "overlap_percentage": 0.585773562537048, "num_intersection": 4941, "num_union": 11929, "num_only_computed": 3494, "num_only_roped": 3494, "total_diff": 6988, "diff_percentage": 0.5857993125995473, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:10:48.415358", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.046875, "l2_diff_relative": 0.20689655172413793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:12:07.722458", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42319696330662165, "overlap_percentage": 0.5947131341868184, "num_intersection": 5017, "num_union": 11855, "num_only_computed": 3419, "num_only_roped": 3419, "total_diff": 6838, "diff_percentage": 0.5768030366933783, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:12:10.251641", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.05322265625, "l2_diff_relative": 0.3132183908045977}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:13:30.000746", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3933437938723264, "overlap_percentage": 0.5646040777619725, "num_intersection": 4763, "num_union": 12109, "num_only_computed": 3673, "num_only_roped": 3673, "total_diff": 7346, "diff_percentage": 0.6066562061276737, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:13:32.535958", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.14073426573426573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:14:52.294137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47435561380515506, "overlap_percentage": 0.6434751688988977, "num_intersection": 5429, "num_union": 11445, "num_only_computed": 3008, "num_only_roped": 3008, "total_diff": 6016, "diff_percentage": 0.5256443861948449, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:14:54.809676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.022705078125, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.2513888888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:16:12.702231", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.449033920137398, "overlap_percentage": 0.6197700604480265, "num_intersection": 5229, "num_union": 11645, "num_only_computed": 3208, "num_only_roped": 3208, "total_diff": 6416, "diff_percentage": 0.5509660798626019, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:16:17.816683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021240234375, "mean_diff": 2.849102020263672e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.3184713375796178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:17:34.917647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43919495139007336, "overlap_percentage": 0.6103342024176345, "num_intersection": 5150, "num_union": 11726, "num_only_computed": 3288, "num_only_roped": 3288, "total_diff": 6576, "diff_percentage": 0.5608050486099266, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:17:38.844007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.968311309814453e-05, "l2_diff": 0.06298828125, "l2_diff_relative": 0.35833333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:18:56.574628", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3909173328937608, "overlap_percentage": 0.5621000237022992, "num_intersection": 4743, "num_union": 12133, "num_only_computed": 3695, "num_only_roped": 3695, "total_diff": 7390, "diff_percentage": 0.6090826671062392, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:18:59.017948", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.872943878173828e-05, "l2_diff": 0.0546875, "l2_diff_relative": 0.2857142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:20:16.595489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45124677558039555, "overlap_percentage": 0.6218746296954616, "num_intersection": 5248, "num_union": 11630, "num_only_computed": 3191, "num_only_roped": 3191, "total_diff": 6382, "diff_percentage": 0.5487532244196045, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:20:19.042660", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.19196428571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:21:04.517568", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:21:04.531256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.6954879760742188e-06, "l2_diff": 0.02587890625, "l2_diff_relative": 0.003113251879699248}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:21:10.347135", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7188457547072724, "overlap_percentage": 0.8364284610630408, "num_intersection": 1082673, "num_union": 1506127, "num_only_computed": 228047, "num_only_roped": 195407, "total_diff": 423454, "diff_percentage": 0.28115424529272764, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:21:10.785070", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 3.814697265625e-05, "l2_diff": 0.44921875, "l2_diff_relative": 0.06748826291079812}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:21:25.087924", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5719466568438276, "overlap_percentage": 0.7276921953473773, "num_intersection": 1335321, "num_union": 2334695, "num_only_computed": 499687, "num_only_roped": 499687, "total_diff": 999374, "diff_percentage": 0.42805334315617244, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:21:25.626052", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.173683166503906e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.11171497584541062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:21:45.819267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4949454498910772, "overlap_percentage": 0.6621585422092013, "num_intersection": 1562228, "num_union": 3156364, "num_only_computed": 797068, "num_only_roped": 797068, "total_diff": 1594136, "diff_percentage": 0.5050545501089228, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:21:46.548619", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.13854679802955666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:22:15.247531", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.445771486015257, "overlap_percentage": 0.6166555231267755, "num_intersection": 1778178, "num_union": 3988990, "num_only_computed": 1105406, "num_only_roped": 1105406, "total_diff": 2210812, "diff_percentage": 0.554228513984743, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:22:17.813513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.97265625, "l2_diff_relative": 0.15408415841584158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:22:49.101136", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42449198316963044, "overlap_percentage": 0.5959906944861779, "num_intersection": 2031060, "num_union": 4784684, "num_only_computed": 1376812, "num_only_roped": 1376812, "total_diff": 2753624, "diff_percentage": 0.5755080168303696, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:22:50.177459", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1620603015075377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:23:27.082627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4044037982362449, "overlap_percentage": 0.5759081522623698, "num_intersection": 2264563, "num_union": 5599757, "num_only_computed": 1667597, "num_only_roped": 1667597, "total_diff": 3335194, "diff_percentage": 0.595596201763755, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:23:28.376517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.552436828613281e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.17857142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:24:11.484867", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3869532748616182, "overlap_percentage": 0.5579903546501609, "num_intersection": 2486655, "num_union": 6426241, "num_only_computed": 1969793, "num_only_roped": 1969793, "total_diff": 3939586, "diff_percentage": 0.6130467251383819, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:24:12.957622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0986328125, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.17537313432835822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:25:03.237128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3868220420331538, "overlap_percentage": 0.5578538995040091, "num_intersection": 2778523, "num_union": 7182949, "num_only_computed": 2202213, "num_only_roped": 2202213, "total_diff": 4404426, "diff_percentage": 0.6131779579668462, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:25:05.397463", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.19088669950738915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:26:03.339651", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36430367656552853, "overlap_percentage": 0.5340507144019717, "num_intersection": 2939962, "num_union": 8070086, "num_only_computed": 2565062, "num_only_roped": 2565062, "total_diff": 5130124, "diff_percentage": 0.6356963234344715, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:26:05.410035", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.4345855712890625e-05, "l2_diff": 1.4296875, "l2_diff_relative": 0.24206349206349206}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:27:11.513269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3541937405302307, "overlap_percentage": 0.5231064506199049, "num_intersection": 3153972, "num_union": 8904652, "num_only_computed": 2875340, "num_only_roped": 2875340, "total_diff": 5750680, "diff_percentage": 0.6458062594697693, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:27:13.810393", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0634765625, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.19065656565656566}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:28:27.738308", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.355786057390447, "overlap_percentage": 0.5248410034179688, "num_intersection": 3439598, "num_union": 9667602, "num_only_computed": 3114002, "num_only_roped": 3114002, "total_diff": 6228004, "diff_percentage": 0.644213942609553, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:28:30.850198", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05419921875, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.1625615763546798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:29:53.775244", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35258707870965966, "overlap_percentage": 0.5213521321614584, "num_intersection": 3690072, "num_union": 10465704, "num_only_computed": 3387816, "num_only_roped": 3387816, "total_diff": 6775632, "diff_percentage": 0.6474129212903403, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:29:56.659000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05419921875, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.16133004926108374}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:31:26.367830", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35058651974596344, "overlap_percentage": 0.5191618820716595, "num_intersection": 3946760, "num_union": 11257592, "num_only_computed": 3655416, "num_only_roped": 3655416, "total_diff": 7310832, "diff_percentage": 0.6494134802540366, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:31:31.731253", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.0517578125e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.1865482233502538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:33:08.048803", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3460288329547878, "overlap_percentage": 0.5141477277201991, "num_intersection": 4178203, "num_union": 12074725, "num_only_computed": 3948261, "num_only_roped": 3948261, "total_diff": 7896522, "diff_percentage": 0.6539711670452122, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:33:12.423021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1201171875, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.19260204081632654}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:34:56.426747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34666681259957355, "overlap_percentage": 0.514851646088131, "num_intersection": 4054224, "num_union": 11694872, "num_only_computed": 3820324, "num_only_roped": 3820324, "total_diff": 7640648, "diff_percentage": 0.6533331874004265, "num_computed": 7874548, "num_roped": 7874548}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 937, "seq_len_k": 16297, "queries_shape": [1, 32, 937, 128], "keys_shape": [1, 8, 16297, 128], "mask_shape": [1, 32, 937, 16297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:35:00.583552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.7894973754882812e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.15625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 937, "seq_len_k": 16297, "queries_shape": [1, 32, 937, 128], "keys_shape": [1, 8, 16297, 128], "attention_shape": [1, 32, 937, 16297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:36:45.425747", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4371777938732904, "overlap_percentage": 0.6083837305822365, "num_intersection": 297569, "num_union": 680659, "num_only_computed": 191545, "num_only_roped": 191545, "total_diff": 383090, "diff_percentage": 0.5628222061267095, "num_computed": 489114, "num_roped": 489114}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16355, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 58, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:36:48.691111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.306640625, "l2_diff_relative": 0.18255813953488373}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16355, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 58, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:38:17.675209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4310681259014168, "overlap_percentage": 0.6024424946644534, "num_intersection": 5081, "num_union": 11787, "num_only_computed": 3353, "num_only_roped": 3353, "total_diff": 6706, "diff_percentage": 0.5689318740985831, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:38:20.143470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.3484230041503906e-05, "l2_diff": 0.050537109375, "l2_diff_relative": 0.2363013698630137}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:39:37.068502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46601772988006257, "overlap_percentage": 0.6357600189708323, "num_intersection": 5362, "num_union": 11506, "num_only_computed": 3072, "num_only_roped": 3072, "total_diff": 6144, "diff_percentage": 0.5339822701199374, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:39:41.910089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.21520618556701032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:40:58.890288", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46989631436786616, "overlap_percentage": 0.6393598103141671, "num_intersection": 5393, "num_union": 11477, "num_only_computed": 3042, "num_only_roped": 3042, "total_diff": 6084, "diff_percentage": 0.5301036856321338, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:41:02.493460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.21016483516483517}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:42:22.565750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4145564313265135, "overlap_percentage": 0.5861292234736218, "num_intersection": 4944, "num_union": 11926, "num_only_computed": 3491, "num_only_roped": 3491, "total_diff": 6982, "diff_percentage": 0.5854435686734865, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:42:26.210063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.04345703125, "l2_diff_relative": 0.23298429319371727}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:43:46.111030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4425444596443228, "overlap_percentage": 0.6135609293504031, "num_intersection": 5176, "num_union": 11696, "num_only_computed": 3260, "num_only_roped": 3260, "total_diff": 6520, "diff_percentage": 0.5574555403556771, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:43:48.763541", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.04296875, "l2_diff_relative": 0.24719101123595505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:45:09.233626", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.428498856997714, "overlap_percentage": 0.5999288762446657, "num_intersection": 5061, "num_union": 11811, "num_only_computed": 3375, "num_only_roped": 3375, "total_diff": 6750, "diff_percentage": 0.571501143002286, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:45:12.979139", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.1498015873015873}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:46:33.001721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44915836482308485, "overlap_percentage": 0.619888585990281, "num_intersection": 5230, "num_union": 11644, "num_only_computed": 3207, "num_only_roped": 3207, "total_diff": 6414, "diff_percentage": 0.5508416351769152, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:46:35.726713", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.21153846153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:47:56.174356", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4358407079646018, "overlap_percentage": 0.6070878274268104, "num_intersection": 5122, "num_union": 11752, "num_only_computed": 3315, "num_only_roped": 3315, "total_diff": 6630, "diff_percentage": 0.5641592920353983, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:47:59.652742", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.014404296875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.31277533039647576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:49:20.189544", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4473413379073756, "overlap_percentage": 0.6181559611282295, "num_intersection": 5216, "num_union": 11660, "num_only_computed": 3222, "num_only_roped": 3222, "total_diff": 6444, "diff_percentage": 0.5526586620926244, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:49:23.308057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.019287109375, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.2668711656441718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:50:43.012851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39505662560965527, "overlap_percentage": 0.5663664375444418, "num_intersection": 4779, "num_union": 12097, "num_only_computed": 3659, "num_only_roped": 3659, "total_diff": 7318, "diff_percentage": 0.6049433743903447, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:50:46.024944", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.2042079207920792}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:52:04.856670", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43703703703703706, "overlap_percentage": 0.6082474226804123, "num_intersection": 5133, "num_union": 11745, "num_only_computed": 3306, "num_only_roped": 3306, "total_diff": 6612, "diff_percentage": 0.562962962962963, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:52:08.206756", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.036865234375, "l2_diff_relative": 0.21089385474860337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:53:27.842342", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42214357937310415, "overlap_percentage": 0.593672236046925, "num_intersection": 5010, "num_union": 11868, "num_only_computed": 3429, "num_only_roped": 3429, "total_diff": 6858, "diff_percentage": 0.5778564206268959, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:53:30.891670", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.301056338028169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:54:51.786063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43708496509450023, "overlap_percentage": 0.6082938388625593, "num_intersection": 5134, "num_union": 11746, "num_only_computed": 3306, "num_only_roped": 3306, "total_diff": 6612, "diff_percentage": 0.5629150349054998, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:54:56.406354", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.08203125, "l2_diff_relative": 0.358974358974359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:56:15.964360", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48174157303370785, "overlap_percentage": 0.6502369668246446, "num_intersection": 5488, "num_union": 11392, "num_only_computed": 2952, "num_only_roped": 2952, "total_diff": 5904, "diff_percentage": 0.5182584269662921, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:56:18.462328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.028564453125, "l2_diff_relative": 0.1652542372881356}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:57:36.904390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4483527796842828, "overlap_percentage": 0.6191209572325553, "num_intersection": 5226, "num_union": 11656, "num_only_computed": 3215, "num_only_roped": 3215, "total_diff": 6430, "diff_percentage": 0.5516472203157172, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:57:41.123149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.7642974853515625e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.17570754716981132}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:58:58.902043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48687687158710585, "overlap_percentage": 0.6548987086838053, "num_intersection": 5528, "num_union": 11354, "num_only_computed": 2913, "num_only_roped": 2913, "total_diff": 5826, "diff_percentage": 0.5131231284128941, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T05:59:03.129643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.002716064453125e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.17688679245283018}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:00:20.515447", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49376271786251436, "overlap_percentage": 0.6610992655768775, "num_intersection": 5581, "num_union": 11303, "num_only_computed": 2861, "num_only_roped": 2861, "total_diff": 5722, "diff_percentage": 0.5062372821374856, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:00:25.504460", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.5616416931152344e-05, "l2_diff": 0.02490234375, "l2_diff_relative": 0.14825581395348839}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:01:10.481943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:01:10.495580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.814697265625e-06, "l2_diff": 0.026611328125, "l2_diff_relative": 0.0032256155303030305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:01:16.290235", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7187681541898625, "overlap_percentage": 0.8363759270704574, "num_intersection": 1082605, "num_union": 1506195, "num_only_computed": 228115, "num_only_roped": 195475, "total_diff": 423590, "diff_percentage": 0.2812318458101375, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:01:18.596319", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.462890625, "l2_diff_relative": 0.0685763888888889}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:01:32.973938", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5695822277877284, "overlap_percentage": 0.7257755824497768, "num_intersection": 1331804, "num_union": 2338212, "num_only_computed": 503204, "num_only_roped": 503204, "total_diff": 1006408, "diff_percentage": 0.4304177722122716, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:01:33.500572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.11768292682926829}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:01:54.121975", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4938654094190992, "overlap_percentage": 0.6611913045247396, "num_intersection": 1559946, "num_union": 3158646, "num_only_computed": 799350, "num_only_roped": 799350, "total_diff": 1598700, "diff_percentage": 0.5061345905809008, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:01:54.841018", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 5.030632019042969e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.14755154639175258}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:02:20.726138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4430701994291444, "overlap_percentage": 0.6140660372647372, "num_intersection": 1770711, "num_union": 3996457, "num_only_computed": 1112873, "num_only_roped": 1112873, "total_diff": 2225746, "diff_percentage": 0.5569298005708556, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:02:21.608932", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.839897155761719e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.17328042328042328}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:02:53.132118", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42290631179520066, "overlap_percentage": 0.5944260817307693, "num_intersection": 2025728, "num_union": 4790016, "num_only_computed": 1382144, "num_only_roped": 1382144, "total_diff": 2764288, "diff_percentage": 0.5770936882047993, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:02:55.288630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.17015706806282724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:03:32.361577", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4067305310173786, "overlap_percentage": 0.5782636006673177, "num_intersection": 2273825, "num_union": 5590495, "num_only_computed": 1658335, "num_only_roped": 1658335, "total_diff": 3316670, "diff_percentage": 0.5932694689826215, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:03:36.072081", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.1806282722513089}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:04:19.333328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39049537814411556, "overlap_percentage": 0.5616636837230009, "num_intersection": 2503025, "num_union": 6409871, "num_only_computed": 1953423, "num_only_roped": 1953423, "total_diff": 3906846, "diff_percentage": 0.6095046218558845, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:04:20.802282", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.17857142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:05:10.698698", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3777500793195695, "overlap_percentage": 0.5483579133686266, "num_intersection": 2731226, "num_union": 7230246, "num_only_computed": 2249510, "num_only_roped": 2249510, "total_diff": 4499020, "diff_percentage": 0.6222499206804305, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:05:14.110234", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.22786458333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:06:11.001855", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3658661973036604, "overlap_percentage": 0.5357277279808408, "num_intersection": 2949194, "num_union": 8060854, "num_only_computed": 2555830, "num_only_roped": 2555830, "total_diff": 5111660, "diff_percentage": 0.6341338026963396, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:06:12.978544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.2734375, "l2_diff_relative": 0.211139896373057}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:07:17.582919", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3616008019682458, "overlap_percentage": 0.5311407006305197, "num_intersection": 3202413, "num_union": 8856211, "num_only_computed": 2826899, "num_only_roped": 2826899, "total_diff": 5653798, "diff_percentage": 0.6383991980317543, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:07:19.812338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.1875, "l2_diff_relative": 0.1919191919191919}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:08:34.500515", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35641322088945904, "overlap_percentage": 0.5255230712890625, "num_intersection": 3444068, "num_union": 9663132, "num_only_computed": 3109532, "num_only_roped": 3109532, "total_diff": 6219064, "diff_percentage": 0.643586779110541, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:08:38.558344", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08154296875, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.18375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:10:00.567945", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3427947666601056, "overlap_percentage": 0.5105691132722078, "num_intersection": 3613751, "num_union": 10542025, "num_only_computed": 3464137, "num_only_roped": 3464137, "total_diff": 6928274, "diff_percentage": 0.6572052333398943, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:10:03.780154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052001953125, "mean_diff": 3.528594970703125e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.2012820512820513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:11:32.959138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3459939768075487, "overlap_percentage": 0.5141092497726967, "num_intersection": 3908349, "num_union": 11296003, "num_only_computed": 3693827, "num_only_roped": 3693827, "total_diff": 7387654, "diff_percentage": 0.6540060231924514, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:11:37.885749", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.211340206185567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:13:15.606032", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3452713415956464, "overlap_percentage": 0.5133110784715221, "num_intersection": 4171404, "num_union": 12081524, "num_only_computed": 3955060, "num_only_roped": 3955060, "total_diff": 7910120, "diff_percentage": 0.6547286584043536, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:13:18.904313", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05517578125, "mean_diff": 2.968311309814453e-05, "l2_diff": 1.125, "l2_diff_relative": 0.1956521739130435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:15:03.648192", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3418006936943344, "overlap_percentage": 0.5094656684865263, "num_intersection": 3993735, "num_union": 11684397, "num_only_computed": 3845331, "num_only_roped": 3845331, "total_diff": 7690662, "diff_percentage": 0.6581993063056656, "num_computed": 7839066, "num_roped": 7839066}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "mask_shape": [1, 32, 933, 16293], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:15:07.978371", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.055908203125, "mean_diff": 2.9921531677246094e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.1723901098901099}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 933, "seq_len_k": 16293, "queries_shape": [1, 32, 933, 128], "keys_shape": [1, 8, 16293, 128], "attention_shape": [1, 32, 933, 16293]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:16:52.288512", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44131127440144075, "overlap_percentage": 0.6123746927390296, "num_intersection": 299450, "num_union": 678546, "num_only_computed": 189548, "num_only_roped": 189548, "total_diff": 379096, "diff_percentage": 0.5586887255985593, "num_computed": 488998, "num_roped": 488998}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 58, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:16:58.152331", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.16901408450704225}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16351, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 58, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:18:29.120256", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4198871768965227, "overlap_percentage": 0.5914373814041746, "num_intersection": 4987, "num_union": 11877, "num_only_computed": 3445, "num_only_roped": 3445, "total_diff": 6890, "diff_percentage": 0.5801128231034773, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:18:33.497520", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.04443359375, "l2_diff_relative": 0.24863387978142076}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:19:51.727138", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4541691816849185, "overlap_percentage": 0.6246442125237192, "num_intersection": 5267, "num_union": 11597, "num_only_computed": 3165, "num_only_roped": 3165, "total_diff": 6330, "diff_percentage": 0.5458308183150815, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:19:55.903643", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0245361328125, "mean_diff": 2.9087066650390625e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.3049645390070922}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:21:14.224909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4863840662730237, "overlap_percentage": 0.6544527451677932, "num_intersection": 5519, "num_union": 11347, "num_only_computed": 2914, "num_only_roped": 2914, "total_diff": 5828, "diff_percentage": 0.5136159337269763, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:21:18.359299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.25149700598802394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:22:37.131039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4492180787076817, "overlap_percentage": 0.6199454523894226, "num_intersection": 5228, "num_union": 11638, "num_only_computed": 3205, "num_only_roped": 3205, "total_diff": 6410, "diff_percentage": 0.5507819212923183, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:22:41.530879", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.023681640625, "mean_diff": 2.8014183044433594e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.3238255033557047}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:23:59.120132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4039117769454848, "overlap_percentage": 0.5754090585724448, "num_intersection": 4853, "num_union": 12015, "num_only_computed": 3581, "num_only_roped": 3581, "total_diff": 7162, "diff_percentage": 0.5960882230545151, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:24:03.692946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.051513671875, "l2_diff_relative": 0.18444055944055945}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:25:20.311798", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47705779334500875, "overlap_percentage": 0.6459568413564145, "num_intersection": 5448, "num_union": 11420, "num_only_computed": 2986, "num_only_roped": 2986, "total_diff": 5972, "diff_percentage": 0.5229422066549912, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:25:23.778116", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.21721311475409835}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:26:40.969965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43892869327874445, "overlap_percentage": 0.610077059869591, "num_intersection": 5146, "num_union": 11724, "num_only_computed": 3289, "num_only_roped": 3289, "total_diff": 6578, "diff_percentage": 0.5610713067212555, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:26:43.424097", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.22939560439560439}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:28:01.540943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4013955806612394, "overlap_percentage": 0.5728512151748666, "num_intersection": 4832, "num_union": 12038, "num_only_computed": 3603, "num_only_roped": 3603, "total_diff": 7206, "diff_percentage": 0.5986044193387606, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:28:03.984198", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.039794921875, "l2_diff_relative": 0.14450354609929078}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:29:21.864060", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4741808650065531, "overlap_percentage": 0.6433143669985776, "num_intersection": 5427, "num_union": 11445, "num_only_computed": 3009, "num_only_roped": 3009, "total_diff": 6018, "diff_percentage": 0.5258191349934469, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:29:24.297404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.19300518134715025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:30:41.125561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43775031955688115, "overlap_percentage": 0.6089378852536748, "num_intersection": 5137, "num_union": 11735, "num_only_computed": 3299, "num_only_roped": 3299, "total_diff": 6598, "diff_percentage": 0.5622496804431188, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:30:43.544602", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.1609442060085837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:32:00.630578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44878509487421653, "overlap_percentage": 0.6195330093635179, "num_intersection": 5227, "num_union": 11647, "num_only_computed": 3210, "num_only_roped": 3210, "total_diff": 6420, "diff_percentage": 0.5512149051257834, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:32:05.446630", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.17937219730941703}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:33:22.513436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47616131572040943, "overlap_percentage": 0.6451345264904587, "num_intersection": 5443, "num_union": 11431, "num_only_computed": 2994, "num_only_roped": 2994, "total_diff": 5988, "diff_percentage": 0.5238386842795906, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:33:25.025142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.04443359375, "l2_diff_relative": 0.19361702127659575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:34:44.103478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4900229560303726, "overlap_percentage": 0.6577388006636644, "num_intersection": 5550, "num_union": 11326, "num_only_computed": 2888, "num_only_roped": 2888, "total_diff": 5776, "diff_percentage": 0.5099770439696274, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:34:46.618120", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.18818681318681318}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:36:05.656523", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4430098332620778, "overlap_percentage": 0.6140080587817018, "num_intersection": 5181, "num_union": 11695, "num_only_computed": 3257, "num_only_roped": 3257, "total_diff": 6514, "diff_percentage": 0.5569901667379222, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:36:08.143554", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01025390625, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.0216064453125, "l2_diff_relative": 0.10899014778325124}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:37:27.056344", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5138577450892456, "overlap_percentage": 0.6788719042540585, "num_intersection": 5729, "num_union": 11149, "num_only_computed": 2710, "num_only_roped": 2710, "total_diff": 5420, "diff_percentage": 0.4861422549107543, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:37:29.566987", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0091552734375, "mean_diff": 2.3484230041503906e-05, "l2_diff": 0.01904296875, "l2_diff_relative": 0.10833333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:38:15.108438", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:38:15.122126", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.025146484375, "l2_diff_relative": 0.003048058712121212}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:38:21.038451", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7181943561350715, "overlap_percentage": 0.8359873300370828, "num_intersection": 1082102, "num_union": 1506698, "num_only_computed": 228618, "num_only_roped": 195978, "total_diff": 424596, "diff_percentage": 0.28180564386492846, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:38:21.419789", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.07038551401869159}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:38:36.175998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5730644533560563, "overlap_percentage": 0.7285962785993304, "num_intersection": 1336980, "num_union": 2333036, "num_only_computed": 498028, "num_only_roped": 498028, "total_diff": 996056, "diff_percentage": 0.4269355466439438, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:38:36.726513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 5.340576171875e-05, "l2_diff": 0.75, "l2_diff_relative": 0.11707317073170732}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:38:58.260374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4919109240466627, "overlap_percentage": 0.6594373914930556, "num_intersection": 1555808, "num_union": 3162784, "num_only_computed": 803488, "num_only_roped": 803488, "total_diff": 1606976, "diff_percentage": 0.5080890759533373, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:38:58.994510", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16796875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:39:27.623028", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43990500449161374, "overlap_percentage": 0.6110194813121449, "num_intersection": 1761926, "num_union": 4005242, "num_only_computed": 1121658, "num_only_roped": 1121658, "total_diff": 2243316, "diff_percentage": 0.5600949955083863, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:39:30.619336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 4.935264587402344e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.18218085106382978}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:40:02.786506", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4240937463304598, "overlap_percentage": 0.5955980741060697, "num_intersection": 2029722, "num_union": 4786022, "num_only_computed": 1378150, "num_only_roped": 1378150, "total_diff": 2756300, "diff_percentage": 0.5759062536695402, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:40:03.883191", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 4.1484832763671875e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.19300518134715025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:40:42.425163", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4054293041888989, "overlap_percentage": 0.576947275797526, "num_intersection": 2268649, "num_union": 5595671, "num_only_computed": 1663511, "num_only_roped": 1663511, "total_diff": 3327022, "diff_percentage": 0.5945706958111011, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:40:43.744497", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.1989247311827957}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:41:28.550911", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38499396767719213, "overlap_percentage": 0.5559503891888786, "num_intersection": 2477564, "num_union": 6435332, "num_only_computed": 1978884, "num_only_roped": 1978884, "total_diff": 3957768, "diff_percentage": 0.6150060323228079, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:41:30.079328", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.218650817871094e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.18622448979591838}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:42:23.337007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3845377216878857, "overlap_percentage": 0.5554745322779605, "num_intersection": 2766672, "num_union": 7194800, "num_only_computed": 2214064, "num_only_roped": 2214064, "total_diff": 4428128, "diff_percentage": 0.6154622783121143, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:42:25.093610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06298828125, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.20668316831683167}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:43:25.582656", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3727768686235821, "overlap_percentage": 0.5430989946637835, "num_intersection": 2989773, "num_union": 8020275, "num_only_computed": 2515251, "num_only_roped": 2515251, "total_diff": 5030502, "diff_percentage": 0.6272231313764179, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:43:27.610053", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07470703125, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.21794871794871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:44:33.434062", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.365725329903907, "overlap_percentage": 0.535576695981233, "num_intersection": 3229159, "num_union": 8829465, "num_only_computed": 2800153, "num_only_roped": 2800153, "total_diff": 5600306, "diff_percentage": 0.6342746700960931, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:44:35.702552", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07666015625, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.17980295566502463}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:45:49.728823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36199516830052675, "overlap_percentage": 0.5315660095214844, "num_intersection": 3483671, "num_union": 9623529, "num_only_computed": 3069929, "num_only_roped": 3069929, "total_diff": 6139858, "diff_percentage": 0.6380048316994732, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:45:52.287243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05810546875, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.18689320388349515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:47:13.811109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3515700793396412, "overlap_percentage": 0.520239512125651, "num_intersection": 3682197, "num_union": 10473579, "num_only_computed": 3395691, "num_only_roped": 3395691, "total_diff": 6791382, "diff_percentage": 0.6484299206603588, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:47:17.850920", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.1865671641791045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:48:46.656991", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3437685985765433, "overlap_percentage": 0.5116485069537985, "num_intersection": 3889642, "num_union": 11314710, "num_only_computed": 3712534, "num_only_roped": 3712534, "total_diff": 7425068, "diff_percentage": 0.6562314014234567, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:48:49.710299", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07275390625, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.18935643564356436}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:50:26.858213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3509731155740884, "overlap_percentage": 0.5195856401997228, "num_intersection": 4222394, "num_union": 12030534, "num_only_computed": 3904070, "num_only_roped": 3904070, "total_diff": 7808140, "diff_percentage": 0.6490268844259116, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:50:30.065138", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.125, "l2_diff_relative": 0.17733990147783252}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:52:13.029487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34349573205385325, "overlap_percentage": 0.5113462199522409, "num_intersection": 4022323, "num_union": 11709965, "num_only_computed": 3843821, "num_only_roped": 3843821, "total_diff": 7687642, "diff_percentage": 0.6565042679461467, "num_computed": 7866144, "num_roped": 7866144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 936, "seq_len_k": 16296, "queries_shape": [1, 32, 936, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 936, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:52:16.482860", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.19140625, "mean_diff": 3.0517578125e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.16331658291457288}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 936, "seq_len_k": 16296, "queries_shape": [1, 32, 936, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 936, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:53:58.838137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4383611797694159, "overlap_percentage": 0.6095286579406846, "num_intersection": 298129, "num_union": 680099, "num_only_computed": 190985, "num_only_roped": 190985, "total_diff": 381970, "diff_percentage": 0.5616388202305841, "num_computed": 489114, "num_roped": 489114}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16354, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 58, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:54:02.049154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 2.288818359375e-05, "l2_diff": 0.275390625, "l2_diff_relative": 0.16947115384615385}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16354, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 58, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:55:29.982478", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4275074058400339, "overlap_percentage": 0.5989564804933001, "num_intersection": 5051, "num_union": 11815, "num_only_computed": 3382, "num_only_roped": 3382, "total_diff": 6764, "diff_percentage": 0.5724925941599661, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:55:34.537086", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.20625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:56:51.025001", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36329103693526227, "overlap_percentage": 0.5329618211999051, "num_intersection": 4495, "num_union": 12373, "num_only_computed": 3939, "num_only_roped": 3939, "total_diff": 7878, "diff_percentage": 0.6367089630647378, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:56:53.588756", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.12756849315068494}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:58:11.207255", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44035522158654256, "overlap_percentage": 0.6114536400284563, "num_intersection": 5157, "num_union": 11711, "num_only_computed": 3277, "num_only_roped": 3277, "total_diff": 6554, "diff_percentage": 0.5596447784134574, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:58:13.641454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.018310546875, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.038330078125, "l2_diff_relative": 0.22819767441860464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:59:31.476271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4646640041673902, "overlap_percentage": 0.6344991108476585, "num_intersection": 5352, "num_union": 11518, "num_only_computed": 3083, "num_only_roped": 3083, "total_diff": 6166, "diff_percentage": 0.5353359958326098, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T06:59:33.924045", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.012451171875, "mean_diff": 2.4199485778808594e-05, "l2_diff": 0.027587890625, "l2_diff_relative": 0.220703125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:00:52.880036", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3832404066907183, "overlap_percentage": 0.5541197391819799, "num_intersection": 4674, "num_union": 12196, "num_only_computed": 3761, "num_only_roped": 3761, "total_diff": 7522, "diff_percentage": 0.6167595933092818, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:00:55.410141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.6808509826660156e-05, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.10027985074626866}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:02:14.291166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4513548387096774, "overlap_percentage": 0.621977240398293, "num_intersection": 5247, "num_union": 11625, "num_only_computed": 3189, "num_only_roped": 3189, "total_diff": 6378, "diff_percentage": 0.5486451612903226, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:02:16.812729", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.22741935483870968}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:03:35.608026", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41117430578788894, "overlap_percentage": 0.5827406353722143, "num_intersection": 4916, "num_union": 11956, "num_only_computed": 3520, "num_only_roped": 3520, "total_diff": 7040, "diff_percentage": 0.5888256942121111, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:03:38.164791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.3245811462402344e-05, "l2_diff": 0.043212890625, "l2_diff_relative": 0.23537234042553193}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:04:56.902878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43816585698457344, "overlap_percentage": 0.6093398127296432, "num_intersection": 5141, "num_union": 11733, "num_only_computed": 3296, "num_only_roped": 3296, "total_diff": 6592, "diff_percentage": 0.5618341430154266, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:04:59.424451", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.5974044799804688e-05, "l2_diff": 0.0267333984375, "l2_diff_relative": 0.1145397489539749}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:06:18.740900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4734544184421935, "overlap_percentage": 0.6426454901031172, "num_intersection": 5422, "num_union": 11452, "num_only_computed": 3015, "num_only_roped": 3015, "total_diff": 6030, "diff_percentage": 0.5265455815578065, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:06:21.224824", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.0265579223632812e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.2175925925925926}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:07:40.055709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4310184007462054, "overlap_percentage": 0.6023939322114245, "num_intersection": 5083, "num_union": 11793, "num_only_computed": 3355, "num_only_roped": 3355, "total_diff": 6710, "diff_percentage": 0.5689815992537947, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:07:44.139594", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.22131147540983606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:09:02.789441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42053872053872055, "overlap_percentage": 0.592083432092913, "num_intersection": 4996, "num_union": 11880, "num_only_computed": 3442, "num_only_roped": 3442, "total_diff": 6884, "diff_percentage": 0.5794612794612795, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:09:06.923059", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.4841556549072266e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.13983050847457626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:10:25.726402", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4451579758540971, "overlap_percentage": 0.6160682545325276, "num_intersection": 5199, "num_union": 11679, "num_only_computed": 3240, "num_only_roped": 3240, "total_diff": 6480, "diff_percentage": 0.5548420241459029, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:10:29.026007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.032470703125, "l2_diff_relative": 0.17317708333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:11:49.082659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47547862575399946, "overlap_percentage": 0.6445076430856737, "num_intersection": 5439, "num_union": 11439, "num_only_computed": 3000, "num_only_roped": 3000, "total_diff": 6000, "diff_percentage": 0.5245213742460005, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:11:51.598821", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.19300518134715025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:13:10.532477", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4692314387675168, "overlap_percentage": 0.6387440758293839, "num_intersection": 5391, "num_union": 11489, "num_only_computed": 3049, "num_only_roped": 3049, "total_diff": 6098, "diff_percentage": 0.5307685612324833, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:13:13.273790", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.2}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:14:31.829780", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5276018099547511, "overlap_percentage": 0.6907582938388626, "num_intersection": 5830, "num_union": 11050, "num_only_computed": 2610, "num_only_roped": 2610, "total_diff": 5220, "diff_percentage": 0.47239819004524886, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:14:35.624012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.0263671875, "l2_diff_relative": 0.13170731707317074}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:15:21.295071", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:15:21.308757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.025634765625, "l2_diff_relative": 0.003107244318181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:15:27.130320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7227805923655425, "overlap_percentage": 0.8390860630407911, "num_intersection": 1086113, "num_union": 1502687, "num_only_computed": 224607, "num_only_roped": 191967, "total_diff": 416574, "diff_percentage": 0.27721940763445746, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:15:28.190748", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.427734375, "l2_diff_relative": 0.06336805555555555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:15:42.763210", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5751668939990265, "overlap_percentage": 0.7302932739257812, "num_intersection": 1340094, "num_union": 2329922, "num_only_computed": 494914, "num_only_roped": 494914, "total_diff": 989828, "diff_percentage": 0.4248331060009734, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:15:43.289276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.11738578680203046}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:16:03.197488", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4923521015709479, "overlap_percentage": 0.6598336961534288, "num_intersection": 1556743, "num_union": 3161849, "num_only_computed": 802553, "num_only_roped": 802553, "total_diff": 1605106, "diff_percentage": 0.5076478984290521, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:16:03.926753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 5.125999450683594e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.1434948979591837}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:16:29.576568", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44942722023941617, "overlap_percentage": 0.6201445839621804, "num_intersection": 1788239, "num_union": 3978929, "num_only_computed": 1095345, "num_only_roped": 1095345, "total_diff": 2190690, "diff_percentage": 0.5505727797605838, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:16:30.476626", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.95703125, "l2_diff_relative": 0.15467171717171718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:17:01.920056", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42769339049069377, "overlap_percentage": 0.5991389934833233, "num_intersection": 2041789, "num_union": 4773955, "num_only_computed": 1366083, "num_only_roped": 1366083, "total_diff": 2732166, "diff_percentage": 0.5723066095093062, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:17:04.587956", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 3.910064697265625e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.15954773869346733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:17:41.530242", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.402609132069253, "overlap_percentage": 0.5740859985351563, "num_intersection": 2257398, "num_union": 5606922, "num_only_computed": 1674762, "num_only_roped": 1674762, "total_diff": 3349524, "diff_percentage": 0.597390867930747, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:17:42.818786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.552436828613281e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.1751269035532995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:18:28.269371", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38720454245139785, "overlap_percentage": 0.5582515492158777, "num_intersection": 2487819, "num_union": 6425077, "num_only_computed": 1968629, "num_only_roped": 1968629, "total_diff": 3937258, "diff_percentage": 0.6127954575486021, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:18:29.744966", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.3046875, "l2_diff_relative": 0.20668316831683167}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:19:20.858741", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.372184853923855, "overlap_percentage": 0.5424704300729852, "num_intersection": 2701902, "num_union": 7259570, "num_only_computed": 2278834, "num_only_roped": 2278834, "total_diff": 4557668, "diff_percentage": 0.627815146076145, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:19:24.729317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 4.506111145019531e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.2131979695431472}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:20:21.758268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36070854417426484, "overlap_percentage": 0.5301775251116071, "num_intersection": 2918640, "num_union": 8091408, "num_only_computed": 2586384, "num_only_roped": 2586384, "total_diff": 5172768, "diff_percentage": 0.6392914558257351, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:20:23.745246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06298828125, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.359375, "l2_diff_relative": 0.2230769230769231}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:21:28.616776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3560871588970087, "overlap_percentage": 0.5251685432765795, "num_intersection": 3166405, "num_union": 8892219, "num_only_computed": 2862907, "num_only_roped": 2862907, "total_diff": 5725814, "diff_percentage": 0.6439128411029913, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:21:30.851023", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05126953125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.18908629441624367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:22:43.307201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3551290702748853, "overlap_percentage": 0.5241258239746094, "num_intersection": 3434911, "num_union": 9672289, "num_only_computed": 3118689, "num_only_roped": 3118689, "total_diff": 6237378, "diff_percentage": 0.6448709297251147, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:22:45.805767", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.1662621359223301}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:24:05.341741", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.348543909631267, "overlap_percentage": 0.5169188887984665, "num_intersection": 3658694, "num_union": 10497082, "num_only_computed": 3419194, "num_only_roped": 3419194, "total_diff": 6838388, "diff_percentage": 0.651456090368733, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:24:08.094832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06005859375, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.1921182266009852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:25:35.961784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3463144653553421, "overlap_percentage": 0.5144629642881197, "num_intersection": 3911038, "num_union": 11293314, "num_only_computed": 3691138, "num_only_roped": 3691138, "total_diff": 7382276, "diff_percentage": 0.6536855346446578, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:25:38.996757", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06298828125, "mean_diff": 3.218650817871094e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.2075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:27:16.971602", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34429128993314656, "overlap_percentage": 0.5122272122290826, "num_intersection": 4162596, "num_union": 12090332, "num_only_computed": 3963868, "num_only_roped": 3963868, "total_diff": 7927736, "diff_percentage": 0.6557087100668534, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:27:20.253535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.1972361809045226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:29:07.058828", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3399963007202339, "overlap_percentage": 0.5074585661728909, "num_intersection": 3987003, "num_union": 11726607, "num_only_computed": 3869802, "num_only_roped": 3869802, "total_diff": 7739604, "diff_percentage": 0.6600036992797661, "num_computed": 7856805, "num_roped": 7856805}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:29:10.612834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 3.039836883544922e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.16751269035532995}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:30:56.939833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.442757977774041, "overlap_percentage": 0.6137661126742132, "num_intersection": 300166, "num_union": 677946, "num_only_computed": 188890, "num_only_roped": 188890, "total_diff": 377780, "diff_percentage": 0.557242022225959, "num_computed": 489056, "num_roped": 489056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16353, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 58, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:31:00.264502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.30859375, "l2_diff_relative": 0.1872037914691943}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16353, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 58, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:32:30.127620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43357416064598386, "overlap_percentage": 0.6048855685995493, "num_intersection": 5101, "num_union": 11765, "num_only_computed": 3332, "num_only_roped": 3332, "total_diff": 6664, "diff_percentage": 0.5664258393540161, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:32:32.647772", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 2.3484230041503906e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.22400990099009901}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:33:50.928092", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4809026253402406, "overlap_percentage": 0.6494723111585439, "num_intersection": 5477, "num_union": 11389, "num_only_computed": 2956, "num_only_roped": 2956, "total_diff": 5912, "diff_percentage": 0.5190973746597595, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:33:53.432394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.8371810913085938e-05, "l2_diff": 0.05322265625, "l2_diff_relative": 0.3061797752808989}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:35:11.996737", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4116662482216085, "overlap_percentage": 0.5832345269148684, "num_intersection": 4919, "num_union": 11949, "num_only_computed": 3515, "num_only_roped": 3515, "total_diff": 7030, "diff_percentage": 0.5883337517783915, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:35:14.468390", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.17618110236220472}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:36:33.657612", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42683133141600405, "overlap_percentage": 0.5982926250889258, "num_intersection": 5046, "num_union": 11822, "num_only_computed": 3388, "num_only_roped": 3388, "total_diff": 6776, "diff_percentage": 0.573168668583996, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:36:36.532062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.849102020263672e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.27259036144578314}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:37:53.795923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43026706231454004, "overlap_percentage": 0.6016597510373444, "num_intersection": 5075, "num_union": 11795, "num_only_computed": 3360, "num_only_roped": 3360, "total_diff": 6720, "diff_percentage": 0.56973293768546, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:37:58.742028", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 2.777576446533203e-05, "l2_diff": 0.052978515625, "l2_diff_relative": 0.273989898989899}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:39:16.719093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.431602172437203, "overlap_percentage": 0.602963841138115, "num_intersection": 5086, "num_union": 11784, "num_only_computed": 3349, "num_only_roped": 3349, "total_diff": 6698, "diff_percentage": 0.568397827562797, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:39:20.811911", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.20978260869565218}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:40:38.099050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42995169082125606, "overlap_percentage": 0.6013513513513513, "num_intersection": 5073, "num_union": 11799, "num_only_computed": 3363, "num_only_roped": 3363, "total_diff": 6726, "diff_percentage": 0.5700483091787439, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:40:42.778135", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.23214285714285715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:41:58.892807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4109382839939789, "overlap_percentage": 0.5825035561877667, "num_intersection": 4914, "num_union": 11958, "num_only_computed": 3522, "num_only_roped": 3522, "total_diff": 7044, "diff_percentage": 0.5890617160060211, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:42:02.621535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.19292237442922375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:43:19.576065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4642485248177716, "overlap_percentage": 0.6341116510608036, "num_intersection": 5350, "num_union": 11524, "num_only_computed": 3087, "num_only_roped": 3087, "total_diff": 6174, "diff_percentage": 0.5357514751822284, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:43:22.001056", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.04150390625, "l2_diff_relative": 0.2514792899408284}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:44:38.838934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4325494524153154, "overlap_percentage": 0.6038876377859429, "num_intersection": 5095, "num_union": 11779, "num_only_computed": 3342, "num_only_roped": 3342, "total_diff": 6684, "diff_percentage": 0.5674505475846846, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:44:41.274233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.23387096774193547}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:45:58.338307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44920566766852726, "overlap_percentage": 0.6199336335624556, "num_intersection": 5231, "num_union": 11645, "num_only_computed": 3207, "num_only_roped": 3207, "total_diff": 6414, "diff_percentage": 0.5507943323314727, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:46:00.767881", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.25132978723404253}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:47:17.707770", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4439976041755797, "overlap_percentage": 0.6149561507466225, "num_intersection": 5189, "num_union": 11687, "num_only_computed": 3249, "num_only_roped": 3249, "total_diff": 6498, "diff_percentage": 0.5560023958244203, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:47:22.584533", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.20899470899470898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:48:39.421039", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39950248756218903, "overlap_percentage": 0.5709207252044081, "num_intersection": 4818, "num_union": 12060, "num_only_computed": 3621, "num_only_roped": 3621, "total_diff": 7242, "diff_percentage": 0.6004975124378109, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:48:42.360136", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.04541015625, "l2_diff_relative": 0.21232876712328766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:49:59.373806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5204035672461941, "overlap_percentage": 0.6845597819646878, "num_intersection": 5777, "num_union": 11101, "num_only_computed": 2662, "num_only_roped": 2662, "total_diff": 5324, "diff_percentage": 0.479596432753806, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:50:01.786472", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.022705078125, "l2_diff_relative": 0.10108695652173913}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:50:47.771281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:50:47.784988", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.0262451171875, "l2_diff_relative": 0.003181226325757576}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:50:53.806588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7273026309205053, "overlap_percentage": 0.8421253090234858, "num_intersection": 1090047, "num_union": 1498753, "num_only_computed": 220673, "num_only_roped": 188033, "total_diff": 408706, "diff_percentage": 0.27269736907949477, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:50:54.200010", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 3.504753112792969e-05, "l2_diff": 0.439453125, "l2_diff_relative": 0.06696428571428571}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:51:09.052652", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.57740444602614, "overlap_percentage": 0.7320943559919085, "num_intersection": 1343399, "num_union": 2326617, "num_only_computed": 491609, "num_only_roped": 491609, "total_diff": 983218, "diff_percentage": 0.4225955539738599, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:51:09.611736", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.11096938775510204}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:51:29.956965", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4967027822237617, "overlap_percentage": 0.6637293497721354, "num_intersection": 1565934, "num_union": 3152658, "num_only_computed": 793362, "num_only_roped": 793362, "total_diff": 1586724, "diff_percentage": 0.5032972177762384, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:51:30.698269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.13959390862944163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:51:57.022240", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4508759342241776, "overlap_percentage": 0.6215223832563921, "num_intersection": 1792212, "num_union": 3974956, "num_only_computed": 1091372, "num_only_roped": 1091372, "total_diff": 2182744, "diff_percentage": 0.5491240657758224, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:51:57.943864", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 4.76837158203125e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.18504901960784315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:52:30.239061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42542236729804345, "overlap_percentage": 0.5969071021446815, "num_intersection": 2034183, "num_union": 4781561, "num_only_computed": 1373689, "num_only_roped": 1373689, "total_diff": 2747378, "diff_percentage": 0.5745776327019565, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:52:31.314346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 3.981590270996094e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.17692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:53:08.999848", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4046345696436599, "overlap_percentage": 0.5761421203613282, "num_intersection": 2265483, "num_union": 5598837, "num_only_computed": 1666677, "num_only_roped": 1666677, "total_diff": 3333354, "diff_percentage": 0.59536543035634, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:53:10.291223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.18026315789473685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:53:53.773361", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40221912851843034, "overlap_percentage": 0.5736894046559053, "num_intersection": 2556617, "num_union": 6356279, "num_only_computed": 1899831, "num_only_roped": 1899831, "total_diff": 3799662, "diff_percentage": 0.5977808714815697, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:53:55.269879", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.1814720812182741}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:54:45.333687", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3842323932829071, "overlap_percentage": 0.5551559046695107, "num_intersection": 2765085, "num_union": 7196387, "num_only_computed": 2215651, "num_only_roped": 2215651, "total_diff": 4431302, "diff_percentage": 0.6157676067170929, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:54:47.036214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.119140625, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.375, "l2_diff_relative": 0.21782178217821782}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:55:44.092787", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37033290729981, "overlap_percentage": 0.5405006408691406, "num_intersection": 2975469, "num_union": 8034579, "num_only_computed": 2529555, "num_only_roped": 2529555, "total_diff": 5059110, "diff_percentage": 0.6296670927001901, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:55:46.067201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 4.172325134277344e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.20812182741116753}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:56:51.983420", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3712016167015495, "overlap_percentage": 0.5414252903150476, "num_intersection": 3264422, "num_union": 8794202, "num_only_computed": 2764890, "num_only_roped": 2764890, "total_diff": 5529780, "diff_percentage": 0.6287983832984505, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:56:54.209240", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.17034313725490197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:58:09.171694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3662320578588936, "overlap_percentage": 0.5361198425292969, "num_intersection": 3513515, "num_union": 9593685, "num_only_computed": 3040085, "num_only_roped": 3040085, "total_diff": 6080170, "diff_percentage": 0.6337679421411063, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:58:11.674983", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.4809112548828125e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.15504807692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:59:31.347114", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35568285368286423, "overlap_percentage": 0.5247287043818721, "num_intersection": 3713971, "num_union": 10441805, "num_only_computed": 3363917, "num_only_roped": 3363917, "total_diff": 6727834, "diff_percentage": 0.6443171463171358, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T07:59:34.084583", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.040771484375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.14915458937198067}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:01:01.390505", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35190701257518275, "overlap_percentage": 0.5206083100417565, "num_intersection": 3957756, "num_union": 11246596, "num_only_computed": 3644420, "num_only_roped": 3644420, "total_diff": 7288840, "diff_percentage": 0.6480929874248172, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:01:05.235198", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.13671875, "mean_diff": 2.968311309814453e-05, "l2_diff": 1.0, "l2_diff_relative": 0.15763546798029557}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:02:40.658464", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3480946186956411, "overlap_percentage": 0.5164246097687752, "num_intersection": 4196706, "num_union": 12056222, "num_only_computed": 3929758, "num_only_roped": 3929758, "total_diff": 7859516, "diff_percentage": 0.6519053813043588, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:02:44.157536", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.9453125, "l2_diff_relative": 0.14975247524752475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:04:29.042267", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3460353677264054, "overlap_percentage": 0.5141549412789879, "num_intersection": 4053541, "num_union": 11714239, "num_only_computed": 3830349, "num_only_roped": 3830349, "total_diff": 7660698, "diff_percentage": 0.6539646322735946, "num_computed": 7883890, "num_roped": 7883890}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "mask_shape": [1, 32, 938, 16298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:04:32.556368", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.83203125, "l2_diff_relative": 0.1351522842639594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "attention_shape": [1, 32, 938, 16298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:06:16.602703", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4399672662458181, "overlap_percentage": 0.6110795384854407, "num_intersection": 298923, "num_union": 679421, "num_only_computed": 190249, "num_only_roped": 190249, "total_diff": 380498, "diff_percentage": 0.5600327337541818, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 58, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:06:21.536302", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.283203125, "l2_diff_relative": 0.17597087378640777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 58, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:07:51.186689", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.444796573875803, "overlap_percentage": 0.6157220773061418, "num_intersection": 5193, "num_union": 11675, "num_only_computed": 3241, "num_only_roped": 3241, "total_diff": 6482, "diff_percentage": 0.555203426124197, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:07:53.708456", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.055419921875, "l2_diff_relative": 0.25795454545454544}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:09:11.538595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47426374202569255, "overlap_percentage": 0.6433906342620036, "num_intersection": 5427, "num_union": 11443, "num_only_computed": 3008, "num_only_roped": 3008, "total_diff": 6016, "diff_percentage": 0.5257362579743075, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:09:14.008779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.20192307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:10:30.710821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41919744258433583, "overlap_percentage": 0.5907528156490812, "num_intersection": 4983, "num_union": 11887, "num_only_computed": 3452, "num_only_roped": 3452, "total_diff": 6904, "diff_percentage": 0.5808025574156642, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:10:33.183255", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.050537109375, "l2_diff_relative": 0.21927966101694915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:11:50.295654", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44588225212100435, "overlap_percentage": 0.6167614983404457, "num_intersection": 5203, "num_union": 11669, "num_only_computed": 3233, "num_only_roped": 3233, "total_diff": 6466, "diff_percentage": 0.5541177478789956, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:11:54.473999", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.21818181818181817}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:13:11.432909", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44873776403915505, "overlap_percentage": 0.6194879089615932, "num_intersection": 5226, "num_union": 11646, "num_only_computed": 3210, "num_only_roped": 3210, "total_diff": 6420, "diff_percentage": 0.5512622359608449, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:13:14.601671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.14730046948356806}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:14:34.742870", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46730434782608693, "overlap_percentage": 0.6369562640749081, "num_intersection": 5374, "num_union": 11500, "num_only_computed": 3063, "num_only_roped": 3063, "total_diff": 6126, "diff_percentage": 0.532695652173913, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:14:38.504762", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.19692737430167598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:15:57.301239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4274596057863125, "overlap_percentage": 0.5989095650112599, "num_intersection": 5053, "num_union": 11821, "num_only_computed": 3384, "num_only_roped": 3384, "total_diff": 6768, "diff_percentage": 0.5725403942136875, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:16:00.486434", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.467632293701172e-05, "l2_diff": 0.044677734375, "l2_diff_relative": 0.2584745762711864}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:17:19.731479", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4430098332620778, "overlap_percentage": 0.6140080587817018, "num_intersection": 5181, "num_union": 11695, "num_only_computed": 3257, "num_only_roped": 3257, "total_diff": 6514, "diff_percentage": 0.5569901667379222, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:17:23.037358", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.24397590361445784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:18:42.285943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44461564800547854, "overlap_percentage": 0.6155487082246978, "num_intersection": 5194, "num_union": 11682, "num_only_computed": 3244, "num_only_roped": 3244, "total_diff": 6488, "diff_percentage": 0.5553843519945215, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:18:45.408058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.17857142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:20:03.137126", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43033898305084745, "overlap_percentage": 0.6017300628036497, "num_intersection": 5078, "num_union": 11800, "num_only_computed": 3361, "num_only_roped": 3361, "total_diff": 6722, "diff_percentage": 0.5696610169491525, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:20:05.675612", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 2.1338462829589844e-05, "l2_diff": 0.046630859375, "l2_diff_relative": 0.2284688995215311}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:21:22.984322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43569241238516504, "overlap_percentage": 0.6069439507050598, "num_intersection": 5122, "num_union": 11756, "num_only_computed": 3317, "num_only_roped": 3317, "total_diff": 6634, "diff_percentage": 0.564307587614835, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:21:25.422133", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0281982421875, "mean_diff": 2.682209014892578e-05, "l2_diff": 0.061279296875, "l2_diff_relative": 0.3201530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:22:41.866671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4795337014637567, "overlap_percentage": 0.6482227488151658, "num_intersection": 5471, "num_union": 11409, "num_only_computed": 2969, "num_only_roped": 2969, "total_diff": 5938, "diff_percentage": 0.5204662985362433, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:22:44.313449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.21234939759036145}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:24:01.751642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4640069384215091, "overlap_percentage": 0.6338862559241706, "num_intersection": 5350, "num_union": 11530, "num_only_computed": 3090, "num_only_roped": 3090, "total_diff": 6180, "diff_percentage": 0.5359930615784909, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:24:06.319442", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.21961325966850828}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:25:26.090871", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4896320480014118, "overlap_percentage": 0.6573865655727994, "num_intersection": 5549, "num_union": 11333, "num_only_computed": 2892, "num_only_roped": 2892, "total_diff": 5784, "diff_percentage": 0.5103679519985882, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:25:29.029918", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021240234375, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.27941176470588236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:26:48.647955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5131307699202294, "overlap_percentage": 0.6782371756900841, "num_intersection": 5725, "num_union": 11157, "num_only_computed": 2716, "num_only_roped": 2716, "total_diff": 5432, "diff_percentage": 0.48686923007977057, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:26:52.029801", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.029052734375, "l2_diff_relative": 0.17196531791907516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:27:37.801601", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:27:37.815310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.725290298461914e-06, "l2_diff": 0.02490234375, "l2_diff_relative": 0.003018465909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:27:43.732091", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7176745043970291, "overlap_percentage": 0.835635043263288, "num_intersection": 1081646, "num_union": 1507154, "num_only_computed": 229074, "num_only_roped": 196434, "total_diff": 425508, "diff_percentage": 0.2823254956029709, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:27:44.829439", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.07093023255813953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:27:59.627414", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5744330349788589, "overlap_percentage": 0.7297014508928571, "num_intersection": 1339008, "num_union": 2331008, "num_only_computed": 496000, "num_only_roped": 496000, "total_diff": 992000, "diff_percentage": 0.42556696502114105, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:28:00.179021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.71875, "l2_diff_relative": 0.11274509803921569}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:28:21.022461", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49298672205865834, "overlap_percentage": 0.6604033576117622, "num_intersection": 1558087, "num_union": 3160505, "num_only_computed": 801209, "num_only_roped": 801209, "total_diff": 1602418, "diff_percentage": 0.5070132779413417, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:28:21.773237", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04541015625, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.890625, "l2_diff_relative": 0.14321608040201006}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:28:48.094997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44320742568273835, "overlap_percentage": 0.6141978177157316, "num_intersection": 1771091, "num_union": 3996077, "num_only_computed": 1112493, "num_only_roped": 1112493, "total_diff": 2224986, "diff_percentage": 0.5567925743172617, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:28:49.017652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 4.8160552978515625e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.17654639175257733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:29:21.053906", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42539017234358967, "overlap_percentage": 0.5968754108135517, "num_intersection": 2034075, "num_union": 4781669, "num_only_computed": 1373797, "num_only_roped": 1373797, "total_diff": 2747594, "diff_percentage": 0.5746098276564103, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:29:22.122517", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16538461538461538}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:29:59.405006", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4043120124325841, "overlap_percentage": 0.5758150736490886, "num_intersection": 2264197, "num_union": 5600123, "num_only_computed": 1667963, "num_only_roped": 1667963, "total_diff": 3335926, "diff_percentage": 0.5956879875674159, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:30:03.174570", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.1967005076142132}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:30:47.319374", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3857282473263824, "overlap_percentage": 0.5567155725815717, "num_intersection": 2480974, "num_union": 6431922, "num_only_computed": 1975474, "num_only_roped": 1975474, "total_diff": 3950948, "diff_percentage": 0.6142717526736177, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:30:48.829735", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.218650817871094e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.1893939393939394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:31:39.071167", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3801816360993296, "overlap_percentage": 0.5509153667249178, "num_intersection": 2743964, "num_union": 7217508, "num_only_computed": 2236772, "num_only_roped": 2236772, "total_diff": 4473544, "diff_percentage": 0.6198183639006705, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:31:40.796943", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.171875, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.20522388059701493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:32:39.651525", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37418407396248304, "overlap_percentage": 0.5445909045991444, "num_intersection": 2997986, "num_union": 8012062, "num_only_computed": 2507038, "num_only_roped": 2507038, "total_diff": 5014076, "diff_percentage": 0.6258159260375169, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:32:41.708579", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 4.172325134277344e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.2064102564102564}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:33:48.585157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3632910208902402, "overlap_percentage": 0.5329618039338485, "num_intersection": 3213393, "num_union": 8845231, "num_only_computed": 2815919, "num_only_roped": 2815919, "total_diff": 5631838, "diff_percentage": 0.6367089791097599, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:33:50.909547", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.054443359375, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1748768472906404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:35:04.701835", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3622520893886474, "overlap_percentage": 0.5318429565429688, "num_intersection": 3485486, "num_union": 9621714, "num_only_computed": 3068114, "num_only_roped": 3068114, "total_diff": 6136228, "diff_percentage": 0.6377479106113526, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:35:07.956104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.15338164251207728}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:36:28.185523", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35807455060797727, "overlap_percentage": 0.5273267957899306, "num_intersection": 3732360, "num_union": 10423416, "num_only_computed": 3345528, "num_only_roped": 3345528, "total_diff": 6691056, "diff_percentage": 0.6419254493920228, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:36:30.969731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05712890625, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.125, "l2_diff_relative": 0.17307692307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:37:59.219912", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34806930603966996, "overlap_percentage": 0.5163967527192215, "num_intersection": 3925739, "num_union": 11278613, "num_only_computed": 3676437, "num_only_roped": 3676437, "total_diff": 7352874, "diff_percentage": 0.6519306939603301, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:38:03.710528", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.099609375, "mean_diff": 3.0279159545898438e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.18239795918367346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:39:40.564023", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3472294844381167, "overlap_percentage": 0.515471919890373, "num_intersection": 4188964, "num_union": 12063964, "num_only_computed": 3937500, "num_only_roped": 3937500, "total_diff": 7875000, "diff_percentage": 0.6527705155618833, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:39:43.894963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 3.0040740966796875e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.16792929292929293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:41:28.620626", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34536556988434625, "overlap_percentage": 0.5134152049305609, "num_intersection": 4047709, "num_union": 11720071, "num_only_computed": 3836181, "num_only_roped": 3836181, "total_diff": 7672362, "diff_percentage": 0.6546344301156537, "num_computed": 7883890, "num_roped": 7883890}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "mask_shape": [1, 32, 938, 16298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:41:33.901724", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.13736979166666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "attention_shape": [1, 32, 938, 16298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:43:18.887320", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43694077420643546, "overlap_percentage": 0.6081541870753028, "num_intersection": 297492, "num_union": 680852, "num_only_computed": 191680, "num_only_roped": 191680, "total_diff": 383360, "diff_percentage": 0.5630592257935645, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 58, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:43:23.484908", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.288818359375e-05, "l2_diff": 0.2890625, "l2_diff_relative": 0.17289719626168223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 58, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:44:53.638004", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4313109885447603, "overlap_percentage": 0.6026796300687692, "num_intersection": 5083, "num_union": 11785, "num_only_computed": 3351, "num_only_roped": 3351, "total_diff": 6702, "diff_percentage": 0.5686890114552398, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:44:56.601029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 2.872943878173828e-05, "l2_diff": 0.05908203125, "l2_diff_relative": 0.26419213973799127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:46:14.584528", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44571085782843434, "overlap_percentage": 0.616597510373444, "num_intersection": 5201, "num_union": 11669, "num_only_computed": 3234, "num_only_roped": 3234, "total_diff": 6468, "diff_percentage": 0.5542891421715657, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:46:17.075660", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.4199485778808594e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.1981382978723404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:47:34.363437", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4068884997081144, "overlap_percentage": 0.5784232365145229, "num_intersection": 4879, "num_union": 11991, "num_only_computed": 3556, "num_only_roped": 3556, "total_diff": 7112, "diff_percentage": 0.5931115002918855, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:47:36.827187", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.009765625, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.023193359375, "l2_diff_relative": 0.12179487179487179}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:48:53.447923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4735371179039301, "overlap_percentage": 0.6427216690374585, "num_intersection": 5422, "num_union": 11450, "num_only_computed": 3014, "num_only_roped": 3014, "total_diff": 6028, "diff_percentage": 0.5264628820960698, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:48:55.898090", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.23417721518987342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:50:13.408166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43432797755674574, "overlap_percentage": 0.6056187766714083, "num_intersection": 5109, "num_union": 11763, "num_only_computed": 3327, "num_only_roped": 3327, "total_diff": 6654, "diff_percentage": 0.5656720224432543, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:50:16.768462", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.030029296875, "l2_diff_relative": 0.24898785425101214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:51:35.318627", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45240144603201926, "overlap_percentage": 0.6229702500888942, "num_intersection": 5256, "num_union": 11618, "num_only_computed": 3181, "num_only_roped": 3181, "total_diff": 6362, "diff_percentage": 0.5475985539679807, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:51:40.007045", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.2154255319148936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:52:59.044479", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46006749156355453, "overlap_percentage": 0.6302003081664098, "num_intersection": 5317, "num_union": 11557, "num_only_computed": 3120, "num_only_roped": 3120, "total_diff": 6240, "diff_percentage": 0.5399325084364455, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:53:01.988568", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.03662109375, "l2_diff_relative": 0.234375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:54:21.028088", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43564440663547427, "overlap_percentage": 0.6068973690447973, "num_intersection": 5121, "num_union": 11755, "num_only_computed": 3317, "num_only_roped": 3317, "total_diff": 6634, "diff_percentage": 0.5643555933645258, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:54:24.852439", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017333984375, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.24363057324840764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:55:44.739867", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38418635170603677, "overlap_percentage": 0.5551078454610097, "num_intersection": 4684, "num_union": 12192, "num_only_computed": 3754, "num_only_roped": 3754, "total_diff": 7508, "diff_percentage": 0.6158136482939632, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:55:47.855945", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.13087606837606838}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:57:07.484151", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.430824008138352, "overlap_percentage": 0.6022040526128688, "num_intersection": 5082, "num_union": 11796, "num_only_computed": 3357, "num_only_roped": 3357, "total_diff": 6714, "diff_percentage": 0.569175991861648, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:57:09.968230", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.037841796875, "l2_diff_relative": 0.18192488262910797}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:58:30.244993", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42743572395128554, "overlap_percentage": 0.5988861239483351, "num_intersection": 5054, "num_union": 11824, "num_only_computed": 3385, "num_only_roped": 3385, "total_diff": 6770, "diff_percentage": 0.5725642760487145, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:58:32.713837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.3245811462402344e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.24854651162790697}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:59:51.668097", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44039593821998463, "overlap_percentage": 0.6114928909952607, "num_intersection": 5161, "num_union": 11719, "num_only_computed": 3279, "num_only_roped": 3279, "total_diff": 6558, "diff_percentage": 0.5596040617800153, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T08:59:55.519057", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.24509803921568626}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:01:15.069216", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43598468736707785, "overlap_percentage": 0.6072274881516587, "num_intersection": 5125, "num_union": 11755, "num_only_computed": 3315, "num_only_roped": 3315, "total_diff": 6630, "diff_percentage": 0.5640153126329222, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:01:18.009080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.21875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:02:37.985711", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4574807908141241, "overlap_percentage": 0.6277692216562019, "num_intersection": 5299, "num_union": 11583, "num_only_computed": 3142, "num_only_roped": 3142, "total_diff": 6284, "diff_percentage": 0.5425192091858758, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:02:40.501394", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.046630859375, "l2_diff_relative": 0.23875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:03:59.774446", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4817870622311946, "overlap_percentage": 0.650278403032816, "num_intersection": 5489, "num_union": 11393, "num_only_computed": 2952, "num_only_roped": 2952, "total_diff": 5904, "diff_percentage": 0.5182129377688054, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:04:02.552192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.046875, "l2_diff_relative": 0.2222222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:05:22.100017", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38099132995256013, "overlap_percentage": 0.5517649846008055, "num_intersection": 4658, "num_union": 12226, "num_only_computed": 3784, "num_only_roped": 3784, "total_diff": 7568, "diff_percentage": 0.6190086700474399, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:05:25.263356", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.11993243243243243}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:06:43.609292", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5005332385353715, "overlap_percentage": 0.6671404880360104, "num_intersection": 5632, "num_union": 11252, "num_only_computed": 2810, "num_only_roped": 2810, "total_diff": 5620, "diff_percentage": 0.4994667614646285, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:06:48.290075", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.0240478515625, "l2_diff_relative": 0.10478723404255319}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:07:33.177941", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:07:33.191576", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.814697265625e-06, "l2_diff": 0.0263671875, "l2_diff_relative": 0.0031960227272727275}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:07:38.955222", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.721860471303434, "overlap_percentage": 0.8384656983930778, "num_intersection": 1085310, "num_union": 1503490, "num_only_computed": 225410, "num_only_roped": 192770, "total_diff": 418180, "diff_percentage": 0.278139528696566, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:07:40.829095", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 3.600120544433594e-05, "l2_diff": 0.41796875, "l2_diff_relative": 0.06430288461538461}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:07:55.166318", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5712696102797404, "overlap_percentage": 0.7271439688546317, "num_intersection": 1334315, "num_union": 2335701, "num_only_computed": 500693, "num_only_roped": 500693, "total_diff": 1001386, "diff_percentage": 0.42873038972025956, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:07:55.729271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 5.316734313964844e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.11620603015075377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:08:16.552610", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4916699201307497, "overlap_percentage": 0.6592208014594184, "num_intersection": 1555297, "num_union": 3163295, "num_only_computed": 803999, "num_only_roped": 803999, "total_diff": 1607998, "diff_percentage": 0.5083300798692503, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:08:17.264606", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 4.935264587402344e-05, "l2_diff": 0.87109375, "l2_diff_relative": 0.138681592039801}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:08:43.083139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4497059447524034, "overlap_percentage": 0.6204098788174716, "num_intersection": 1789004, "num_union": 3978164, "num_only_computed": 1094580, "num_only_roped": 1094580, "total_diff": 2189160, "diff_percentage": 0.5502940552475967, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:08:43.986899", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 4.601478576660156e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.17125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:09:15.611072", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41842038722915864, "overlap_percentage": 0.5899807856633112, "num_intersection": 2010579, "num_union": 4805165, "num_only_computed": 1397293, "num_only_roped": 1397293, "total_diff": 2794586, "diff_percentage": 0.5815796127708414, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:09:18.238908", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.076957702636719e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1782051282051282}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:09:55.642620", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39935166959847146, "overlap_percentage": 0.5707667032877605, "num_intersection": 2244346, "num_union": 5619974, "num_only_computed": 1687814, "num_only_roped": 1687814, "total_diff": 3375628, "diff_percentage": 0.6006483304015285, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:09:58.314502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 3.552436828613281e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.17654639175257733}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:10:42.687444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3884613820812084, "overlap_percentage": 0.5595566244686351, "num_intersection": 2493635, "num_union": 6419261, "num_only_computed": 1962813, "num_only_roped": 1962813, "total_diff": 3925626, "diff_percentage": 0.6115386179187916, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:10:44.224032", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.0517578125e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.17375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:11:35.470142", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3782037464446629, "overlap_percentage": 0.5488357543945312, "num_intersection": 2733606, "num_union": 7227866, "num_only_computed": 2247130, "num_only_roped": 2247130, "total_diff": 4494260, "diff_percentage": 0.6217962535553371, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:11:37.212074", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09228515625, "mean_diff": 4.172325134277344e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.1806930693069307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:12:35.571450", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36895706317839855, "overlap_percentage": 0.5390337989443824, "num_intersection": 2967394, "num_union": 8042654, "num_only_computed": 2537630, "num_only_roped": 2537630, "total_diff": 5075260, "diff_percentage": 0.6310429368216014, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:12:37.584864", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.17857142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:13:44.028486", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37006776133104885, "overlap_percentage": 0.5402181874150815, "num_intersection": 3257144, "num_union": 8801480, "num_only_computed": 2772168, "num_only_roped": 2772168, "total_diff": 5544336, "diff_percentage": 0.6299322386689511, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:13:46.321223", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 3.62396240234375e-05, "l2_diff": 0.9921875, "l2_diff_relative": 0.1504739336492891}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:15:00.411210", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35529819724411393, "overlap_percentage": 0.5243099975585938, "num_intersection": 3436118, "num_union": 9671082, "num_only_computed": 3117482, "num_only_roped": 3117482, "total_diff": 6234964, "diff_percentage": 0.6447018027558861, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:15:03.235403", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06005859375, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.1796116504854369}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:16:23.722464", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3474517851924547, "overlap_percentage": 0.5157168353045428, "num_intersection": 3650186, "num_union": 10505590, "num_only_computed": 3427702, "num_only_roped": 3427702, "total_diff": 6855404, "diff_percentage": 0.6525482148075453, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:16:26.504004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.24249267578125e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.18842364532019704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:17:54.938944", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34052389077610606, "overlap_percentage": 0.5080459857809132, "num_intersection": 3862255, "num_union": 11342097, "num_only_computed": 3739921, "num_only_roped": 3739921, "total_diff": 7479842, "diff_percentage": 0.659476109223894, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:17:58.681974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.053955078125, "mean_diff": 3.0040740966796875e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.18401015228426396}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:19:35.960449", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34055867388936784, "overlap_percentage": 0.5080846971081149, "num_intersection": 4128932, "num_union": 12123996, "num_only_computed": 3997532, "num_only_roped": 3997532, "total_diff": 7995064, "diff_percentage": 0.6594413261106322, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:19:39.246115", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 2.849102020263672e-05, "l2_diff": 0.984375, "l2_diff_relative": 0.16071428571428573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:21:26.125251", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34312591869230485, "overlap_percentage": 0.510936337266694, "num_intersection": 4037235, "num_union": 11766045, "num_only_computed": 3864405, "num_only_roped": 3864405, "total_diff": 7728810, "diff_percentage": 0.6568740813076952, "num_computed": 7901640, "num_roped": 7901640}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 940, "seq_len_k": 16300, "queries_shape": [1, 32, 940, 128], "keys_shape": [1, 8, 16300, 128], "mask_shape": [1, 32, 940, 16300], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:21:29.655134", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.072265625, "mean_diff": 2.6464462280273438e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.15460526315789475}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 940, "seq_len_k": 16300, "queries_shape": [1, 32, 940, 128], "keys_shape": [1, 8, 16300, 128], "attention_shape": [1, 32, 940, 16300]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:23:15.754721", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43784395412230626, "overlap_percentage": 0.6090284733152096, "num_intersection": 297955, "num_union": 680505, "num_only_computed": 191275, "num_only_roped": 191275, "total_diff": 382550, "diff_percentage": 0.5621560458776937, "num_computed": 489230, "num_roped": 489230}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16358, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 58, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:23:19.022548", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.283203125, "l2_diff_relative": 0.17597087378640777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16358, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 58, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:24:48.768923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4221885010959366, "overlap_percentage": 0.5937166567871962, "num_intersection": 5008, "num_union": 11862, "num_only_computed": 3427, "num_only_roped": 3427, "total_diff": 6854, "diff_percentage": 0.5778114989040634, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:24:51.470364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.2308673469387755}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:26:09.561282", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4696864111498258, "overlap_percentage": 0.6391654812707445, "num_intersection": 5392, "num_union": 11480, "num_only_computed": 3044, "num_only_roped": 3044, "total_diff": 6088, "diff_percentage": 0.5303135888501742, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:26:12.761683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.21505376344086022}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:27:31.845513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4696864111498258, "overlap_percentage": 0.6391654812707445, "num_intersection": 5392, "num_union": 11480, "num_only_computed": 3044, "num_only_roped": 3044, "total_diff": 6088, "diff_percentage": 0.5303135888501742, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:27:35.441320", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.2721518987341772}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:28:53.980536", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4134695928966326, "overlap_percentage": 0.5850420765675003, "num_intersection": 4936, "num_union": 11938, "num_only_computed": 3501, "num_only_roped": 3501, "total_diff": 7002, "diff_percentage": 0.5865304071033673, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:28:57.661816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.030029296875, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.3541666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:30:15.349428", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4557846605124666, "overlap_percentage": 0.6261704397297617, "num_intersection": 5283, "num_union": 11591, "num_only_computed": 3154, "num_only_roped": 3154, "total_diff": 6308, "diff_percentage": 0.5442153394875334, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:30:17.823131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10302734375, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.126953125, "l2_diff_relative": 0.8843537414965986}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:31:35.820033", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.451449213038617, "overlap_percentage": 0.6220668404835269, "num_intersection": 5249, "num_union": 11627, "num_only_computed": 3189, "num_only_roped": 3189, "total_diff": 6378, "diff_percentage": 0.548550786961383, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:31:38.284142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.21910112359550563}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:32:56.045027", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4071541732677395, "overlap_percentage": 0.5786916330884095, "num_intersection": 4883, "num_union": 11993, "num_only_computed": 3555, "num_only_roped": 3555, "total_diff": 7110, "diff_percentage": 0.5928458267322605, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:32:58.537621", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.03515625, "l2_diff_relative": 0.2057142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:34:15.914108", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40556295802798137, "overlap_percentage": 0.5770825927242564, "num_intersection": 4870, "num_union": 12008, "num_only_computed": 3569, "num_only_roped": 3569, "total_diff": 7138, "diff_percentage": 0.5944370419720186, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:34:18.371235", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.11767578125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:35:36.064195", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45162122645566355, "overlap_percentage": 0.6222301220523758, "num_intersection": 5251, "num_union": 11627, "num_only_computed": 3188, "num_only_roped": 3188, "total_diff": 6376, "diff_percentage": 0.5483787735443365, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:35:40.626449", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.21703296703296704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:36:58.620694", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43598468736707785, "overlap_percentage": 0.6072274881516587, "num_intersection": 5125, "num_union": 11755, "num_only_computed": 3315, "num_only_roped": 3315, "total_diff": 6630, "diff_percentage": 0.5640153126329222, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:37:03.167256", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.16959459459459458}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:38:20.560842", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4431050696759853, "overlap_percentage": 0.6140995260663508, "num_intersection": 5183, "num_union": 11697, "num_only_computed": 3257, "num_only_roped": 3257, "total_diff": 6514, "diff_percentage": 0.5568949303240147, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:38:25.313714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.028564453125, "l2_diff_relative": 0.1386255924170616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:39:42.976419", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46303839154172804, "overlap_percentage": 0.6329818741855231, "num_intersection": 5343, "num_union": 11539, "num_only_computed": 3098, "num_only_roped": 3098, "total_diff": 6196, "diff_percentage": 0.5369616084582719, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:39:47.599690", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.04052734375, "l2_diff_relative": 0.23850574712643677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:41:05.235473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4395838662914641, "overlap_percentage": 0.6107096315602417, "num_intersection": 5155, "num_union": 11727, "num_only_computed": 3286, "num_only_roped": 3286, "total_diff": 6572, "diff_percentage": 0.5604161337085358, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:41:08.087808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.17204301075268819}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:42:26.185729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.394680323806377, "overlap_percentage": 0.5659796256811183, "num_intersection": 4778, "num_union": 12106, "num_only_computed": 3664, "num_only_roped": 3664, "total_diff": 7328, "diff_percentage": 0.605319676193623, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:42:29.082426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.4066696166992188e-05, "l2_diff": 0.029296875, "l2_diff_relative": 0.10135135135135136}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:43:48.444195", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3763756419662509, "overlap_percentage": 0.5469083155650319, "num_intersection": 4617, "num_union": 12267, "num_only_computed": 3825, "num_only_roped": 3825, "total_diff": 7650, "diff_percentage": 0.623624358033749, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:43:50.911000", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.537799835205078e-05, "l2_diff": 0.026123046875, "l2_diff_relative": 0.09037162162162163}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:45:11.298448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5159350031421133, "overlap_percentage": 0.6806822219590193, "num_intersection": 5747, "num_union": 11139, "num_only_computed": 2696, "num_only_roped": 2696, "total_diff": 5392, "diff_percentage": 0.48406499685788673, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:45:13.847181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.17268041237113402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:46:02.953947", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:46:02.967675", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7401914596557617e-06, "l2_diff": 0.025390625, "l2_diff_relative": 0.003077651515151515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:46:08.937392", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7226269795271693, "overlap_percentage": 0.8389825401730532, "num_intersection": 1085979, "num_union": 1502821, "num_only_computed": 224741, "num_only_roped": 192101, "total_diff": 416842, "diff_percentage": 0.27737302047283074, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:46:11.745589", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 3.719329833984375e-05, "l2_diff": 0.439453125, "l2_diff_relative": 0.06510416666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:46:26.693504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5777095969463929, "overlap_percentage": 0.732339586530413, "num_intersection": 1343849, "num_union": 2326167, "num_only_computed": 491159, "num_only_roped": 491159, "total_diff": 982318, "diff_percentage": 0.42229040305360704, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:46:27.245250", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 4.9114227294921875e-05, "l2_diff": 0.82421875, "l2_diff_relative": 0.1268028846153846}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:46:47.813758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49058801342308594, "overlap_percentage": 0.6582476298014323, "num_intersection": 1553001, "num_union": 3165591, "num_only_computed": 806295, "num_only_roped": 806295, "total_diff": 1612590, "diff_percentage": 0.5094119865769141, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:46:48.554477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.890625, "l2_diff_relative": 0.14690721649484537}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:47:14.995723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44485979856730806, "overlap_percentage": 0.6157826510342684, "num_intersection": 1775661, "num_union": 3991507, "num_only_computed": 1107923, "num_only_roped": 1107923, "total_diff": 2215846, "diff_percentage": 0.5551402014326919, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:47:15.921542", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:47:48.414473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4364248537809572, "overlap_percentage": 0.6076542780949519, "num_intersection": 2070808, "num_union": 4744936, "num_only_computed": 1337064, "num_only_roped": 1337064, "total_diff": 2674128, "diff_percentage": 0.5635751462190428, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:47:49.530271", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.0, "l2_diff_relative": 0.16580310880829016}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:48:28.113385", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4069454549943368, "overlap_percentage": 0.5784807840983073, "num_intersection": 2274679, "num_union": 5589641, "num_only_computed": 1657481, "num_only_roped": 1657481, "total_diff": 3314962, "diff_percentage": 0.5930545450056631, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:48:30.760890", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.17268041237113402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:49:14.471239", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39493837893842276, "overlap_percentage": 0.5662449107450598, "num_intersection": 2523441, "num_union": 6389455, "num_only_computed": 1933007, "num_only_roped": 1933007, "total_diff": 3866014, "diff_percentage": 0.6050616210615772, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:49:15.976963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.17698019801980197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:50:06.171624", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3881220508507123, "overlap_percentage": 0.5592045031095806, "num_intersection": 2785250, "num_union": 7176222, "num_only_computed": 2195486, "num_only_roped": 2195486, "total_diff": 4390972, "diff_percentage": 0.6118779491492877, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:50:07.886038", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 4.220008850097656e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.1810344827586207}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:51:05.071962", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3796518405490314, "overlap_percentage": 0.5503589085170201, "num_intersection": 3029739, "num_union": 7980309, "num_only_computed": 2475285, "num_only_roped": 2475285, "total_diff": 4950570, "diff_percentage": 0.6203481594509687, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:51:07.063310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.17857142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:52:12.457049", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36642823965716187, "overlap_percentage": 0.5363300157629926, "num_intersection": 3233701, "num_union": 8824923, "num_only_computed": 2795611, "num_only_roped": 2795611, "total_diff": 5591222, "diff_percentage": 0.6335717603428381, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:52:14.708672", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.049560546875, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.15251196172248804}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:53:27.601454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35881737936882874, "overlap_percentage": 0.5281318664550781, "num_intersection": 3461165, "num_union": 9646035, "num_only_computed": 3092435, "num_only_roped": 3092435, "total_diff": 6184870, "diff_percentage": 0.6411826206311713, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:53:31.557454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06396484375, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.92578125, "l2_diff_relative": 0.14040284360189573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:54:54.652177", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34772837150212016, "overlap_percentage": 0.5160214459454572, "num_intersection": 3652342, "num_union": 10503434, "num_only_computed": 3425546, "num_only_roped": 3425546, "total_diff": 6851092, "diff_percentage": 0.6522716284978798, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:54:57.471025", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.953125, "l2_diff_relative": 0.14454976303317535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:56:27.459917", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34660803276847485, "overlap_percentage": 0.5147868189318426, "num_intersection": 3913500, "num_union": 11290852, "num_only_computed": 3688676, "num_only_roped": 3688676, "total_diff": 7377352, "diff_percentage": 0.6533919672315252, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:56:31.982016", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.091796875, "mean_diff": 3.0040740966796875e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.15776699029126215}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:58:09.688632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34456475510621265, "overlap_percentage": 0.5125298038605721, "num_intersection": 4165055, "num_union": 12087873, "num_only_computed": 3961409, "num_only_roped": 3961409, "total_diff": 7922818, "diff_percentage": 0.6554352448937873, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T09:58:13.006590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 2.86102294921875e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.17164179104477612}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:00:00.022728", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33437114464443196, "overlap_percentage": 0.5011666296688863, "num_intersection": 3968936, "num_union": 11869852, "num_only_computed": 3950458, "num_only_roped": 3950458, "total_diff": 7900916, "diff_percentage": 0.665628855355568, "num_computed": 7919394, "num_roped": 7919394}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 942, "seq_len_k": 16302, "queries_shape": [1, 32, 942, 128], "keys_shape": [1, 8, 16302, 128], "mask_shape": [1, 32, 942, 16302], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:00:03.618491", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.060546875, "mean_diff": 2.7418136596679688e-05, "l2_diff": 0.87890625, "l2_diff_relative": 0.14802631578947367}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 942, "seq_len_k": 16302, "queries_shape": [1, 32, 942, 128], "keys_shape": [1, 8, 16302, 128], "attention_shape": [1, 32, 942, 16302]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:01:48.636435", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44014763862092104, "overlap_percentage": 0.6112534948741846, "num_intersection": 299079, "num_union": 679497, "num_only_computed": 190209, "num_only_roped": 190209, "total_diff": 380418, "diff_percentage": 0.5598523613790789, "num_computed": 489288, "num_roped": 489288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16360, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 58, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:01:51.912246", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.302734375, "l2_diff_relative": 0.18452380952380953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16360, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 58, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:03:22.060446", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41531750692056035, "overlap_percentage": 0.5868895211000474, "num_intersection": 4951, "num_union": 11921, "num_only_computed": 3485, "num_only_roped": 3485, "total_diff": 6970, "diff_percentage": 0.5846824930794396, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:03:25.420649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.2670157068062827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:04:43.850140", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4395154410510152, "overlap_percentage": 0.6106435936944411, "num_intersection": 5152, "num_union": 11722, "num_only_computed": 3285, "num_only_roped": 3285, "total_diff": 6570, "diff_percentage": 0.5604845589489849, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:04:47.862809", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.2125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:06:06.459743", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.432914402173913, "overlap_percentage": 0.6042432144127059, "num_intersection": 5098, "num_union": 11776, "num_only_computed": 3339, "num_only_roped": 3339, "total_diff": 6678, "diff_percentage": 0.5670855978260869, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:06:09.227497", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.2673611111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:07:27.553281", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4664581160931526, "overlap_percentage": 0.6361697084617208, "num_intersection": 5368, "num_union": 11508, "num_only_computed": 3070, "num_only_roped": 3070, "total_diff": 6140, "diff_percentage": 0.5335418839068474, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:07:30.920763", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.037841796875, "l2_diff_relative": 0.22270114942528735}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:08:51.073353", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42521746474115363, "overlap_percentage": 0.5967053804219009, "num_intersection": 5035, "num_union": 11841, "num_only_computed": 3403, "num_only_roped": 3403, "total_diff": 6806, "diff_percentage": 0.5747825352588464, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:08:54.355607", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.384185791015625e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.2387820512820513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:10:13.515595", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38332923530858126, "overlap_percentage": 0.5542125844294348, "num_intersection": 4677, "num_union": 12201, "num_only_computed": 3762, "num_only_roped": 3762, "total_diff": 7524, "diff_percentage": 0.6166707646914187, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:10:16.607249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.043212890625, "l2_diff_relative": 0.14274193548387096}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:11:35.603661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41808099479079147, "overlap_percentage": 0.5896433226685627, "num_intersection": 4976, "num_union": 11902, "num_only_computed": 3463, "num_only_roped": 3463, "total_diff": 6926, "diff_percentage": 0.5819190052092086, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:11:39.106789", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.04052734375, "l2_diff_relative": 0.1930232558139535}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:12:58.072960", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45404427599276426, "overlap_percentage": 0.624526066350711, "num_intersection": 5271, "num_union": 11609, "num_only_computed": 3169, "num_only_roped": 3169, "total_diff": 6338, "diff_percentage": 0.5459557240072358, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:13:01.886991", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.2222222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:14:20.770513", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4260370026189068, "overlap_percentage": 0.5975118483412323, "num_intersection": 5043, "num_union": 11837, "num_only_computed": 3397, "num_only_roped": 3397, "total_diff": 6794, "diff_percentage": 0.5739629973810931, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:14:23.274338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.2}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:15:41.560021", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4353001190273763, "overlap_percentage": 0.606563203411918, "num_intersection": 5120, "num_union": 11762, "num_only_computed": 3321, "num_only_roped": 3321, "total_diff": 6642, "diff_percentage": 0.5646998809726237, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:15:44.026824", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.1977401129943503}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:17:03.516232", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46000172965493386, "overlap_percentage": 0.6301386091695297, "num_intersection": 5319, "num_union": 11563, "num_only_computed": 3122, "num_only_roped": 3122, "total_diff": 6244, "diff_percentage": 0.5399982703450662, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:17:05.979006", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.03173828125, "l2_diff_relative": 0.2226027397260274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:18:23.359642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44061433447098974, "overlap_percentage": 0.6117033878227908, "num_intersection": 5164, "num_union": 11720, "num_only_computed": 3278, "num_only_roped": 3278, "total_diff": 6556, "diff_percentage": 0.5593856655290103, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:18:25.826181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.2717391304347826}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:19:44.375680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41347844286312263, "overlap_percentage": 0.5850509357972045, "num_intersection": 4939, "num_union": 11945, "num_only_computed": 3503, "num_only_roped": 3503, "total_diff": 7006, "diff_percentage": 0.5865215571368774, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:19:46.916243", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.1603585657370518}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:21:06.257901", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.409045393858478, "overlap_percentage": 0.5805993130403885, "num_intersection": 4902, "num_union": 11984, "num_only_computed": 3541, "num_only_roped": 3541, "total_diff": 7082, "diff_percentage": 0.5909546061415221, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:21:08.785377", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.044677734375, "l2_diff_relative": 0.2147887323943662}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:22:28.576644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4484474180820038, "overlap_percentage": 0.6192111808598839, "num_intersection": 5228, "num_union": 11658, "num_only_computed": 3215, "num_only_roped": 3215, "total_diff": 6430, "diff_percentage": 0.5515525819179963, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "mask_shape": [1, 32, 1, 16375], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:22:31.116304", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.046630859375, "l2_diff_relative": 0.24362244897959184}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "attention_shape": [1, 32, 1, 16375]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:23:51.345933", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4514825956166738, "overlap_percentage": 0.622098531501658, "num_intersection": 5253, "num_union": 11635, "num_only_computed": 3191, "num_only_roped": 3191, "total_diff": 6382, "diff_percentage": 0.5485174043833262, "num_computed": 8444, "num_roped": 8444}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16376, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16376, 128], "mask_shape": [1, 32, 1, 16376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:23:53.915044", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.2007042253521127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16376, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16376, 128], "attention_shape": [1, 32, 1, 16376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:25:13.147394", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4658449787344848, "overlap_percentage": 0.6355992420653719, "num_intersection": 5367, "num_union": 11521, "num_only_computed": 3077, "num_only_roped": 3077, "total_diff": 6154, "diff_percentage": 0.5341550212655152, "num_computed": 8444, "num_roped": 8444}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16377, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:25:15.629734", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.21484375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16377, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:26:33.476699", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5205257472092186, "overlap_percentage": 0.6846654825340438, "num_intersection": 5782, "num_union": 11108, "num_only_computed": 2663, "num_only_roped": 2663, "total_diff": 5326, "diff_percentage": 0.47947425279078143, "num_computed": 8445, "num_roped": 8445}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16378, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16378, 128], "mask_shape": [1, 32, 1, 16378], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:26:37.133562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.025634765625, "l2_diff_relative": 0.13125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16378, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16378, 128], "attention_shape": [1, 32, 1, 16378]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:27:23.090508", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:27:23.104153", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7997961044311523e-06, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.0031516335227272725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:27:29.053268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.719321781750802, "overlap_percentage": 0.8367506180469716, "num_intersection": 1083090, "num_union": 1505710, "num_only_computed": 227630, "num_only_roped": 194990, "total_diff": 422620, "diff_percentage": 0.28067821824919803, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:27:30.587580", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.933906555175781e-05, "l2_diff": 0.466796875, "l2_diff_relative": 0.06883640552995392}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:27:45.354777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5694768447580343, "overlap_percentage": 0.7256900242396763, "num_intersection": 1331647, "num_union": 2338369, "num_only_computed": 503361, "num_only_roped": 503361, "total_diff": 1006722, "diff_percentage": 0.43052315524196566, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:27:45.907368", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 5.340576171875e-05, "l2_diff": 0.75, "l2_diff_relative": 0.11538461538461539}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:28:07.489390", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49226054168143824, "overlap_percentage": 0.659751468234592, "num_intersection": 1556549, "num_union": 3162043, "num_only_computed": 802747, "num_only_roped": 802747, "total_diff": 1605494, "diff_percentage": 0.5077394583185618, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:28:08.227022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 5.0067901611328125e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.13841463414634148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:28:34.551864", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4461046455792788, "overlap_percentage": 0.6169742237437855, "num_intersection": 1779097, "num_union": 3988071, "num_only_computed": 1104487, "num_only_roped": 1104487, "total_diff": 2208974, "diff_percentage": 0.5538953544207212, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:28:35.472918", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.458427429199219e-05, "l2_diff": 0.97265625, "l2_diff_relative": 0.15332512315270935}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:29:08.023328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42380041980293326, "overlap_percentage": 0.5953087439903846, "num_intersection": 2028736, "num_union": 4787008, "num_only_computed": 1379136, "num_only_roped": 1379136, "total_diff": 2758272, "diff_percentage": 0.5761995801970667, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:29:09.129671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.16169154228855723}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:29:47.134463", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40264290403755304, "overlap_percentage": 0.5741203308105469, "num_intersection": 2257533, "num_union": 5606787, "num_only_computed": 1674627, "num_only_roped": 1674627, "total_diff": 3349254, "diff_percentage": 0.5973570959624469, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:29:48.950997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.17297979797979798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:30:33.160913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3851885513366534, "overlap_percentage": 0.5561532413258272, "num_intersection": 2478468, "num_union": 6434428, "num_only_computed": 1977980, "num_only_roped": 1977980, "total_diff": 3955960, "diff_percentage": 0.6148114486633466, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:30:34.698089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.125, "l2_diff_relative": 0.1836734693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:31:26.460487", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37663605117510174, "overlap_percentage": 0.5471831873843545, "num_intersection": 2725375, "num_union": 7236097, "num_only_computed": 2255361, "num_only_roped": 2255361, "total_diff": 4510722, "diff_percentage": 0.6233639488248983, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:31:28.224472", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09375, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.359375, "l2_diff_relative": 0.22894736842105262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:32:26.759433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36015970008918213, "overlap_percentage": 0.5295844305129278, "num_intersection": 2915375, "num_union": 8094673, "num_only_computed": 2589649, "num_only_roped": 2589649, "total_diff": 5179298, "diff_percentage": 0.6398402999108179, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:32:28.775239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 4.3392181396484375e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.22486772486772486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:33:35.979431", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35842232897330645, "overlap_percentage": 0.5277038242505945, "num_intersection": 3181691, "num_union": 8876933, "num_only_computed": 2847621, "num_only_roped": 2847621, "total_diff": 5695242, "diff_percentage": 0.6415776710266936, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:33:40.487199", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.18401015228426396}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:34:54.510762", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3588230141110378, "overlap_percentage": 0.5281379699707032, "num_intersection": 3461205, "num_union": 9645995, "num_only_computed": 3092395, "num_only_roped": 3092395, "total_diff": 6184790, "diff_percentage": 0.6411769858889622, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:34:57.064458", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1755050505050505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:36:20.683799", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3508662438033422, "overlap_percentage": 0.5194685194227431, "num_intersection": 3676740, "num_union": 10479036, "num_only_computed": 3401148, "num_only_roped": 3401148, "total_diff": 6802296, "diff_percentage": 0.6491337561966578, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:36:25.567154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.1171875, "l2_diff_relative": 0.17875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:37:55.140564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34655162259522243, "overlap_percentage": 0.5147245999040275, "num_intersection": 3913027, "num_union": 11291325, "num_only_computed": 3689149, "num_only_roped": 3689149, "total_diff": 7378298, "diff_percentage": 0.6534483774047776, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:37:58.206262", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.25, "l2_diff_relative": 0.20100502512562815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:39:36.353587", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.344699804966782, "overlap_percentage": 0.512679192327684, "num_intersection": 4166269, "num_union": 12086659, "num_only_computed": 3960195, "num_only_roped": 3960195, "total_diff": 7920390, "diff_percentage": 0.655300195033218, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:39:40.791673", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.20854922279792745}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:41:25.803436", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33961333106434577, "overlap_percentage": 0.5070318773171915, "num_intersection": 3979390, "num_union": 11717414, "num_only_computed": 3869012, "num_only_roped": 3869012, "total_diff": 7738024, "diff_percentage": 0.6603866689356542, "num_computed": 7848402, "num_roped": 7848402}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 934, "seq_len_k": 16294, "queries_shape": [1, 32, 934, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 934, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:41:31.107761", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.18157894736842106}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 934, "seq_len_k": 16294, "queries_shape": [1, 32, 934, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 934, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:43:15.756936", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4342596299212714, "overlap_percentage": 0.6055523293855918, "num_intersection": 296149, "num_union": 681963, "num_only_computed": 192907, "num_only_roped": 192907, "total_diff": 385814, "diff_percentage": 0.5657403700787286, "num_computed": 489056, "num_roped": 489056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16352, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 58, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:43:20.704423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.283203125, "l2_diff_relative": 0.173444976076555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16352, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 58, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:44:50.952352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42673434856175974, "overlap_percentage": 0.5981973434535104, "num_intersection": 5044, "num_union": 11820, "num_only_computed": 3388, "num_only_roped": 3388, "total_diff": 6776, "diff_percentage": 0.5732656514382403, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:44:53.849934", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.042236328125, "l2_diff_relative": 0.23633879781420766}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:46:12.885922", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4564766839378238, "overlap_percentage": 0.6268231945926717, "num_intersection": 5286, "num_union": 11580, "num_only_computed": 3147, "num_only_roped": 3147, "total_diff": 6294, "diff_percentage": 0.5435233160621762, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:46:15.909562", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.20441988950276244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:47:35.562012", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45534558633186645, "overlap_percentage": 0.6257559587335468, "num_intersection": 5277, "num_union": 11589, "num_only_computed": 3156, "num_only_roped": 3156, "total_diff": 6312, "diff_percentage": 0.5446544136681336, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:47:38.618824", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 2.4557113647460938e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.2536764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:48:57.489564", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3485769107771027, "overlap_percentage": 0.5169551814085843, "num_intersection": 4360, "num_union": 12508, "num_only_computed": 4074, "num_only_roped": 4074, "total_diff": 8148, "diff_percentage": 0.6514230892228974, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:49:00.965336", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.4722347259521484e-05, "l2_diff": 0.025634765625, "l2_diff_relative": 0.08413461538461539}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:50:20.183271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4409704425081155, "overlap_percentage": 0.6120464785392459, "num_intersection": 5162, "num_union": 11706, "num_only_computed": 3272, "num_only_roped": 3272, "total_diff": 6544, "diff_percentage": 0.5590295574918845, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:50:22.874109", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.04736328125, "l2_diff_relative": 0.24494949494949494}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:51:43.044584", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4333050127442651, "overlap_percentage": 0.6046235921754594, "num_intersection": 5100, "num_union": 11770, "num_only_computed": 3335, "num_only_roped": 3335, "total_diff": 6670, "diff_percentage": 0.566694987255735, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:51:46.702352", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.04443359375, "l2_diff_relative": 0.23096446700507614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:53:04.951618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4162189388851578, "overlap_percentage": 0.5877889745109662, "num_intersection": 4958, "num_union": 11912, "num_only_computed": 3477, "num_only_roped": 3477, "total_diff": 6954, "diff_percentage": 0.5837810611148422, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:53:07.739796", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.18359375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:54:26.600200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41650575098648307, "overlap_percentage": 0.5880749170222854, "num_intersection": 4961, "num_union": 11911, "num_only_computed": 3475, "num_only_roped": 3475, "total_diff": 6950, "diff_percentage": 0.5834942490135169, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:54:29.098425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.058837890625, "l2_diff_relative": 0.2713963963963964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:55:48.992166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3604257377842284, "overlap_percentage": 0.5298719772403983, "num_intersection": 4470, "num_union": 12402, "num_only_computed": 3966, "num_only_roped": 3966, "total_diff": 7932, "diff_percentage": 0.6395742622157716, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:55:51.470613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.1576797385620915}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:57:09.912372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.448412017167382, "overlap_percentage": 0.6191774327367547, "num_intersection": 5224, "num_union": 11650, "num_only_computed": 3213, "num_only_roped": 3213, "total_diff": 6426, "diff_percentage": 0.551587982832618, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:57:12.438280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.0595703125, "l2_diff_relative": 0.291866028708134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:58:31.980821", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4465495070724389, "overlap_percentage": 0.6173995496029394, "num_intersection": 5209, "num_union": 11665, "num_only_computed": 3228, "num_only_roped": 3228, "total_diff": 6456, "diff_percentage": 0.5534504929275611, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:58:34.486309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.9311904907226562e-05, "l2_diff": 0.04345703125, "l2_diff_relative": 0.1816326530612245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:59:53.975535", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.432597623089983, "overlap_percentage": 0.6039345816544205, "num_intersection": 5096, "num_union": 11780, "num_only_computed": 3342, "num_only_roped": 3342, "total_diff": 6684, "diff_percentage": 0.5674023769100169, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T10:59:56.498176", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.1316793893129771}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:01:16.078644", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4363775640480041, "overlap_percentage": 0.6076084380184877, "num_intersection": 5127, "num_union": 11749, "num_only_computed": 3311, "num_only_roped": 3311, "total_diff": 6622, "diff_percentage": 0.5636224359519959, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:01:18.608221", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.018310546875, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.031005859375, "l2_diff_relative": 0.1436651583710407}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:02:04.129748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:02:04.167979", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7401914596557617e-06, "l2_diff": 0.025390625, "l2_diff_relative": 0.003077651515151515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:02:10.254469", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7172415348509553, "overlap_percentage": 0.8353414709517923, "num_intersection": 1081266, "num_union": 1507534, "num_only_computed": 229454, "num_only_roped": 196814, "total_diff": 426268, "diff_percentage": 0.28275846514904474, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:02:10.638364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.9577484130859375e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.07005813953488373}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:02:25.541822", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5681322728760446, "overlap_percentage": 0.7245973859514508, "num_intersection": 1329642, "num_union": 2340374, "num_only_computed": 505366, "num_only_roped": 505366, "total_diff": 1010732, "diff_percentage": 0.4318677271239554, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:02:26.161098", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 5.3882598876953125e-05, "l2_diff": 0.75390625, "l2_diff_relative": 0.11654589371980677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:02:47.384958", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4928346284057938, "overlap_percentage": 0.6602668762207031, "num_intersection": 1557765, "num_union": 3160827, "num_only_computed": 801531, "num_only_roped": 801531, "total_diff": 1603062, "diff_percentage": 0.5071653715942062, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:02:48.124971", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.038818359375, "mean_diff": 4.696846008300781e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.13419117647058823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:03:14.616618", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44277236382121654, "overlap_percentage": 0.6137799349698153, "num_intersection": 1769886, "num_union": 3997282, "num_only_computed": 1113698, "num_only_roped": 1113698, "total_diff": 2227396, "diff_percentage": 0.5572276361787835, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:03:15.558443", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16709844559585493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:03:48.859892", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4231371622923809, "overlap_percentage": 0.5946540832519531, "num_intersection": 2026505, "num_union": 4789239, "num_only_computed": 1381367, "num_only_roped": 1381367, "total_diff": 2762734, "diff_percentage": 0.5768628377076191, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:03:49.991645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 3.814697265625e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16454081632653061}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:04:28.417736", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4001027958366796, "overlap_percentage": 0.5715334574381511, "num_intersection": 2247361, "num_union": 5616959, "num_only_computed": 1684799, "num_only_roped": 1684799, "total_diff": 3369598, "diff_percentage": 0.5998972041633204, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:04:30.138175", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.20963541666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:05:14.659788", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38579697782963285, "overlap_percentage": 0.5567871542537913, "num_intersection": 2481293, "num_union": 6431603, "num_only_computed": 1975155, "num_only_roped": 1975155, "total_diff": 3950310, "diff_percentage": 0.6142030221703672, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:05:16.199842", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.2890625, "l2_diff_relative": 0.20522388059701493}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:06:07.993853", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3697760939538547, "overlap_percentage": 0.5399073550575658, "num_intersection": 2689136, "num_union": 7272336, "num_only_computed": 2291600, "num_only_roped": 2291600, "total_diff": 4583200, "diff_percentage": 0.6302239060461453, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:06:09.759850", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.553794860839844e-05, "l2_diff": 1.484375, "l2_diff_relative": 0.24111675126903553}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:07:08.167761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36456204441983314, "overlap_percentage": 0.5343282790411086, "num_intersection": 2941490, "num_union": 8068558, "num_only_computed": 2563534, "num_only_roped": 2563534, "total_diff": 5127068, "diff_percentage": 0.6354379555801669, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:07:10.194315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.2190721649484536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:08:16.967776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3631678843503809, "overlap_percentage": 0.5328292846679688, "num_intersection": 3212594, "num_union": 8846030, "num_only_computed": 2816718, "num_only_roped": 2816718, "total_diff": 5633436, "diff_percentage": 0.6368321156496191, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:08:19.211817", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.17945544554455445}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:09:32.844383", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36180441578630046, "overlap_percentage": 0.5313603210449219, "num_intersection": 3482323, "num_union": 9624877, "num_only_computed": 3071277, "num_only_roped": 3071277, "total_diff": 6142554, "diff_percentage": 0.6381955842136996, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:09:35.342698", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.17632850241545894}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:10:55.251559", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35184603532598807, "overlap_percentage": 0.520541579635055, "num_intersection": 3684335, "num_union": 10471441, "num_only_computed": 3393553, "num_only_roped": 3393553, "total_diff": 6787106, "diff_percentage": 0.6481539646740119, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:10:58.011051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.1484375, "l2_diff_relative": 0.17926829268292682}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:12:25.220811", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3515992353915942, "overlap_percentage": 0.5202714328108162, "num_intersection": 3955195, "num_union": 11249157, "num_only_computed": 3646981, "num_only_roped": 3646981, "total_diff": 7293962, "diff_percentage": 0.6484007646084058, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:12:30.222054", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.1806930693069307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:14:06.858113", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35567291111966165, "overlap_percentage": 0.5247178846789945, "num_intersection": 4264101, "num_union": 11988827, "num_only_computed": 3862363, "num_only_roped": 3862363, "total_diff": 7724726, "diff_percentage": 0.6443270888803383, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:14:10.349178", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06884765625, "mean_diff": 3.0517578125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.16911764705882354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:15:53.817370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3459749256411811, "overlap_percentage": 0.5140882182130834, "num_intersection": 4034771, "num_union": 11662033, "num_only_computed": 3813631, "num_only_roped": 3813631, "total_diff": 7627262, "diff_percentage": 0.654025074358819, "num_computed": 7848402, "num_roped": 7848402}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 934, "seq_len_k": 16294, "queries_shape": [1, 32, 934, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 934, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:15:57.542832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 2.956390380859375e-05, "l2_diff": 0.9375, "l2_diff_relative": 0.1507537688442211}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 934, "seq_len_k": 16294, "queries_shape": [1, 32, 934, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 934, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:17:40.522653", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4363152306872231, "overlap_percentage": 0.6075480108617418, "num_intersection": 297125, "num_union": 680987, "num_only_computed": 191931, "num_only_roped": 191931, "total_diff": 383862, "diff_percentage": 0.5636847693127769, "num_computed": 489056, "num_roped": 489056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16352, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 58, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:17:43.762795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.28515625, "l2_diff_relative": 0.17298578199052134}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16352, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 58, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:19:13.894343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4219224283305228, "overlap_percentage": 0.5934535104364327, "num_intersection": 5004, "num_union": 11860, "num_only_computed": 3428, "num_only_roped": 3428, "total_diff": 6856, "diff_percentage": 0.5780775716694773, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:19:16.409953", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033203125, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.044677734375, "l2_diff_relative": 0.21785714285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:20:35.293534", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4484713156990725, "overlap_percentage": 0.6192339618166726, "num_intersection": 5222, "num_union": 11644, "num_only_computed": 3211, "num_only_roped": 3211, "total_diff": 6422, "diff_percentage": 0.5515286843009275, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:20:37.862798", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.20876288659793815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:21:56.956847", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4582396679923915, "overlap_percentage": 0.6284833392624214, "num_intersection": 5300, "num_union": 11566, "num_only_computed": 3133, "num_only_roped": 3133, "total_diff": 6266, "diff_percentage": 0.5417603320076085, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:21:59.526684", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.040771484375, "l2_diff_relative": 0.2220744680851064}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:23:18.711198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4137959936300394, "overlap_percentage": 0.5853687455537112, "num_intersection": 4937, "num_union": 11931, "num_only_computed": 3497, "num_only_roped": 3497, "total_diff": 6994, "diff_percentage": 0.5862040063699606, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:23:21.270954", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.0478515625, "l2_diff_relative": 0.28994082840236685}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:24:40.315541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4420791655980166, "overlap_percentage": 0.6131135878586673, "num_intersection": 5171, "num_union": 11697, "num_only_computed": 3263, "num_only_roped": 3263, "total_diff": 6526, "diff_percentage": 0.5579208344019834, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:24:43.781913", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.020751953125, "mean_diff": 2.753734588623047e-05, "l2_diff": 0.049072265625, "l2_diff_relative": 0.337248322147651}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:26:02.762448", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45318287535532775, "overlap_percentage": 0.62371072910492, "num_intersection": 5261, "num_union": 11609, "num_only_computed": 3174, "num_only_roped": 3174, "total_diff": 6348, "diff_percentage": 0.5468171246446722, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:26:06.894286", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.20725388601036268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:27:26.322375", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4238690074274139, "overlap_percentage": 0.5953764078245406, "num_intersection": 5022, "num_union": 11848, "num_only_computed": 3413, "num_only_roped": 3413, "total_diff": 6826, "diff_percentage": 0.576130992572586, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:27:28.908606", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 2.4199485778808594e-05, "l2_diff": 0.05322265625, "l2_diff_relative": 0.2794871794871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:28:48.164766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4630593132154006, "overlap_percentage": 0.6330014224751067, "num_intersection": 5340, "num_union": 11532, "num_only_computed": 3096, "num_only_roped": 3096, "total_diff": 6192, "diff_percentage": 0.5369406867845994, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:28:50.902666", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.07666015625, "l2_diff_relative": 0.4266304347826087}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:30:09.869720", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4534803583735355, "overlap_percentage": 0.6239924134660977, "num_intersection": 5264, "num_union": 11608, "num_only_computed": 3172, "num_only_roped": 3172, "total_diff": 6344, "diff_percentage": 0.5465196416264645, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:30:12.954269", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.7881393432617188e-05, "l2_diff": 0.04052734375, "l2_diff_relative": 0.16085271317829458}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:31:31.808082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44766643788606725, "overlap_percentage": 0.6184662794832286, "num_intersection": 5218, "num_union": 11656, "num_only_computed": 3219, "num_only_roped": 3219, "total_diff": 6438, "diff_percentage": 0.5523335621139327, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:31:35.096142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.038330078125, "l2_diff_relative": 0.18601895734597157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:32:53.768634", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4593098676813976, "overlap_percentage": 0.6294891549128837, "num_intersection": 5311, "num_union": 11563, "num_only_computed": 3126, "num_only_roped": 3126, "total_diff": 6252, "diff_percentage": 0.5406901323186024, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:32:57.956628", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.0623207092285156e-05, "l2_diff": 0.041748046875, "l2_diff_relative": 0.20955882352941177}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:34:17.341210", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48818342151675487, "overlap_percentage": 0.6560796397250533, "num_intersection": 5536, "num_union": 11340, "num_only_computed": 2902, "num_only_roped": 2902, "total_diff": 5804, "diff_percentage": 0.5118165784832451, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:34:20.821896", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.6689300537109375e-05, "l2_diff": 0.0272216796875, "l2_diff_relative": 0.17531446540880502}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:35:40.218120", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4778877309746913, "overlap_percentage": 0.6467172315714624, "num_intersection": 5457, "num_union": 11419, "num_only_computed": 2981, "num_only_roped": 2981, "total_diff": 5962, "diff_percentage": 0.5221122690253087, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:35:43.262084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.18125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:37:01.951050", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4053288925895087, "overlap_percentage": 0.5768455978196468, "num_intersection": 4868, "num_union": 12010, "num_only_computed": 3571, "num_only_roped": 3571, "total_diff": 7142, "diff_percentage": 0.5946711074104912, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:37:06.062072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.0294189453125, "l2_diff_relative": 0.17616959064327486}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:38:24.619573", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5135862254506323, "overlap_percentage": 0.678634909349449, "num_intersection": 5727, "num_union": 11151, "num_only_computed": 2712, "num_only_roped": 2712, "total_diff": 5424, "diff_percentage": 0.4864137745493678, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:38:28.884878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.0242919921875, "l2_diff_relative": 0.11306818181818182}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:39:14.705307", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:39:14.719021", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7848949432373047e-06, "l2_diff": 0.0263671875, "l2_diff_relative": 0.0031719924812030073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:39:20.876658", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7203889482554214, "overlap_percentage": 0.8374721878862793, "num_intersection": 1084024, "num_union": 1504776, "num_only_computed": 226696, "num_only_roped": 194056, "total_diff": 420752, "diff_percentage": 0.2796110517445786, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:39:21.484166", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 3.3855438232421875e-05, "l2_diff": 0.443359375, "l2_diff_relative": 0.06538018433179724}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:39:36.860119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5750357492931683, "overlap_percentage": 0.7301875523158482, "num_intersection": 1339900, "num_union": 2330116, "num_only_computed": 495108, "num_only_roped": 495108, "total_diff": 990216, "diff_percentage": 0.42496425070683175, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:39:37.433195", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.982948303222656e-05, "l2_diff": 0.78125, "l2_diff_relative": 0.12437810945273632}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:39:59.438161", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4961200246299327, "overlap_percentage": 0.6632088555230035, "num_intersection": 1564706, "num_union": 3153886, "num_only_computed": 794590, "num_only_roped": 794590, "total_diff": 1589180, "diff_percentage": 0.5038799753700672, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:40:02.292305", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 4.649162292480469e-05, "l2_diff": 0.8359375, "l2_diff_relative": 0.1364795918367347}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:40:29.784807", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45433124398564423, "overlap_percentage": 0.6247974742542614, "num_intersection": 1801656, "num_union": 3965512, "num_only_computed": 1081928, "num_only_roped": 1081928, "total_diff": 2163856, "diff_percentage": 0.5456687560143558, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:40:30.745879", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03564453125, "mean_diff": 4.124641418457031e-05, "l2_diff": 0.89453125, "l2_diff_relative": 0.14384422110552764}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:41:03.401570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4333132081534527, "overlap_percentage": 0.6046315706693209, "num_intersection": 2060507, "num_union": 4755237, "num_only_computed": 1347365, "num_only_roped": 1347365, "total_diff": 2694730, "diff_percentage": 0.5666867918465472, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:41:04.496444", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 3.647804260253906e-05, "l2_diff": 0.9453125, "l2_diff_relative": 0.15125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:41:42.761168", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4093008277871849, "overlap_percentage": 0.5808565775553386, "num_intersection": 2284021, "num_union": 5580299, "num_only_computed": 1648139, "num_only_roped": 1648139, "total_diff": 3296278, "diff_percentage": 0.5906991722128151, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:41:44.075379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 3.337860107421875e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.16457286432160803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:42:28.491493", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39117057607901656, "overlap_percentage": 0.5623617733226103, "num_intersection": 2506136, "num_union": 6406760, "num_only_computed": 1950312, "num_only_roped": 1950312, "total_diff": 3900624, "diff_percentage": 0.6088294239209835, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:42:30.004375", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.19362745098039216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:43:22.439162", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3807590002896948, "overlap_percentage": 0.5515213012695312, "num_intersection": 2746982, "num_union": 7214490, "num_only_computed": 2233754, "num_only_roped": 2233754, "total_diff": 4467508, "diff_percentage": 0.6192409997103052, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:43:24.190805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052490234375, "mean_diff": 4.291534423828125e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.1972361809045226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:44:25.432363", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3719280813762883, "overlap_percentage": 0.5421976361955915, "num_intersection": 2984811, "num_union": 8025237, "num_only_computed": 2520213, "num_only_roped": 2520213, "total_diff": 5040426, "diff_percentage": 0.6280719186237117, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:44:27.426502", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.18842364532019704}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:45:32.353047", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3588720750913202, "overlap_percentage": 0.5281911103621774, "num_intersection": 3184629, "num_union": 8873995, "num_only_computed": 2844683, "num_only_roped": 2844683, "total_diff": 5689366, "diff_percentage": 0.6411279249086798, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:45:34.601232", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.049072265625, "mean_diff": 3.886222839355469e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.1834975369458128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:46:47.071237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34988544120250537, "overlap_percentage": 0.5183927917480469, "num_intersection": 3397339, "num_union": 9709861, "num_only_computed": 3156261, "num_only_roped": 3156261, "total_diff": 6312522, "diff_percentage": 0.6501145587974946, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:46:49.599833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.051025390625, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.1606280193236715}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:48:12.057219", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3478869851815782, "overlap_percentage": 0.5161960743091725, "num_intersection": 3653578, "num_union": 10502198, "num_only_computed": 3424310, "num_only_roped": 3424310, "total_diff": 6848620, "diff_percentage": 0.6521130148184218, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:48:17.036923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06396484375, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.94921875, "l2_diff_relative": 0.14963054187192118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:49:45.783583", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35324068898684813, "overlap_percentage": 0.5220663136449354, "num_intersection": 3968840, "num_union": 11235512, "num_only_computed": 3633336, "num_only_roped": 3633336, "total_diff": 7266672, "diff_percentage": 0.6467593110131519, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:49:48.886783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.849102020263672e-05, "l2_diff": 0.9296875, "l2_diff_relative": 0.14949748743718594}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:51:27.273117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34890152800935514, "overlap_percentage": 0.5173120806294103, "num_intersection": 4203918, "num_union": 12049010, "num_only_computed": 3922546, "num_only_roped": 3922546, "total_diff": 7845092, "diff_percentage": 0.6510984719906449, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:51:30.558454", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.9296875, "l2_diff_relative": 0.14727722772277227}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:53:15.606296", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3413636941249497, "overlap_percentage": 0.5089800709831218, "num_intersection": 4007988, "num_union": 11741108, "num_only_computed": 3866560, "num_only_roped": 3866560, "total_diff": 7733120, "diff_percentage": 0.6586363058750503, "num_computed": 7874548, "num_roped": 7874548}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 937, "seq_len_k": 16297, "queries_shape": [1, 32, 937, 128], "keys_shape": [1, 8, 16297, 128], "mask_shape": [1, 32, 937, 16297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:53:19.556875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.7734375, "l2_diff_relative": 0.12627551020408162}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 937, "seq_len_k": 16297, "queries_shape": [1, 32, 937, 128], "keys_shape": [1, 8, 16297, 128], "attention_shape": [1, 32, 937, 16297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:55:04.488009", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4462292226925232, "overlap_percentage": 0.6170933565590027, "num_intersection": 301829, "num_union": 676399, "num_only_computed": 187285, "num_only_roped": 187285, "total_diff": 374570, "diff_percentage": 0.5537707773074768, "num_computed": 489114, "num_roped": 489114}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16355, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 58, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:55:08.848333", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.467632293701172e-05, "l2_diff": 0.302734375, "l2_diff_relative": 0.18810679611650485}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16355, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 58, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:56:38.700057", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43740945888368127, "overlap_percentage": 0.6086080151766659, "num_intersection": 5133, "num_union": 11735, "num_only_computed": 3301, "num_only_roped": 3301, "total_diff": 6602, "diff_percentage": 0.5625905411163187, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:56:41.217610", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.21717171717171718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:57:59.674064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4550159579056327, "overlap_percentage": 0.6254446288830923, "num_intersection": 5275, "num_union": 11593, "num_only_computed": 3159, "num_only_roped": 3159, "total_diff": 6318, "diff_percentage": 0.5449840420943672, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:58:02.162508", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 3.0159950256347656e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.25149700598802394}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:59:20.509724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49331680977250597, "overlap_percentage": 0.6606994665085951, "num_intersection": 5573, "num_union": 11297, "num_only_computed": 2862, "num_only_roped": 2862, "total_diff": 5724, "diff_percentage": 0.506683190227494, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T11:59:23.040229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.23557692307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:00:42.427815", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4299033734531276, "overlap_percentage": 0.6013040901007706, "num_intersection": 5072, "num_union": 11798, "num_only_computed": 3363, "num_only_roped": 3363, "total_diff": 6726, "diff_percentage": 0.5700966265468723, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:00:44.919727", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.8133392333984375e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2606951871657754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:02:03.992703", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4531048144001378, "overlap_percentage": 0.6236367946894262, "num_intersection": 5261, "num_union": 11611, "num_only_computed": 3175, "num_only_roped": 3175, "total_diff": 6350, "diff_percentage": 0.5468951855998622, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:02:06.542591", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0260009765625, "mean_diff": 2.8371810913085938e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.3291139240506329}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:03:24.669501", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4553609937030967, "overlap_percentage": 0.6257705073494547, "num_intersection": 5279, "num_union": 11593, "num_only_computed": 3157, "num_only_roped": 3157, "total_diff": 6314, "diff_percentage": 0.5446390062969033, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:03:27.110875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.2808988764044944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:04:44.221897", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41335120194321134, "overlap_percentage": 0.584923551025246, "num_intersection": 4935, "num_union": 11939, "num_only_computed": 3502, "num_only_roped": 3502, "total_diff": 7004, "diff_percentage": 0.5866487980567887, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:04:48.707096", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03125, "mean_diff": 2.765655517578125e-05, "l2_diff": 0.060791015625, "l2_diff_relative": 0.3497191011235955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:06:06.192956", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4593098676813976, "overlap_percentage": 0.6294891549128837, "num_intersection": 5311, "num_union": 11563, "num_only_computed": 3126, "num_only_roped": 3126, "total_diff": 6252, "diff_percentage": 0.5406901323186024, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:06:09.035779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07568359375, "mean_diff": 3.4809112548828125e-05, "l2_diff": 0.091796875, "l2_diff_relative": 0.6911764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:07:26.741324", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4564598256666954, "overlap_percentage": 0.6268073003081299, "num_intersection": 5289, "num_union": 11587, "num_only_computed": 3149, "num_only_roped": 3149, "total_diff": 6298, "diff_percentage": 0.5435401743333046, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:07:29.670548", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052978515625, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.078125, "l2_diff_relative": 0.47619047619047616}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:08:50.686410", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47944244761988253, "overlap_percentage": 0.6481393695188433, "num_intersection": 5469, "num_union": 11407, "num_only_computed": 2969, "num_only_roped": 2969, "total_diff": 5938, "diff_percentage": 0.5205575523801175, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:08:53.796653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.04345703125, "l2_diff_relative": 0.279874213836478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:10:13.490377", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4157020634121792, "overlap_percentage": 0.5872733736224671, "num_intersection": 4956, "num_union": 11922, "num_only_computed": 3483, "num_only_roped": 3483, "total_diff": 6966, "diff_percentage": 0.5842979365878208, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:10:16.382402", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0458984375, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.2838983050847458}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:11:35.972913", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4585205668855859, "overlap_percentage": 0.6287474819291385, "num_intersection": 5306, "num_union": 11572, "num_only_computed": 3133, "num_only_roped": 3133, "total_diff": 6266, "diff_percentage": 0.5414794331144142, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:11:38.576650", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.0693359375, "l2_diff_relative": 0.29338842975206614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:13:00.295327", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5249796729605204, "overlap_percentage": 0.6885071090047393, "num_intersection": 5811, "num_union": 11069, "num_only_computed": 2629, "num_only_roped": 2629, "total_diff": 5258, "diff_percentage": 0.4750203270394796, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:13:03.103155", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.029052734375, "l2_diff_relative": 0.18949044585987262}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:14:22.884064", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5196254951386389, "overlap_percentage": 0.6838862559241706, "num_intersection": 5772, "num_union": 11108, "num_only_computed": 2668, "num_only_roped": 2668, "total_diff": 5336, "diff_percentage": 0.4803745048613612, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:14:25.553551", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.20603015075376885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:15:45.172213", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5293051906875623, "overlap_percentage": 0.6922165620187182, "num_intersection": 5843, "num_union": 11039, "num_only_computed": 2598, "num_only_roped": 2598, "total_diff": 5196, "diff_percentage": 0.47069480931243773, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:15:48.010089", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.0279541015625, "l2_diff_relative": 0.12665929203539822}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:16:34.016480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:16:34.030149", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7848949432373047e-06, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.0030985667293233084}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:16:39.952544", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7189770068233188, "overlap_percentage": 0.836517305315204, "num_intersection": 1082788, "num_union": 1506012, "num_only_computed": 227932, "num_only_roped": 195292, "total_diff": 423224, "diff_percentage": 0.28102299317668117, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:16:40.381229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.47265625, "l2_diff_relative": 0.06906392694063927}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:16:57.203903", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5698642137538327, "overlap_percentage": 0.7260044642857143, "num_intersection": 1332224, "num_union": 2337792, "num_only_computed": 502784, "num_only_roped": 502784, "total_diff": 1005568, "diff_percentage": 0.43013578624616733, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:16:57.749879", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.77734375, "l2_diff_relative": 0.11901913875598086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:17:18.017939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49229263355972136, "overlap_percentage": 0.65978029039171, "num_intersection": 1556617, "num_union": 3161975, "num_only_computed": 802679, "num_only_roped": 802679, "total_diff": 1605358, "diff_percentage": 0.5077073664402786, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:17:18.736831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 5.078315734863281e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.14268292682926828}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:17:44.831498", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4458791388557605, "overlap_percentage": 0.6167585199529474, "num_intersection": 1778475, "num_union": 3988693, "num_only_computed": 1105109, "num_only_roped": 1105109, "total_diff": 2210218, "diff_percentage": 0.5541208611442395, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:17:45.748306", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 4.601478576660156e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.16009852216748768}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:18:17.723805", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42463936938946184, "overlap_percentage": 0.5961359464205228, "num_intersection": 2031555, "num_union": 4784189, "num_only_computed": 1376317, "num_only_roped": 1376317, "total_diff": 2752634, "diff_percentage": 0.5753606306105382, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:18:20.720617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.16375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:18:59.229105", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4051691467857796, "overlap_percentage": 0.5766838073730469, "num_intersection": 2267613, "num_union": 5596707, "num_only_computed": 1664547, "num_only_roped": 1664547, "total_diff": 3329094, "diff_percentage": 0.5948308532142205, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:19:02.152435", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.16417910447761194}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:19:46.785710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38712487817966257, "overlap_percentage": 0.558168747845818, "num_intersection": 2487450, "num_union": 6425446, "num_only_computed": 1968998, "num_only_roped": 1968998, "total_diff": 3937996, "diff_percentage": 0.6128751218203374, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:19:48.330625", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 3.24249267578125e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.21683673469387754}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:20:39.884406", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36936202795092743, "overlap_percentage": 0.5394658540424547, "num_intersection": 2686937, "num_union": 7274535, "num_only_computed": 2293799, "num_only_roped": 2293799, "total_diff": 4587598, "diff_percentage": 0.6306379720490726, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:20:41.671553", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0732421875, "mean_diff": 4.649162292480469e-05, "l2_diff": 1.5390625, "l2_diff_relative": 0.261968085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:21:39.418968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3584972149694636, "overlap_percentage": 0.5277849833170573, "num_intersection": 2905469, "num_union": 8104579, "num_only_computed": 2599555, "num_only_roped": 2599555, "total_diff": 5199110, "diff_percentage": 0.6415027850305365, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:21:41.396310", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 4.267692565917969e-05, "l2_diff": 1.3359375, "l2_diff_relative": 0.2261904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:22:46.274979", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3615202441983417, "overlap_percentage": 0.5310537918754246, "num_intersection": 3201889, "num_union": 8856735, "num_only_computed": 2827423, "num_only_roped": 2827423, "total_diff": 5654846, "diff_percentage": 0.6384797558016583, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:22:48.501233", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04833984375, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.125, "l2_diff_relative": 0.1836734693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:24:00.441180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3571261131639742, "overlap_percentage": 0.526297607421875, "num_intersection": 3449144, "num_union": 9658056, "num_only_computed": 3104456, "num_only_roped": 3104456, "total_diff": 6208912, "diff_percentage": 0.6428738868360258, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:24:04.449338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.17}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:25:25.337338", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3555771784836735, "overlap_percentage": 0.5246136983235677, "num_intersection": 3713157, "num_union": 10442619, "num_only_computed": 3364731, "num_only_roped": 3364731, "total_diff": 6729462, "diff_percentage": 0.6444228215163265, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:25:29.275825", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.169921875, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.1687192118226601}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:26:57.554079", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35416391309753636, "overlap_percentage": 0.5230739198882004, "num_intersection": 3976500, "num_union": 11227852, "num_only_computed": 3625676, "num_only_roped": 3625676, "total_diff": 7251352, "diff_percentage": 0.6458360869024636, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:27:02.219812", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 3.2901763916015625e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.17682926829268292}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:28:37.928209", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3535265882167964, "overlap_percentage": 0.5223784908171623, "num_intersection": 4245090, "num_union": 12007838, "num_only_computed": 3881374, "num_only_roped": 3881374, "total_diff": 7762748, "diff_percentage": 0.6464734117832036, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:28:41.166577", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 2.9802322387695312e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.16169154228855723}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:30:24.882090", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3489310114514115, "overlap_percentage": 0.5173444875820175, "num_intersection": 4073854, "num_union": 11675242, "num_only_computed": 3800694, "num_only_roped": 3800694, "total_diff": 7601388, "diff_percentage": 0.6510689885485885, "num_computed": 7874548, "num_roped": 7874548}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 937, "seq_len_k": 16297, "queries_shape": [1, 32, 937, 128], "keys_shape": [1, 8, 16297, 128], "mask_shape": [1, 32, 937, 16297], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:30:30.705645", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.83984375, "l2_diff_relative": 0.13782051282051283}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 937, "seq_len_k": 16297, "queries_shape": [1, 32, 937, 128], "keys_shape": [1, 8, 16297, 128], "attention_shape": [1, 32, 937, 16297]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:32:15.775246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4364623684651056, "overlap_percentage": 0.6076906406277474, "num_intersection": 297230, "num_union": 680998, "num_only_computed": 191884, "num_only_roped": 191884, "total_diff": 383768, "diff_percentage": 0.5635376315348943, "num_computed": 489114, "num_roped": 489114}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16355, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 58, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:32:21.065604", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.28125, "l2_diff_relative": 0.17307692307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16355, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 58, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:33:49.554710", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42937039233963226, "overlap_percentage": 0.6007825468342424, "num_intersection": 5067, "num_union": 11801, "num_only_computed": 3367, "num_only_roped": 3367, "total_diff": 6734, "diff_percentage": 0.5706296076603677, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:33:52.028948", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025634765625, "mean_diff": 2.4437904357910156e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.29411764705882354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:35:09.476777", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43789958230329895, "overlap_percentage": 0.6090822859852976, "num_intersection": 5137, "num_union": 11731, "num_only_computed": 3297, "num_only_roped": 3297, "total_diff": 6594, "diff_percentage": 0.562100417696701, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:35:11.942740", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.039794921875, "mean_diff": 2.8848648071289062e-05, "l2_diff": 0.0654296875, "l2_diff_relative": 0.41875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:36:28.951859", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45168229928577575, "overlap_percentage": 0.6222880853586248, "num_intersection": 5249, "num_union": 11621, "num_only_computed": 3186, "num_only_roped": 3186, "total_diff": 6372, "diff_percentage": 0.5483177007142243, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:36:31.412797", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.0380859375, "l2_diff_relative": 0.22941176470588234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:37:51.995718", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4337922828488866, "overlap_percentage": 0.6050978067575578, "num_intersection": 5104, "num_union": 11766, "num_only_computed": 3331, "num_only_roped": 3331, "total_diff": 6662, "diff_percentage": 0.5662077171511134, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:37:54.610942", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.25748502994011974}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:39:15.822492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45510996119016817, "overlap_percentage": 0.6255334281650071, "num_intersection": 5277, "num_union": 11595, "num_only_computed": 3159, "num_only_roped": 3159, "total_diff": 6318, "diff_percentage": 0.5448900388098318, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:39:18.438959", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.056884765625, "l2_diff_relative": 0.3386627906976744}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:40:39.966160", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39634196805429117, "overlap_percentage": 0.5676861071597914, "num_intersection": 4789, "num_union": 12083, "num_only_computed": 3647, "num_only_roped": 3647, "total_diff": 7294, "diff_percentage": 0.6036580319457089, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:40:42.573831", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 3.075599670410156e-05, "l2_diff": 0.08349609375, "l2_diff_relative": 0.41911764705882354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:42:02.814329", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4674319506044004, "overlap_percentage": 0.6370747896171625, "num_intersection": 5375, "num_union": 11499, "num_only_computed": 3062, "num_only_roped": 3062, "total_diff": 6124, "diff_percentage": 0.5325680493955997, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:42:05.293962", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.6570091247558594e-05, "l2_diff": 0.0302734375, "l2_diff_relative": 0.17032967032967034}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:43:23.024838", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42987882382848913, "overlap_percentage": 0.601280075856347, "num_intersection": 5073, "num_union": 11801, "num_only_computed": 3364, "num_only_roped": 3364, "total_diff": 6728, "diff_percentage": 0.5701211761715109, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:43:25.493638", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.037353515625, "l2_diff_relative": 0.2125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:44:42.859331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44116140051238256, "overlap_percentage": 0.6122303863474757, "num_intersection": 5166, "num_union": 11710, "num_only_computed": 3272, "num_only_roped": 3272, "total_diff": 6544, "diff_percentage": 0.5588385994876174, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:44:45.690355", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2754237288135593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:46:03.022283", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4684998259658893, "overlap_percentage": 0.638065892391562, "num_intersection": 5384, "num_union": 11492, "num_only_computed": 3054, "num_only_roped": 3054, "total_diff": 6108, "diff_percentage": 0.5315001740341107, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:46:08.003861", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017578125, "mean_diff": 1.5616416931152344e-05, "l2_diff": 0.0301513671875, "l2_diff_relative": 0.17152777777777778}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:47:26.262514", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4286439817166074, "overlap_percentage": 0.6000710984713828, "num_intersection": 5064, "num_union": 11814, "num_only_computed": 3375, "num_only_roped": 3375, "total_diff": 6750, "diff_percentage": 0.5713560182833926, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:47:30.318226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.519918441772461e-05, "l2_diff": 0.032470703125, "l2_diff_relative": 0.16140776699029127}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:48:49.651061", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44664438158909747, "overlap_percentage": 0.6174902239601848, "num_intersection": 5211, "num_union": 11667, "num_only_computed": 3228, "num_only_roped": 3228, "total_diff": 6456, "diff_percentage": 0.5533556184109025, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:48:52.307700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.17916666666666667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:50:11.730604", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4308722556582182, "overlap_percentage": 0.6022511848341232, "num_intersection": 5083, "num_union": 11797, "num_only_computed": 3357, "num_only_roped": 3357, "total_diff": 6714, "diff_percentage": 0.5691277443417818, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:50:14.293710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.016845703125, "mean_diff": 1.9431114196777344e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.2088235294117647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:51:33.596709", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45416953824948314, "overlap_percentage": 0.6246445497630332, "num_intersection": 5272, "num_union": 11608, "num_only_computed": 3168, "num_only_roped": 3168, "total_diff": 6336, "diff_percentage": 0.5458304617505169, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:51:37.292514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.041259765625, "l2_diff_relative": 0.16765873015873015}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:52:57.203148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44179690836108976, "overlap_percentage": 0.6128420803222367, "num_intersection": 5173, "num_union": 11709, "num_only_computed": 3268, "num_only_roped": 3268, "total_diff": 6536, "diff_percentage": 0.5582030916389102, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:52:59.934272", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 1.609325408935547e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.14895833333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:54:19.748475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45937067773167356, "overlap_percentage": 0.6295462622911977, "num_intersection": 5314, "num_union": 11568, "num_only_computed": 3127, "num_only_roped": 3127, "total_diff": 6254, "diff_percentage": 0.5406293222683264, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:54:22.824727", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.5497207641601562e-05, "l2_diff": 0.0308837890625, "l2_diff_relative": 0.13343881856540085}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:55:43.737873", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47651945780498467, "overlap_percentage": 0.6454631603885336, "num_intersection": 5449, "num_union": 11435, "num_only_computed": 2993, "num_only_roped": 2993, "total_diff": 5986, "diff_percentage": 0.5234805421950153, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:55:46.378875", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.0322265625, "l2_diff_relative": 0.15714285714285714}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:56:34.172464", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:56:34.186152", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.0031220407196969695}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:56:40.307319", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7169681928458774, "overlap_percentage": 0.8351560568603213, "num_intersection": 1081026, "num_union": 1507774, "num_only_computed": 229694, "num_only_roped": 197054, "total_diff": 426748, "diff_percentage": 0.28303180715412257, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:56:40.712537", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03466796875, "mean_diff": 4.0531158447265625e-05, "l2_diff": 0.4765625, "l2_diff_relative": 0.0715962441314554}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:56:56.119643", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5679011449046212, "overlap_percentage": 0.7244093758719308, "num_intersection": 1329297, "num_union": 2340719, "num_only_computed": 505711, "num_only_roped": 505711, "total_diff": 1011422, "diff_percentage": 0.4320988550953788, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:56:56.693731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 5.555152893066406e-05, "l2_diff": 0.765625, "l2_diff_relative": 0.12009803921568628}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:57:17.875132", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48990273904997306, "overlap_percentage": 0.6576304965549045, "num_intersection": 1551545, "num_union": 3167047, "num_only_computed": 807751, "num_only_roped": 807751, "total_diff": 1615502, "diff_percentage": 0.5100972609500269, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:57:19.834036", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.9140625, "l2_diff_relative": 0.14625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:57:46.752751", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44390154015015937, "overlap_percentage": 0.6148640025745739, "num_intersection": 1773012, "num_union": 3994156, "num_only_computed": 1110572, "num_only_roped": 1110572, "total_diff": 2221144, "diff_percentage": 0.5560984598498406, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:57:47.669101", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.6253204345703125e-05, "l2_diff": 0.99609375, "l2_diff_relative": 0.16017587939698494}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:58:20.000254", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42256745082659575, "overlap_percentage": 0.5940912686861478, "num_intersection": 2024587, "num_union": 4791157, "num_only_computed": 1383285, "num_only_roped": 1383285, "total_diff": 2766570, "diff_percentage": 0.5774325491734043, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:58:21.119889", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 3.981590270996094e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.1649746192893401}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:58:59.584208", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4030613109632898, "overlap_percentage": 0.5745455423990885, "num_intersection": 2259205, "num_union": 5605115, "num_only_computed": 1672955, "num_only_roped": 1672955, "total_diff": 3345910, "diff_percentage": 0.5969386890367102, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:59:00.898998", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 3.337860107421875e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.16792929292929293}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:59:45.043250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3843079800469704, "overlap_percentage": 0.5552347968606388, "num_intersection": 2474375, "num_union": 6438521, "num_only_computed": 1982073, "num_only_roped": 1982073, "total_diff": 3964146, "diff_percentage": 0.6156920199530296, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T12:59:46.565466", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06689453125, "mean_diff": 3.170967102050781e-05, "l2_diff": 1.140625, "l2_diff_relative": 0.1931216931216931}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:00:39.160200", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37229279133390153, "overlap_percentage": 0.5425850717644942, "num_intersection": 2702473, "num_union": 7258999, "num_only_computed": 2278263, "num_only_roped": 2278263, "total_diff": 4556526, "diff_percentage": 0.6277072086660984, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:00:40.904997", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 4.6253204345703125e-05, "l2_diff": 1.4921875, "l2_diff_relative": 0.2581081081081081}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:01:41.540065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3609393085519026, "overlap_percentage": 0.530426751999628, "num_intersection": 2920012, "num_union": 8090036, "num_only_computed": 2585012, "num_only_roped": 2585012, "total_diff": 5170024, "diff_percentage": 0.6390606914480974, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:01:43.545662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07958984375, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.53125, "l2_diff_relative": 0.26344086021505375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:02:49.690123", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35640733758374465, "overlap_percentage": 0.5255166758661685, "num_intersection": 3168504, "num_union": 8890120, "num_only_computed": 2860808, "num_only_roped": 2860808, "total_diff": 5721616, "diff_percentage": 0.6435926624162553, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:02:51.958169", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10986328125, "mean_diff": 3.9577484130859375e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.211340206185567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:04:05.771415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35187025461536436, "overlap_percentage": 0.5205680847167968, "num_intersection": 3411595, "num_union": 9695605, "num_only_computed": 3142005, "num_only_roped": 3142005, "total_diff": 6284010, "diff_percentage": 0.6481297453846356, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:04:08.275963", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.080078125, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.20442708333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:05:30.208674", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34985144342749447, "overlap_percentage": 0.518355475531684, "num_intersection": 3668862, "num_union": 10486914, "num_only_computed": 3409026, "num_only_roped": 3409026, "total_diff": 6818052, "diff_percentage": 0.6501485565725055, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:05:34.217985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 3.528594970703125e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.19458762886597938}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:07:03.355696", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35200366501532304, "overlap_percentage": 0.5207140692349138, "num_intersection": 3958560, "num_union": 11245792, "num_only_computed": 3643616, "num_only_roped": 3643616, "total_diff": 7287232, "diff_percentage": 0.6479963349846769, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:07:06.404995", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.1967005076142132}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:08:46.581188", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3499696041613768, "overlap_percentage": 0.5184851615659652, "num_intersection": 4213451, "num_union": 12039477, "num_only_computed": 3913013, "num_only_roped": 3913013, "total_diff": 7826026, "diff_percentage": 0.6500303958386232, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:08:50.698795", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.1875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:10:38.081415", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3455642991685827, "overlap_percentage": 0.5136347618350237, "num_intersection": 4040325, "num_union": 11691963, "num_only_computed": 3825819, "num_only_roped": 3825819, "total_diff": 7651638, "diff_percentage": 0.6544357008314172, "num_computed": 7866144, "num_roped": 7866144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 936, "seq_len_k": 16296, "queries_shape": [1, 32, 936, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 936, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:10:41.602706", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10546875, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.16709183673469388}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 936, "seq_len_k": 16296, "queries_shape": [1, 32, 936, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 936, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:12:27.359396", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4361249519201125, "overlap_percentage": 0.6073635185253335, "num_intersection": 297070, "num_union": 681158, "num_only_computed": 192044, "num_only_roped": 192044, "total_diff": 384088, "diff_percentage": 0.5638750480798875, "num_computed": 489114, "num_roped": 489114}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16354, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 58, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:12:30.650501", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 2.3484230041503906e-05, "l2_diff": 0.2890625, "l2_diff_relative": 0.1761904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16354, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 58, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:14:00.822167", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4188609405232607, "overlap_percentage": 0.5904185936203012, "num_intersection": 4979, "num_union": 11887, "num_only_computed": 3454, "num_only_roped": 3454, "total_diff": 6908, "diff_percentage": 0.5811390594767393, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:14:03.502673", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 2.872943878173828e-05, "l2_diff": 0.055419921875, "l2_diff_relative": 0.2880710659898477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:15:22.626800", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3850069792265375, "overlap_percentage": 0.555963955418544, "num_intersection": 4689, "num_union": 12179, "num_only_computed": 3745, "num_only_roped": 3745, "total_diff": 7490, "diff_percentage": 0.6149930207734625, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:15:25.863568", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.030517578125, "l2_diff_relative": 0.11160714285714286}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:16:48.011370", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44356011981172444, "overlap_percentage": 0.6145364002845625, "num_intersection": 5183, "num_union": 11685, "num_only_computed": 3251, "num_only_roped": 3251, "total_diff": 6502, "diff_percentage": 0.5564398801882756, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:16:52.262052", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.04833984375, "l2_diff_relative": 0.24029126213592233}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:18:13.708968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43537820131030375, "overlap_percentage": 0.6066390041493775, "num_intersection": 5117, "num_union": 11753, "num_only_computed": 3318, "num_only_roped": 3318, "total_diff": 6636, "diff_percentage": 0.5646217986896962, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:18:16.285976", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.050537109375, "l2_diff_relative": 0.2991329479768786}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:19:35.642863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36301203845843094, "overlap_percentage": 0.5326615293420273, "num_intersection": 4493, "num_union": 12377, "num_only_computed": 3942, "num_only_roped": 3942, "total_diff": 7884, "diff_percentage": 0.636987961541569, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:19:38.133262", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.0291748046875, "l2_diff_relative": 0.10983455882352941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:20:56.758082", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4068206453764696, "overlap_percentage": 0.5783546704599336, "num_intersection": 4879, "num_union": 11993, "num_only_computed": 3557, "num_only_roped": 3557, "total_diff": 7114, "diff_percentage": 0.5931793546235304, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:20:59.854710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.052734375, "l2_diff_relative": 0.26865671641791045}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:22:16.420516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4467501286228777, "overlap_percentage": 0.6175912754860123, "num_intersection": 5210, "num_union": 11662, "num_only_computed": 3226, "num_only_roped": 3226, "total_diff": 6452, "diff_percentage": 0.5532498713771222, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:22:19.531417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.22786458333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:23:36.142571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41834075817432964, "overlap_percentage": 0.5899016237999288, "num_intersection": 4977, "num_union": 11897, "num_only_computed": 3460, "num_only_roped": 3460, "total_diff": 6920, "diff_percentage": 0.5816592418256703, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:23:38.577596", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03955078125, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.068359375, "l2_diff_relative": 0.3225806451612903}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:25:00.271813", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48017543859649126, "overlap_percentage": 0.6488088183003438, "num_intersection": 5474, "num_union": 11400, "num_only_computed": 2963, "num_only_roped": 2963, "total_diff": 5926, "diff_percentage": 0.5198245614035087, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:25:02.849796", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.23265895953757226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:26:23.903998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4316253817441466, "overlap_percentage": 0.6029864896894999, "num_intersection": 5088, "num_union": 11788, "num_only_computed": 3350, "num_only_roped": 3350, "total_diff": 6700, "diff_percentage": 0.5683746182558534, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:26:26.836703", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.1925}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:27:47.022680", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4307757524374735, "overlap_percentage": 0.6021569092201944, "num_intersection": 5081, "num_union": 11795, "num_only_computed": 3357, "num_only_roped": 3357, "total_diff": 6714, "diff_percentage": 0.5692242475625265, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:27:50.187067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 2.753734588623047e-05, "l2_diff": 0.056884765625, "l2_diff_relative": 0.32005494505494503}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:29:09.918276", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4472646201337678, "overlap_percentage": 0.6180827112217088, "num_intersection": 5216, "num_union": 11662, "num_only_computed": 3223, "num_only_roped": 3223, "total_diff": 6446, "diff_percentage": 0.5527353798662322, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:29:12.539085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.20652173913043478}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:29:58.296846", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:29:58.310487", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.0269775390625, "l2_diff_relative": 0.0032211986940298507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:30:04.231760", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7209264604408944, "overlap_percentage": 0.8378352904820766, "num_intersection": 1084494, "num_union": 1504306, "num_only_computed": 226226, "num_only_roped": 193586, "total_diff": 419812, "diff_percentage": 0.2790735395591057, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:30:04.619235", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 3.314018249511719e-05, "l2_diff": 0.40625, "l2_diff_relative": 0.05963302752293578}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:30:21.776454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5741311755963551, "overlap_percentage": 0.7294578552246094, "num_intersection": 1338561, "num_union": 2331455, "num_only_computed": 496447, "num_only_roped": 496447, "total_diff": 992894, "diff_percentage": 0.42586882440364493, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:30:22.314226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05126953125, "mean_diff": 4.839897155761719e-05, "l2_diff": 0.6875, "l2_diff_relative": 0.10837438423645321}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:30:42.613724", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4948592543875489, "overlap_percentage": 0.6620814005533854, "num_intersection": 1562046, "num_union": 3156546, "num_only_computed": 797250, "num_only_roped": 797250, "total_diff": 1594500, "diff_percentage": 0.505140745612451, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:30:43.346279", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 4.57763671875e-05, "l2_diff": 0.828125, "l2_diff_relative": 0.12864077669902912}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:31:09.599003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4510040620388693, "overlap_percentage": 0.6216441067782316, "num_intersection": 1792563, "num_union": 3974605, "num_only_computed": 1091021, "num_only_roped": 1091021, "total_diff": 2182042, "diff_percentage": 0.5489959379611308, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:31:10.502298", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.172325134277344e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.14190821256038647}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:31:41.882878", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4307115790392881, "overlap_percentage": 0.6020942101111779, "num_intersection": 2051860, "num_union": 4763884, "num_only_computed": 1356012, "num_only_roped": 1356012, "total_diff": 2712024, "diff_percentage": 0.5692884209607119, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:31:45.050400", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 3.838539123535156e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.17279411764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:32:22.007526", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40063068560077025, "overlap_percentage": 0.5720718383789063, "num_intersection": 2249478, "num_union": 5614842, "num_only_computed": 1682682, "num_only_roped": 1682682, "total_diff": 3365364, "diff_percentage": 0.5993693143992298, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:32:24.962068", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05126953125, "mean_diff": 3.4809112548828125e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1802030456852792}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:33:08.246099", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3856698640727976, "overlap_percentage": 0.5566547618192785, "num_intersection": 2480703, "num_union": 6432193, "num_only_computed": 1975745, "num_only_roped": 1975745, "total_diff": 3951490, "diff_percentage": 0.6143301359272024, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:33:09.723276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 2.8967857360839844e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.16791044776119404}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:33:59.981572", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3820578241910399, "overlap_percentage": 0.5528825458727384, "num_intersection": 2753762, "num_union": 7207710, "num_only_computed": 2226974, "num_only_roped": 2226974, "total_diff": 4453948, "diff_percentage": 0.6179421758089602, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:34:03.418544", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.17574257425742573}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:35:00.714645", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3733565010870799, "overlap_percentage": 0.5437138875325521, "num_intersection": 2993158, "num_union": 8016890, "num_only_computed": 2511866, "num_only_roped": 2511866, "total_diff": 5023732, "diff_percentage": 0.6266434989129201, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:35:02.734249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0693359375, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.25, "l2_diff_relative": 0.1951219512195122}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:36:07.252305", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3569383527476805, "overlap_percentage": 0.526093690291695, "num_intersection": 3171983, "num_union": 8886641, "num_only_computed": 2857329, "num_only_roped": 2857329, "total_diff": 5714658, "diff_percentage": 0.6430616472523195, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:36:09.476410", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 3.790855407714844e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.17682926829268292}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:37:22.124340", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35479934505076827, "overlap_percentage": 0.5237666320800781, "num_intersection": 3432557, "num_union": 9674643, "num_only_computed": 3121043, "num_only_roped": 3121043, "total_diff": 6242086, "diff_percentage": 0.6452006549492317, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:37:24.632654", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09521484375, "mean_diff": 3.266334533691406e-05, "l2_diff": 0.984375, "l2_diff_relative": 0.15365853658536585}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:38:45.761997", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35503698650933846, "overlap_percentage": 0.5240255285192419, "num_intersection": 3708994, "num_union": 10446782, "num_only_computed": 3368894, "num_only_roped": 3368894, "total_diff": 6737788, "diff_percentage": 0.6449630134906615, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:38:50.992618", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.058837890625, "mean_diff": 3.170967102050781e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.1484375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:40:18.733938", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35073134047920357, "overlap_percentage": 0.5193206524026805, "num_intersection": 3947967, "num_union": 11256385, "num_only_computed": 3654209, "num_only_roped": 3654209, "total_diff": 7308418, "diff_percentage": 0.6492686595207964, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:40:21.731782", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 2.8371810913085938e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.17279411764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:42:00.591095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34191110024565347, "overlap_percentage": 0.5095883031045237, "num_intersection": 4141151, "num_union": 12111777, "num_only_computed": 3985313, "num_only_roped": 3985313, "total_diff": 7970626, "diff_percentage": 0.6580888997543465, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:42:05.703309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09765625, "mean_diff": 3.0279159545898438e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.17}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:43:48.415888", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3389993237390006, "overlap_percentage": 0.5063472665428751, "num_intersection": 3996242, "num_union": 11788348, "num_only_computed": 3896053, "num_only_roped": 3896053, "total_diff": 7792106, "diff_percentage": 0.6610006762609995, "num_computed": 7892295, "num_roped": 7892295}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 939, "seq_len_k": 16299, "queries_shape": [1, 32, 939, 128], "keys_shape": [1, 8, 16299, 128], "mask_shape": [1, 32, 939, 16299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:43:52.704878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07177734375, "mean_diff": 2.765655517578125e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.14720812182741116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 939, "seq_len_k": 16299, "queries_shape": [1, 32, 939, 128], "keys_shape": [1, 8, 16299, 128], "attention_shape": [1, 32, 939, 16299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:45:35.452519", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4420260269348855, "overlap_percentage": 0.6130624810904958, "num_intersection": 299893, "num_union": 678451, "num_only_computed": 189279, "num_only_roped": 189279, "total_diff": 378558, "diff_percentage": 0.5579739730651145, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16357, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 58, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:45:38.839084", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 2.491474151611328e-05, "l2_diff": 0.314453125, "l2_diff_relative": 0.19258373205741627}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16357, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 58, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:47:07.926367", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44447298570083055, "overlap_percentage": 0.615411973918198, "num_intersection": 5191, "num_union": 11679, "num_only_computed": 3244, "num_only_roped": 3244, "total_diff": 6488, "diff_percentage": 0.5555270142991694, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:47:10.461679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 3.147125244140625e-05, "l2_diff": 0.058349609375, "l2_diff_relative": 0.32297297297297295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:48:29.825195", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.403143974049738, "overlap_percentage": 0.5746295198577356, "num_intersection": 4847, "num_union": 12023, "num_only_computed": 3588, "num_only_roped": 3588, "total_diff": 7176, "diff_percentage": 0.596856025950262, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:48:32.331613", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.16463414634146342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:49:51.787735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4236773268078643, "overlap_percentage": 0.5951872925557136, "num_intersection": 5021, "num_union": 11851, "num_only_computed": 3415, "num_only_roped": 3415, "total_diff": 6830, "diff_percentage": 0.5763226731921357, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:49:54.309315", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.045654296875, "l2_diff_relative": 0.20964125560538116}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:51:13.814073", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48756833010051137, "overlap_percentage": 0.6555239449976292, "num_intersection": 5530, "num_union": 11342, "num_only_computed": 2906, "num_only_roped": 2906, "total_diff": 5812, "diff_percentage": 0.5124316698994886, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:51:16.341731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.019775390625, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.2896551724137931}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:52:35.663029", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4175067204301075, "overlap_percentage": 0.5890719450041484, "num_intersection": 4970, "num_union": 11904, "num_only_computed": 3467, "num_only_roped": 3467, "total_diff": 6934, "diff_percentage": 0.5824932795698925, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:52:38.157560", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021728515625, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.32092198581560283}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:53:57.531706", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45352743561030234, "overlap_percentage": 0.6240369799691834, "num_intersection": 5265, "num_union": 11609, "num_only_computed": 3172, "num_only_roped": 3172, "total_diff": 6344, "diff_percentage": 0.5464725643896976, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:54:00.584985", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.491474151611328e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.23299319727891157}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:55:20.447850", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4628987517337032, "overlap_percentage": 0.6328513865844987, "num_intersection": 5340, "num_union": 11536, "num_only_computed": 3098, "num_only_roped": 3098, "total_diff": 6196, "diff_percentage": 0.5371012482662968, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:55:22.960301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021728515625, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.049072265625, "l2_diff_relative": 0.2716216216216216}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:56:42.853202", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45344931530445265, "overlap_percentage": 0.6239630244133682, "num_intersection": 5265, "num_union": 11611, "num_only_computed": 3173, "num_only_roped": 3173, "total_diff": 6346, "diff_percentage": 0.5465506846955474, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:56:46.325780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 3.0517578125e-05, "l2_diff": 0.05322265625, "l2_diff_relative": 0.307909604519774}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:58:05.952537", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42310286677908937, "overlap_percentage": 0.5946202156653632, "num_intersection": 5018, "num_union": 11860, "num_only_computed": 3421, "num_only_roped": 3421, "total_diff": 6842, "diff_percentage": 0.5768971332209106, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:58:09.333417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 2.5033950805664062e-05, "l2_diff": 0.056396484375, "l2_diff_relative": 0.2238372093023256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:59:28.534541", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44863101879666983, "overlap_percentage": 0.6193861831970613, "num_intersection": 5227, "num_union": 11651, "num_only_computed": 3212, "num_only_roped": 3212, "total_diff": 6424, "diff_percentage": 0.5513689812033302, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T13:59:31.329189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.04541015625, "l2_diff_relative": 0.23969072164948454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:00:51.143888", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4262779890156316, "overlap_percentage": 0.5977488151658767, "num_intersection": 5045, "num_union": 11835, "num_only_computed": 3395, "num_only_roped": 3395, "total_diff": 6790, "diff_percentage": 0.5737220109843684, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:00:53.648111", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.24611398963730569}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:02:15.719723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45642795513373596, "overlap_percentage": 0.6267772511848341, "num_intersection": 5290, "num_union": 11590, "num_only_computed": 3150, "num_only_roped": 3150, "total_diff": 6300, "diff_percentage": 0.543572044866264, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:02:18.412136", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021240234375, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.2936241610738255}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:03:39.182470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4523399862353751, "overlap_percentage": 0.6229119772538799, "num_intersection": 5258, "num_union": 11624, "num_only_computed": 3183, "num_only_roped": 3183, "total_diff": 6366, "diff_percentage": 0.5476600137646249, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:03:41.698906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.2384393063583815}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:05:00.784259", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4665971679263313, "overlap_percentage": 0.636299016704182, "num_intersection": 5371, "num_union": 11511, "num_only_computed": 3070, "num_only_roped": 3070, "total_diff": 6140, "diff_percentage": 0.5334028320736687, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:05:03.306833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.0478515625, "l2_diff_relative": 0.22790697674418606}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:06:24.368881", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45828295042321643, "overlap_percentage": 0.6285240464344942, "num_intersection": 5306, "num_union": 11578, "num_only_computed": 3136, "num_only_roped": 3136, "total_diff": 6272, "diff_percentage": 0.5417170495767836, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:06:26.938385", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.491474151611328e-05, "l2_diff": 0.04736328125, "l2_diff_relative": 0.24871794871794872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:07:47.439840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5017344125233478, "overlap_percentage": 0.6682065861170339, "num_intersection": 5641, "num_union": 11243, "num_only_computed": 2801, "num_only_roped": 2801, "total_diff": 5602, "diff_percentage": 0.4982655874766521, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:07:49.976121", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.020263671875, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.032470703125, "l2_diff_relative": 0.17592592592592593}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:08:35.789937", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:08:35.803632", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.025634765625, "l2_diff_relative": 0.003107244318181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:08:41.638833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7240254075314231, "overlap_percentage": 0.8399242892459827, "num_intersection": 1087198, "num_union": 1501602, "num_only_computed": 223522, "num_only_roped": 190882, "total_diff": 414404, "diff_percentage": 0.2759745924685769, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:08:42.014240", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.46484375, "l2_diff_relative": 0.07151442307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:08:56.630570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5781872255116508, "overlap_percentage": 0.7327232360839844, "num_intersection": 1344553, "num_union": 2325463, "num_only_computed": 490455, "num_only_roped": 490455, "total_diff": 980910, "diff_percentage": 0.4218127744883492, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:08:57.183549", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04541015625, "mean_diff": 4.982948303222656e-05, "l2_diff": 0.6796875, "l2_diff_relative": 0.11328125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:09:17.905764", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4948871957970998, "overlap_percentage": 0.6621064080132378, "num_intersection": 1562105, "num_union": 3156487, "num_only_computed": 797191, "num_only_roped": 797191, "total_diff": 1594382, "diff_percentage": 0.5051128042029003, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:09:18.628742", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 5.0067901611328125e-05, "l2_diff": 0.93359375, "l2_diff_relative": 0.1516497461928934}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:09:44.681272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45330471663903527, "overlap_percentage": 0.6238261136141691, "num_intersection": 1798855, "num_union": 3968313, "num_only_computed": 1084729, "num_only_roped": 1084729, "total_diff": 2169458, "diff_percentage": 0.5466952833609647, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:09:45.602433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 4.38690185546875e-05, "l2_diff": 0.953125, "l2_diff_relative": 0.1556122448979592}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:10:17.544504", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.427090144772594, "overlap_percentage": 0.5985468350923978, "num_intersection": 2039771, "num_union": 4775973, "num_only_computed": 1368101, "num_only_roped": 1368101, "total_diff": 2736202, "diff_percentage": 0.572909855227406, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:10:19.045594", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.15816326530612246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:10:56.868442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41367259136278317, "overlap_percentage": 0.5852452596028646, "num_intersection": 2301278, "num_union": 5563042, "num_only_computed": 1630882, "num_only_roped": 1630882, "total_diff": 3261764, "diff_percentage": 0.5863274086372169, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:11:00.853813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.17692307692307693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:11:44.929176", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39204750977865044, "overlap_percentage": 0.563267427332261, "num_intersection": 2510172, "num_union": 6402724, "num_only_computed": 1946276, "num_only_roped": 1946276, "total_diff": 3892552, "diff_percentage": 0.6079524902213496, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:11:46.455622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.0040740966796875e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.1725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:12:37.601174", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3846945747037282, "overlap_percentage": 0.5556381627133018, "num_intersection": 2767487, "num_union": 7193985, "num_only_computed": 2213249, "num_only_roped": 2213249, "total_diff": 4426498, "diff_percentage": 0.6153054252962719, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:12:39.367118", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.125, "l2_diff_relative": 0.18090452261306533}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:13:36.831246", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37166999283769625, "overlap_percentage": 0.541923341296968, "num_intersection": 2983301, "num_union": 8026747, "num_only_computed": 2521723, "num_only_roped": 2521723, "total_diff": 5043446, "diff_percentage": 0.6283300071623037, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:13:38.815426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.044921875, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.18125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:14:43.003975", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3630620262861353, "overlap_percentage": 0.5327153413192086, "num_intersection": 3211907, "num_union": 8846717, "num_only_computed": 2817405, "num_only_roped": 2817405, "total_diff": 5634810, "diff_percentage": 0.6369379737138647, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:14:45.259788", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 3.695487976074219e-05, "l2_diff": 0.984375, "l2_diff_relative": 0.1529126213592233}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:15:58.134512", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3531205744485759, "overlap_percentage": 0.5219351196289063, "num_intersection": 3420554, "num_union": 9686646, "num_only_computed": 3133046, "num_only_roped": 3133046, "total_diff": 6266092, "diff_percentage": 0.6468794255514241, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:16:00.658503", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0673828125, "mean_diff": 3.361701965332031e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.14055023923444976}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:17:21.381837", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34665319611637185, "overlap_percentage": 0.5148366292317709, "num_intersection": 3643956, "num_union": 10511820, "num_only_computed": 3433932, "num_only_roped": 3433932, "total_diff": 6867864, "diff_percentage": 0.6533468038836281, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:17:24.149408", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 3.0994415283203125e-05, "l2_diff": 0.91015625, "l2_diff_relative": 0.14070048309178743}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:18:54.482214", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3430228249412397, "overlap_percentage": 0.5108220330600081, "num_intersection": 3883359, "num_union": 11320993, "num_only_computed": 3718817, "num_only_roped": 3718817, "total_diff": 7437634, "diff_percentage": 0.6569771750587603, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:18:57.636801", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.9802322387695312e-05, "l2_diff": 0.95703125, "l2_diff_relative": 0.1516089108910891}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:20:35.976539", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34465241205799413, "overlap_percentage": 0.5126267710039693, "num_intersection": 4165843, "num_union": 12087085, "num_only_computed": 3960621, "num_only_roped": 3960621, "total_diff": 7921242, "diff_percentage": 0.6553475879420059, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:20:41.422568", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 2.944469451904297e-05, "l2_diff": 0.9609375, "l2_diff_relative": 0.14855072463768115}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:22:27.371387", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3423484368223328, "overlap_percentage": 0.5100738786313266, "num_intersection": 4007551, "num_union": 11706059, "num_only_computed": 3849254, "num_only_roped": 3849254, "total_diff": 7698508, "diff_percentage": 0.6576515631776673, "num_computed": 7856805, "num_roped": 7856805}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:22:33.224249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.1614010989010989}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:24:18.545496", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4370981581390975, "overlap_percentage": 0.608306615193352, "num_intersection": 297496, "num_union": 680616, "num_only_computed": 191560, "num_only_roped": 191560, "total_diff": 383120, "diff_percentage": 0.5629018418609025, "num_computed": 489056, "num_roped": 489056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16353, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 58, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:24:24.531753", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.2890625, "l2_diff_relative": 0.1761904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16353, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 58, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:25:54.942568", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4098470283373736, "overlap_percentage": 0.5814063796988024, "num_intersection": 4903, "num_union": 11963, "num_only_computed": 3530, "num_only_roped": 3530, "total_diff": 7060, "diff_percentage": 0.5901529716626265, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:25:57.473662", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.288818359375e-05, "l2_diff": 0.047607421875, "l2_diff_relative": 0.2074468085106383}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:27:16.612986", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45121321631388744, "overlap_percentage": 0.6218427605834222, "num_intersection": 5244, "num_union": 11622, "num_only_computed": 3189, "num_only_roped": 3189, "total_diff": 6378, "diff_percentage": 0.5487867836861126, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:27:19.170993", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.19912790697674418}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:28:38.053859", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4078958350721976, "overlap_percentage": 0.5794403604458146, "num_intersection": 4887, "num_union": 11981, "num_only_computed": 3547, "num_only_roped": 3547, "total_diff": 7094, "diff_percentage": 0.5921041649278024, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:28:40.593116", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.02783203125, "l2_diff_relative": 0.16473988439306358}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:29:57.576433", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4899743838883491, "overlap_percentage": 0.6576950438700498, "num_intersection": 5547, "num_union": 11321, "num_only_computed": 2887, "num_only_roped": 2887, "total_diff": 5774, "diff_percentage": 0.5100256161116509, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:30:00.016301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.017333984375, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.03564453125, "l2_diff_relative": 0.24333333333333335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:31:18.412146", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4290554849639983, "overlap_percentage": 0.6004742145820984, "num_intersection": 5065, "num_union": 11805, "num_only_computed": 3370, "num_only_roped": 3370, "total_diff": 6740, "diff_percentage": 0.5709445150360017, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:31:21.080022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.2119205298013245}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:32:40.411803", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37132173630304016, "overlap_percentage": 0.5415530527563722, "num_intersection": 4568, "num_union": 12302, "num_only_computed": 3867, "num_only_roped": 3867, "total_diff": 7734, "diff_percentage": 0.6286782636969599, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:32:43.931623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.1611328125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:34:03.692365", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4536055828379426, "overlap_percentage": 0.6241109530583214, "num_intersection": 5265, "num_union": 11607, "num_only_computed": 3171, "num_only_roped": 3171, "total_diff": 6342, "diff_percentage": 0.5463944171620574, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:34:06.892652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 1.8835067749023438e-05, "l2_diff": 0.02978515625, "l2_diff_relative": 0.1882716049382716}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:35:27.053711", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41235560020090406, "overlap_percentage": 0.5839260312944523, "num_intersection": 4926, "num_union": 11946, "num_only_computed": 3510, "num_only_roped": 3510, "total_diff": 7020, "diff_percentage": 0.5876443997990959, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:35:30.724214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0142822265625, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.18787425149700598}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:36:50.176003", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4181023615429868, "overlap_percentage": 0.5896645727154202, "num_intersection": 4975, "num_union": 11899, "num_only_computed": 3462, "num_only_roped": 3462, "total_diff": 6924, "diff_percentage": 0.5818976384570131, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:36:52.874141", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.014892578125, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.029052734375, "l2_diff_relative": 0.17921686746987953}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:38:13.505701", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4358407079646018, "overlap_percentage": 0.6070878274268104, "num_intersection": 5122, "num_union": 11752, "num_only_computed": 3315, "num_only_roped": 3315, "total_diff": 6630, "diff_percentage": 0.5641592920353983, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:38:16.582384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.037109375, "l2_diff_relative": 0.22093023255813954}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:39:36.901450", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41934398654331373, "overlap_percentage": 0.5908983171367622, "num_intersection": 4986, "num_union": 11890, "num_only_computed": 3452, "num_only_roped": 3452, "total_diff": 6904, "diff_percentage": 0.5806560134566863, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:39:40.415273", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.20180722891566266}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:41:00.898294", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3795471266247037, "overlap_percentage": 0.5502488741407917, "num_intersection": 4643, "num_union": 12233, "num_only_computed": 3795, "num_only_roped": 3795, "total_diff": 7590, "diff_percentage": 0.6204528733752963, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:41:03.844949", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.14732142857142858}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:42:23.072159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4035758835758836, "overlap_percentage": 0.5750681360350752, "num_intersection": 4853, "num_union": 12025, "num_only_computed": 3586, "num_only_roped": 3586, "total_diff": 7172, "diff_percentage": 0.5964241164241164, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:42:25.559779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.5079975128173828e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.1332720588235294}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:43:43.504968", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41451558833389207, "overlap_percentage": 0.5860883990994193, "num_intersection": 4946, "num_union": 11932, "num_only_computed": 3493, "num_only_roped": 3493, "total_diff": 6986, "diff_percentage": 0.585484411666108, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:43:45.988362", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.9788742065429688e-05, "l2_diff": 0.036376953125, "l2_diff_relative": 0.17009132420091325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:45:03.301619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4568050401311815, "overlap_percentage": 0.627132701421801, "num_intersection": 5293, "num_union": 11587, "num_only_computed": 3147, "num_only_roped": 3147, "total_diff": 6294, "diff_percentage": 0.5431949598688185, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:45:05.770058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.288818359375e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.20833333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:46:23.311043", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5092989985693849, "overlap_percentage": 0.6748815165876777, "num_intersection": 5696, "num_union": 11184, "num_only_computed": 2744, "num_only_roped": 2744, "total_diff": 5488, "diff_percentage": 0.4907010014306152, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:46:27.469323", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.02685546875, "l2_diff_relative": 0.17295597484276728}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:47:12.281915", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:47:12.295604", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.814697265625e-06, "l2_diff": 0.02685546875, "l2_diff_relative": 0.0032307330827067667}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:47:18.077166", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7174933142618687, "overlap_percentage": 0.8355122064276885, "num_intersection": 1081487, "num_union": 1507313, "num_only_computed": 229233, "num_only_roped": 196593, "total_diff": 425826, "diff_percentage": 0.28250668573813137, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:47:20.650844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 3.886222839355469e-05, "l2_diff": 0.453125, "l2_diff_relative": 0.06712962962962964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:47:35.003782", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5777380837229298, "overlap_percentage": 0.7323624747140067, "num_intersection": 1343891, "num_union": 2326125, "num_only_computed": 491117, "num_only_roped": 491117, "total_diff": 982234, "diff_percentage": 0.4222619162770702, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:47:35.542585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 4.76837158203125e-05, "l2_diff": 0.71875, "l2_diff_relative": 0.11165048543689321}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:47:55.310576", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4893106915809268, "overlap_percentage": 0.6570968627929688, "num_intersection": 1550286, "num_union": 3168306, "num_only_computed": 809010, "num_only_roped": 809010, "total_diff": 1618020, "diff_percentage": 0.5106893084190731, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:47:56.025189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 5.078315734863281e-05, "l2_diff": 0.93359375, "l2_diff_relative": 0.1524234693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:48:21.543966", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4405473670748473, "overlap_percentage": 0.6116388494318182, "num_intersection": 1763712, "num_union": 4003456, "num_only_computed": 1119872, "num_only_roped": 1119872, "total_diff": 2239744, "diff_percentage": 0.5594526329251527, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:48:22.441142", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 4.482269287109375e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.15752551020408162}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:48:53.663784", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.430692358522805, "overlap_percentage": 0.6020754300631009, "num_intersection": 2051796, "num_union": 4763948, "num_only_computed": 1356076, "num_only_roped": 1356076, "total_diff": 2712152, "diff_percentage": 0.5693076414771949, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:48:54.752131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.1567258883248731}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:49:33.991063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4026298953831205, "overlap_percentage": 0.5741071065266927, "num_intersection": 2257481, "num_union": 5606839, "num_only_computed": 1674679, "num_only_roped": 1674679, "total_diff": 3349358, "diff_percentage": 0.5973701046168794, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:49:35.278760", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.3125, "l2_diff_relative": 0.21105527638190955}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:50:18.545579", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3766506330998679, "overlap_percentage": 0.5471985760857078, "num_intersection": 2438562, "num_union": 6474334, "num_only_computed": 2017886, "num_only_roped": 2017886, "total_diff": 4035772, "diff_percentage": 0.6233493669001321, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:50:22.238507", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0625, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.21778350515463918}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:51:13.754115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3779860251918382, "overlap_percentage": 0.5486064710115132, "num_intersection": 2732464, "num_union": 7229008, "num_only_computed": 2248272, "num_only_roped": 2248272, "total_diff": 4496544, "diff_percentage": 0.6220139748081618, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:51:17.878680", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 4.3392181396484375e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.2012820512820513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:52:15.568300", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3774733420660509, "overlap_percentage": 0.5480662754603794, "num_intersection": 3017118, "num_union": 7992930, "num_only_computed": 2487906, "num_only_roped": 2487906, "total_diff": 4975812, "diff_percentage": 0.6225266579339491, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:52:17.587063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04541015625, "mean_diff": 4.100799560546875e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.1916243654822335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:53:23.415095", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36171273774677226, "overlap_percentage": 0.5312614440917969, "num_intersection": 3203141, "num_union": 8855483, "num_only_computed": 2826171, "num_only_roped": 2826171, "total_diff": 5652342, "diff_percentage": 0.6382872622532277, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:53:25.683437", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0712890625, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.1642156862745098}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:54:40.001601", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35769685423528247, "overlap_percentage": 0.5269171142578125, "num_intersection": 3453204, "num_union": 9653996, "num_only_computed": 3100396, "num_only_roped": 3100396, "total_diff": 6200792, "diff_percentage": 0.6423031457647176, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:54:44.900617", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0830078125, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.14832535885167464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:56:07.771675", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.354160594164103, "overlap_percentage": 0.5230703000669126, "num_intersection": 3702233, "num_union": 10453543, "num_only_computed": 3375655, "num_only_roped": 3375655, "total_diff": 6751310, "diff_percentage": 0.6458394058358969, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:56:11.201378", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.078125, "mean_diff": 3.24249267578125e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.1494047619047619}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:57:41.152076", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3494039205648692, "overlap_percentage": 0.5178640957536369, "num_intersection": 3936894, "num_union": 11267458, "num_only_computed": 3665282, "num_only_roped": 3665282, "total_diff": 7330564, "diff_percentage": 0.6505960794351308, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:57:45.222597", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.1638755980861244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:59:22.798562", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34530341100860873, "overlap_percentage": 0.5133465182396674, "num_intersection": 4171692, "num_union": 12081236, "num_only_computed": 3954772, "num_only_roped": 3954772, "total_diff": 7909544, "diff_percentage": 0.6546965889913913, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T14:59:26.101012", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.039836883544922e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.15476190476190477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:01:11.513900", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3377774953466023, "overlap_percentage": 0.5049830730768694, "num_intersection": 3981231, "num_union": 11786549, "num_only_computed": 3902659, "num_only_roped": 3902659, "total_diff": 7805318, "diff_percentage": 0.6622225046533977, "num_computed": 7883890, "num_roped": 7883890}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "mask_shape": [1, 32, 938, 16298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:01:16.528702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.15234375, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.85546875, "l2_diff_relative": 0.13419117647058823}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "attention_shape": [1, 32, 938, 16298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:03:00.883615", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4319059313922072, "overlap_percentage": 0.6032602029551978, "num_intersection": 295098, "num_union": 683246, "num_only_computed": 194074, "num_only_roped": 194074, "total_diff": 388148, "diff_percentage": 0.5680940686077928, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 58, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:03:05.337739", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.27734375, "l2_diff_relative": 0.16824644549763032}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 58, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:04:33.858119", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4330133378642426, "overlap_percentage": 0.6043395778989803, "num_intersection": 5097, "num_union": 11771, "num_only_computed": 3337, "num_only_roped": 3337, "total_diff": 6674, "diff_percentage": 0.5669866621357573, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:04:36.337438", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.2669491525423729}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:05:53.377934", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4558163617535381, "overlap_percentage": 0.6262003556609366, "num_intersection": 5282, "num_union": 11588, "num_only_computed": 3153, "num_only_roped": 3153, "total_diff": 6306, "diff_percentage": 0.5441836382464619, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:05:55.835590", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.035400390625, "l2_diff_relative": 0.18979057591623036}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:07:12.706269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37871853546910755, "overlap_percentage": 0.5493775933609959, "num_intersection": 4634, "num_union": 12236, "num_only_computed": 3801, "num_only_roped": 3801, "total_diff": 7602, "diff_percentage": 0.6212814645308925, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:07:15.554696", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0126953125, "mean_diff": 1.7881393432617188e-05, "l2_diff": 0.0228271484375, "l2_diff_relative": 0.08408273381294964}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:08:32.843806", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47405207059234666, "overlap_percentage": 0.6431958274063537, "num_intersection": 5426, "num_union": 11446, "num_only_computed": 3010, "num_only_roped": 3010, "total_diff": 6020, "diff_percentage": 0.5259479294076533, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:08:35.706062", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.2530555725097656e-05, "l2_diff": 0.031982421875, "l2_diff_relative": 0.2197986577181208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:09:52.719491", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.429103845502287, "overlap_percentage": 0.6005215742057848, "num_intersection": 5066, "num_union": 11806, "num_only_computed": 3370, "num_only_roped": 3370, "total_diff": 6740, "diff_percentage": 0.570896154497713, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:09:55.748339", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.03955078125, "l2_diff_relative": 0.21428571428571427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:11:14.088745", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44160615121742847, "overlap_percentage": 0.6126585279127652, "num_intersection": 5169, "num_union": 11705, "num_only_computed": 3268, "num_only_roped": 3268, "total_diff": 6536, "diff_percentage": 0.5583938487825716, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:11:16.580371", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.030029296875, "l2_diff_relative": 0.15073529411764705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:12:35.041494", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4569159039889484, "overlap_percentage": 0.6272371696100509, "num_intersection": 5292, "num_union": 11582, "num_only_computed": 3145, "num_only_roped": 3145, "total_diff": 6290, "diff_percentage": 0.5430840960110517, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:12:37.529027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 1.728534698486328e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.19473684210526315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:13:55.248833", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4174365865949941, "overlap_percentage": 0.5890021332069211, "num_intersection": 4970, "num_union": 11906, "num_only_computed": 3468, "num_only_roped": 3468, "total_diff": 6936, "diff_percentage": 0.5825634134050058, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:13:57.694404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.04443359375, "l2_diff_relative": 0.2740963855421687}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:15:15.414314", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4404233526800956, "overlap_percentage": 0.6115193173737853, "num_intersection": 5160, "num_union": 11716, "num_only_computed": 3278, "num_only_roped": 3278, "total_diff": 6556, "diff_percentage": 0.5595766473199044, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:15:19.996868", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.21017699115044247}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:16:38.908766", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.441947885519009, "overlap_percentage": 0.6129873207726034, "num_intersection": 5173, "num_union": 11705, "num_only_computed": 3266, "num_only_roped": 3266, "total_diff": 6532, "diff_percentage": 0.558052114480991, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:16:43.897779", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.023193359375, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.047119140625, "l2_diff_relative": 0.26222826086956524}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:18:03.289725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4328890398166228, "overlap_percentage": 0.60421850930205, "num_intersection": 5099, "num_union": 11779, "num_only_computed": 3340, "num_only_roped": 3340, "total_diff": 6680, "diff_percentage": 0.5671109601833771, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:18:07.689543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.06396484375, "l2_diff_relative": 0.3393782383419689}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:19:25.496205", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43610685724008846, "overlap_percentage": 0.6073459715639811, "num_intersection": 5126, "num_union": 11754, "num_only_computed": 3314, "num_only_roped": 3314, "total_diff": 6628, "diff_percentage": 0.5638931427599115, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:19:28.374819", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.05517578125, "l2_diff_relative": 0.30213903743315507}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:20:46.093134", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45442012752024813, "overlap_percentage": 0.6248815165876778, "num_intersection": 5274, "num_union": 11606, "num_only_computed": 3166, "num_only_roped": 3166, "total_diff": 6332, "diff_percentage": 0.5455798724797518, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:20:48.577038", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.633167266845703e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.16666666666666666}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:22:06.100424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.504232379934064, "overlap_percentage": 0.6704181968961024, "num_intersection": 5659, "num_union": 11223, "num_only_computed": 2782, "num_only_roped": 2782, "total_diff": 5564, "diff_percentage": 0.495767620065936, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:22:08.561196", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01513671875, "mean_diff": 1.800060272216797e-05, "l2_diff": 0.032470703125, "l2_diff_relative": 0.16878172588832488}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:23:26.478008", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48465394424412983, "overlap_percentage": 0.6528847292974767, "num_intersection": 5511, "num_union": 11371, "num_only_computed": 2930, "num_only_roped": 2930, "total_diff": 5860, "diff_percentage": 0.5153460557558702, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:23:29.055658", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 1.71661376953125e-05, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.14963054187192118}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:24:48.707424", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4454241931341495, "overlap_percentage": 0.6163231461738924, "num_intersection": 5203, "num_union": 11681, "num_only_computed": 3239, "num_only_roped": 3239, "total_diff": 6478, "diff_percentage": 0.5545758068658505, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:24:51.216130", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013427734375, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.0257568359375, "l2_diff_relative": 0.10989583333333333}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:25:36.931776", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:25:36.945482", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.025634765625, "l2_diff_relative": 0.003107244318181818}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:25:43.912475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7194188459941885, "overlap_percentage": 0.8368162855377008, "num_intersection": 1083175, "num_union": 1505625, "num_only_computed": 227545, "num_only_roped": 194905, "total_diff": 422450, "diff_percentage": 0.2805811540058115, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:25:44.285377", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03271484375, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.48046875, "l2_diff_relative": 0.07085253456221198}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:25:59.026368", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.570392874640833, "overlap_percentage": 0.726433345249721, "num_intersection": 1333011, "num_union": 2337005, "num_only_computed": 501997, "num_only_roped": 501997, "total_diff": 1003994, "diff_percentage": 0.42960712535916695, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:25:59.583435", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 5.459785461425781e-05, "l2_diff": 0.76953125, "l2_diff_relative": 0.11838942307692307}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:26:20.769366", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4932484712579404, "overlap_percentage": 0.660638173421224, "num_intersection": 1558641, "num_union": 3159951, "num_only_computed": 800655, "num_only_roped": 800655, "total_diff": 1601310, "diff_percentage": 0.5067515287420596, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:26:21.515710", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 5.14984130859375e-05, "l2_diff": 0.91796875, "l2_diff_relative": 0.14399509803921567}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:26:50.531426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45197031188632314, "overlap_percentage": 0.6225613680752841, "num_intersection": 1795208, "num_union": 3971960, "num_only_computed": 1088376, "num_only_roped": 1088376, "total_diff": 2176752, "diff_percentage": 0.5480296881136769, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:26:53.555674", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 4.363059997558594e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.15346534653465346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:27:25.695112", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4224766005706399, "overlap_percentage": 0.59400147658128, "num_intersection": 2024281, "num_union": 4791463, "num_only_computed": 1383591, "num_only_roped": 1383591, "total_diff": 2767182, "diff_percentage": 0.57752339942936, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:27:26.808154", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.981590270996094e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.17408376963350786}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:28:04.745442", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3979924763191773, "overlap_percentage": 0.5693771362304687, "num_intersection": 2238882, "num_union": 5625438, "num_only_computed": 1693278, "num_only_roped": 1693278, "total_diff": 3386556, "diff_percentage": 0.6020075236808227, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:28:06.052425", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04443359375, "mean_diff": 3.695487976074219e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.18882978723404256}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:28:50.349233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38477985969326917, "overlap_percentage": 0.5557271172018612, "num_intersection": 2476569, "num_union": 6436327, "num_only_computed": 1979879, "num_only_roped": 1979879, "total_diff": 3959758, "diff_percentage": 0.6152201403067309, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:28:51.858051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.24249267578125e-05, "l2_diff": 1.1328125, "l2_diff_relative": 0.18685567010309279}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:29:42.533998", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3787212533769181, "overlap_percentage": 0.5493804530093545, "num_intersection": 2736319, "num_union": 7225153, "num_only_computed": 2244417, "num_only_roped": 2244417, "total_diff": 4488834, "diff_percentage": 0.6212787466230819, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:29:44.272041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.315376281738281e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.1913265306122449}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:30:42.376124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37349835867037956, "overlap_percentage": 0.5438642955961681, "num_intersection": 2993986, "num_union": 8016062, "num_only_computed": 2511038, "num_only_roped": 2511038, "total_diff": 5022076, "diff_percentage": 0.6265016413296205, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:30:44.398639", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0595703125, "mean_diff": 3.981590270996094e-05, "l2_diff": 1.453125, "l2_diff_relative": 0.23969072164948454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:31:51.489489", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35908986040464247, "overlap_percentage": 0.5284269581670347, "num_intersection": 3186051, "num_union": 8872573, "num_only_computed": 2843261, "num_only_roped": 2843261, "total_diff": 5686522, "diff_percentage": 0.6409101395953575, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:31:53.771816", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.21556122448979592}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:33:06.780465", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3502493601685504, "overlap_percentage": 0.5187921142578125, "num_intersection": 3399956, "num_union": 9707244, "num_only_computed": 3153644, "num_only_roped": 3153644, "total_diff": 6307288, "diff_percentage": 0.6497506398314495, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:33:10.406633", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.19117647058823528}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:34:33.194950", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34980793824731204, "overlap_percentage": 0.5183077211733218, "num_intersection": 3668524, "num_union": 10487252, "num_only_computed": 3409364, "num_only_roped": 3409364, "total_diff": 6818728, "diff_percentage": 0.650192061752688, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:34:36.515535", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1181640625, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.17051282051282052}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:36:05.611647", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3465485219616324, "overlap_percentage": 0.5147211798306169, "num_intersection": 3913001, "num_union": 11291351, "num_only_computed": 3689175, "num_only_roped": 3689175, "total_diff": 7378350, "diff_percentage": 0.6534514780383676, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:36:11.307331", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 3.24249267578125e-05, "l2_diff": 1.125, "l2_diff_relative": 0.1836734693877551}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:37:49.218948", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34777322049901416, "overlap_percentage": 0.5160708273610761, "num_intersection": 4193831, "num_union": 12059097, "num_only_computed": 3932633, "num_only_roped": 3932633, "total_diff": 7865266, "diff_percentage": 0.6522267795009858, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:37:52.774119", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04345703125, "mean_diff": 2.849102020263672e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.15979381443298968}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:39:38.383055", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34521166364905514, "overlap_percentage": 0.5132451241355211, "num_intersection": 4014260, "num_union": 11628402, "num_only_computed": 3807071, "num_only_roped": 3807071, "total_diff": 7614142, "diff_percentage": 0.6547883363509449, "num_computed": 7821331, "num_roped": 7821331}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 931, "seq_len_k": 16291, "queries_shape": [1, 32, 931, 128], "keys_shape": [1, 8, 16291, 128], "mask_shape": [1, 32, 931, 16291], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:39:41.986577", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0556640625, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.14945652173913043}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 931, "seq_len_k": 16291, "queries_shape": [1, 32, 931, 128], "keys_shape": [1, 8, 16291, 128], "attention_shape": [1, 32, 931, 16291]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:41:26.411570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44293509536639997, "overlap_percentage": 0.6139362702990142, "num_intersection": 300178, "num_union": 677702, "num_only_computed": 188762, "num_only_roped": 188762, "total_diff": 377524, "diff_percentage": 0.5570649046336, "num_computed": 488940, "num_roped": 488940}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16349, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16349, 128], "mask_shape": [1, 32, 58, 16349], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:41:29.670274", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.29296875, "l2_diff_relative": 0.176056338028169}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16349, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16349, 128], "attention_shape": [1, 32, 58, 16349]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:42:59.185372", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43396547325452844, "overlap_percentage": 0.6052662792076859, "num_intersection": 5103, "num_union": 11759, "num_only_computed": 3328, "num_only_roped": 3328, "total_diff": 6656, "diff_percentage": 0.5660345267454715, "num_computed": 8431, "num_roped": 8431}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16350, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16350, 128], "mask_shape": [1, 32, 1, 16350], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:43:01.678834", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.6106834411621094e-05, "l2_diff": 0.04931640625, "l2_diff_relative": 0.2671957671957672}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16350, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16350, 128], "attention_shape": [1, 32, 1, 16350]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:44:20.060411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4704805092875207, "overlap_percentage": 0.6399003676906654, "num_intersection": 5395, "num_union": 11467, "num_only_computed": 3036, "num_only_roped": 3036, "total_diff": 6072, "diff_percentage": 0.5295194907124793, "num_computed": 8431, "num_roped": 8431}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16351, 128], "mask_shape": [1, 32, 1, 16351], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:44:23.413085", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.849102020263672e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.27121212121212124}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16351, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16351, 128], "attention_shape": [1, 32, 1, 16351]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:45:40.179888", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46732793874532325, "overlap_percentage": 0.6369781783681214, "num_intersection": 5371, "num_union": 11493, "num_only_computed": 3061, "num_only_roped": 3061, "total_diff": 6122, "diff_percentage": 0.5326720612546768, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 1, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:45:43.355916", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.682209014892578e-05, "l2_diff": 0.04541015625, "l2_diff_relative": 0.2703488372093023}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16352, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 1, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:47:01.686866", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3988055739880557, "overlap_percentage": 0.5702087286527514, "num_intersection": 4808, "num_union": 12056, "num_only_computed": 3624, "num_only_roped": 3624, "total_diff": 7248, "diff_percentage": 0.6011944260119443, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:47:04.147513", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.6345252990722656e-05, "l2_diff": 0.046875, "l2_diff_relative": 0.2909090909090909}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:48:21.292769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4713425804763151, "overlap_percentage": 0.640697260761295, "num_intersection": 5403, "num_union": 11463, "num_only_computed": 3030, "num_only_roped": 3030, "total_diff": 6060, "diff_percentage": 0.528657419523685, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:48:23.758258", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 2.193450927734375e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.25}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:49:41.726229", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4403074295473954, "overlap_percentage": 0.6114075655164236, "num_intersection": 5156, "num_union": 11710, "num_only_computed": 3277, "num_only_roped": 3277, "total_diff": 6554, "diff_percentage": 0.5596925704526046, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:49:45.571930", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.044677734375, "l2_diff_relative": 0.26142857142857145}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:51:05.201700", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4502622302467544, "overlap_percentage": 0.6209390562010908, "num_intersection": 5237, "num_union": 11631, "num_only_computed": 3197, "num_only_roped": 3197, "total_diff": 6394, "diff_percentage": 0.5497377697532456, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:51:09.848770", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.0400390625, "l2_diff_relative": 0.19339622641509435}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:52:28.721642", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4556437694166379, "overlap_percentage": 0.6260374673938819, "num_intersection": 5280, "num_union": 11588, "num_only_computed": 3154, "num_only_roped": 3154, "total_diff": 6308, "diff_percentage": 0.5443562305833621, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:52:31.723122", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.043212890625, "l2_diff_relative": 0.2058139534883721}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:53:50.727180", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4811237928007024, "overlap_percentage": 0.6496739774748074, "num_intersection": 5480, "num_union": 11390, "num_only_computed": 2955, "num_only_roped": 2955, "total_diff": 5910, "diff_percentage": 0.5188762071992976, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:53:53.706946", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.2026315789473684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:55:14.445666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4074753879526114, "overlap_percentage": 0.5790160047421459, "num_intersection": 4884, "num_union": 11986, "num_only_computed": 3551, "num_only_roped": 3551, "total_diff": 7102, "diff_percentage": 0.5925246120473886, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:55:17.523908", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.00830078125, "mean_diff": 1.9311904907226562e-05, "l2_diff": 0.0194091796875, "l2_diff_relative": 0.09987437185929648}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:56:37.253797", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5069667738478028, "overlap_percentage": 0.6728307254623044, "num_intersection": 5676, "num_union": 11196, "num_only_computed": 2760, "num_only_roped": 2760, "total_diff": 5520, "diff_percentage": 0.4930332261521972, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:56:39.758201", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.0272216796875, "l2_diff_relative": 0.1302570093457944}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:57:25.664902", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:57:25.678555", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.814697265625e-06, "l2_diff": 0.026611328125, "l2_diff_relative": 0.0032256155303030305}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:57:31.550566", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7214093640200973, "overlap_percentage": 0.8381613102595797, "num_intersection": 1084916, "num_union": 1503884, "num_only_computed": 225804, "num_only_roped": 193164, "total_diff": 418968, "diff_percentage": 0.2785906359799027, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:57:31.935322", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 3.5762786865234375e-05, "l2_diff": 0.439453125, "l2_diff_relative": 0.06540697674418605}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:57:46.906646", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5746478510655643, "overlap_percentage": 0.729874747140067, "num_intersection": 1339326, "num_union": 2330690, "num_only_computed": 495682, "num_only_roped": 495682, "total_diff": 991364, "diff_percentage": 0.42535214893443574, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:57:47.457780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03759765625, "mean_diff": 5.221366882324219e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.11791237113402062}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:58:07.612502", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4915642991238554, "overlap_percentage": 0.6591258578830295, "num_intersection": 1555073, "num_union": 3163519, "num_only_computed": 804223, "num_only_roped": 804223, "total_diff": 1608446, "diff_percentage": 0.5084357008761445, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:58:08.340974", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03564453125, "mean_diff": 5.0067901611328125e-05, "l2_diff": 0.86328125, "l2_diff_relative": 0.14022842639593908}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:58:34.667128", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.449475306229496, "overlap_percentage": 0.6201903603293679, "num_intersection": 1788371, "num_union": 3978797, "num_only_computed": 1095213, "num_only_roped": 1095213, "total_diff": 2190426, "diff_percentage": 0.550524693770504, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:58:35.570182", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.1551507537688442}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:59:07.747130", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4304254269348563, "overlap_percentage": 0.6018145634577825, "num_intersection": 2050907, "num_union": 4764837, "num_only_computed": 1356965, "num_only_roped": 1356965, "total_diff": 2713930, "diff_percentage": 0.5695745730651437, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:59:08.855276", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.743171691894531e-05, "l2_diff": 1.0, "l2_diff_relative": 0.15920398009950248}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:59:46.489943", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3992274315702611, "overlap_percentage": 0.5706398010253906, "num_intersection": 2243847, "num_union": 5620473, "num_only_computed": 1688313, "num_only_roped": 1688313, "total_diff": 3376626, "diff_percentage": 0.6007725684297389, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T15:59:47.760833", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.25, "l2_diff_relative": 0.2094240837696335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:00:31.019204", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38287109607427905, "overlap_percentage": 0.553733601289637, "num_intersection": 2467685, "num_union": 6445211, "num_only_computed": 1988763, "num_only_roped": 1988763, "total_diff": 3977526, "diff_percentage": 0.617128903925721, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:00:32.499346", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.4332275390625e-05, "l2_diff": 1.375, "l2_diff_relative": 0.2222222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:01:22.456954", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37569136919895496, "overlap_percentage": 0.5461855436626234, "num_intersection": 2720406, "num_union": 7241066, "num_only_computed": 2260330, "num_only_roped": 2260330, "total_diff": 4520660, "diff_percentage": 0.624308630801045, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:01:24.711247", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.265625, "l2_diff_relative": 0.20984455958549222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:02:21.633557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36701786415129856, "overlap_percentage": 0.5369613284156436, "num_intersection": 2955985, "num_union": 8054063, "num_only_computed": 2549039, "num_only_roped": 2549039, "total_diff": 5098078, "diff_percentage": 0.6329821358487014, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:02:23.613906", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04736328125, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.1951530612244898}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:03:28.300918", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36499409397234267, "overlap_percentage": 0.5347921951957371, "num_intersection": 3224429, "num_union": 8834195, "num_only_computed": 2804883, "num_only_roped": 2804883, "total_diff": 5609766, "diff_percentage": 0.6350059060276573, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:03:30.816557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.10107421875, "mean_diff": 3.7670135498046875e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.16379310344827586}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:04:43.760290", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3591496272635427, "overlap_percentage": 0.5284916687011719, "num_intersection": 3463523, "num_union": 9643677, "num_only_computed": 3090077, "num_only_roped": 3090077, "total_diff": 6180154, "diff_percentage": 0.6408503727364573, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:04:46.340818", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.056640625, "mean_diff": 3.409385681152344e-05, "l2_diff": 0.96875, "l2_diff_relative": 0.14761904761904762}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:06:08.253114", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3588370489961812, "overlap_percentage": 0.5281531722457321, "num_intersection": 3738209, "num_union": 10417567, "num_only_computed": 3339679, "num_only_roped": 3339679, "total_diff": 6679358, "diff_percentage": 0.6411629510038188, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:06:11.093422", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.049560546875, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.15758293838862558}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:07:44.593473", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3510126718038436, "overlap_percentage": 0.519628985174771, "num_intersection": 3950311, "num_union": 11254041, "num_only_computed": 3651865, "num_only_roped": 3651865, "total_diff": 7303730, "diff_percentage": 0.6489873281961563, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:07:47.710642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.203125, "l2_diff_relative": 0.1905940594059406}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:09:25.831578", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34254392094939495, "overlap_percentage": 0.5102908226751512, "num_intersection": 4146860, "num_union": 12106068, "num_only_computed": 3979604, "num_only_roped": 3979604, "total_diff": 7959208, "diff_percentage": 0.657456079050605, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:09:29.156249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0791015625, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.20024875621890548}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:11:13.425137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3351882323101649, "overlap_percentage": 0.5020838623333531, "num_intersection": 3944775, "num_union": 11768835, "num_only_computed": 3912030, "num_only_roped": 3912030, "total_diff": 7824060, "diff_percentage": 0.6648117676898351, "num_computed": 7856805, "num_roped": 7856805}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "mask_shape": [1, 32, 935, 16295], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:11:16.911683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 3.0517578125e-05, "l2_diff": 1.0625, "l2_diff_relative": 0.17258883248730963}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 935, "seq_len_k": 16295, "queries_shape": [1, 32, 935, 128], "keys_shape": [1, 8, 16295, 128], "attention_shape": [1, 32, 935, 16295]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:12:59.985914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4379622673686098, "overlap_percentage": 0.6091429202381732, "num_intersection": 297905, "num_union": 680207, "num_only_computed": 191151, "num_only_roped": 191151, "total_diff": 382302, "diff_percentage": 0.5620377326313901, "num_computed": 489056, "num_roped": 489056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16353, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 58, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:13:05.943022", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.302734375, "l2_diff_relative": 0.18719806763285024}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16353, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 58, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:14:33.984990", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43503786267336, "overlap_percentage": 0.6063085497450492, "num_intersection": 5113, "num_union": 11753, "num_only_computed": 3320, "num_only_roped": 3320, "total_diff": 6640, "diff_percentage": 0.56496213732664, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:14:36.430067", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03173828125, "mean_diff": 2.3245811462402344e-05, "l2_diff": 0.04833984375, "l2_diff_relative": 0.2357142857142857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:15:57.662094", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44153846153846155, "overlap_percentage": 0.6125933831376734, "num_intersection": 5166, "num_union": 11700, "num_only_computed": 3267, "num_only_roped": 3267, "total_diff": 6534, "diff_percentage": 0.5584615384615385, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:16:00.224956", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02099609375, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.2161764705882353}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:17:21.248335", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4558950457448645, "overlap_percentage": 0.6262746027981978, "num_intersection": 5282, "num_union": 11586, "num_only_computed": 3152, "num_only_roped": 3152, "total_diff": 6304, "diff_percentage": 0.5441049542551355, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:17:23.833202", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.23372781065088757}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:18:44.802401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4265899864682003, "overlap_percentage": 0.5980554896846099, "num_intersection": 5044, "num_union": 11824, "num_only_computed": 3390, "num_only_roped": 3390, "total_diff": 6780, "diff_percentage": 0.5734100135317998, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:18:47.341374", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02685546875, "mean_diff": 2.968311309814453e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.3258620689655172}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:20:07.894548", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43598910452843037, "overlap_percentage": 0.6072317723770005, "num_intersection": 5122, "num_union": 11748, "num_only_computed": 3313, "num_only_roped": 3313, "total_diff": 6626, "diff_percentage": 0.5640108954715697, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:20:10.429433", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.046630859375, "l2_diff_relative": 0.300314465408805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:21:29.337761", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4324530865245818, "overlap_percentage": 0.6037937166567872, "num_intersection": 5093, "num_union": 11777, "num_only_computed": 3342, "num_only_roped": 3342, "total_diff": 6684, "diff_percentage": 0.5675469134754182, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:21:31.847251", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.04638671875, "l2_diff_relative": 0.2375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:22:51.326992", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4310432569974555, "overlap_percentage": 0.6024182076813656, "num_intersection": 5082, "num_union": 11790, "num_only_computed": 3354, "num_only_roped": 3354, "total_diff": 6708, "diff_percentage": 0.5689567430025445, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:22:54.307838", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0244140625, "mean_diff": 2.658367156982422e-05, "l2_diff": 0.0439453125, "l2_diff_relative": 0.2795031055900621}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:24:13.610237", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3875, "overlap_percentage": 0.5585585585585585, "num_intersection": 4712, "num_union": 12160, "num_only_computed": 3724, "num_only_roped": 3724, "total_diff": 7448, "diff_percentage": 0.6125, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:24:18.631014", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.035888671875, "l2_diff_relative": 0.1284965034965035}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:25:37.436106", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39523730775591204, "overlap_percentage": 0.5665520919758208, "num_intersection": 4780, "num_union": 12094, "num_only_computed": 3657, "num_only_roped": 3657, "total_diff": 7314, "diff_percentage": 0.604762692244088, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:25:39.967297", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.2036637931034483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:26:57.668313", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45202650374322345, "overlap_percentage": 0.6226146734621311, "num_intersection": 5253, "num_union": 11621, "num_only_computed": 3184, "num_only_roped": 3184, "total_diff": 6368, "diff_percentage": 0.5479734962567765, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:27:00.126384", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.574920654296875e-05, "l2_diff": 0.054443359375, "l2_diff_relative": 0.32794117647058824}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:28:19.116854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43686675180928053, "overlap_percentage": 0.6080824840009481, "num_intersection": 5131, "num_union": 11745, "num_only_computed": 3307, "num_only_roped": 3307, "total_diff": 6614, "diff_percentage": 0.5631332481907194, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:28:21.598623", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 2.396106719970703e-05, "l2_diff": 0.058837890625, "l2_diff_relative": 0.2654185022026432}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:29:39.087606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45032657270539705, "overlap_percentage": 0.6210002370229912, "num_intersection": 5240, "num_union": 11636, "num_only_computed": 3198, "num_only_roped": 3198, "total_diff": 6396, "diff_percentage": 0.549673427294603, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:29:41.553080", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.053955078125, "l2_diff_relative": 0.229253112033195}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:30:58.833007", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43936551253624423, "overlap_percentage": 0.6104988742742031, "num_intersection": 5152, "num_union": 11726, "num_only_computed": 3287, "num_only_roped": 3287, "total_diff": 6574, "diff_percentage": 0.5606344874637558, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:31:01.948567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.045654296875, "l2_diff_relative": 0.2280487804878049}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:32:18.882744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5152168058173984, "overlap_percentage": 0.6800568787771063, "num_intersection": 5739, "num_union": 11139, "num_only_computed": 2700, "num_only_roped": 2700, "total_diff": 5400, "diff_percentage": 0.4847831941826017, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:32:21.315568", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.3484230041503906e-05, "l2_diff": 0.025146484375, "l2_diff_relative": 0.1268472906403941}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:33:07.141729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:33:08.791765", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7848949432373047e-06, "l2_diff": 0.02587890625, "l2_diff_relative": 0.003136837121212121}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:33:14.552115", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7203249266363289, "overlap_percentage": 0.8374289245982695, "num_intersection": 1083968, "num_union": 1504832, "num_only_computed": 226752, "num_only_roped": 194112, "total_diff": 420864, "diff_percentage": 0.27967507336367115, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:33:14.920888", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.029296875, "mean_diff": 3.552436828613281e-05, "l2_diff": 0.431640625, "l2_diff_relative": 0.06454439252336448}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:33:30.193427", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5764565191991807, "overlap_percentage": 0.7313319614955357, "num_intersection": 1342000, "num_union": 2328016, "num_only_computed": 493008, "num_only_roped": 493008, "total_diff": 986016, "diff_percentage": 0.4235434808008192, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:33:30.741027", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 5.125999450683594e-05, "l2_diff": 0.71484375, "l2_diff_relative": 0.11611675126903553}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:33:50.516862", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4936630164408938, "overlap_percentage": 0.6610098944769965, "num_intersection": 1559518, "num_union": 3159074, "num_only_computed": 799778, "num_only_roped": 799778, "total_diff": 1599556, "diff_percentage": 0.5063369835591063, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:33:51.276367", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 5.173683166503906e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:34:17.456472", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4469140758284327, "overlap_percentage": 0.6177479137073864, "num_intersection": 1781328, "num_union": 3985840, "num_only_computed": 1102256, "num_only_roped": 1102256, "total_diff": 2204512, "diff_percentage": 0.5530859241715673, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:34:19.364261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 4.982948303222656e-05, "l2_diff": 1.2265625, "l2_diff_relative": 0.19823232323232323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:34:50.611518", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42196022158877894, "overlap_percentage": 0.5934908940241888, "num_intersection": 2022541, "num_union": 4793203, "num_only_computed": 1385331, "num_only_roped": 1385331, "total_diff": 2770662, "diff_percentage": 0.578039778411221, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:34:51.678903", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.910064697265625e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.1736842105263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:35:28.922980", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40957262328464017, "overlap_percentage": 0.5811302185058593, "num_intersection": 2285097, "num_union": 5579223, "num_only_computed": 1647063, "num_only_roped": 1647063, "total_diff": 3294126, "diff_percentage": 0.5904273767153598, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:35:30.225683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 3.457069396972656e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.1736842105263158}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:36:14.408588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39561768116191653, "overlap_percentage": 0.5669427759507123, "num_intersection": 2526551, "num_union": 6386345, "num_only_computed": 1929897, "num_only_roped": 1929897, "total_diff": 3859794, "diff_percentage": 0.6043823188380835, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:36:15.953786", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.17839195979899497}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:37:07.023014", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.387489811256841, "overlap_percentage": 0.5585479736328125, "num_intersection": 2781980, "num_union": 7179492, "num_only_computed": 2198756, "num_only_roped": 2198756, "total_diff": 4397512, "diff_percentage": 0.612510188743159, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:37:08.782307", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.2333984375, "mean_diff": 4.2438507080078125e-05, "l2_diff": 1.2109375, "l2_diff_relative": 0.19183168316831684}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:38:07.634958", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38017950528865935, "overlap_percentage": 0.5509131295340401, "num_intersection": 3032790, "num_union": 7977258, "num_only_computed": 2472234, "num_only_roped": 2472234, "total_diff": 4944468, "diff_percentage": 0.6198204947113407, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:38:09.667137", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.07421875, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.18226600985221675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:39:16.158863", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3753759761464799, "overlap_percentage": 0.5458521635636039, "num_intersection": 3291113, "num_union": 8767511, "num_only_computed": 2738199, "num_only_roped": 2738199, "total_diff": 5476398, "diff_percentage": 0.6246240238535201, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:39:18.458364", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0654296875, "mean_diff": 3.695487976074219e-05, "l2_diff": 1.015625, "l2_diff_relative": 0.15550239234449761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:40:32.682767", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3624385771190108, "overlap_percentage": 0.5320439147949219, "num_intersection": 3486803, "num_union": 9620397, "num_only_computed": 3066797, "num_only_roped": 3066797, "total_diff": 6133594, "diff_percentage": 0.6375614228809893, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:40:37.262264", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0888671875, "mean_diff": 3.337860107421875e-05, "l2_diff": 0.93359375, "l2_diff_relative": 0.1402582159624413}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:42:00.753386", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35532513046742703, "overlap_percentage": 0.5243393226906106, "num_intersection": 3711215, "num_union": 10444561, "num_only_computed": 3366673, "num_only_roped": 3366673, "total_diff": 6733346, "diff_percentage": 0.644674869532573, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:42:04.003296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 3.170967102050781e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.1674641148325359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:43:34.583725", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3423892775209918, "overlap_percentage": 0.5101192079741379, "num_intersection": 3878016, "num_union": 11326336, "num_only_computed": 3724160, "num_only_roped": 3724160, "total_diff": 7448320, "diff_percentage": 0.6576107224790082, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:43:39.613727", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1259765625, "mean_diff": 3.1948089599609375e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.1834975369458128}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:45:18.144598", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3387124779131643, "overlap_percentage": 0.5060272216796875, "num_intersection": 4112212, "num_union": 12140716, "num_only_computed": 4014252, "num_only_roped": 4014252, "total_diff": 8028504, "diff_percentage": 0.6612875220868357, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:45:21.486676", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0810546875, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.1015625, "l2_diff_relative": 0.17279411764705882}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:47:05.589812", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33753812980870884, "overlap_percentage": 0.5047155251670958, "num_intersection": 3970165, "num_union": 11762123, "num_only_computed": 3895979, "num_only_roped": 3895979, "total_diff": 7791958, "diff_percentage": 0.6624618701912911, "num_computed": 7866144, "num_roped": 7866144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 936, "seq_len_k": 16296, "queries_shape": [1, 32, 936, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 936, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:47:09.705212", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 2.956390380859375e-05, "l2_diff": 0.93359375, "l2_diff_relative": 0.15012562814070352}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 936, "seq_len_k": 16296, "queries_shape": [1, 32, 936, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 936, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:48:52.724956", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44037105205035704, "overlap_percentage": 0.6114689009106261, "num_intersection": 299078, "num_union": 679150, "num_only_computed": 190036, "num_only_roped": 190036, "total_diff": 380072, "diff_percentage": 0.5596289479496429, "num_computed": 489114, "num_roped": 489114}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16354, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 58, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:48:55.985787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0439453125, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.30078125, "l2_diff_relative": 0.18689320388349515}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16354, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 58, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:50:25.294269", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4332087015635622, "overlap_percentage": 0.6045298233131744, "num_intersection": 5098, "num_union": 11768, "num_only_computed": 3335, "num_only_roped": 3335, "total_diff": 6670, "diff_percentage": 0.5667912984364378, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:50:28.284252", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.22346368715083798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:51:47.685957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3670475727368506, "overlap_percentage": 0.5369931230732748, "num_intersection": 4529, "num_union": 12339, "num_only_computed": 3905, "num_only_roped": 3905, "total_diff": 7810, "diff_percentage": 0.6329524272631494, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:51:52.601287", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.039794921875, "l2_diff_relative": 0.14348591549295775}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:53:12.561716", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4341098452644108, "overlap_percentage": 0.6054066872184017, "num_intersection": 5106, "num_union": 11762, "num_only_computed": 3328, "num_only_roped": 3328, "total_diff": 6656, "diff_percentage": 0.5658901547355892, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:53:16.990407", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.043701171875, "l2_diff_relative": 0.23803191489361702}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:54:37.032191", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4541849840530989, "overlap_percentage": 0.6246591582691168, "num_intersection": 5269, "num_union": 11601, "num_only_computed": 3166, "num_only_roped": 3166, "total_diff": 6332, "diff_percentage": 0.5458150159469012, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:54:40.677549", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.47955322265625e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.2549407114624506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:56:00.519093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4388059701492537, "overlap_percentage": 0.6099585062240664, "num_intersection": 5145, "num_union": 11725, "num_only_computed": 3290, "num_only_roped": 3290, "total_diff": 6580, "diff_percentage": 0.5611940298507463, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:56:05.086813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.288818359375e-05, "l2_diff": 0.0296630859375, "l2_diff_relative": 0.1797337278106509}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:57:22.227182", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4685351205500914, "overlap_percentage": 0.6380986249407302, "num_intersection": 5383, "num_union": 11489, "num_only_computed": 3053, "num_only_roped": 3053, "total_diff": 6106, "diff_percentage": 0.5314648794499086, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:57:26.067653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.811981201171875e-05, "l2_diff": 0.027587890625, "l2_diff_relative": 0.16424418604651161}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:58:43.619431", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43237965871466166, "overlap_percentage": 0.6037221431958274, "num_intersection": 5093, "num_union": 11779, "num_only_computed": 3343, "num_only_roped": 3343, "total_diff": 6686, "diff_percentage": 0.5676203412853383, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T16:58:46.072539", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 1.990795135498047e-05, "l2_diff": 0.0306396484375, "l2_diff_relative": 0.18455882352941178}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:00:04.417729", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.45302678033238614, "overlap_percentage": 0.623562877800166, "num_intersection": 5261, "num_union": 11613, "num_only_computed": 3176, "num_only_roped": 3176, "total_diff": 6352, "diff_percentage": 0.5469732196676139, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:00:06.893702", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.015625, "mean_diff": 2.110004425048828e-05, "l2_diff": 0.030517578125, "l2_diff_relative": 0.19171779141104295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:01:24.890823", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47667804323094426, "overlap_percentage": 0.6456086286594761, "num_intersection": 5447, "num_union": 11427, "num_only_computed": 2990, "num_only_roped": 2990, "total_diff": 5980, "diff_percentage": 0.5233219567690558, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:01:27.914954", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013916015625, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.0311279296875, "l2_diff_relative": 0.2125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:02:47.239645", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4545767971039476, "overlap_percentage": 0.6250296278739038, "num_intersection": 5274, "num_union": 11602, "num_only_computed": 3164, "num_only_roped": 3164, "total_diff": 6328, "diff_percentage": 0.5454232028960524, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:02:52.291333", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.029541015625, "l2_diff_relative": 0.1822289156626506}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:04:11.669381", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3935590421139554, "overlap_percentage": 0.5648257881014458, "num_intersection": 4766, "num_union": 12110, "num_only_computed": 3672, "num_only_roped": 3672, "total_diff": 7344, "diff_percentage": 0.6064409578860446, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:04:15.927673", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 1.6689300537109375e-05, "l2_diff": 0.0264892578125, "l2_diff_relative": 0.11542553191489362}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:05:35.288516", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43325407608695654, "overlap_percentage": 0.6045740016589644, "num_intersection": 5102, "num_union": 11776, "num_only_computed": 3337, "num_only_roped": 3337, "total_diff": 6674, "diff_percentage": 0.5667459239130435, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:05:38.113722", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0302734375, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.0458984375, "l2_diff_relative": 0.1902834008097166}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:06:57.102840", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4630721220527046, "overlap_percentage": 0.6330133902121104, "num_intersection": 5342, "num_union": 11536, "num_only_computed": 3097, "num_only_roped": 3097, "total_diff": 6194, "diff_percentage": 0.5369278779472955, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:07:00.894739", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 2.276897430419922e-05, "l2_diff": 0.049560546875, "l2_diff_relative": 0.21323529411764705}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:08:19.156103", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4427350427350427, "overlap_percentage": 0.6137440758293838, "num_intersection": 5180, "num_union": 11700, "num_only_computed": 3260, "num_only_roped": 3260, "total_diff": 6520, "diff_percentage": 0.5572649572649573, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:08:21.641445", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.044189453125, "l2_diff_relative": 0.181}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:09:39.527524", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5111906893464637, "overlap_percentage": 0.6765402843601895, "num_intersection": 5710, "num_union": 11170, "num_only_computed": 2730, "num_only_roped": 2730, "total_diff": 5460, "diff_percentage": 0.4888093106535363, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:09:41.995317", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.013671875, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.0230712890625, "l2_diff_relative": 0.1125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:10:26.630923", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:10:26.644548", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7401914596557617e-06, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.0031516335227272725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:10:32.400426", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7182228658773337, "overlap_percentage": 0.8360066440049444, "num_intersection": 1082127, "num_union": 1506673, "num_only_computed": 228593, "num_only_roped": 195953, "total_diff": 424546, "diff_percentage": 0.2817771341226663, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:10:32.767767", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.470703125, "l2_diff_relative": 0.07005813953488373}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:10:47.100851", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5689045332165994, "overlap_percentage": 0.7252251761300224, "num_intersection": 1330794, "num_union": 2339222, "num_only_computed": 504214, "num_only_roped": 504214, "total_diff": 1008428, "diff_percentage": 0.43109546678340066, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:10:47.629995", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048828125, "mean_diff": 5.53131103515625e-05, "l2_diff": 0.76171875, "l2_diff_relative": 0.1183252427184466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:11:07.578187", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4919613985240984, "overlap_percentage": 0.6594827440049913, "num_intersection": 1555915, "num_union": 3162677, "num_only_computed": 803381, "num_only_roped": 803381, "total_diff": 1606762, "diff_percentage": 0.5080386014759016, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:11:08.283170", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 5.125999450683594e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.1416256157635468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:11:34.051625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44588747627655334, "overlap_percentage": 0.6167664961381392, "num_intersection": 1778498, "num_union": 3988670, "num_only_computed": 1105086, "num_only_roped": 1105086, "total_diff": 2210172, "diff_percentage": 0.5541125237234467, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:11:34.961008", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 4.506111145019531e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.15532178217821782}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:12:06.489063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42414611753073544, "overlap_percentage": 0.5956497192382812, "num_intersection": 2029898, "num_union": 4785846, "num_only_computed": 1377974, "num_only_roped": 1377974, "total_diff": 2755948, "diff_percentage": 0.5758538824692646, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:12:07.573145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.037109375, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1620603015075377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:12:46.685129", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40452143201064134, "overlap_percentage": 0.5760274251302083, "num_intersection": 2265032, "num_union": 5599288, "num_only_computed": 1667128, "num_only_roped": 1667128, "total_diff": 3334256, "diff_percentage": 0.5954785679893586, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:12:47.968640", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 3.3855438232421875e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.1755050505050505}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:13:31.351032", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3823179725146135, "overlap_percentage": 0.553154889275046, "num_intersection": 2465106, "num_union": 6447790, "num_only_computed": 1991342, "num_only_roped": 1991342, "total_diff": 3982684, "diff_percentage": 0.6176820274853865, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:13:34.349477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.064453125, "mean_diff": 3.409385681152344e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.22948717948717948}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:14:25.370769", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3693462159324083, "overlap_percentage": 0.5394489890650699, "num_intersection": 2686853, "num_union": 7274619, "num_only_computed": 2293883, "num_only_roped": 2293883, "total_diff": 4587766, "diff_percentage": 0.6306537840675918, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:14:27.088589", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 4.5299530029296875e-05, "l2_diff": 1.421875, "l2_diff_relative": 0.24074074074074073}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:15:26.455262", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36138676359467353, "overlap_percentage": 0.5309097653343564, "num_intersection": 2922671, "num_union": 8087377, "num_only_computed": 2582353, "num_only_roped": 2582353, "total_diff": 5164706, "diff_percentage": 0.6386132364053265, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:15:28.755436", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05712890625, "mean_diff": 4.363059997558594e-05, "l2_diff": 1.3984375, "l2_diff_relative": 0.2355263157894737}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:16:35.247570", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3608354271073237, "overlap_percentage": 0.5303145698879076, "num_intersection": 3197432, "num_union": 8861192, "num_only_computed": 2831880, "num_only_roped": 2831880, "total_diff": 5663760, "diff_percentage": 0.6391645728926763, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:16:38.769226", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.3203125, "l2_diff_relative": 0.21125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:17:52.504211", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.354396301036567, "overlap_percentage": 0.5233273315429687, "num_intersection": 3429678, "num_union": 9677522, "num_only_computed": 3123922, "num_only_roped": 3123922, "total_diff": 6247844, "diff_percentage": 0.645603698963433, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:17:55.061177", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06787109375, "mean_diff": 3.62396240234375e-05, "l2_diff": 1.15625, "l2_diff_relative": 0.18592964824120603}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:19:16.833247", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35530138412200435, "overlap_percentage": 0.5243134675202547, "num_intersection": 3711032, "num_union": 10444744, "num_only_computed": 3366856, "num_only_roped": 3366856, "total_diff": 6733712, "diff_percentage": 0.6446986158779957, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:19:19.657417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.1318359375, "mean_diff": 3.24249267578125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.16995073891625614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:20:52.268588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3574982183471583, "overlap_percentage": 0.5267015654465248, "num_intersection": 4004078, "num_union": 11200274, "num_only_computed": 3598098, "num_only_roped": 3598098, "total_diff": 7196196, "diff_percentage": 0.6425017816528417, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:20:55.340316", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.09130859375, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.17164179104477612}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:22:34.216125", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3555006021091459, "overlap_percentage": 0.5245303492392263, "num_intersection": 4262577, "num_union": 11990351, "num_only_computed": 3863887, "num_only_roped": 3863887, "total_diff": 7727774, "diff_percentage": 0.6444993978908541, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:22:37.529602", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05029296875, "mean_diff": 3.123283386230469e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.16995073891625614}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:24:24.898492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3492959287560083, "overlap_percentage": 0.5177454720078254, "num_intersection": 4086200, "num_union": 11698390, "num_only_computed": 3806095, "num_only_roped": 3806095, "total_diff": 7612190, "diff_percentage": 0.6507040712439917, "num_computed": 7892295, "num_roped": 7892295}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 939, "seq_len_k": 16299, "queries_shape": [1, 32, 939, 128], "keys_shape": [1, 8, 16299, 128], "mask_shape": [1, 32, 939, 16299], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:24:28.474192", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.8828125, "l2_diff_relative": 0.1434010152284264}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 939, "seq_len_k": 16299, "queries_shape": [1, 32, 939, 128], "keys_shape": [1, 8, 16299, 128], "attention_shape": [1, 32, 939, 16299]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:26:15.180367", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4394630248403979, "overlap_percentage": 0.6105930020524478, "num_intersection": 298685, "num_union": 679659, "num_only_computed": 190487, "num_only_roped": 190487, "total_diff": 380974, "diff_percentage": 0.5605369751596021, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16357, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 58, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:26:18.498041", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04052734375, "mean_diff": 2.3603439331054688e-05, "l2_diff": 0.283203125, "l2_diff_relative": 0.1751207729468599}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16357, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 58, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:27:48.225539", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4300245825209799, "overlap_percentage": 0.6014226437462952, "num_intersection": 5073, "num_union": 11797, "num_only_computed": 3362, "num_only_roped": 3362, "total_diff": 6724, "diff_percentage": 0.5699754174790201, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:27:51.199642", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.1696090698242188e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.21875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:29:08.264677", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3888202848439944, "overlap_percentage": 0.5599288678126852, "num_intersection": 4723, "num_union": 12147, "num_only_computed": 3712, "num_only_roped": 3712, "total_diff": 7424, "diff_percentage": 0.6111797151560056, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:29:11.334514", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.034423828125, "l2_diff_relative": 0.12771739130434784}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:30:30.351411", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4621717653176185, "overlap_percentage": 0.6321716453295401, "num_intersection": 5333, "num_union": 11539, "num_only_computed": 3103, "num_only_roped": 3103, "total_diff": 6206, "diff_percentage": 0.5378282346823815, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:30:32.801229", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.288818359375e-05, "l2_diff": 0.040283203125, "l2_diff_relative": 0.22664835164835165}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:31:51.513739", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4173387096774194, "overlap_percentage": 0.5889046941678521, "num_intersection": 4968, "num_union": 11904, "num_only_computed": 3468, "num_only_roped": 3468, "total_diff": 6936, "diff_percentage": 0.5826612903225806, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:31:53.983125", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.5987625122070312e-05, "l2_diff": 0.051513671875, "l2_diff_relative": 0.3031609195402299}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:33:11.202137", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44642551002914455, "overlap_percentage": 0.6172810240606851, "num_intersection": 5208, "num_union": 11666, "num_only_computed": 3229, "num_only_roped": 3229, "total_diff": 6458, "diff_percentage": 0.5535744899708555, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:33:13.652878", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.5153160095214844e-05, "l2_diff": 0.046142578125, "l2_diff_relative": 0.27958579881656803}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:34:30.640414", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4685813751087903, "overlap_percentage": 0.6381415194974517, "num_intersection": 5384, "num_union": 11490, "num_only_computed": 3053, "num_only_roped": 3053, "total_diff": 6106, "diff_percentage": 0.5314186248912097, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:34:34.412846", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.728534698486328e-05, "l2_diff": 0.03271484375, "l2_diff_relative": 0.17539267015706805}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:35:51.588661", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43126113137138494, "overlap_percentage": 0.6026309552026546, "num_intersection": 5085, "num_union": 11791, "num_only_computed": 3353, "num_only_roped": 3353, "total_diff": 6706, "diff_percentage": 0.568738868628615, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:35:54.027780", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.04736328125, "l2_diff_relative": 0.25935828877005346}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:37:12.807328", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.39252413565475697, "overlap_percentage": 0.5637591846409101, "num_intersection": 4757, "num_union": 12119, "num_only_computed": 3681, "num_only_roped": 3681, "total_diff": 7362, "diff_percentage": 0.607475864345243, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:37:15.357127", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.052978515625, "l2_diff_relative": 0.2411111111111111}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:38:32.630093", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46256499133448875, "overlap_percentage": 0.6325394004028914, "num_intersection": 5338, "num_union": 11540, "num_only_computed": 3101, "num_only_roped": 3101, "total_diff": 6202, "diff_percentage": 0.5374350086655113, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:38:35.989944", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.19101123595505617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:39:52.881632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4541225122770742, "overlap_percentage": 0.6246000710984714, "num_intersection": 5271, "num_union": 11607, "num_only_computed": 3168, "num_only_roped": 3168, "total_diff": 6336, "diff_percentage": 0.5458774877229258, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:39:56.439030", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.0478515625, "l2_diff_relative": 0.21030042918454936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:41:15.363233", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44743611730406446, "overlap_percentage": 0.6182464454976303, "num_intersection": 5218, "num_union": 11662, "num_only_computed": 3222, "num_only_roped": 3222, "total_diff": 6444, "diff_percentage": 0.5525638826959355, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:41:17.831856", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02734375, "mean_diff": 2.1576881408691406e-05, "l2_diff": 0.05224609375, "l2_diff_relative": 0.24429223744292236}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:42:36.097148", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.502313990744037, "overlap_percentage": 0.6687203791469194, "num_intersection": 5644, "num_union": 11236, "num_only_computed": 2796, "num_only_roped": 2796, "total_diff": 5592, "diff_percentage": 0.49768600925596296, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:42:38.622280", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01220703125, "mean_diff": 1.704692840576172e-05, "l2_diff": 0.026123046875, "l2_diff_relative": 0.16512345679012347}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:43:58.895631", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.485960742892351, "overlap_percentage": 0.6540694230541405, "num_intersection": 5521, "num_union": 11361, "num_only_computed": 2920, "num_only_roped": 2920, "total_diff": 5840, "diff_percentage": 0.514039257107649, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:44:01.401404", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.8596649169921875e-05, "l2_diff": 0.0361328125, "l2_diff_relative": 0.18407960199004975}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:45:20.705296", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4951731467540519, "overlap_percentage": 0.6623622793507878, "num_intersection": 5591, "num_union": 11291, "num_only_computed": 2850, "num_only_roped": 2850, "total_diff": 5700, "diff_percentage": 0.5048268532459481, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:45:23.225379", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.03564453125, "l2_diff_relative": 0.20165745856353592}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:46:42.477357", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5032051282051282, "overlap_percentage": 0.6695095948827292, "num_intersection": 5652, "num_union": 11232, "num_only_computed": 2790, "num_only_roped": 2790, "total_diff": 5580, "diff_percentage": 0.4967948717948718, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:46:46.440951", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.0284423828125, "l2_diff_relative": 0.14709595959595959}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:47:32.568314", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:47:32.582004", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.769993782043457e-06, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.0031516335227272725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:47:38.432352", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7224023414239493, "overlap_percentage": 0.8388311186650186, "num_intersection": 1085783, "num_union": 1503017, "num_only_computed": 224937, "num_only_roped": 192297, "total_diff": 417234, "diff_percentage": 0.2775976585760507, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:47:40.164244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.743171691894531e-05, "l2_diff": 0.447265625, "l2_diff_relative": 0.06626157407407407}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:47:54.633459", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5726728079200657, "overlap_percentage": 0.7282796587262835, "num_intersection": 1336399, "num_union": 2333617, "num_only_computed": 498609, "num_only_roped": 498609, "total_diff": 997218, "diff_percentage": 0.4273271920799343, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:47:55.174563", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 5.125999450683594e-05, "l2_diff": 0.7109375, "l2_diff_relative": 0.11375}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:48:15.210201", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49280723594816006, "overlap_percentage": 0.6602422926161025, "num_intersection": 1557707, "num_union": 3160885, "num_only_computed": 801589, "num_only_roped": 801589, "total_diff": 1603178, "diff_percentage": 0.5071927640518399, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:48:15.931358", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0419921875, "mean_diff": 4.863739013671875e-05, "l2_diff": 0.859375, "l2_diff_relative": 0.13819095477386933}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:48:41.705271", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44476930835218675, "overlap_percentage": 0.6156959533691406, "num_intersection": 1775411, "num_union": 3991757, "num_only_computed": 1108173, "num_only_roped": 1108173, "total_diff": 2216346, "diff_percentage": 0.5552306916478132, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:48:42.592649", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06005859375, "mean_diff": 4.863739013671875e-05, "l2_diff": 1.109375, "l2_diff_relative": 0.1802030456852792}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:49:14.290030", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4245015102456772, "overlap_percentage": 0.5960000845102164, "num_intersection": 2031092, "num_union": 4784652, "num_only_computed": 1376780, "num_only_roped": 1376780, "total_diff": 2753560, "diff_percentage": 0.5754984897543228, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:49:16.137653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.00543212890625e-05, "l2_diff": 1.046875, "l2_diff_relative": 0.1717948717948718}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:49:55.517632", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4023222610135503, "overlap_percentage": 0.5737943013509115, "num_intersection": 2256251, "num_union": 5608069, "num_only_computed": 1675909, "num_only_roped": 1675909, "total_diff": 3351818, "diff_percentage": 0.5976777389864497, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:49:56.818511", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 3.600120544433594e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.19696969696969696}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:50:42.438176", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3918142626944608, "overlap_percentage": 0.563026652616613, "num_intersection": 2509099, "num_union": 6403797, "num_only_computed": 1947349, "num_only_roped": 1947349, "total_diff": 3894698, "diff_percentage": 0.6081857373055392, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:50:43.972123", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05859375, "mean_diff": 3.2901763916015625e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.2198492462311558}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:51:35.534832", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36900164228435567, "overlap_percentage": 0.5390813727127878, "num_intersection": 2685022, "num_union": 7276450, "num_only_computed": 2295714, "num_only_roped": 2295714, "total_diff": 4591428, "diff_percentage": 0.6309983577156443, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:51:40.007249", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.068359375, "mean_diff": 4.458427429199219e-05, "l2_diff": 1.375, "l2_diff_relative": 0.2268041237113402}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:52:37.661117", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3688146104719953, "overlap_percentage": 0.5388817560105097, "num_intersection": 2966557, "num_union": 8043491, "num_only_computed": 2538467, "num_only_roped": 2538467, "total_diff": 5076934, "diff_percentage": 0.6311853895280047, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:52:39.692214", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06201171875, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.234375, "l2_diff_relative": 0.20050761421319796}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:53:45.887748", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36997763818670154, "overlap_percentage": 0.5401221565578295, "num_intersection": 3256565, "num_union": 8802059, "num_only_computed": 2772747, "num_only_roped": 2772747, "total_diff": 5545494, "diff_percentage": 0.6300223618132984, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:53:48.192697", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04833984375, "mean_diff": 3.814697265625e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.16911764705882354}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:55:03.191454", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35903449159696715, "overlap_percentage": 0.5283670043945312, "num_intersection": 3462706, "num_union": 9644494, "num_only_computed": 3090894, "num_only_roped": 3090894, "total_diff": 6181788, "diff_percentage": 0.6409655084030329, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:55:07.877543", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.048583984375, "mean_diff": 3.4809112548828125e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.15595238095238095}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:56:31.125845", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3548738327954334, "overlap_percentage": 0.5238477918836806, "num_intersection": 3707736, "num_union": 10448040, "num_only_computed": 3370152, "num_only_roped": 3370152, "total_diff": 6740304, "diff_percentage": 0.6451261672045666, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:56:34.393413", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.15995260663507108}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:58:04.379376", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3540220934527904, "overlap_percentage": 0.5229192273370151, "num_intersection": 3975324, "num_union": 11229028, "num_only_computed": 3626852, "num_only_roped": 3626852, "total_diff": 7253704, "diff_percentage": 0.6459779065472097, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:58:07.400572", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.055908203125, "mean_diff": 3.147125244140625e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.1674641148325359}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:59:43.722464", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3482813795153897, "overlap_percentage": 0.5166301112021169, "num_intersection": 4198376, "num_union": 12054552, "num_only_computed": 3928088, "num_only_roped": 3928088, "total_diff": 7856176, "diff_percentage": 0.6517186204846103, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T17:59:48.410706", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 3.039836883544922e-05, "l2_diff": 1.0546875, "l2_diff_relative": 0.1622596153846154}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:01:31.874606", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.33906947100063733, "overlap_percentage": 0.5064255116611137, "num_intersection": 3983616, "num_union": 11748672, "num_only_computed": 3882528, "num_only_roped": 3882528, "total_diff": 7765056, "diff_percentage": 0.6609305289993627, "num_computed": 7866144, "num_roped": 7866144}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 936, "seq_len_k": 16296, "queries_shape": [1, 32, 936, 128], "keys_shape": [1, 8, 16296, 128], "mask_shape": [1, 32, 936, 16296], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:01:35.339837", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 2.9325485229492188e-05, "l2_diff": 0.90625, "l2_diff_relative": 0.14146341463414633}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 936, "seq_len_k": 16296, "queries_shape": [1, 32, 936, 128], "keys_shape": [1, 8, 16296, 128], "attention_shape": [1, 32, 936, 16296]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:03:20.559666", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43686325660098, "overlap_percentage": 0.6080790981243637, "num_intersection": 297420, "num_union": 680808, "num_only_computed": 191694, "num_only_roped": 191694, "total_diff": 383388, "diff_percentage": 0.56313674339902, "num_computed": 489114, "num_roped": 489114}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16354, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 58, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:03:23.795440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 2.4080276489257812e-05, "l2_diff": 0.29296875, "l2_diff_relative": 0.18292682926829268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16354, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 58, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:04:52.256162", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42389193752638243, "overlap_percentage": 0.5953990276295505, "num_intersection": 5021, "num_union": 11845, "num_only_computed": 3412, "num_only_roped": 3412, "total_diff": 6824, "diff_percentage": 0.5761080624736176, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:04:54.720284", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.052978515625, "l2_diff_relative": 0.22698744769874477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:06:11.660989", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3773168939332081, "overlap_percentage": 0.5479013516718046, "num_intersection": 4621, "num_union": 12247, "num_only_computed": 3813, "num_only_roped": 3813, "total_diff": 7626, "diff_percentage": 0.6226831060667919, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:06:14.145234", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 1.8358230590820312e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.10966257668711657}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:07:30.898908", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41036789297658866, "overlap_percentage": 0.5819302821911312, "num_intersection": 4908, "num_union": 11960, "num_only_computed": 3526, "num_only_roped": 3526, "total_diff": 7052, "diff_percentage": 0.5896321070234114, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:07:33.971239", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.0341796875, "l2_diff_relative": 0.15625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:08:52.096331", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4468267581475129, "overlap_percentage": 0.6176644931831654, "num_intersection": 5210, "num_union": 11660, "num_only_computed": 3225, "num_only_roped": 3225, "total_diff": 6450, "diff_percentage": 0.5531732418524872, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:08:55.689805", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.3365020751953125e-05, "l2_diff": 0.04052734375, "l2_diff_relative": 0.2292817679558011}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:10:15.316441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4063021007002334, "overlap_percentage": 0.5778304682868998, "num_intersection": 4874, "num_union": 11996, "num_only_computed": 3561, "num_only_roped": 3561, "total_diff": 7122, "diff_percentage": 0.5936978992997666, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:10:18.535796", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.2339572192513369}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:11:38.732974", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4647104783401337, "overlap_percentage": 0.6345424371740161, "num_intersection": 5353, "num_union": 11519, "num_only_computed": 3083, "num_only_roped": 3083, "total_diff": 6166, "diff_percentage": 0.5352895216598663, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:11:41.265072", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 1.9550323486328125e-05, "l2_diff": 0.041015625, "l2_diff_relative": 0.2028985507246377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:13:01.249648", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4161490683229814, "overlap_percentage": 0.5877192982456141, "num_intersection": 4958, "num_union": 11914, "num_only_computed": 3478, "num_only_roped": 3478, "total_diff": 6956, "diff_percentage": 0.5838509316770186, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:13:03.766557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0224609375, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.2560386473429952}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:14:24.022891", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4500300764801925, "overlap_percentage": 0.6207182647860614, "num_intersection": 5237, "num_union": 11637, "num_only_computed": 3200, "num_only_roped": 3200, "total_diff": 6400, "diff_percentage": 0.5499699235198076, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:14:26.540915", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.019287109375, "mean_diff": 2.8133392333984375e-05, "l2_diff": 0.054931640625, "l2_diff_relative": 0.3073770491803279}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:15:45.530617", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47396925227113906, "overlap_percentage": 0.6431195922721347, "num_intersection": 5426, "num_union": 11448, "num_only_computed": 3011, "num_only_roped": 3011, "total_diff": 6022, "diff_percentage": 0.5260307477288609, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:15:48.069165", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01611328125, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.0311279296875, "l2_diff_relative": 0.19086826347305388}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:17:07.501258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41719852200201546, "overlap_percentage": 0.5887651102156909, "num_intersection": 4968, "num_union": 11908, "num_only_computed": 3470, "num_only_roped": 3470, "total_diff": 6940, "diff_percentage": 0.5828014779979845, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:17:10.000058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0390625, "mean_diff": 1.919269561767578e-05, "l2_diff": 0.0478515625, "l2_diff_relative": 0.19367588932806323}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:18:29.515633", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38737257481091747, "overlap_percentage": 0.5584261673382318, "num_intersection": 4712, "num_union": 12164, "num_only_computed": 3726, "num_only_roped": 3726, "total_diff": 7452, "diff_percentage": 0.6126274251890825, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:18:33.583345", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.7881393432617188e-05, "l2_diff": 0.0390625, "l2_diff_relative": 0.14814814814814814}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:19:51.391588", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4508725178371873, "overlap_percentage": 0.6215191373385472, "num_intersection": 5245, "num_union": 11633, "num_only_computed": 3194, "num_only_roped": 3194, "total_diff": 6388, "diff_percentage": 0.5491274821628127, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:19:54.363554", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01318359375, "mean_diff": 1.621246337890625e-05, "l2_diff": 0.027099609375, "l2_diff_relative": 0.1483957219251337}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:21:12.448254", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47174747122427624, "overlap_percentage": 0.6410712169688352, "num_intersection": 5410, "num_union": 11468, "num_only_computed": 3029, "num_only_roped": 3029, "total_diff": 6058, "diff_percentage": 0.5282525287757237, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:21:14.920787", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.033935546875, "l2_diff_relative": 0.18783783783783783}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:22:33.703492", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4725639012474919, "overlap_percentage": 0.6418246445497631, "num_intersection": 5417, "num_union": 11463, "num_only_computed": 3023, "num_only_roped": 3023, "total_diff": 6046, "diff_percentage": 0.5274360987525081, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:22:36.191793", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 2.0742416381835938e-05, "l2_diff": 0.031494140625, "l2_diff_relative": 0.16973684210526316}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:23:53.766483", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5101091429593845, "overlap_percentage": 0.6755924170616113, "num_intersection": 5702, "num_union": 11178, "num_only_computed": 2738, "num_only_roped": 2738, "total_diff": 5476, "diff_percentage": 0.48989085704061547, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:23:56.206864", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0146484375, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.028076171875, "l2_diff_relative": 0.1537433155080214}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:24:41.307845", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:24:41.321529", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.025146484375, "l2_diff_relative": 0.0030713263358778625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:24:47.113619", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7195753137852975, "overlap_percentage": 0.8369221260815822, "num_intersection": 1083312, "num_union": 1505488, "num_only_computed": 227408, "num_only_roped": 194768, "total_diff": 422176, "diff_percentage": 0.28042468621470246, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:24:49.977338", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 3.528594970703125e-05, "l2_diff": 0.416015625, "l2_diff_relative": 0.06279481132075472}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:25:04.405140", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5711054840760378, "overlap_percentage": 0.727010999407087, "num_intersection": 1334071, "num_union": 2335945, "num_only_computed": 500937, "num_only_roped": 500937, "total_diff": 1001874, "diff_percentage": 0.42889451592396227, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:25:04.930671", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03466796875, "mean_diff": 5.269050598144531e-05, "l2_diff": 0.72265625, "l2_diff_relative": 0.11981865284974093}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:25:24.833250", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4929952251029667, "overlap_percentage": 0.6604109870062934, "num_intersection": 1558105, "num_union": 3160487, "num_only_computed": 801191, "num_only_roped": 801191, "total_diff": 1602382, "diff_percentage": 0.5070047748970333, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:25:25.550808", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04296875, "mean_diff": 5.340576171875e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.16923076923076924}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:25:51.192671", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44538088072684473, "overlap_percentage": 0.6162816827947443, "num_intersection": 1777100, "num_union": 3990068, "num_only_computed": 1106484, "num_only_roped": 1106484, "total_diff": 2212968, "diff_percentage": 0.5546191192731552, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:25:52.093386", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.696846008300781e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.17010309278350516}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:26:23.448715", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4231463740977631, "overlap_percentage": 0.5946631798377404, "num_intersection": 2026536, "num_union": 4789208, "num_only_computed": 1381336, "num_only_roped": 1381336, "total_diff": 2762672, "diff_percentage": 0.5768536259022369, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:26:24.540063", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03515625, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.16623711340206185}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:27:03.875961", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4081423268855788, "overlap_percentage": 0.5796890258789062, "num_intersection": 2279430, "num_union": 5584890, "num_only_computed": 1652730, "num_only_roped": 1652730, "total_diff": 3305460, "diff_percentage": 0.5918576731144213, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:27:05.144555", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04248046875, "mean_diff": 3.5762786865234375e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.17783505154639176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:27:48.508480", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3850946966400533, "overlap_percentage": 0.5560554055606618, "num_intersection": 2478032, "num_union": 6434864, "num_only_computed": 1978416, "num_only_roped": 1978416, "total_diff": 3956832, "diff_percentage": 0.6149053033599466, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:27:52.132026", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0517578125, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.2075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:28:43.810854", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3745567674981368, "overlap_percentage": 0.5449855202122739, "num_intersection": 2714429, "num_union": 7247043, "num_only_computed": 2266307, "num_only_roped": 2266307, "total_diff": 4532614, "diff_percentage": 0.6254432325018632, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:28:47.911652", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.054931640625, "mean_diff": 4.38690185546875e-05, "l2_diff": 1.25, "l2_diff_relative": 0.20512820512820512}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:29:45.493773", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3702210327389305, "overlap_percentage": 0.5403814769926525, "num_intersection": 2974813, "num_union": 8035235, "num_only_computed": 2530211, "num_only_roped": 2530211, "total_diff": 5060422, "diff_percentage": 0.6297789672610695, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:29:47.486260", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06103515625, "mean_diff": 4.124641418457031e-05, "l2_diff": 1.296875, "l2_diff_relative": 0.2075}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:30:52.896023", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36618193773895336, "overlap_percentage": 0.536066138226053, "num_intersection": 3232110, "num_union": 8826514, "num_only_computed": 2797202, "num_only_roped": 2797202, "total_diff": 5594404, "diff_percentage": 0.6338180622610466, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:30:56.719215", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05908203125, "mean_diff": 3.8623809814453125e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.18625}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:32:09.048468", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34736080336716846, "overlap_percentage": 0.5156166076660156, "num_intersection": 3379145, "num_union": 9728055, "num_only_computed": 3174455, "num_only_roped": 3174455, "total_diff": 6348910, "diff_percentage": 0.6526391966328315, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:32:11.553440", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0703125, "mean_diff": 3.695487976074219e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.1922110552763819}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:33:31.739822", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34961850459598326, "overlap_percentage": 0.5180997495298032, "num_intersection": 3667052, "num_union": 10488724, "num_only_computed": 3410836, "num_only_roped": 3410836, "total_diff": 6821672, "diff_percentage": 0.6503814954040167, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:33:34.524595", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.361701965332031e-05, "l2_diff": 1.09375, "l2_diff_relative": 0.17412935323383086}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:35:05.885662", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3499504923067744, "overlap_percentage": 0.5184641870959051, "num_intersection": 3941456, "num_union": 11262896, "num_only_computed": 3660720, "num_only_roped": 3660720, "total_diff": 7321440, "diff_percentage": 0.6500495076932257, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:35:08.989679", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.052734375, "mean_diff": 3.075599670410156e-05, "l2_diff": 1.0703125, "l2_diff_relative": 0.17297979797979798}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:36:47.326664", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34948067638566077, "overlap_percentage": 0.5179483967442666, "num_intersection": 4209089, "num_union": 12043839, "num_only_computed": 3917375, "num_only_roped": 3917375, "total_diff": 7834750, "diff_percentage": 0.6505193236143393, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:36:50.665423", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.046875, "mean_diff": 3.0159950256347656e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1620603015075377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:38:37.090744", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3438744219842348, "overlap_percentage": 0.5117657072102066, "num_intersection": 4016543, "num_union": 11680261, "num_only_computed": 3831859, "num_only_roped": 3831859, "total_diff": 7663718, "diff_percentage": 0.6561255780157652, "num_computed": 7848402, "num_roped": 7848402}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 934, "seq_len_k": 16294, "queries_shape": [1, 32, 934, 128], "keys_shape": [1, 8, 16294, 128], "mask_shape": [1, 32, 934, 16294], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:38:40.641244", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05322265625, "mean_diff": 2.956390380859375e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.14668367346938777}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 934, "seq_len_k": 16294, "queries_shape": [1, 32, 934, 128], "keys_shape": [1, 8, 16294, 128], "attention_shape": [1, 32, 934, 16294]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:40:24.192078", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44124221442580147, "overlap_percentage": 0.612308201923706, "num_intersection": 299453, "num_union": 678659, "num_only_computed": 189603, "num_only_roped": 189603, "total_diff": 379206, "diff_percentage": 0.5587577855741985, "num_computed": 489056, "num_roped": 489056}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16352, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16352, 128], "mask_shape": [1, 32, 58, 16352], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:40:27.625050", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.31640625, "l2_diff_relative": 0.1966019417475728}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16352, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16352, 128], "attention_shape": [1, 32, 58, 16352]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:41:56.216021", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43389167587790156, "overlap_percentage": 0.6051944971537002, "num_intersection": 5103, "num_union": 11761, "num_only_computed": 3329, "num_only_roped": 3329, "total_diff": 6658, "diff_percentage": 0.5661083241220984, "num_computed": 8432, "num_roped": 8432}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "mask_shape": [1, 32, 1, 16353], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:41:58.681357", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03857421875, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.050537109375, "l2_diff_relative": 0.25875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16353, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16353, 128], "attention_shape": [1, 32, 1, 16353]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:43:15.701065", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4764947912107152, "overlap_percentage": 0.6454405312462943, "num_intersection": 5443, "num_union": 11423, "num_only_computed": 2990, "num_only_roped": 2990, "total_diff": 5980, "diff_percentage": 0.5235052087892847, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "mask_shape": [1, 32, 1, 16354], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:43:18.113783", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02880859375, "mean_diff": 2.5391578674316406e-05, "l2_diff": 0.045654296875, "l2_diff_relative": 0.2641242937853107}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16354, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16354, 128], "attention_shape": [1, 32, 1, 16354]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:44:36.176758", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4992, "overlap_percentage": 0.6659551760939167, "num_intersection": 5616, "num_union": 11250, "num_only_computed": 2817, "num_only_roped": 2817, "total_diff": 5634, "diff_percentage": 0.5008, "num_computed": 8433, "num_roped": 8433}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "mask_shape": [1, 32, 1, 16355], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:44:39.820901", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 2.562999725341797e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.25483870967741934}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16355, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16355, 128], "attention_shape": [1, 32, 1, 16355]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:45:59.310171", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4308253456612096, "overlap_percentage": 0.6022053592601375, "num_intersection": 5079, "num_union": 11789, "num_only_computed": 3355, "num_only_roped": 3355, "total_diff": 6710, "diff_percentage": 0.5691746543387904, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 1, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:46:02.699557", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.022216796875, "mean_diff": 2.6226043701171875e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.2840909090909091}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16356, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 1, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:47:22.509750", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.47666987656482535, "overlap_percentage": 0.6456011382499407, "num_intersection": 5445, "num_union": 11423, "num_only_computed": 2989, "num_only_roped": 2989, "total_diff": 5978, "diff_percentage": 0.5233301234351746, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:47:25.699150", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04150390625, "mean_diff": 2.8967857360839844e-05, "l2_diff": 0.0703125, "l2_diff_relative": 0.43902439024390244}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:48:45.709470", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48320731492878494, "overlap_percentage": 0.651570835803201, "num_intersection": 5496, "num_union": 11374, "num_only_computed": 2939, "num_only_roped": 2939, "total_diff": 5878, "diff_percentage": 0.516792685071215, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:48:49.344301", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.2423780487804878}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:50:09.030444", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41669465905273767, "overlap_percentage": 0.5882631890930646, "num_intersection": 4962, "num_union": 11908, "num_only_computed": 3473, "num_only_roped": 3473, "total_diff": 6946, "diff_percentage": 0.5833053409472624, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:50:11.515923", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 2.765655517578125e-05, "l2_diff": 0.055419921875, "l2_diff_relative": 0.30842391304347827}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:51:30.341561", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4563659905049633, "overlap_percentage": 0.6267188240872451, "num_intersection": 5287, "num_union": 11585, "num_only_computed": 3149, "num_only_roped": 3149, "total_diff": 6298, "diff_percentage": 0.5436340094950367, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:51:32.799840", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.033935546875, "mean_diff": 3.361701965332031e-05, "l2_diff": 0.06689453125, "l2_diff_relative": 0.45364238410596025}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:52:50.045532", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43262290906003226, "overlap_percentage": 0.603959222380275, "num_intersection": 5095, "num_union": 11777, "num_only_computed": 3341, "num_only_roped": 3341, "total_diff": 6682, "diff_percentage": 0.5673770909399677, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:52:52.481629", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03076171875, "mean_diff": 2.09808349609375e-05, "l2_diff": 0.05078125, "l2_diff_relative": 0.22413793103448276}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:54:10.046571", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4314557176789956, "overlap_percentage": 0.6028209079056537, "num_intersection": 5086, "num_union": 11788, "num_only_computed": 3351, "num_only_roped": 3351, "total_diff": 6702, "diff_percentage": 0.5685442823210044, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:54:13.313490", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02294921875, "mean_diff": 2.2292137145996094e-05, "l2_diff": 0.04736328125, "l2_diff_relative": 0.23658536585365852}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:55:33.411907", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4374307862679956, "overlap_percentage": 0.6086286594761171, "num_intersection": 5135, "num_union": 11739, "num_only_computed": 3302, "num_only_roped": 3302, "total_diff": 6604, "diff_percentage": 0.5625692137320044, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:55:36.792717", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02197265625, "mean_diff": 2.288818359375e-05, "l2_diff": 0.048828125, "l2_diff_relative": 0.23148148148148148}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:56:58.418322", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.48243148278285314, "overlap_percentage": 0.6508651339179901, "num_intersection": 5492, "num_union": 11384, "num_only_computed": 2946, "num_only_roped": 2946, "total_diff": 5892, "diff_percentage": 0.5175685172171469, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:57:01.394771", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01171875, "mean_diff": 1.8477439880371094e-05, "l2_diff": 0.028076171875, "l2_diff_relative": 0.1969178082191781}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:58:23.658086", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4401775046936337, "overlap_percentage": 0.6112822943825551, "num_intersection": 5158, "num_union": 11718, "num_only_computed": 3280, "num_only_roped": 3280, "total_diff": 6560, "diff_percentage": 0.5598224953063663, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:58:28.635622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02783203125, "mean_diff": 2.0503997802734375e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.19954128440366972}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:59:48.179157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3954526663910707, "overlap_percentage": 0.566773314373741, "num_intersection": 4783, "num_union": 12095, "num_only_computed": 3656, "num_only_roped": 3656, "total_diff": 7312, "diff_percentage": 0.6045473336089293, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T18:59:52.306131", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.03466796875, "l2_diff_relative": 0.14730290456431536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:01:09.899268", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4440451745379877, "overlap_percentage": 0.6150017774617845, "num_intersection": 5190, "num_union": 11688, "num_only_computed": 3249, "num_only_roped": 3249, "total_diff": 6498, "diff_percentage": 0.5559548254620124, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:01:12.833051", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.163135593220339}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:02:31.998109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5185318459877654, "overlap_percentage": 0.6829383886255924, "num_intersection": 5764, "num_union": 11116, "num_only_computed": 2676, "num_only_roped": 2676, "total_diff": 5352, "diff_percentage": 0.48146815401223464, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:02:34.459584", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01708984375, "mean_diff": 2.086162567138672e-05, "l2_diff": 0.0279541015625, "l2_diff_relative": 0.14604591836734693}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:03:22.514094", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:03:22.527743", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.0260009765625, "l2_diff_relative": 0.0031516335227272725}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:03:28.304198", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.720041459590188, "overlap_percentage": 0.8372373300370828, "num_intersection": 1083720, "num_union": 1505080, "num_only_computed": 227000, "num_only_roped": 194360, "total_diff": 421360, "diff_percentage": 0.2799585404098121, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:03:28.681731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 3.647804260253906e-05, "l2_diff": 0.427734375, "l2_diff_relative": 0.06456367924528301}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:03:43.779297", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5720968167534243, "overlap_percentage": 0.727813720703125, "num_intersection": 1335544, "num_union": 2334472, "num_only_computed": 499464, "num_only_roped": 499464, "total_diff": 998928, "diff_percentage": 0.42790318324657567, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:03:44.315683", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 5.245208740234375e-05, "l2_diff": 0.71875, "l2_diff_relative": 0.11794871794871795}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:04:04.285939", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49085410356818554, "overlap_percentage": 0.6584871080186632, "num_intersection": 1553566, "num_union": 3165026, "num_only_computed": 805730, "num_only_roped": 805730, "total_diff": 1611460, "diff_percentage": 0.5091458964318145, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:04:05.001585", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 5.054473876953125e-05, "l2_diff": 0.88671875, "l2_diff_relative": 0.14258793969849246}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:04:31.058273", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44809046949707754, "overlap_percentage": 0.6188708218661222, "num_intersection": 1784566, "num_union": 3982602, "num_only_computed": 1099018, "num_only_roped": 1099018, "total_diff": 2198036, "diff_percentage": 0.5519095305029225, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:04:32.233038", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0400390625, "mean_diff": 4.5299530029296875e-05, "l2_diff": 0.98046875, "l2_diff_relative": 0.15609452736318408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:05:03.886279", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.424016089311894, "overlap_percentage": 0.595521486722506, "num_intersection": 2029461, "num_union": 4786283, "num_only_computed": 1378411, "num_only_roped": 1378411, "total_diff": 2756822, "diff_percentage": 0.575983910688106, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:05:04.984551", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.1620603015075377}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:05:42.230858", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4052135877052388, "overlap_percentage": 0.5767288208007812, "num_intersection": 2267790, "num_union": 5596530, "num_only_computed": 1664370, "num_only_roped": 1664370, "total_diff": 3328740, "diff_percentage": 0.5947864122947613, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:05:43.526700", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0498046875, "mean_diff": 3.6716461181640625e-05, "l2_diff": 1.21875, "l2_diff_relative": 0.1989795918367347}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:06:26.932379", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3802834438078861, "overlap_percentage": 0.5510222491096047, "num_intersection": 2455602, "num_union": 6457294, "num_only_computed": 2000846, "num_only_roped": 2000846, "total_diff": 4001692, "diff_percentage": 0.619716556192114, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:06:28.415117", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0478515625, "mean_diff": 3.2901763916015625e-05, "l2_diff": 1.1953125, "l2_diff_relative": 0.19416243654822335}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:07:18.693735", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37242154449557047, "overlap_percentage": 0.5427217985454359, "num_intersection": 2703154, "num_union": 7258318, "num_only_computed": 2277582, "num_only_roped": 2277582, "total_diff": 4555164, "diff_percentage": 0.6275784555044296, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:07:20.415132", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 4.3392181396484375e-05, "l2_diff": 1.3671875, "l2_diff_relative": 0.21875}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:08:18.224925", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.364130753283099, "overlap_percentage": 0.5338648841494605, "num_intersection": 2938939, "num_union": 8071109, "num_only_computed": 2566085, "num_only_roped": 2566085, "total_diff": 5132170, "diff_percentage": 0.635869246716901, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:08:20.226181", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.08056640625, "mean_diff": 4.1961669921875e-05, "l2_diff": 1.359375, "l2_diff_relative": 0.22081218274111675}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:09:24.946225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3535098911220609, "overlap_percentage": 0.522360262663468, "num_intersection": 3149473, "num_union": 8909151, "num_only_computed": 2879839, "num_only_roped": 2879839, "total_diff": 5759678, "diff_percentage": 0.6464901088779391, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:09:27.151074", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05126953125, "mean_diff": 4.029273986816406e-05, "l2_diff": 1.2578125, "l2_diff_relative": 0.20431472081218274}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:10:40.999625", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3506094394278375, "overlap_percentage": 0.51918701171875, "num_intersection": 3402544, "num_union": 9704656, "num_only_computed": 3151056, "num_only_roped": 3151056, "total_diff": 6302112, "diff_percentage": 0.6493905605721625, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:10:43.564844", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04931640625, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.17034313725490197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:12:05.357139", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35267199468860483, "overlap_percentage": 0.5214449564615885, "num_intersection": 3690729, "num_union": 10465047, "num_only_computed": 3387159, "num_only_roped": 3387159, "total_diff": 6774318, "diff_percentage": 0.6473280053113951, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:12:08.199934", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 3.314018249511719e-05, "l2_diff": 1.0390625, "l2_diff_relative": 0.16219512195121952}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:13:39.861557", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35071838093800617, "overlap_percentage": 0.5193064459438982, "num_intersection": 3947859, "num_union": 11256493, "num_only_computed": 3654317, "num_only_roped": 3654317, "total_diff": 7308634, "diff_percentage": 0.6492816190619938, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:13:42.957772", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05224609375, "mean_diff": 3.0994415283203125e-05, "l2_diff": 1.0859375, "l2_diff_relative": 0.17034313725490197}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:15:21.447879", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3469396414553941, "overlap_percentage": 0.5151524697580645, "num_intersection": 4186368, "num_union": 12066560, "num_only_computed": 3940096, "num_only_roped": 3940096, "total_diff": 7880192, "diff_percentage": 0.6530603585446059, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:15:24.746477", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 3.0159950256347656e-05, "l2_diff": 1.03125, "l2_diff_relative": 0.16176470588235295}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:17:11.387190", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34592532863990644, "overlap_percentage": 0.5140334627471098, "num_intersection": 4075155, "num_union": 11780447, "num_only_computed": 3852646, "num_only_roped": 3852646, "total_diff": 7705292, "diff_percentage": 0.6540746713600936, "num_computed": 7927801, "num_roped": 7927801}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 943, "seq_len_k": 16303, "queries_shape": [1, 32, 943, 128], "keys_shape": [1, 8, 16303, 128], "mask_shape": [1, 32, 943, 16303], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:17:15.172426", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0537109375, "mean_diff": 2.7179718017578125e-05, "l2_diff": 0.96484375, "l2_diff_relative": 0.15360696517412936}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 943, "seq_len_k": 16303, "queries_shape": [1, 32, 943, 128], "keys_shape": [1, 8, 16303, 128], "attention_shape": [1, 32, 943, 16303]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:19:03.403010", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4340400151819118, "overlap_percentage": 0.6053387779794314, "num_intersection": 296185, "num_union": 682391, "num_only_computed": 193103, "num_only_roped": 193103, "total_diff": 386206, "diff_percentage": 0.5659599848180882, "num_computed": 489288, "num_roped": 489288}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16361, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 58, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:19:06.738969", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0380859375, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.296875, "l2_diff_relative": 0.18095238095238095}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16361, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 58, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:20:36.731157", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41004428845993146, "overlap_percentage": 0.581604835842124, "num_intersection": 4907, "num_union": 11967, "num_only_computed": 3530, "num_only_roped": 3530, "total_diff": 7060, "diff_percentage": 0.5899557115400685, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:20:40.104791", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02978515625, "mean_diff": 2.6702880859375e-05, "l2_diff": 0.0498046875, "l2_diff_relative": 0.2802197802197802}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:21:56.871218", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46399444733645673, "overlap_percentage": 0.6338745999762949, "num_intersection": 5348, "num_union": 11526, "num_only_computed": 3089, "num_only_roped": 3089, "total_diff": 6178, "diff_percentage": 0.5360055526635433, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:21:59.345478", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 2.586841583251953e-05, "l2_diff": 0.03369140625, "l2_diff_relative": 0.24295774647887325}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:23:16.454133", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46747826086956523, "overlap_percentage": 0.6371178004266413, "num_intersection": 5376, "num_union": 11500, "num_only_computed": 3062, "num_only_roped": 3062, "total_diff": 6124, "diff_percentage": 0.5325217391304348, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:23:18.905620", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02392578125, "mean_diff": 2.8252601623535156e-05, "l2_diff": 0.04248046875, "l2_diff_relative": 0.2806451612903226}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:24:35.909343", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40680226742247416, "overlap_percentage": 0.5783360986015643, "num_intersection": 4880, "num_union": 11996, "num_only_computed": 3558, "num_only_roped": 3558, "total_diff": 7116, "diff_percentage": 0.5931977325775258, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:24:38.684145", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.968311309814453e-05, "l2_diff": 0.0517578125, "l2_diff_relative": 0.3706293706293706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:25:55.973315", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3929190393661797, "overlap_percentage": 0.5641663704230359, "num_intersection": 4761, "num_union": 12117, "num_only_computed": 3678, "num_only_roped": 3678, "total_diff": 7356, "diff_percentage": 0.6070809606338202, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:25:59.241547", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.4318695068359375e-05, "l2_diff": 0.03857421875, "l2_diff_relative": 0.18899521531100477}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:27:16.851278", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44639643499871456, "overlap_percentage": 0.6172532290555753, "num_intersection": 5209, "num_union": 11669, "num_only_computed": 3230, "num_only_roped": 3230, "total_diff": 6460, "diff_percentage": 0.5536035650012855, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:27:19.502869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 2.2172927856445312e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.22361111111111112}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:28:37.903224", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4390451832907076, "overlap_percentage": 0.6101895734597157, "num_intersection": 5150, "num_union": 11730, "num_only_computed": 3290, "num_only_roped": 3290, "total_diff": 6580, "diff_percentage": 0.5609548167092924, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:28:40.365032", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01953125, "mean_diff": 2.5272369384765625e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.2700617283950617}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:29:57.754194", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4470638662666095, "overlap_percentage": 0.6178909952606635, "num_intersection": 5215, "num_union": 11665, "num_only_computed": 3225, "num_only_roped": 3225, "total_diff": 6450, "diff_percentage": 0.5529361337333905, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:30:00.645823", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0283203125, "mean_diff": 2.372264862060547e-05, "l2_diff": 0.052734375, "l2_diff_relative": 0.25961538461538464}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:31:17.809638", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42934552535771736, "overlap_percentage": 0.6007582040042649, "num_intersection": 5071, "num_union": 11811, "num_only_computed": 3370, "num_only_roped": 3370, "total_diff": 6740, "diff_percentage": 0.5706544746422826, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:31:20.825907", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03466796875, "mean_diff": 2.3126602172851562e-05, "l2_diff": 0.052001953125, "l2_diff_relative": 0.24204545454545454}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:32:39.055691", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4782837127845884, "overlap_percentage": 0.6470797298898234, "num_intersection": 5462, "num_union": 11420, "num_only_computed": 2979, "num_only_roped": 2979, "total_diff": 5958, "diff_percentage": 0.5217162872154115, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:32:41.497104", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.014404296875, "mean_diff": 2.1219253540039062e-05, "l2_diff": 0.033203125, "l2_diff_relative": 0.23776223776223776}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:34:00.557527", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.41787033926771916, "overlap_percentage": 0.5894337834636342, "num_intersection": 4976, "num_union": 11908, "num_only_computed": 3466, "num_only_roped": 3466, "total_diff": 6932, "diff_percentage": 0.5821296607322808, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:34:03.026193", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0205078125, "mean_diff": 1.633167266845703e-05, "l2_diff": 0.033447265625, "l2_diff_relative": 0.18513513513513513}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:35:20.817441", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.38643455411397604, "overlap_percentage": 0.5574508410329306, "num_intersection": 4706, "num_union": 12178, "num_only_computed": 3736, "num_only_roped": 3736, "total_diff": 7472, "diff_percentage": 0.613565445886024, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "mask_shape": [1, 32, 1, 16373], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:35:23.266931", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.7404556274414062e-05, "l2_diff": 0.029296875, "l2_diff_relative": 0.1214574898785425}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16373, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16373, 128], "attention_shape": [1, 32, 1, 16373]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:36:42.936692", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40564388579039373, "overlap_percentage": 0.5771645149828261, "num_intersection": 4873, "num_union": 12013, "num_only_computed": 3570, "num_only_roped": 3570, "total_diff": 7140, "diff_percentage": 0.5943561142096062, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "mask_shape": [1, 32, 1, 16374], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:36:47.874194", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.6450881958007812e-05, "l2_diff": 0.03125, "l2_diff_relative": 0.13675213675213677}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16374, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16374, 128], "attention_shape": [1, 32, 1, 16374]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:38:07.494429", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4431245192718571, "overlap_percentage": 0.6141182044297051, "num_intersection": 5185, "num_union": 11701, "num_only_computed": 3258, "num_only_roped": 3258, "total_diff": 6516, "diff_percentage": 0.5568754807281429, "num_computed": 8443, "num_roped": 8443}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "mask_shape": [1, 32, 1, 16375], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:38:12.272283", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01904296875, "mean_diff": 1.8715858459472656e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.19751381215469613}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16375, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16375, 128], "attention_shape": [1, 32, 1, 16375]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:39:31.965124", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4334946099651982, "overlap_percentage": 0.6048081477972524, "num_intersection": 5107, "num_union": 11781, "num_only_computed": 3337, "num_only_roped": 3337, "total_diff": 6674, "diff_percentage": 0.5665053900348018, "num_computed": 8444, "num_roped": 8444}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16376, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16376, 128], "mask_shape": [1, 32, 1, 16376], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:39:36.079414", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.043212890625, "l2_diff_relative": 0.22348484848484848}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16376, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16376, 128], "attention_shape": [1, 32, 1, 16376]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:40:56.121389", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4534813667269128, "overlap_percentage": 0.6239933680720038, "num_intersection": 5269, "num_union": 11619, "num_only_computed": 3175, "num_only_roped": 3175, "total_diff": 6350, "diff_percentage": 0.5465186332730871, "num_computed": 8444, "num_roped": 8444}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16377, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16377, 128], "mask_shape": [1, 32, 1, 16377], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:40:59.993567", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.025390625, "mean_diff": 2.2649765014648438e-05, "l2_diff": 0.0439453125, "l2_diff_relative": 0.19911504424778761}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16377, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16377, 128], "attention_shape": [1, 32, 1, 16377]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:42:17.426957", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5147982062780269, "overlap_percentage": 0.679692125518058, "num_intersection": 5740, "num_union": 11150, "num_only_computed": 2705, "num_only_roped": 2705, "total_diff": 5410, "diff_percentage": 0.4852017937219731, "num_computed": 8445, "num_roped": 8445}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16378, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16378, 128], "mask_shape": [1, 32, 1, 16378], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:42:21.090714", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01416015625, "mean_diff": 1.823902130126953e-05, "l2_diff": 0.0263671875, "l2_diff_relative": 0.15789473684210525}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16378, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16378, 128], "attention_shape": [1, 32, 1, 16378]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:43:08.673792", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 1.0, "overlap_percentage": 1.0, "num_intersection": 1048576, "num_union": 1048576, "num_only_computed": 0, "num_only_roped": 0, "total_diff": 0, "diff_percentage": 0.0, "num_computed": 1048576, "num_roped": 1048576}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "mask_shape": [1, 32, 1024, 1024], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:43:08.687417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.001953125, "mean_diff": 3.7550926208496094e-06, "l2_diff": 0.02587890625, "l2_diff_relative": 0.003113251879699248}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 1024, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 1024, 128], "attention_shape": [1, 32, 1024, 1024]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:43:14.501693", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.7174591317304688, "overlap_percentage": 0.8354890296662546, "num_intersection": 1081457, "num_union": 1507343, "num_only_computed": 229263, "num_only_roped": 196623, "total_diff": 425886, "diff_percentage": 0.28254086826953123, "num_computed": 1310720, "num_roped": 1278080}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "mask_shape": [1, 32, 1024, 2048], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:43:14.879029", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 4.029273986816406e-05, "l2_diff": 0.474609375, "l2_diff_relative": 0.0703125}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 2048, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 2048, 128], "attention_shape": [1, 32, 1024, 2048]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:43:29.290946", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.5682877363852279, "overlap_percentage": 0.7247238159179688, "num_intersection": 1329874, "num_union": 2340142, "num_only_computed": 505134, "num_only_roped": 505134, "total_diff": 1010268, "diff_percentage": 0.4317122636147721, "num_computed": 1835008, "num_roped": 1835008}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "mask_shape": [1, 32, 1024, 3072], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:43:32.555978", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.04638671875, "mean_diff": 5.507469177246094e-05, "l2_diff": 0.76953125, "l2_diff_relative": 0.11896135265700483}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 3072, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 3072, 128], "attention_shape": [1, 32, 1024, 3072]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:43:52.446660", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.49070574070850503, "overlap_percentage": 0.6583535936143663, "num_intersection": 1553251, "num_union": 3165341, "num_only_computed": 806045, "num_only_roped": 806045, "total_diff": 1612090, "diff_percentage": 0.509294259291495, "num_computed": 2359296, "num_roped": 2359296}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "mask_shape": [1, 32, 1024, 4096], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:43:53.163731", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0341796875, "mean_diff": 5.1021575927734375e-05, "l2_diff": 0.8984375, "l2_diff_relative": 0.1416256157635468}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 4096, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 4096, 128], "attention_shape": [1, 32, 1024, 4096]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:44:18.743401", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4447953683720033, "overlap_percentage": 0.6157209222966974, "num_intersection": 1775483, "num_union": 3991685, "num_only_computed": 1108101, "num_only_roped": 1108101, "total_diff": 2216202, "diff_percentage": 0.5552046316279967, "num_computed": 2883584, "num_roped": 2883584}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "mask_shape": [1, 32, 1024, 5120], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:44:19.625188", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.041015625, "mean_diff": 4.601478576660156e-05, "l2_diff": 1.0078125, "l2_diff_relative": 0.15965346534653466}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 5120, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 5120, 128], "attention_shape": [1, 32, 1024, 5120]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:44:51.003098", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4259722908280971, "overlap_percentage": 0.5974482022798978, "num_intersection": 2036027, "num_union": 4779717, "num_only_computed": 1371845, "num_only_roped": 1371845, "total_diff": 2743690, "diff_percentage": 0.5740277091719028, "num_computed": 3407872, "num_roped": 3407872}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "mask_shape": [1, 32, 1024, 6144], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:44:52.097747", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0361328125, "mean_diff": 3.814697265625e-05, "l2_diff": 0.98828125, "l2_diff_relative": 0.15733830845771143}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 6144, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 6144, 128], "attention_shape": [1, 32, 1024, 6144]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:45:29.853385", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.40181908214532336, "overlap_percentage": 0.5732823689778646, "num_intersection": 2254238, "num_union": 5610082, "num_only_computed": 1677922, "num_only_roped": 1677922, "total_diff": 3355844, "diff_percentage": 0.5981809178546766, "num_computed": 3932160, "num_roped": 3932160}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "mask_shape": [1, 32, 1024, 7168], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:45:31.145622", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 3.504753112792969e-05, "l2_diff": 1.1640625, "l2_diff_relative": 0.191025641025641}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 7168, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 7168, 128], "attention_shape": [1, 32, 1024, 7168]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:46:15.824723", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3742118195004983, "overlap_percentage": 0.5446202895220589, "num_intersection": 2427072, "num_union": 6485824, "num_only_computed": 2029376, "num_only_roped": 2029376, "total_diff": 4058752, "diff_percentage": 0.6257881804995017, "num_computed": 4456448, "num_roped": 4456448}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "mask_shape": [1, 32, 1024, 8192], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:46:17.366939", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0576171875, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.3515625, "l2_diff_relative": 0.22763157894736843}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 8192, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 8192, 128], "attention_shape": [1, 32, 1024, 8192]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:47:10.467159", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36881465525533413, "overlap_percentage": 0.5388818038137335, "num_intersection": 2684028, "num_union": 7277444, "num_only_computed": 2296708, "num_only_roped": 2296708, "total_diff": 4593416, "diff_percentage": 0.6311853447446658, "num_computed": 4980736, "num_roped": 4980736}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "mask_shape": [1, 32, 1024, 9216], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:47:12.230653", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05078125, "mean_diff": 4.410743713378906e-05, "l2_diff": 1.25, "l2_diff_relative": 0.20725388601036268}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 9216, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 9216, 128], "attention_shape": [1, 32, 1024, 9216]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:48:14.492699", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.36914704624911304, "overlap_percentage": 0.5392365228562128, "num_intersection": 2968510, "num_union": 8041538, "num_only_computed": 2536514, "num_only_roped": 2536514, "total_diff": 5073028, "diff_percentage": 0.6308529537508869, "num_computed": 5505024, "num_roped": 5505024}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "mask_shape": [1, 32, 1024, 10240], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:48:16.524706", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.06591796875, "mean_diff": 4.0531158447265625e-05, "l2_diff": 1.1796875, "l2_diff_relative": 0.18969849246231155}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 10240, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 10240, 128], "attention_shape": [1, 32, 1024, 10240]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:49:23.588542", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35778128984574475, "overlap_percentage": 0.5270087200662364, "num_intersection": 3177500, "num_union": 8881124, "num_only_computed": 2851812, "num_only_roped": 2851812, "total_diff": 5703624, "diff_percentage": 0.6422187101542552, "num_computed": 6029312, "num_roped": 6029312}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "mask_shape": [1, 32, 1024, 11264], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:49:25.899990", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.095703125, "mean_diff": 3.933906555175781e-05, "l2_diff": 1.328125, "l2_diff_relative": 0.21573604060913706}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 11264, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 11264, 128], "attention_shape": [1, 32, 1024, 11264]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:50:42.166950", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3513048186627534, "overlap_percentage": 0.5199490356445312, "num_intersection": 3407538, "num_union": 9699662, "num_only_computed": 3146062, "num_only_roped": 3146062, "total_diff": 6292124, "diff_percentage": 0.6486951813372466, "num_computed": 6553600, "num_roped": 6553600}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "mask_shape": [1, 32, 1024, 12288], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:50:46.921296", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.647804260253906e-05, "l2_diff": 1.28125, "l2_diff_relative": 0.20603015075376885}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 12288, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 12288, 128], "attention_shape": [1, 32, 1024, 12288]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:52:11.006272", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.35056916858253157, "overlap_percentage": 0.5191428573043259, "num_intersection": 3674435, "num_union": 10481341, "num_only_computed": 3403453, "num_only_roped": 3403453, "total_diff": 6806906, "diff_percentage": 0.6494308314174684, "num_computed": 7077888, "num_roped": 7077888}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "mask_shape": [1, 32, 1024, 13312], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:52:14.268309", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.05615234375, "mean_diff": 3.266334533691406e-05, "l2_diff": 1.171875, "l2_diff_relative": 0.19035532994923857}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 13312, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 13312, 128], "attention_shape": [1, 32, 1024, 13312]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:53:45.217704", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3531182093687472, "overlap_percentage": 0.5219325361580684, "num_intersection": 3967823, "num_union": 11236529, "num_only_computed": 3634353, "num_only_roped": 3634353, "total_diff": 7268706, "diff_percentage": 0.6468817906312527, "num_computed": 7602176, "num_roped": 7602176}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "mask_shape": [1, 32, 1024, 14336], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:53:49.014470", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.0517578125e-05, "l2_diff": 1.078125, "l2_diff_relative": 0.17783505154639176}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 14336, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 14336, 128], "attention_shape": [1, 32, 1024, 14336]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:55:27.453906", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3485829900390446, "overlap_percentage": 0.5169618668094758, "num_intersection": 4201072, "num_union": 12051856, "num_only_computed": 3925392, "num_only_roped": 3925392, "total_diff": 7850784, "diff_percentage": 0.6514170099609554, "num_computed": 8126464, "num_roped": 8126464}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "mask_shape": [1, 32, 1024, 15360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:55:30.784417", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0615234375, "mean_diff": 3.0517578125e-05, "l2_diff": 1.0234375, "l2_diff_relative": 0.16794871794871793}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1024, "seq_len_k": 15360, "queries_shape": [1, 32, 1024, 128], "keys_shape": [1, 8, 15360, 128], "attention_shape": [1, 32, 1024, 15360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:57:16.892859", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.34761384068636964, "overlap_percentage": 0.5158953257846063, "num_intersection": 4067262, "num_union": 11700518, "num_only_computed": 3816628, "num_only_roped": 3816628, "total_diff": 7633256, "diff_percentage": 0.6523861593136304, "num_computed": 7883890, "num_roped": 7883890}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "mask_shape": [1, 32, 938, 16298], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:57:20.413045", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0546875, "mean_diff": 2.7894973754882812e-05, "l2_diff": 0.875, "l2_diff_relative": 0.14583333333333334}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 938, "seq_len_k": 16298, "queries_shape": [1, 32, 938, 128], "keys_shape": [1, 8, 16298, 128], "attention_shape": [1, 32, 938, 16298]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:59:05.679475", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4396007027725377, "overlap_percentage": 0.6107258796496937, "num_intersection": 298750, "num_union": 679594, "num_only_computed": 190422, "num_only_roped": 190422, "total_diff": 380844, "diff_percentage": 0.5603992972274623, "num_computed": 489172, "num_roped": 489172}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "mask_shape": [1, 32, 58, 16356], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T19:59:11.695370", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03662109375, "mean_diff": 2.300739288330078e-05, "l2_diff": 0.28515625, "l2_diff_relative": 0.1721698113207547}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 58, "seq_len_k": 16356, "queries_shape": [1, 32, 58, 128], "keys_shape": [1, 8, 16356, 128], "attention_shape": [1, 32, 58, 16356]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:00:42.368165", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.43118954692007466, "overlap_percentage": 0.6025610623666113, "num_intersection": 5082, "num_union": 11786, "num_only_computed": 3352, "num_only_roped": 3352, "total_diff": 6704, "diff_percentage": 0.5688104530799253, "num_computed": 8434, "num_roped": 8434}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "mask_shape": [1, 32, 1, 16357], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:00:44.869468", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0322265625, "mean_diff": 2.181529998779297e-05, "l2_diff": 0.04833984375, "l2_diff_relative": 0.20121951219512196}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16357, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16357, 128], "attention_shape": [1, 32, 1, 16357]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:02:04.400794", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4660641348744243, "overlap_percentage": 0.6358032009484291, "num_intersection": 5363, "num_union": 11507, "num_only_computed": 3072, "num_only_roped": 3072, "total_diff": 6144, "diff_percentage": 0.5339358651255758, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "mask_shape": [1, 32, 1, 16358], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:02:06.919189", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.205371856689453e-05, "l2_diff": 0.038818359375, "l2_diff_relative": 0.20075757575757575}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16358, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16358, 128], "attention_shape": [1, 32, 1, 16358]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:03:25.758258", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4337922828488866, "overlap_percentage": 0.6050978067575578, "num_intersection": 5104, "num_union": 11766, "num_only_computed": 3331, "num_only_roped": 3331, "total_diff": 6662, "diff_percentage": 0.5662077171511134, "num_computed": 8435, "num_roped": 8435}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "mask_shape": [1, 32, 1, 16359], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:03:28.298173", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.0384788513183594e-05, "l2_diff": 0.042236328125, "l2_diff_relative": 0.18642241379310345}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16359, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16359, 128], "attention_shape": [1, 32, 1, 16359]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:04:47.503063", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4339622641509434, "overlap_percentage": 0.6052631578947368, "num_intersection": 5106, "num_union": 11766, "num_only_computed": 3330, "num_only_roped": 3330, "total_diff": 6660, "diff_percentage": 0.5660377358490566, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "mask_shape": [1, 32, 1, 16360], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:04:49.990170", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.027099609375, "mean_diff": 2.6941299438476562e-05, "l2_diff": 0.0595703125, "l2_diff_relative": 0.34269662921348315}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16360, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16360, 128], "attention_shape": [1, 32, 1, 16360]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:06:08.923439", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.37865664324235987, "overlap_percentage": 0.5493124703651019, "num_intersection": 4634, "num_union": 12238, "num_only_computed": 3802, "num_only_roped": 3802, "total_diff": 7604, "diff_percentage": 0.6213433567576402, "num_computed": 8436, "num_roped": 8436}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "mask_shape": [1, 32, 1, 16361], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:06:12.951170", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0234375, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.0419921875, "l2_diff_relative": 0.15579710144927536}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16361, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16361, 128], "attention_shape": [1, 32, 1, 16361]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:07:30.323914", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4515268817204301, "overlap_percentage": 0.6221405712931136, "num_intersection": 5249, "num_union": 11625, "num_only_computed": 3188, "num_only_roped": 3188, "total_diff": 6376, "diff_percentage": 0.5484731182795699, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "mask_shape": [1, 32, 1, 16362], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:07:33.829261", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.021484375, "mean_diff": 2.014636993408203e-05, "l2_diff": 0.04296875, "l2_diff_relative": 0.2222222222222222}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16362, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16362, 128], "attention_shape": [1, 32, 1, 16362]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:08:51.350681", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4284263099974604, "overlap_percentage": 0.5998577693492948, "num_intersection": 5061, "num_union": 11813, "num_only_computed": 3376, "num_only_roped": 3376, "total_diff": 6752, "diff_percentage": 0.5715736900025395, "num_computed": 8437, "num_roped": 8437}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "mask_shape": [1, 32, 1, 16363], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:08:53.827113", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03369140625, "mean_diff": 2.5510787963867188e-05, "l2_diff": 0.062255859375, "l2_diff_relative": 0.33031088082901555}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16363, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16363, 128], "attention_shape": [1, 32, 1, 16363]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:10:12.139485", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4456056193249957, "overlap_percentage": 0.6164968001896184, "num_intersection": 5202, "num_union": 11674, "num_only_computed": 3236, "num_only_roped": 3236, "total_diff": 6472, "diff_percentage": 0.5543943806750042, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "mask_shape": [1, 32, 1, 16364], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:10:14.614560", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.03466796875, "mean_diff": 2.7060508728027344e-05, "l2_diff": 0.06640625, "l2_diff_relative": 0.3300970873786408}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16364, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16364, 128], "attention_shape": [1, 32, 1, 16364]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:11:33.318482", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.3978298683011679, "overlap_percentage": 0.5692107134392036, "num_intersection": 4803, "num_union": 12073, "num_only_computed": 3635, "num_only_roped": 3635, "total_diff": 7270, "diff_percentage": 0.6021701316988322, "num_computed": 8438, "num_roped": 8438}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "mask_shape": [1, 32, 1, 16365], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:11:35.977058", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02490234375, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.054443359375, "l2_diff_relative": 0.223}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16365, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16365, 128], "attention_shape": [1, 32, 1, 16365]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:12:59.893225", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.46905735921316044, "overlap_percentage": 0.6385827704704349, "num_intersection": 5389, "num_union": 11489, "num_only_computed": 3050, "num_only_roped": 3050, "total_diff": 6100, "diff_percentage": 0.5309426407868396, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "mask_shape": [1, 32, 1, 16366], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:13:02.569007", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0185546875, "mean_diff": 1.9073486328125e-05, "l2_diff": 0.034912109375, "l2_diff_relative": 0.20906432748538012}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16366, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16366, 128], "attention_shape": [1, 32, 1, 16366]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:14:27.502094", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.42394330549228043, "overlap_percentage": 0.5954496978314966, "num_intersection": 5025, "num_union": 11853, "num_only_computed": 3414, "num_only_roped": 3414, "total_diff": 6828, "diff_percentage": 0.5760566945077196, "num_computed": 8439, "num_roped": 8439}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "mask_shape": [1, 32, 1, 16367], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:14:31.187869", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02587890625, "mean_diff": 1.895427703857422e-05, "l2_diff": 0.039306640625, "l2_diff_relative": 0.19925742574257427}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16367, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16367, 128], "attention_shape": [1, 32, 1, 16367]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:15:52.834109", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4325723499957566, "overlap_percentage": 0.603909952606635, "num_intersection": 5097, "num_union": 11783, "num_only_computed": 3343, "num_only_roped": 3343, "total_diff": 6686, "diff_percentage": 0.5674276500042434, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "mask_shape": [1, 32, 1, 16368], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:15:55.818832", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.01806640625, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.042724609375, "l2_diff_relative": 0.2266839378238342}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16368, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16368, 128], "attention_shape": [1, 32, 1, 16368]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:17:15.421479", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4795337014637567, "overlap_percentage": 0.6482227488151658, "num_intersection": 5471, "num_union": 11409, "num_only_computed": 2969, "num_only_roped": 2969, "total_diff": 5938, "diff_percentage": 0.5204662985362433, "num_computed": 8440, "num_roped": 8440}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "mask_shape": [1, 32, 1, 16369], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:17:17.881858", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.9669532775878906e-05, "l2_diff": 0.0299072265625, "l2_diff_relative": 0.18788343558282208}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16369, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16369, 128], "attention_shape": [1, 32, 1, 16369]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:18:35.740659", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44352287302265925, "overlap_percentage": 0.6145006515815662, "num_intersection": 5187, "num_union": 11695, "num_only_computed": 3254, "num_only_roped": 3254, "total_diff": 6508, "diff_percentage": 0.5564771269773408, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "mask_shape": [1, 32, 1, 16370], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:18:38.196921", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.02001953125, "mean_diff": 2.1457672119140625e-05, "l2_diff": 0.03759765625, "l2_diff_relative": 0.19543147208121828}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16370, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16370, 128], "attention_shape": [1, 32, 1, 16370]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:19:55.856101", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.44760761447436115, "overlap_percentage": 0.6184101409785571, "num_intersection": 5220, "num_union": 11662, "num_only_computed": 3221, "num_only_roped": 3221, "total_diff": 6442, "diff_percentage": 0.5523923855256389, "num_computed": 8441, "num_roped": 8441}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "mask_shape": [1, 32, 1, 16371], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:19:59.199813", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0263671875, "mean_diff": 2.2411346435546875e-05, "l2_diff": 0.0478515625, "l2_diff_relative": 0.20851063829787234}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16371, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16371, 128], "attention_shape": [1, 32, 1, 16371]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:21:17.051955", "metric": "research_mask_roped_vs_unroped", "value": {"jaccard_similarity": 0.4318181818181818, "overlap_percentage": 0.6031746031746031, "num_intersection": 5092, "num_union": 11792, "num_only_computed": 3350, "num_only_roped": 3350, "total_diff": 6700, "diff_percentage": 0.5681818181818182, "num_computed": 8442, "num_roped": 8442}, "metadata": {"layer_idx": 15, "head_idx": 0, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "mask_shape": [1, 32, 1, 16372], "comparison_type": "unroped_vs_roped", "extend_context": true, "unroped_used": true}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
{"timestamp": "2025-11-19T20:21:20.915046", "metric": "research_attention_weight_diff", "value": {"max_diff": 0.0166015625, "mean_diff": 1.6927719116210938e-05, "l2_diff": 0.0213623046875, "l2_diff_relative": 0.09308510638297872}, "metadata": {"layer_idx": 15, "head_idx": 10, "batch_size": 1, "seq_len_q": 1, "seq_len_k": 16372, "queries_shape": [1, 32, 1, 128], "keys_shape": [1, 8, 16372, 128], "attention_shape": [1, 32, 1, 16372]}, "location": "sparse_attention_hub.sparse_attention.research_attention.base.ResearchAttention.custom_attention"}
